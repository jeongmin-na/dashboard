<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Samsung AI Experience Group Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #1a1a1a;
            color: #e1e1e1;
            overflow-x: hidden;
        }

        .dashboard-container {
            display: flex;
            height: 100vh;
            align-items: stretch;
        }

        /* ì‚¬ì´ë“œë°” ìŠ¤íƒ€ì¼ */
        .sidebar {
            width: 250px;
            background-color: #2a2a2a;
            color: #b1b1b1;
            border-right: 1px solid #3a3a3a;
            display: flex;
            flex-direction: column;
        }



        .menu-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: #b1b1b1;
            text-decoration: none;
            transition: all 0.2s ease;
            font-size: 14px;
            cursor: pointer;
            user-select: none;
        }

        .menu-item:hover {
            background-color: #3a3a3a;
            color: #fff;
        }

        .menu-item.active {
            background-color: #4a4a4a;
            color: #fff;
        }

        .refresh-button {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: #b1b1b1;
            text-decoration: none;
            transition: all 0.2s ease;
            font-size: 14px;
            cursor: pointer;
            user-select: none;
        }

        .refresh-button:hover {
            background-color: #3a3a3a;
            color: #fff;
        }

        .refresh-progress {
            position: absolute;
            bottom: -10px;
            left: 20px;
            right: 20px;
            height: 6px;
            background-color: #2a2a2a;
            border-radius: 3px;
            overflow: hidden;
            display: none;
        }

        .refresh-progress-bar {
            height: 100%;
            background-color: #4a9eff;
            border-radius: 3px;
            width: 0%;
            transition: width 0.3s ease;
        }

        .refresh-button {
            position: relative;
        }

        .menu-icon {
            width: 16px;
            height: 16px;
            margin-right: 12px;
            opacity: 0.7;
        }

        /* ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ */
        .main-content {
            flex: 1;
            background-color: #1a1a1a;
            display: flex;
            flex-direction: column;
        }

        .header {
            background-color: #1a1a1a; /* ë°°ê²½ìƒ‰ ê²€ì •ìœ¼ë¡œ ë³€ê²½ */
            padding: 20px 30px;
            height: 80px;
            box-sizing: border-box;
            position: relative;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* í—¤ë” ì•„ë˜ ì„ ì— ì—¬ë°± ì¶”ê°€ */
        .header::after {
            content: '';
            position: absolute;
            left: 30px;
            right: 30px;
            bottom: 0;
            height: 1px;
            background-color: #3a3a3a;
        }



        .header-left h1 {
            color: #fff;
            font-size: 24px;
            font-weight: 600;
        }

        .content-area {
            padding: 30px;
            min-height: calc(100vh - 80px);
            overflow-y: auto;
        }

        /* ê¸°ë³¸ ìˆ¨ê¹€ ì²˜ë¦¬ */
        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        /* Overview í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
        .overview-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .overview-stat-box {
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 8px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .overview-stat-box:hover {
            background-color: #3a3a3a;
            border-color: #4a4a4a;
        }

        .overview-stat-box.clickable {
            cursor: pointer;
        }

        .overview-stat-box.selected {
            background-color: #3a3a3a;
            border-color: #5a9eff;
            box-shadow: 0 0 10px rgba(90, 158, 255, 0.3);
        }

        .overview-stat-box.selected .stat-number,
        .overview-stat-box.selected .stat-label,
        .overview-stat-box.selected .stat-description {
            color: white;
        }

        .overview-stat-box .stat-number {
            font-size: 36px;
            font-weight: 700;
            color: #fff;
            margin-bottom: 8px;
        }

        .overview-stat-box .stat-label {
            font-size: 16px;
            font-weight: 600;
            color: #e1e1e1;
            margin-bottom: 4px;
        }

        .overview-stat-box .stat-description {
            font-size: 12px;
            color: #b1b1b1;
        }

        .overview-chart-container {
            background-color: #1a1a1a;
            border: 1px solid #3a3a3a;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-header h3 {
            color: #fff;
            font-size: 18px;
            font-weight: 600;
            background-color: transparent;
        }

        .chart-controls {
            display: flex;
            gap: 8px;
        }

        .chart-btn {
            background-color: #3a3a3a;
            border: 1px solid #4a4a4a;
            color: #b1b1b1;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .chart-btn:hover {
            background-color: #4a4a4a;
            color: #fff;
        }

        .chart-btn.active {
            background-color: #4a9eff;
            border-color: #4a9eff;
            color: white;
        }

        .overview-member-details {
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 4px;
            overflow: hidden;
        }

        .member-details-header {
            background-color: #1a1a1a;
            color: #fff;
            padding: 15px 20px;
            margin: 0;
            border-bottom: 1px solid #3a3a3a;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .member-details-header h3 {
            font-size: 18px;
            font-weight: 600;
        }



        .member-list {
            display: grid;
            gap: 0;
        }

        .member-list-header {
            display: grid;
            grid-template-columns: 1.5fr 2fr 1fr 1.5fr 1fr 1fr 1fr;
            gap: 20px;
            padding: 12px 20px;
            background-color: #2a2a2a;
            color: #b1b1b1;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            border-bottom: 2px solid #3a3a3a;
        }

        .member-item {
            display: grid;
            grid-template-columns: 1.5fr 2fr 1fr 1.5fr 1fr 1fr 1fr;
            gap: 20px;
            align-items: center;
            padding: 12px 20px;
            background-color: #1a1a1a;
            border-bottom: 1px solid #3a3a3a;
            font-size: 14px;
        }

        .member-item:hover {
            background-color: #2a2a2a;
        }

        .member-item:last-child {
            border-bottom: none;
        }

        .member-date {
            color: #b1b1b1;
            font-size: 13px;
        }

        .member-email {
            color: #b1b1b1;
        }

        .clickable-email {
            color: #4a9eff;
            cursor: pointer;
            text-decoration: none;
            transition: color 0.2s ease;
        }

        .clickable-email:hover {
            color: #2196f3;
            text-decoration: underline;
        }

        .member-type {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .member-type.active {
            background-color: rgba(76, 175, 80, 0.2);
            color: #4caf50;
        }

        .member-type.inactive {
            background-color: rgba(255, 152, 0, 0.2);
            color: #ff9800;
        }

        .member-kind {
            color: #e1e1e1;
            font-size: 13px;
        }

        .member-request {
            color: #fff;
            font-weight: 500;
        }

        .member-spend {
            color: #4a9eff;
            font-weight: 600;
        }

        /* í™œë™ë¦¬ìŠ¤íŠ¸ í˜ì´ì§€ë„¤ì´ì…˜ ìŠ¤íƒ€ì¼ */
        .activity-pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            padding: 15px 20px;
            background-color: #2a2a2a;
            border-top: 1px solid #3a3a3a;
        }

        .activity-pagination button {
            background: #3a3a3a;
            border: 1px solid #4a4a4a;
            color: #e1e1e1;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
        }

        .activity-pagination button:hover {
            background: #4a4a4a;
        }

        .activity-pagination button.active {
            background: #4a9eff;
            border-color: #4a9eff;
            color: white;
        }

        .activity-pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .activity-pagination .page-info {
            color: #b1b1b1;
            font-size: 12px;
            margin: 0 10px;
        }

        .activity-page-size-selector {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: auto;
        }

        .activity-page-size-selector select {
            background: #3a3a3a;
            color: #fff;
            border: 1px solid #4a4a4a;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
        }
        
        /* ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ í˜ì´ì§€ë„¤ì´ì…˜ ìŠ¤íƒ€ì¼ */
        .user-cumulative-pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            padding: 15px 20px;
            background-color: #2a2a2a;
            border-top: 1px solid #3a3a3a;
        }
        
        .user-cumulative-pagination button {
            background: #3a3a3a;
            color: #e1e1e1;
            border: 1px solid #4a4a4a;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
        }
        
        .user-cumulative-pagination button:hover:not(:disabled) {
            background: #4a4a4a;
            border-color: #5a5a5a;
        }
        
        .user-cumulative-pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .user-cumulative-pagination .page-info {
            color: #b1b1b1;
            font-size: 14px;
            min-width: 120px;
            text-align: center;
        }
        
        .user-cumulative-page-size-selector {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .user-cumulative-page-size-selector select {
            background: #3a3a3a;
            color: #fff;
            border: 1px solid #4a4a4a;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
        }

        /* Members í˜ì´ì§€ë„¤ì´ì…˜ ìŠ¤íƒ€ì¼ (All Raw Eventsì™€ ë™ì¼) */
        #members-pagination button {
            background: #3a3a3a;
            border: 1px solid #4a4a4a;
            color: #e1e1e1;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            margin: 0 2px;
            transition: all 0.2s ease;
        }

        #members-pagination button:hover {
            background: #4a4a4a;
            border-color: #5a5a5a;
        }

        #members-pagination button.active {
            background: #4a9eff;
            border-color: #4a9eff;
            color: white;
            font-weight: 600;
        }

        #members-pagination span {
            color: #7a7a7a;
            padding: 0 5px;
        }

        /* í•„í„° ë° ê²€ìƒ‰ ì˜ì—­ */
        .filter-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 15px 0;
            border-bottom: 1px solid #3a3a3a;
        }

        /* Members ì„¹ì…˜ì—ì„œ êµ¬ë¶„ì„  ì œê±° ë° ê°„ê²© ì¶•ì†Œ */
        #members .filter-controls {
            border-bottom: none;
            margin-bottom: 15px;
            padding: 10px 0;
        }

        .filter-controls         .chart-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .date-picker {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .date-picker input[type="date"] {
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 4px;
            padding: 8px 12px;
            color: #fff;
            font-size: 14px;
        }

        /* ë‹¬ë ¥ ì•„ì´ì½˜ ìƒ‰ìƒ ë³€ê²½ */
        .date-picker input[type="date"]::-webkit-calendar-picker-indicator {
            filter: invert(1) brightness(1.5) sepia(1) saturate(5) hue-rotate(45deg);
            cursor: pointer;
        }

        .date-picker input[type="date"]::-moz-calendar-picker-indicator {
            filter: invert(1) brightness(1.5) sepia(1) saturate(5) hue-rotate(45deg);
            cursor: pointer;
        }

        .date-picker span {
            color: #ccc;
            font-weight: 500;
        }

        .filter-controls .chart-btn {
            min-width: 40px;
        }

        /* ë°ì´í„° ë¡œë”© ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .data-loading-btn {
            background: linear-gradient(135deg, #4a9eff, #007bff);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(74, 158, 255, 0.3);
        }

        .data-loading-btn:hover {
            background: linear-gradient(135deg, #007bff, #0056b3);
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(74, 158, 255, 0.4);
        }

        .data-loading-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(74, 158, 255, 0.3);
        }

        .data-loading-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .date-filter-btn {
            background: #2a2a2a;
            border: 1px solid #3a3a3a;
            color: #e1e1e1;
            padding: 6px 16px;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .date-filter-btn:hover {
            background-color: #3a3a3a;
        }

        .analytics-btn {
            background: transparent;
            border: 1px solid #4a4a4a;
            color: #e1e1e1;
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
            height: 32px;
        }

        .analytics-btn:hover {
            background-color: #2a2a2a;
        }

        /* ë°°ì§€ ìŠ¤íƒ€ì¼ */
        .role-badge {
            background-color: #3a3a3a;
            color: #e1e1e1;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
            display: inline-block;
        }

        .role-badge.admin {
            background-color: #4a9eff;
            color: white;
        }

        /* Members í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
        .data-table {
            background-color: #1a1a1a;
            border: 1px solid #3a3a3a;
            border-radius: 8px;
            overflow: hidden;
            width: 100%;
        }

        .table-header {
            background-color: #2a2a2a;
            padding: 15px 20px;
            border-bottom: 1px solid #3a3a3a;
            display: grid;
            grid-template-columns: 2fr 2fr 1fr 1fr 1fr 0.5fr;
            gap: 20px;
            font-size: 12px;
            font-weight: 600;
            color: #b1b1b1;
            text-transform: uppercase;
        }

        .table-row {
            padding: 15px 20px;
            border-bottom: 1px solid #3a3a3a;
            display: grid;
            grid-template-columns: 2fr 2fr 1fr 1fr 1fr 0.5fr;
            gap: 20px;
            align-items: center;
            font-size: 14px;
            background-color: #1a1a1a;
        }

        .table-row:hover {
            background-color: #2a2a2a;
        }

        .table-row:last-child {
            border-bottom: none;
        }

        /* Usage í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
        .usage-cards {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .usage-card {
            background-color: #2a2a2a;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #3a3a3a;
        }

        .usage-card-number {
            font-size: 32px;
            font-weight: 700;
            color: #fff;
            margin-bottom: 8px;
        }

        .usage-card-label {
            color: #b1b1b1;
            font-size: 14px;
        }

        .search-box {
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 6px;
            padding: 8px 12px;
            color: #e1e1e1;
            font-size: 14px;
            width: 250px;
        }

        .search-container {
            position: relative;
            display: inline-block;
        }

        .search-clear-btn {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #f44336;
            cursor: pointer;
            padding: 4px;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            transition: all 0.2s ease;
        }

        .search-clear-btn:hover {
            background-color: #f44336;
            color: white;
        }

        .search-clear-btn:active {
            background-color: #d32f2f;
            color: white;
        }

        .autocomplete-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 6px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            margin-top: 2px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .autocomplete-item {
            padding: 10px 12px;
            cursor: pointer;
            border-bottom: 1px solid #3a3a3a;
            transition: background-color 0.2s ease;
        }

        .autocomplete-item:last-child {
            border-bottom: none;
        }

        .autocomplete-item:hover {
            background-color: #3a3a3a;
        }

        .autocomplete-item.selected {
            background-color: #4a9eff;
            color: white;
        }

        .autocomplete-item .user-name {
            font-weight: 600;
            color: #e1e1e1;
            font-size: 14px;
            margin-bottom: 2px;
        }

        .autocomplete-item .user-email {
            color: #b1b1b1;
            font-size: 12px;
        }

        .autocomplete-item.selected .user-name,
        .autocomplete-item.selected .user-email {
            color: white;
        }

        .user-cumulative-info {
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 8px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .user-cumulative-header {
            background-color: #1a1a1a;
            color: #fff;
            padding: 15px 20px;
            margin: 0;
            border-bottom: 1px solid #3a3a3a;
            font-size: 18px;
            font-weight: 600;
        }

        .user-cumulative-table {
            background-color: #2a2a2a;
            padding: 15px 20px;
            border-bottom: 1px solid #3a3a3a;
            display: grid;
            grid-template-columns: 1.5fr 2fr 1fr 1.5fr 1fr 1fr 1fr;
            gap: 20px;
            font-size: 12px;
            font-weight: 600;
            color: #b1b1b1;
            text-transform: uppercase;
        }

        /* Overview í™œë™ í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .overview-activity-header {
            background-color: #1a1a1a;
            color: #fff;
            padding: 15px 20px;
            margin: 0;
            border-bottom: 1px solid #3a3a3a;
            font-size: 18px;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .overview-activity-table {
            background-color: #2a2a2a;
            padding: 15px 20px;
            border-bottom: 1px solid #3a3a3a;
            display: grid;
            grid-template-columns: 1.5fr 2fr 1fr 1.5fr 1fr 1fr 1fr;
            gap: 20px;
            font-size: 12px;
            font-weight: 600;
            color: #b1b1b1;
            text-transform: uppercase;
        }

        /* Export CSV ë²„íŠ¼ í˜¸ë²„ íš¨ê³¼ */
        .export-csv-btn:hover {
            background-color: #45a049 !important;
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .export-csv-btn:active {
            transform: translateY(0);
            box-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }

        .user-cumulative-row {
            padding: 15px 20px;
            border-bottom: 1px solid #3a3a3a;
            display: grid;
            grid-template-columns: 1.5fr 2fr 1fr 1.5fr 1fr 1fr 1fr;
            gap: 20px;
            align-items: center;
            font-size: 14px;
            background-color: #1a1a1a;
        }

        .user-cumulative-row:hover {
            background-color: #2a2a2a;
        }

        .user-cumulative-row:last-child {
            border-bottom: none;
        }

        .user-email {
            color: #4a9eff;
            font-weight: 600;
        }

        /* Settings í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
        .settings-section {
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 8px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .accordion-header {
            background-color: #2a2a2a;
            padding: 20px;
            border-bottom: 1px solid #3a3a3a;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.2s ease;
        }

        .accordion-header:hover {
            background-color: #3a3a3a;
        }

        .accordion-title {
            font-size: 18px;
            font-weight: 600;
            color: #fff;
        }

        .accordion-arrow {
            font-size: 16px;
            color: #b1b1b1;
            transition: transform 0.2s ease;
        }

        .accordion-content {
            display: none;
            padding: 20px;
            background-color: #1a1a1a;
        }

        .accordion-content.active {
            display: block;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #3a3a3a;
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-label {
            color: #fff;
            margin-bottom: 4px;
        }

        .setting-description {
            color: #7a7a7a;
            font-size: 12px;
        }

        .toggle-switch {
            width: 44px;
            height: 24px;
            background-color: #4a9eff;
            border-radius: 12px;
            position: relative;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .toggle-switch.off {
            background-color: #5a5a5a;
        }

        .toggle-switch::after {
            content: '';
            width: 20px;
            height: 20px;
            background-color: white;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            right: 2px;
            transition: all 0.2s ease;
        }

        .toggle-switch.off::after {
            right: 22px;
        }

        .setting-select {
            background: #3a3a3a;
            color: #fff;
            border: 1px solid #4a4a4a;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 14px;
        }

        .export-btn {
            background: #4a9eff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.2s;
        }

        .export-btn:hover {
            background: #3a8edf;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .sidebar {
                width: 70px;
            }
           
            .menu-text {
                display: none;
            }

            .overview-stats {
                grid-template-columns: 1fr;
            }

            .member-item,
            .member-list-header,
            .table-row,
            .table-header,
            .user-cumulative-row,
            .user-cumulative-table {
                grid-template-columns: 1fr;
                gap: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- ì‚¬ì´ë“œë°” -->
        <nav class="sidebar">
            <div style="height: 20px;"></div>
            <a href="javascript:void(0)" class="refresh-button" onclick="handleRefreshClick()">
                <span class="menu-icon">ğŸ”„</span>
                <span class="menu-text">ì‚¬ìš©ì ì •ë³´ ì—…ë°ì´íŠ¸</span>
                <div class="refresh-progress">
                    <div class="refresh-progress-bar"></div>
                </div>
            </a>
            <div style="height: 1px; background-color: #3a3a3a; margin: 10px 20px;"></div>
            <a href="javascript:void(0)" class="menu-item active" data-section="overview">
                <span class="menu-icon">ğŸ“Š</span>
                <span class="menu-text">Overview</span>
            </a>
            <a href="javascript:void(0)" class="menu-item" data-section="settings">
                <span class="menu-icon">âš™ï¸</span>
                <span class="menu-text">Settings</span>
            </a>
            <a href="javascript:void(0)" class="menu-item" data-section="members">
                <span class="menu-icon">ğŸ‘¥</span>
                <span class="menu-text">Members</span>
            </a>
            <a href="javascript:void(0)" class="menu-item" data-section="usage">
                <span class="menu-icon">ğŸ“ˆ</span>
                <span class="menu-text">Usage</span>
            </a>
        </nav>

        <!-- ë©”ì¸ ì½˜í…ì¸  -->
        <main class="main-content">
            <header class="header">
                <div class="header-left">
                    <h1 id="page-title">Dashboard Overview</h1>
                </div>
                <div class="header-right">
                    <!-- Clear Cache button and Ready status removed -->
                </div>
            </header>

            <div class="content-area">
                <!-- Overview ì„¹ì…˜ -->
                <div id="overview" class="content-section active">
                    <!-- 2.1.1 í•„í„°ë§ ê¸°ëŠ¥ -->
                    <div class="filter-controls">
                        <div class="chart-controls">
                            <button class="chart-btn" data-days="1">1d</button>
                            <button class="chart-btn" data-days="7">7d</button>
                            <button class="chart-btn active" data-days="30">30d</button>
                            <div class="date-picker">
                                <input type="date" id="start-date" />
                                <span>~</span>
                                <input type="date" id="end-date" />
                                <button class="analytics-btn" onclick="applyDateFilter()">ì ìš©</button>
                            </div>
                        </div>

                    </div>

                    <!-- ì‚¬ìš©ëŸ‰ ê°œìš” ì¹´ë“œ (Usageì—ì„œ ì´ë™) -->
                    <div class="usage-cards">
                        <div class="usage-card">
                            <div class="usage-card-number">-</div>
                            <div class="usage-card-label">Total Users</div>
                        </div>
                        <div class="usage-card">
                            <div class="usage-card-number">-</div>
                            <div class="usage-card-label">Lines of Agent Edits</div>
                        </div>
                        <div class="usage-card">
                            <div class="usage-card-number">-</div>
                            <div class="usage-card-label">Tabs Accepted</div>
                        </div>
                        <div class="usage-card">
                            <div class="usage-card-number">-</div>
                            <div class="usage-card-label">Chats</div>
                        </div>
                    </div>

                    <!-- ê·¸ë˜í”„ ì˜ì—­ -->
                    <div class="overview-chart-container">
                        <div class="chart-header">
                            <h3>ì¼ë³„ í™œë™ ì¶”ì´</h3>
                        </div>
                        <canvas id="overviewChart" style="width: 100%; height: 300px;"></canvas>
                    </div>

                    <!-- 2.1.2 í†µê³„ ì¹´ë“œ -->
                    <div class="overview-stats">
                        <div class="overview-stat-box clickable" data-type="total" onclick="filterOverviewMembersByType('total')">
                            <div class="stat-number">20</div>
                            <div class="stat-label">
                                <span class="role-badge" style="background-color: #4a9eff; color: white;">ì „ì²´ ë©¤ë²„</span>
                            </div>
                            <div class="stat-description">ëª¨ë“  ë©¤ë²„ì˜ í™œë™ ê¸°ë¡</div>
                        </div>
                        <div class="overview-stat-box clickable" data-type="active" onclick="filterOverviewMembersByType('active')">
                            <div class="stat-number">13</div>
                            <div class="stat-label">
                                <span class="role-badge" style="background-color: #4caf50; color: white;">í™œì„± ë©¤ë²„</span>
                            </div>
                            <div class="stat-description">í™œì„± ë©¤ë²„ì˜ í™œë™ ê¸°ë¡</div>
                        </div>
                        <div class="overview-stat-box clickable" data-type="inactive" onclick="filterOverviewMembersByType('inactive')">
                            <div class="stat-number">7</div>
                            <div class="stat-label">
                                <span class="role-badge" style="background-color: #ff9800; color: white;">ë¹„í™œì„± ë©¤ë²„</span>
                            </div>
                            <div class="stat-description">ë¹„í™œì„± ë©¤ë²„ì˜ í™œë™ ê¸°ë¡</div>
                        </div>
                    </div>

                    <!-- ë©¤ë²„ ì„¸ë¶€ ë¦¬ìŠ¤íŠ¸ -->
                    <div class="overview-member-details">
                        <div class="overview-activity-header">ğŸ“‹ í™œë™ ë¦¬ìŠ¤íŠ¸</div>
                        <div class="overview-activity-table">
                            <div>ë§ˆì§€ë§‰ í™œë™</div>
                            <div>ì‚¬ìš©ì</div>
                            <div>ìƒíƒœ</div>
                            <div>í™œë™ ìœ í˜•</div>
                            <div>ìš”ì²­ ìˆ˜</div>
                            <div>ë¹„ìš©</div>
                            <div>ì œí•œ</div>
                        </div>
                        <div id="overview-activity-container">
                            <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë  í…Œì´ë¸” ë‚´ìš© -->
                            <div style="padding: 20px; text-align: center; color: #7a7a7a; background-color: #1a1a1a;">
                                ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                            </div>
                        </div>
                        
                        <!-- Overview í™œë™ë¦¬ìŠ¤íŠ¸ í˜ì´ì§€ë„¤ì´ì…˜ (Members ìŠ¤íƒ€ì¼) -->
                        <div id="overview-activity-pagination" style="display: none; padding: 15px 20px; background-color: #2a2a2a; border-top: 1px solid #3a3a3a; text-align: center;">
                            <!-- ìˆ«ì í˜ì´ì§€ ë²„íŠ¼ë“¤ì´ ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
                        </div>
                    </div>
                </div>

                <!-- Members ì„¹ì…˜ -->
                <div id="members" class="content-section">
                    <div class="filter-controls" style="margin-bottom: 10px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                            <div style="color: #e1e1e1; font-size: 14px; font-weight: 500; margin-left: 20px;">
                                Fast Requests last reset on: <span id="fast-requests-reset-date" style="color: #ffffff; font-weight: 600;">2025ë…„ 7ì›” 22ì¼</span> (ì˜¤ëŠ˜ ë‚ ì§œ: <span id="today-date" style="color: #ff9800; font-weight: 600;">2025-08-03</span>)
                            </div>
                            <div style="display: flex; align-items: center; gap: 15px; margin-left: auto;">
                                <div class="search-container">
                                    <div style="position: relative; display: flex; align-items: center;">
                                        <span style="position: absolute; left: 12px; color: #7a7a7a; font-size: 14px;">ğŸ”</span>
                                        <input type="text" class="search-box" id="members-search" placeholder="Search name, email..." onkeyup="filterMembers(this.value)" oninput="toggleSearchClearBtn('members-search'); showAutocomplete('members-search')" autocomplete="off" style="padding-left: 35px;">
                                        <button class="search-clear-btn" id="members-search-clear" onclick="clearSearch('members-search')" style="display: none;">Ã—</button>
                                    </div>
                                    <div id="members-autocomplete" class="autocomplete-dropdown" style="display: none;"></div>
                                </div>
                                <button class="export-csv-btn" onclick="exportMembersToCSV()" style="background: #4caf50; color: white; border: none; padding: 8px 16px; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: pointer; transition: background-color 0.2s ease;">
                                    ğŸ“Š Export CSV
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="data-table" id="members-table-container">
                        <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë  í…Œì´ë¸” í—¤ë”ì™€ ë‚´ìš© -->
                        <div style="padding: 20px; text-align: center; color: #7a7a7a; background-color: #1a1a1a;">
                            ì‹¤ì œ ë©¤ë²„ ë°ì´í„°ë¥¼ ë¡œë”©í•˜ëŠ” ì¤‘...
                        </div>
                    </div>
                    
                    <!-- Members í˜ì´ì§€ë„¤ì´ì…˜ (All Raw Events ìŠ¤íƒ€ì¼) -->
                    <div id="members-pagination" style="display: none; padding: 15px 20px; background-color: #2a2a2a; border-top: 1px solid #3a3a3a; text-align: center;">
                        <!-- ìˆ«ì í˜ì´ì§€ ë²„íŠ¼ë“¤ì´ ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
                    </div>
                </div>

                <!-- Usage ì„¹ì…˜ -->
                <div id="usage" class="content-section">
                    <!-- ë‚ ì§œ í•„í„°ì™€ ê²€ìƒ‰ -->
                    <div class="filter-controls">
                        <div class="chart-controls">
                            <button class="chart-btn" data-days="1">1d</button>
                            <button class="chart-btn" data-days="7">7d</button>
                            <button class="chart-btn active" data-days="30">30d</button>
                            <div class="date-picker">
                                <input type="date" id="usage-start-date" />
                                <span>~</span>
                                <input type="date" id="usage-end-date" />
                                <button class="analytics-btn" onclick="applyUsageDateFilter()">ì ìš©</button>
                            </div>
                        </div>
                        <div>
                            <div class="search-container">
                                <div style="position: relative; display: flex; align-items: center;">
                                    <span style="position: absolute; left: 12px; color: #7a7a7a; font-size: 14px;">ğŸ”</span>
                                    <input type="text" class="search-box" id="usage-search" placeholder="Search name, email..." onkeyup="filterUsageMembers(this.value)" oninput="toggleSearchClearBtn('usage-search'); showAutocomplete('usage-search')" autocomplete="off" style="padding-left: 35px;">
                                    <button class="search-clear-btn" id="usage-search-clear" onclick="clearSearch('usage-search')" style="display: none;">Ã—</button>
                                </div>
                                <div id="usage-autocomplete" class="autocomplete-dropdown" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <!-- ì‚¬ìš©ìë³„ ëˆ„ì  ì •ë³´ -->
                    <div class="user-cumulative-info">
                        <div class="user-cumulative-header">ğŸ“Š ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´</div>
                        <div class="user-cumulative-table">
                            <div>NAME</div>
                            <div>EMAIL</div>
                            <div>ROLE</div>
                            <div>REQUEST</div>
                            <div>SPEND</div>
                            <div>LAST ACT</div>
                        </div>
                        <div id="user-cumulative-container">
                            <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë  í…Œì´ë¸” ë‚´ìš© -->
                            <div style="padding: 20px; text-align: center; color: #7a7a7a; background-color: #1a1a1a;">
                                ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                            </div>
                        </div>
                        
                        <!-- ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ í˜ì´ì§€ë„¤ì´ì…˜ (All Raw Events ìŠ¤íƒ€ì¼) -->
                        <div id="user-cumulative-pagination" style="display: none; padding: 15px 20px; background-color: #2a2a2a; border-top: 1px solid #3a3a3a; text-align: center;">
                            <!-- ìˆ«ì í˜ì´ì§€ ë²„íŠ¼ë“¤ì´ ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
                        </div>
                    </div>

                    <!-- All Raw Events í…Œì´ë¸” -->
                    <div class="user-cumulative-info">
                        <div class="user-cumulative-header">ğŸ“‹ All Raw Events</div>
                        <div class="user-cumulative-table">
                            <div>DATE</div>
                            <div>USER</div>
                            <div>KIND</div>
                            <div>MAX_MODEL</div>
                            <div>MODEL</div>
                            <div>TOKENS</div>
                            <div>COST</div>
                        </div>
                        <div style="padding: 20px; text-align: center; color: #7a7a7a; background-color: #1a1a1a;">
                            ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                        </div>
                        
                        <!-- í•„í„°ë§ëœ ì´ë²¤íŠ¸ í˜ì´ì§€ë„¤ì´ì…˜ -->
                        <div class="filtered-events-pagination" style="display: none; padding: 15px 20px; background-color: #2a2a2a; border-top: 1px solid #3a3a3a; text-align: center;">
                            <!-- ìˆ«ì í˜ì´ì§€ ë²„íŠ¼ë“¤ì´ ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
                        </div>
                    </div>
                </div>

                <!-- Settings ì„¹ì…˜ -->
                <div id="settings" class="content-section">
                    <!-- í™œì„± ê¸°ê°„ ì„¤ì • -->
                    <div class="settings-section">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <div class="accordion-title">í™œì„± ê¸°ê°„ ì„¤ì •</div>
                            <div class="accordion-arrow">â–¼</div>
                        </div>
                        <div class="accordion-content">
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">í™œì„± ìƒíƒœ ìë™ ì „í™˜</div>
                                    <div class="setting-description">ì§€ì •ëœ ê¸°ê°„ ë™ì•ˆ í™œë™ì´ ì—†ìœ¼ë©´ ìë™ìœ¼ë¡œ ë¹„í™œì„± ìƒíƒœë¡œ ì „í™˜ë©ë‹ˆë‹¤</div>
                                </div>
                                <div class="toggle-switch" onclick="toggleSwitch(this)"></div>
                            </div>
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">ë¹„í™œì„± ì „í™˜ ê¸°ê°„</div>
                                    <div class="setting-description">í™œë™ì´ ì—†ì„ ê²½ìš° ë¹„í™œì„±ìœ¼ë¡œ ì „í™˜ë˜ëŠ” ê¸°ê°„</div>
                                </div>
                                <select class="setting-select">
                                    <option>7ì¼</option>
                                    <option>14ì¼</option>
                                    <option selected>30ì¼</option>
                                    <option>60ì¼</option>
                                    <option>90ì¼</option>
                                </select>
                            </div>
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">í™œì„± ìƒíƒœ ì•Œë¦¼</div>
                                    <div class="setting-description">ë¹„í™œì„± ì „í™˜ ì „ ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼ì„ ë°œì†¡í•©ë‹ˆë‹¤</div>
                                </div>
                                <div class="toggle-switch" onclick="toggleSwitch(this)"></div>
                            </div>
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">ì•Œë¦¼ ë°œì†¡ ì‹œì </div>
                                    <div class="setting-description">ë¹„í™œì„± ì „í™˜ ëª‡ ì¼ ì „ì— ì•Œë¦¼ì„ ë°œì†¡í• ì§€ ì„¤ì •</div>
                                </div>
                                <select class="setting-select">
                                    <option>1ì¼ ì „</option>
                                    <option selected>3ì¼ ì „</option>
                                    <option>7ì¼ ì „</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Email Report ì„¤ì • -->
                    <div class="settings-section">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <div class="accordion-title">Email Report ì„¤ì •</div>
                            <div class="accordion-arrow">â–¼</div>
                        </div>
                        <div class="accordion-content">
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">ìë™ ë¦¬í¬íŠ¸ ë°œì†¡</div>
                                    <div class="setting-description">ì •ê¸°ì ìœ¼ë¡œ ì‚¬ìš© í˜„í™© ë¦¬í¬íŠ¸ë¥¼ ì´ë©”ì¼ë¡œ ë°œì†¡í•©ë‹ˆë‹¤</div>
                                </div>
                                <div class="toggle-switch" onclick="toggleSwitch(this)"></div>
                            </div>
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">ë°œì†¡ ì£¼ê¸°</div>
                                    <div class="setting-description">ë¦¬í¬íŠ¸ ë°œì†¡ ì£¼ê¸°ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤</div>
                                </div>
                                <select class="setting-select">
                                    <option>ë§¤ì¼</option>
                                    <option selected>ë§¤ì£¼</option>
                                    <option>ë§¤ì›”</option>
                                    <option>ë¶„ê¸°ë³„</option>
                                </select>
                            </div>
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">ìˆ˜ì‹ ì ê·¸ë£¹</div>
                                    <div class="setting-description">ë¦¬í¬íŠ¸ë¥¼ ë°›ì„ ëŒ€ìƒì„ ì„¤ì •í•©ë‹ˆë‹¤</div>
                                </div>
                                <div style="display: flex; gap: 10px;">
                                    <label style="display: flex; align-items: center; gap: 5px;">
                                        <input type="checkbox" checked style="width: 16px; height: 16px;">
                                        <span style="color: #e1e1e1; font-size: 14px;">ê´€ë¦¬ì</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 5px;">
                                        <input type="checkbox" style="width: 16px; height: 16px;">
                                        <span style="color: #e1e1e1; font-size: 14px;">ì „ì²´ ë©¤ë²„</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Export Documents ì„¤ì • -->
                    <div class="settings-section">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <div class="accordion-title">Export Documents ì„¤ì •</div>
                            <div class="accordion-arrow">â–¼</div>
                        </div>
                        <div class="accordion-content">
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">ìë™ ë°±ì—…</div>
                                    <div class="setting-description">ë°ì´í„°ë¥¼ ì •ê¸°ì ìœ¼ë¡œ ìë™ ë°±ì—…í•©ë‹ˆë‹¤</div>
                                </div>
                                <div class="toggle-switch" onclick="toggleSwitch(this)"></div>
                            </div>
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">Export í˜•ì‹</div>
                                    <div class="setting-description">ë¬¸ì„œë¥¼ ë‚´ë³´ë‚¼ íŒŒì¼ í˜•ì‹ì„ ì„ íƒí•©ë‹ˆë‹¤</div>
                                </div>
                                <select class="setting-select">
                                    <option>CSV</option>
                                    <option selected>Excel (XLSX)</option>
                                    <option>PDF</option>
                                    <option>JSON</option>
                                </select>
                            </div>
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">Export ë²”ìœ„</div>
                                    <div class="setting-description">ë‚´ë³´ë‚¼ ë°ì´í„°ì˜ ê¸°ê°„ì„ ì„¤ì •í•©ë‹ˆë‹¤</div>
                                </div>
                                <select class="setting-select">
                                    <option>ìµœê·¼ 7ì¼</option>
                                    <option selected>ìµœê·¼ 30ì¼</option>
                                    <option>ìµœê·¼ 90ì¼</option>
                                    <option>ì „ì²´ ê¸°ê°„</option>
                                    <option>ì‚¬ìš©ì ì§€ì •</option>
                                </select>
                            </div>
                            <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #3a3a3a;">
                                <button class="export-btn">ğŸ“¥ ì§€ê¸ˆ Export í•˜ê¸°</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // ë©¤ë²„ í™œë™ ë°ì´í„°
        const memberData = {
            total: [
                { date: "25ë…„ 7ì›” 25ì¼ (ì˜¤ëŠ˜)", email: "greenmold@samsung.com", type: "active", kind: "Chat Request", request: "3", spend: "$0.05" },
                { date: "25ë…„ 7ì›” 25ì¼ (ì˜¤ëŠ˜)", email: "ck9104.lee@samsung.com", type: "active", kind: "Code Generation", request: "2", spend: "$0.03" },
                { date: "25ë…„ 7ì›” 25ì¼ (ì˜¤ëŠ˜)", email: "by07.so@samsung.com", type: "active", kind: "Analysis", request: "5", spend: "$0.08" },
                { date: "25ë…„ 7ì›” 24ì¼ (1ì¼ì „)", email: "dynamic.choi@samsung.com", type: "inactive", kind: "Chat Request", request: "1", spend: "$0.01" },
                { date: "25ë…„ 7ì›” 24ì¼ (1ì¼ì „)", email: "darney.jeon@samsung.com", type: "inactive", kind: "Code Review", request: "2", spend: "$0.02" },
                { date: "25ë…„ 7ì›” 24ì¼ (1ì¼ì „)", email: "j0117.lee@samsung.com", type: "active", kind: "Documentation", request: "4", spend: "$0.04" },
                { date: "25ë…„ 7ì›” 24ì¼ (1ì¼ì „)", email: "kaeul.kim@samsung.com", type: "active", kind: "Chat Request", request: "6", spend: "$0.06" },
                { date: "25ë…„ 7ì›” 24ì¼ (1ì¼ì „)", email: "nw.aioffice@samsung.com", type: "inactive", kind: "Analysis", request: "1", spend: "$0.01" },
                { date: "25ë…„ 7ì›” 24ì¼ (1ì¼ì „)", email: "sh.ryan.park@samsung.com", type: "active", kind: "Code Generation", request: "7", spend: "$0.07" },
                { date: "25ë…„ 7ì›” 24ì¼ (1ì¼ì „)", email: "sejin.seo@samsung.com", type: "active", kind: "Chat Request", request: "3", spend: "$0.03" },
                { date: "25ë…„ 7ì›” 23ì¼ (2ì¼ì „)", email: "sol22.lee@samsung.com", type: "inactive", kind: "Documentation", request: "2", spend: "$0.02" },
                { date: "25ë…„ 7ì›” 23ì¼ (2ì¼ì „)", email: "shee.lim@samsung.com", type: "inactive", kind: "Analysis", request: "1", spend: "$0.01" },
                { date: "25ë…„ 7ì›” 23ì¼ (2ì¼ì „)", email: "joseph2.jeon@samsung.com", type: "active", kind: "Code Review", request: "5", spend: "$0.05" },
                { date: "25ë…„ 7ì›” 23ì¼ (2ì¼ì „)", email: "taewoo.bang@samsung.com", type: "inactive", kind: "Chat Request", request: "1", spend: "$0.01" },
                { date: "25ë…„ 7ì›” 23ì¼ (2ì¼ì „)", email: "baewj@samsung.com", type: "inactive", kind: "Code Generation", request: "3", spend: "$0.03" },
                { date: "25ë…„ 7ì›” 22ì¼ (3ì¼ì „)", email: "yj7.park@samsung.com", type: "active", kind: "Analysis", request: "4", spend: "$0.04" },
                { date: "25ë…„ 7ì›” 22ì¼ (3ì¼ì „)", email: "nemo.kim@samsung.com", type: "active", kind: "Chat Request", request: "6", spend: "$0.06" },
                { date: "25ë…„ 7ì›” 22ì¼ (3ì¼ì „)", email: "ms0402.kim@samsung.com", type: "active", kind: "Documentation", request: "3", spend: "$0.03" },
                { date: "25ë…„ 7ì›” 21ì¼ (4ì¼ì „)", email: "shx.kim@samsung.com", type: "active", kind: "Code Review", request: "5", spend: "$0.05" },
                { date: "25ë…„ 7ì›” 21ì¼ (4ì¼ì „)", email: "greenmold@samsung.com", type: "active", kind: "Analysis", request: "8", spend: "$0.08" }
            ]
        };

        // í™œì„±/ë¹„í™œì„± ë©¤ë²„ í™œë™ ë¶„ë¥˜
        memberData.active = memberData.total.filter(activity => activity.type === "active");
        memberData.inactive = memberData.total.filter(activity => activity.type === "inactive");

        // ë©¤ë²„ ë¦¬ìŠ¤íŠ¸ ë Œë”ë§
        function renderMemberList(type) {
            const memberList = document.getElementById('member-list');
            const memberListTitle = document.getElementById('member-list-title');
           
            let activities = [];
            let title = "";
            let icon = "";
           
            switch(type) {
                case 'active':
                    activities = memberData.active;
                    title = "í™œì„± ë©¤ë²„ í™œë™ ë¦¬ìŠ¤íŠ¸";
                    icon = "ğŸŸ¢";
                    break;
                case 'inactive':
                    activities = memberData.inactive;
                    title = "ë¹„í™œì„± ë©¤ë²„ í™œë™ ë¦¬ìŠ¤íŠ¸";
                    icon = "ğŸŸ ";
                    break;
                default:
                    activities = memberData.total;
                    title = "ì „ì²´ í™œë™ ë¦¬ìŠ¤íŠ¸";
                    icon = "ğŸ“Š";
            }
           
            memberListTitle.textContent = `${icon} ${title}`;
           
            memberList.innerHTML = `
                <div class="member-list-header">
                    <div>DATE</div>
                    <div>EMAIL</div>
                    <div>TYPE</div>
                    <div>KIND</div>
                    <div>REQUEST</div>
                    <div>SPEND</div>
                </div>
                ${activities.map(activity => `
                    <div class="member-item">
                        <div class="member-date">${activity.date}</div>
                        <div class="member-email">${activity.email}</div>
                        <div class="member-type ${activity.type}">${activity.type === 'active' ? 'í™œì„±' : 'ë¹„í™œì„±'}</div>
                        <div class="member-kind">${activity.kind}</div>
                        <div class="member-request">${activity.request}</div>
                        <div class="member-spend">${activity.spend}</div>
                    </div>
                `).join('')}
            `;
        }

        // í†µê³„ ë°•ìŠ¤ í´ë¦­ ì´ë²¤íŠ¸
        function initOverviewStats() {
            const statBoxes = document.querySelectorAll('.overview-stat-box');
           
            statBoxes.forEach(box => {
                box.addEventListener('click', function() {
                    // ëª¨ë“  ë°•ìŠ¤ì—ì„œ selected í´ë˜ìŠ¤ ì œê±°
                    statBoxes.forEach(b => b.classList.remove('selected'));
                   
                    // í´ë¦­ëœ ë°•ìŠ¤ì— selected í´ë˜ìŠ¤ ì¶”ê°€
                    this.classList.add('selected');
                   
                    // í•´ë‹¹ íƒ€ì…ì˜ ë©¤ë²„ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
                    const type = this.getAttribute('data-type');
                    renderMemberList(type);
                });
            });
           
            // ì´ˆê¸° ë¡œë“œ ì‹œ ì „ì²´ ë©¤ë²„ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
            renderMemberList('total');
        }

        // ì°¨íŠ¸ ìƒì„± (Overviewìš©)
        function createOverviewChart() {
            const canvas = document.getElementById('overviewChart');
            if (!canvas) return;
           
            // Canvas í¬ê¸° ì„¤ì •
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = 300;
           
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
           
            // ë°°ê²½ ì„¤ì •
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, width, height);
           
            // ê·¸ë¦¬ë“œ ê·¸ë¦¬ê¸°
            ctx.strokeStyle = '#3a3a3a';
            ctx.lineWidth = 1;
           
            // ì„¸ë¡œ ê·¸ë¦¬ë“œ
            for (let i = 0; i <= 6; i++) {
                const x = (width / 6) * i;
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, height);
                ctx.stroke();
            }
           
            // ê°€ë¡œ ê·¸ë¦¬ë“œ
            for (let i = 0; i <= 5; i++) {
                const y = (height / 5) * i;
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(width, y);
                ctx.stroke();
            }
           
            // ë°ì´í„° í¬ì¸íŠ¸ (ì˜ˆì‹œ)
            const dataPoints = [
                {x: width * 0.1, y: height * 0.8},
                {x: width * 0.25, y: height * 0.7},
                {x: width * 0.4, y: height * 0.6},
                {x: width * 0.55, y: height * 0.3},
                {x: width * 0.7, y: height * 0.4},
                {x: width * 0.85, y: height * 0.5}
            ];
           
            // ì„  ê·¸ë˜í”„ ê·¸ë¦¬ê¸°
            ctx.strokeStyle = '#4a9eff';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(dataPoints[0].x, dataPoints[0].y);
           
            for (let i = 1; i < dataPoints.length; i++) {
                ctx.lineTo(dataPoints[i].x, dataPoints[i].y);
            }
            ctx.stroke();
           
            // ë°ì´í„° í¬ì¸íŠ¸ ì› ê·¸ë¦¬ê¸°
            dataPoints.forEach(point => {
                ctx.fillStyle = '#4a9eff';
                ctx.beginPath();
                ctx.arc(point.x, point.y, 4, 0, Math.PI * 2);
                ctx.fill();
            });
           
            // ë‚ ì§œ ë ˆì´ë¸”
            const dates = ['Jul 18', 'Jul 19', 'Jul 20', 'Jul 21', 'Jul 22', 'Jul 23', 'Jul 24'];
            ctx.fillStyle = '#7a7a7a';
            ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'center';
           
            dates.forEach((date, index) => {
                const x = (width / 6) * index;
                ctx.fillText(date, x, height - 10);
            });
        }

        // ë©”ë‰´ í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬
        document.querySelectorAll('.menu-item').forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
               
                // ëª¨ë“  ë©”ë‰´ ì•„ì´í…œì—ì„œ active í´ë˜ìŠ¤ ì œê±°
                document.querySelectorAll('.menu-item').forEach(menu => {
                    menu.classList.remove('active');
                });
               
                // í´ë¦­ëœ ë©”ë‰´ì— active í´ë˜ìŠ¤ ì¶”ê°€
                this.classList.add('active');
               
                // ëª¨ë“  ì½˜í…ì¸  ì„¹ì…˜ ìˆ¨ê¸°ê¸°
                document.querySelectorAll('.content-section').forEach(section => {
                    section.classList.remove('active');
                });
               
                // ì„ íƒëœ ì„¹ì…˜ í‘œì‹œ
                const sectionName = this.getAttribute('data-section');
                const targetSection = document.getElementById(sectionName);
                if (targetSection) {
                    targetSection.classList.add('active');
                }
               
                // í—¤ë” ì œëª© ì—…ë°ì´íŠ¸
                const pageTitle = document.getElementById('page-title');
               
                switch(sectionName) {
                    case 'overview':
                        pageTitle.textContent = 'Dashboard Overview';
                        // í•„í„° ê¸°ë³¸ê°’ ì„¤ì • í›„
                        setTimeout(async () => {
                            createOverviewChart();
                            console.log('=== Overview ë©”ë‰´ í´ë¦­ ì‹œ ìë™ ì‹¤ì œ API ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì‹œì‘ ===');
                            await refreshAllRealData(); // ìë™ ìƒˆë¡œê³ ì¹¨
                        }, 100);
                        break;
                    case 'members':
                        pageTitle.textContent = 'Dashboard Members';
                        // Members ë©”ë‰´ í´ë¦­ ì‹œ ìë™ ìƒˆë¡œê³ ì¹¨
                        setTimeout(async () => {
                            console.log('=== Members ë©”ë‰´ í´ë¦­ ì‹œ ìë™ ì‹¤ì œ API ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì‹œì‘ ===');
                            await updateMembersWithRealData();
                        }, 100);
                        break;
                    case 'usage':
                        pageTitle.textContent = 'Usage Analytics';
                        // Usage ë©”ë‰´ í´ë¦­ ì‹œ ì¡°ê±´ë¶€ ë°ì´í„° ë¡œë”©
                        setTimeout(async () => {
                            if (!isUsageDataLoaded) {
                                console.log('=== Usage ë©”ë‰´ ì²« ë²ˆì§¸ í´ë¦­ - ë°ì´í„° ë¡œë”© ì‹œì‘ ===');
                                await updateUsageWithCurrentFilter(30, true); // ì²« ë²ˆì§¸ ë¡œë”©
                            } else {
                                console.log('=== Usage ë©”ë‰´ ì¬í´ë¦­ - ë°±ê·¸ë¼ìš´ë“œ ë°ì´í„° ê°±ì‹  ===');
                                updateUsageWithCurrentFilter(30, false); // ë°±ê·¸ë¼ìš´ë“œ ë¡œë”©
                            }
                        }, 100);
                        break;
                    case 'settings':
                        pageTitle.textContent = 'Settings';
                        break;
                    default:
                        pageTitle.textContent = sectionName.charAt(0).toUpperCase() + sectionName.slice(1);
                }
            });
        });

        // ì•„ì½”ë””ì–¸ í† ê¸€ í•¨ìˆ˜
        function toggleAccordion(header) {
            const content = header.nextElementSibling;
            const arrow = header.querySelector('.accordion-arrow');
           
            // ë‹¤ë¥¸ ëª¨ë“  ì•„ì½”ë””ì–¸ ë‹«ê¸°
            document.querySelectorAll('.accordion-content').forEach(otherContent => {
                if (otherContent !== content) {
                    otherContent.classList.remove('active');
                    otherContent.previousElementSibling.querySelector('.accordion-arrow').textContent = 'â–¼';
                }
            });
           
            // í˜„ì¬ ì•„ì½”ë””ì–¸ í† ê¸€
            if (content.classList.contains('active')) {
                content.classList.remove('active');
                arrow.textContent = 'â–¼';
            } else {
                content.classList.add('active');
                arrow.textContent = 'â–²';
            }
        }

        // í† ê¸€ ìŠ¤ìœ„ì¹˜ í•¨ìˆ˜
        function toggleSwitch(toggle) {
            toggle.classList.toggle('off');
        }

        // Overview í†µê³„ ì¹´ë“œ í´ë¦­ ì‹œ ë©¤ë²„ íƒ€ì…ë³„ í•„í„°ë§
        function filterOverviewMembersByType(type) {
            console.log(`=== Overview í†µê³„ ì¹´ë“œ í´ë¦­: ${type} ===`);
            
            // ì„ íƒ ìƒíƒœ ì—…ë°ì´íŠ¸
            updateOverviewSelection(type);
            currentFilterType = type;
            
            // ë©¤ë²„ ë°ì´í„° í•„í„°ë§ ë° í‘œì‹œ
            filterAndDisplayMembers(type);
            
            console.log(`í†µê³„ ì¹´ë“œ ì„ íƒ ì™„ë£Œ: ${type} - í•„í„°ë§ëœ ë°ì´í„° í‘œì‹œ`);
        }

        // ë©¤ë²„ ë°ì´í„°ë¥¼ íƒ€ì…ë³„ë¡œ í•„í„°ë§í•˜ê³  í‘œì‹œ
        function filterAndDisplayMembers(type) {
            console.log(`=== ë©¤ë²„ ë°ì´í„° í•„í„°ë§ ì‹œì‘: ${type} ===`);
            
            if (!originalMembersData || originalMembersData.length === 0) {
                console.log('í•„í„°ë§í•  ë©¤ë²„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            let filteredMembers = [];
            
            if (type === 'total') {
                // ì „ì²´ ë©¤ë²„ í‘œì‹œ
                filteredMembers = [...originalMembersData];
                console.log(`ì „ì²´ ë©¤ë²„ í‘œì‹œ: ${filteredMembers.length}ëª…`);
            } else if (type === 'active') {
                // í™œì„± ë©¤ë²„ë§Œ í•„í„°ë§ (Premium Requestsê°€ ìˆëŠ” ë©¤ë²„)
                filteredMembers = originalMembersData.filter(member => 
                    member.spendData.premiumRequests > 0
                );
                console.log(`í™œì„± ë©¤ë²„ í•„í„°ë§: ${filteredMembers.length}ëª…`);
            } else if (type === 'inactive') {
                // ë¹„í™œì„± ë©¤ë²„ë§Œ í•„í„°ë§ (Premium Requestsê°€ ì—†ëŠ” ë©¤ë²„)
                filteredMembers = originalMembersData.filter(member => 
                    member.spendData.premiumRequests === 0
                );
                console.log(`ë¹„í™œì„± ë©¤ë²„ í•„í„°ë§: ${filteredMembers.length}ëª…`);
            }
            
            // í•„í„°ë§ëœ ë°ì´í„°ë¡œ í…Œì´ë¸” ì—…ë°ì´íŠ¸
            if (filteredMembers.length > 0) {
                currentMembersData = filteredMembers;
                currentMembersPage = 1; // í˜ì´ì§€ ë¦¬ì…‹
                renderMembersTableWithPagination(filteredMembers);
            } else {
                // ë°ì´í„°ê°€ ì—†ì„ ê²½ìš° ë¹ˆ í…Œì´ë¸” í‘œì‹œ
                const container = document.getElementById('members-table-container');
                if (container) {
                    container.innerHTML = `
                        <div style="padding: 20px; text-align: center; color: #7a7a7a; background-color: #1a1a1a;">
                            ${type === 'active' ? 'í™œì„± ë©¤ë²„ê°€ ì—†ìŠµë‹ˆë‹¤.' : 
                              type === 'inactive' ? 'ë¹„í™œì„± ë©¤ë²„ê°€ ì—†ìŠµë‹ˆë‹¤.' : 
                              'ë©¤ë²„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.'}
                        </div>
                    `;
                }
            }
            
            // í™œë™ ë¦¬ìŠ¤íŠ¸ë„ í•¨ê»˜ ì—…ë°ì´íŠ¸
            updateActivityListByType(type);
            
            console.log(`=== ë©¤ë²„ ë°ì´í„° í•„í„°ë§ ì™„ë£Œ: ${type} ===`);
        }

        // í™œë™ ë¦¬ìŠ¤íŠ¸ë¥¼ íƒ€ì…ë³„ë¡œ í•„í„°ë§í•˜ê³  ì—…ë°ì´íŠ¸
        function updateActivityListByType(type) {
            console.log(`=== í™œë™ ë¦¬ìŠ¤íŠ¸ í•„í„°ë§ ì‹œì‘: ${type} ===`);
            
            if (!currentActivities || currentActivities.length === 0) {
                console.log('í•„í„°ë§í•  í™œë™ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                updateActivityList([]);
                return;
            }
            
            let filteredActivities = [];
            
            if (type === 'total') {
                // ì „ì²´ í™œë™ í‘œì‹œ
                filteredActivities = [...currentActivities];
                console.log(`ì „ì²´ í™œë™ í‘œì‹œ: ${filteredActivities.length}ê°œ`);
            } else if (type === 'active') {
                // í™œì„± í™œë™ë§Œ í•„í„°ë§
                filteredActivities = currentActivities.filter(activity => 
                    activity.type === 'active'
                );
                console.log(`í™œì„± í™œë™ í•„í„°ë§: ${filteredActivities.length}ê°œ`);
            } else if (type === 'inactive') {
                // ë¹„í™œì„± í™œë™ë§Œ í•„í„°ë§
                filteredActivities = currentActivities.filter(activity => 
                    activity.type === 'inactive'
                );
                console.log(`ë¹„í™œì„± í™œë™ í•„í„°ë§: ${filteredActivities.length}ê°œ`);
            }
            
            // í•„í„°ë§ëœ í™œë™ ë°ì´í„°ë¡œ ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            updateActivityList(filteredActivities);
            
            console.log(`=== í™œë™ ë¦¬ìŠ¤íŠ¸ í•„í„°ë§ ì™„ë£Œ: ${type} ===`);
        }

        // Overview í†µê³„ ì¹´ë“œ ì„ íƒ ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateOverviewSelection(type) {
            // ëª¨ë“  í†µê³„ ì¹´ë“œì—ì„œ selected í´ë˜ìŠ¤ ì œê±°
            document.querySelectorAll('.overview-stat-box').forEach(box => {
                box.classList.remove('selected');
            });
            
            // í´ë¦­ëœ ì¹´ë“œì— selected í´ë˜ìŠ¤ ì¶”ê°€
            const targetBox = document.querySelector(`.overview-stat-box[data-type="${type}"]`);
            if (targetBox) {
                targetBox.classList.add('selected');
            }
            
            console.log(`í†µê³„ ì¹´ë“œ ì„ íƒ ìƒíƒœ ì—…ë°ì´íŠ¸: ${type}`);
        }

        // íƒ€ì…ë³„ ë©¤ë²„ ë°ì´í„°ë¥¼ ì‹¤ì œ APIì—ì„œ ê°€ì ¸ì™€ì„œ í‘œì‹œ
        async function updateMembersByTypeWithRealData(type) {
            console.log(`=== ${type} ë©¤ë²„ ì‹¤ì œ API ë°ì´í„° ë¡œë“œ ì‹œì‘ ===`);
            console.log(`ìš”ì²­ëœ íƒ€ì…: ${type}, í˜„ì¬ í•„í„° íƒ€ì…: ${currentFilterType}`);
           
            // í˜„ì¬ í•„í„° ê¸°ê°„ ê²°ì •
            let dateRange;
            if (currentDateRange) {
                dateRange = currentDateRange;
            } else {
                const filterDays = getCurrentFilterDays();
                dateRange = getDateRange(filterDays);
            }
           
            console.log(`í•„í„° ê¸°ê°„: ${new Date(dateRange.startDate).toLocaleDateString()} ~ ${new Date(dateRange.endDate).toLocaleDateString()}`);
           
            // ì‹¤ì œ API ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            const [membersData, eventsData] = await Promise.all([
                getTeamMembers(),
                getFilteredEvents(dateRange.startDate, dateRange.endDate)
            ]);
           
            if (!membersData || !membersData.teamMembers) {
                throw new Error('ë©¤ë²„ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
           
            console.log(`API ì‘ë‹µ: ë©¤ë²„ ${membersData.teamMembers.length}ëª…, ì´ë²¤íŠ¸ ${eventsData?.usageEvents?.length || 0}ê°œ`);
           
            if (type === 'inactive') {
                // ë¹„í™œì„± ë©¤ë²„ ì²˜ë¦¬
                await showInactiveMembersWithData(membersData, eventsData);
            } else if (type === 'active') {
                // í™œì„± ë©¤ë²„ ì²˜ë¦¬
                await showActiveMembersWithData(membersData, eventsData, 'active');
            } else if (type === 'total') {
                // ì „ì²´ ë©¤ë²„ ì²˜ë¦¬
                await showActiveMembersWithData(membersData, eventsData, 'total');
            } else {
                console.error(`ì•Œ ìˆ˜ ì—†ëŠ” íƒ€ì…: ${type}`);
                currentActivityPage = 1; // í˜ì´ì§€ë„¤ì´ì…˜ ì´ˆê¸°í™”
                updateActivityList([]);
                // ì œëª©ì€ ë™ì ìœ¼ë¡œ ìƒì„±ë¨
            }
           
            console.log(`=== ${type} ë©¤ë²„ ì‹¤ì œ API ë°ì´í„° ë¡œë“œ ì™„ë£Œ ===`);
        }

        // í™œì„± ë©¤ë²„ ë˜ëŠ” ì „ì²´ ë©¤ë²„ í‘œì‹œ
        async function showActiveMembersWithData(membersData, eventsData, type) {
            console.log(`=== ${type} ë©¤ë²„ ë°ì´í„° í‘œì‹œ ì‹œì‘ ===`);
           
            if (!eventsData || !eventsData.usageEvents) {
                console.log('í™œë™ ì´ë²¤íŠ¸ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                currentActivityPage = 1; // í˜ì´ì§€ë„¤ì´ì…˜ ì´ˆê¸°í™”
                updateActivityList([]);
                // ì œëª©ì€ ë™ì ìœ¼ë¡œ ìƒì„±ë¨
                return;
            }
           
            // ì§€ì¶œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            const spendingData = await getTeamSpendingData();
            const memberSpendMap = {};
            if (spendingData && spendingData.teamMemberSpend) {
                spendingData.teamMemberSpend.forEach(spendInfo => {
                    memberSpendMap[spendInfo.email] = {
                        premiumRequests: spendInfo.fastPremiumRequests || 0,
                        spend: (spendInfo.spendCents || 0) / 100,
                        hardLimitOverride: spendInfo.hardLimitOverrideDollars || 0
                    };
                });
            }
           
            // ì‹¤ì œ í™œë™ ë¦¬ìŠ¤íŠ¸ ìƒì„±
            const activities = createActivityListWithLastActivity(eventsData.usageEvents, membersData.teamMembers, memberSpendMap);
            console.log(`ìƒì„±ëœ í™œë™ ë¦¬ìŠ¤íŠ¸: ${activities.length}ëª…`);
           
            let filteredActivities;
            if (type === 'active') {
                // í™œì„± ë©¤ë²„: request > 0ì¸ ë©¤ë²„ë§Œ
                filteredActivities = activities.filter(activity => activity.request > 0);
            } else if (type === 'total') {
                // ì „ì²´ ë©¤ë²„: ì‹¤ì œ í™œë™ì´ ìˆëŠ” ëª¨ë“  ë©¤ë²„
                filteredActivities = activities;
            } else {
                // ê¸°ë³¸ê°’: ì „ì²´ ë©¤ë²„
                filteredActivities = activities;
                console.log(`ê¸°ë³¸ ì „ì²´ ë©¤ë²„ í‘œì‹œ: ${filteredActivities.length}ëª…`);
            }
           
            console.log(`${type} ë©¤ë²„ ìµœì¢… ë°ì´í„°: ${filteredActivities.length}ëª…`);
            console.log('í‘œì‹œë  ë©¤ë²„ ëª©ë¡:', filteredActivities.map(a => `${a.email} (${a.request} requests)`));
           
            updateActivityList(filteredActivities);
            // ì œëª©ì€ ë™ì ìœ¼ë¡œ ìƒì„±ë¨
           
            console.log(`=== ${type} ë©¤ë²„ ë°ì´í„° í‘œì‹œ ì™„ë£Œ ===`);
        }

        // ë¹„í™œì„± ë©¤ë²„ í‘œì‹œ í•¨ìˆ˜ (ë°ì´í„°ì™€ í•¨ê»˜)
        async function showInactiveMembersWithData(membersData, eventsData) {
            console.log('=== ë¹„í™œì„± ë©¤ë²„ í‘œì‹œ ì‹œì‘ ===');
           
            // ì§€ì¶œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            const spendingData = await getTeamSpendingData();
            const memberSpendMap = {};
            if (spendingData && spendingData.teamMemberSpend) {
                spendingData.teamMemberSpend.forEach(spendInfo => {
                    memberSpendMap[spendInfo.email] = {
                        premiumRequests: spendInfo.fastPremiumRequests || 0,
                        spend: (spendInfo.spendCents || 0) / 100,
                        hardLimitOverride: spendInfo.hardLimitOverrideDollars || 0
                    };
                });
            }
           
            // í™œë™ì´ ìˆëŠ” ì‚¬ìš©ì ëª©ë¡ ìƒì„±
            const activeUserEmails = new Set();
            if (eventsData && eventsData.usageEvents) {
                eventsData.usageEvents.forEach(event => {
                    if (event.userEmail && event.requestsCosts > 0) {
                        activeUserEmails.add(event.userEmail);
                    }
                });
            }
           
            // ë¹„í™œì„± ë©¤ë²„ í•„í„°ë§
            const inactiveMembers = membersData.teamMembers.filter(member =>
                !activeUserEmails.has(member.email)
            );
           
            console.log(`ë¹„í™œì„± ë©¤ë²„: ${inactiveMembers.length}ëª…`);
            console.log('ë¹„í™œì„± ë©¤ë²„ ëª©ë¡:', inactiveMembers.map(m => m.email));
           
            // ë¹„í™œì„± ë©¤ë²„ë¥¼ í™œë™ ë¦¬ìŠ¤íŠ¸ í˜•íƒœë¡œ ë³€í™˜
            const inactiveActivities = inactiveMembers.map(member => {
                const spendData = memberSpendMap[member.email] || {};
                const actualSpend = spendData.spend || 0; // ì‹¤ì œ ì§€ì¶œ ë°ì´í„° ì‚¬ìš©
                const premiumRequests = spendData.premiumRequests || 0;
                const hardLimit = spendData.hardLimitOverride || 0;
                const limitDisplay = hardLimit > 0 ? `$${hardLimit}` : '$0';
               
                return {
                    date: 'No Activity',
                    timestamp: 0,
                    email: member.email,
                    name: member.name || 'Unnamed',
                    type: 'inactive',
                    kind: 'No Activity',
                    request: premiumRequests, // Premium Requests ì‚¬ìš©
                    spend: `$${actualSpend.toFixed(2)}`, // ì‹¤ì œ ì§€ì¶œ ë°ì´í„° ì‚¬ìš©
                    limit: limitDisplay
                };
            });
           
            currentActivityPage = 1; // í˜ì´ì§€ë„¤ì´ì…˜ ì´ˆê¸°í™”
            updateActivityList(inactiveActivities);
            // ì œëª©ì€ ë™ì ìœ¼ë¡œ ìƒì„±ë¨
        }

        // ë¹„í™œì„± ë©¤ë²„ í‘œì‹œ í•¨ìˆ˜ (ê¸°ì¡´ í˜¸í™˜ì„± ìœ ì§€)
        async function showInactiveMembers() {
            try {
                console.log('=== ë¹„í™œì„± ë©¤ë²„ í‘œì‹œ ì‹œì‘ (ê¸°ì¡´ í•¨ìˆ˜) ===');
               
                // í˜„ì¬ í•„í„° ê¸°ê°„ì˜ ì´ë²¤íŠ¸ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                let dateRange;
                if (currentDateRange) {
                    dateRange = currentDateRange;
                } else {
                    const filterDays = getCurrentFilterDays();
                    dateRange = getDateRange(filterDays);
                }
               
                const [membersData, eventsData] = await Promise.all([
                    getTeamMembers(),
                    getFilteredEvents(dateRange.startDate, dateRange.endDate)
                ]);
               
                if (!membersData || !membersData.teamMembers) {
                    console.error('ë©¤ë²„ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
               
                await showInactiveMembersWithData(membersData, eventsData);
               
            } catch (error) {
                console.error('âŒ ë¹„í™œì„± ë©¤ë²„ í‘œì‹œ ì‹¤íŒ¨:', error);
            }
        }

        // í™œë™ ë°ì´í„°ë¥¼ íƒ€ì…ë³„ë¡œ í•„í„°ë§ (ì‹¤ì œ í™œë™ ê¸°ì¤€) - ì‚¬ìš© ì¤‘ë‹¨ë¨
        // ì´ì œ ê° í†µê³„ ì¹´ë“œ í´ë¦­ ì‹œ ì‹¤ì œ API ë°ì´í„°ë¥¼ ìƒˆë¡œ ê°€ì ¸ì™€ì„œ í‘œì‹œí•¨
        function filterActivitiesByType(activities, type) {
            console.log(`âš ï¸ filterActivitiesByType ì‚¬ìš© ì¤‘ë‹¨ë¨. ëŒ€ì‹  updateMembersByTypeWithRealData ì‚¬ìš©`);
            console.log(`í•„í„°ë§ ìš”ì²­: ${type}, ì „ì²´ í™œë™ ìˆ˜: ${activities.length}`);
           
            let filteredActivities;
            switch (type) {
                case 'active':
                    filteredActivities = activities.filter(activity => activity.type === 'active' && activity.request > 0);
                    break;
                case 'inactive':
                    // ë¹„í™œì„± ë©¤ë²„ë„ í‘œì‹œí•˜ë„ë¡ ìˆ˜ì •
                    filteredActivities = activities.filter(activity => activity.type === 'inactive');
                    break;
                case 'total':
                default:
                    filteredActivities = activities;
                    break;
            }
           
            console.log(`í•„í„°ë§ ê²°ê³¼: ${filteredActivities.length}ëª…`);
            return filteredActivities;
        }

        // Overview í™œë™ë¦¬ìŠ¤íŠ¸ ì œëª© ì—…ë°ì´íŠ¸ (ë™ì ìœ¼ë¡œ í—¤ë”ì— í¬í•¨ë¨)
        function updateOverviewActivityTitle(type, count, totalCount) {
            // ì œëª©ì€ renderOverviewActivityTableWithPaginationì—ì„œ ë™ì ìœ¼ë¡œ ìƒì„±ë¨
            let title, emoji;
            switch (type) {
                case 'active':
                    title = 'í™œì„± ë©¤ë²„ í™œë™ ë¦¬ìŠ¤íŠ¸';
                    emoji = 'âœ…';
                    break;
                case 'inactive':
                    title = 'ë¹„í™œì„± ë©¤ë²„ í™œë™ ë¦¬ìŠ¤íŠ¸';
                    emoji = 'ğŸ’¤';
                    break;
                case 'total':
                default:
                    title = 'ì „ì²´ í™œë™ ë¦¬ìŠ¤íŠ¸';
                    emoji = 'ğŸ“Š';
                    break;
            }
           
            // ë™ì ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ì œëª©ì— ì‚¬ìš©ë  ê¸°ë³¸ ì •ë³´ ë°˜í™˜
            return { title, emoji };
        }

        // í˜„ì¬ Overview í•„í„° ê¸°ê°„ì„ í…ìŠ¤íŠ¸ë¡œ ë°˜í™˜
        function getCurrentOverviewPeriodText() {
            let dateRange;
            if (currentDateRange) {
                dateRange = currentDateRange;
            } else {
                const filterDays = getCurrentFilterDays();
                dateRange = getDateRange(filterDays);
            }
            
            const startDate = new Date(dateRange.startDate).toLocaleDateString('ko-KR');
            const endDate = new Date(dateRange.endDate).toLocaleDateString('ko-KR');
            
            // ë‚ ì§œ ëì˜ "." ì œê±°
            const cleanStartDate = startDate.replace(/\.$/, '');
            const cleanEndDate = endDate.replace(/\.$/, '');
            
            return `${cleanStartDate} ~ ${cleanEndDate}`;
        }

        // ì°¨íŠ¸ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('chart-btn')) {
                // í˜„ì¬ ì„¹ì…˜ì˜ ì°¨íŠ¸ ë²„íŠ¼ë“¤ë§Œ ì²˜ë¦¬
                const parentSection = e.target.closest('.content-section');
                if (parentSection) {
                    parentSection.querySelectorAll('.chart-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    e.target.classList.add('active');
                   
                    // Overview ì„¹ì…˜ì˜ í•„í„° ë²„íŠ¼ì¸ ê²½ìš° í™œë™ ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
                    if (parentSection.id === 'overview') {
                        const days = e.target.getAttribute('data-days') || 1;
                        console.log(`Overview í•„í„° ë²„íŠ¼ í´ë¦­: ${days}ì¼`);
                        updateOverviewWithCurrentFilter();
                    }
                    // Usage ì„¹ì…˜ì˜ í•„í„° ë²„íŠ¼ì¸ ê²½ìš° ì‚¬ìš©ëŸ‰ ë°ì´í„° ì—…ë°ì´íŠ¸
                    else if (parentSection.id === 'usage') {
                        const days = e.target.getAttribute('data-days') || 30;
                        console.log(`Usage í•„í„° ë²„íŠ¼ í´ë¦­: ${days}ì¼`);
                        updateUsageWithCurrentFilter(days);
                    }
                }
            }
        });

        // ë‚ ì§œ í•„í„° ì ìš© í•¨ìˆ˜
        async function applyDateFilter() {
            const startDateInput = document.getElementById('start-date');
            const endDateInput = document.getElementById('end-date');
           
            if (!startDateInput.value || !endDateInput.value) {
                alert('ì‹œì‘ ë‚ ì§œì™€ ì¢…ë£Œ ë‚ ì§œë¥¼ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
           
            const startDate = new Date(startDateInput.value).getTime();
            const endDate = new Date(endDateInput.value).getTime() + (24 * 60 * 60 * 1000 - 1); // í•˜ë£¨ ëê¹Œì§€
           
            if (startDate > endDate) {
                alert('ì‹œì‘ ë‚ ì§œëŠ” ì¢…ë£Œ ë‚ ì§œë³´ë‹¤ ë¹ ë¥¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
           
            console.log(`Overview ì‚¬ìš©ì ì •ì˜ ë‚ ì§œ ë²”ìœ„ ì ìš©: ${new Date(startDate).toLocaleDateString()} ~ ${new Date(endDate).toLocaleDateString()}`);
           
            // í˜„ì¬ ë‚ ì§œ ë²”ìœ„ ì €ì¥
            currentDateRange = { startDate, endDate };
           
            // ë²„íŠ¼ active ìƒíƒœ ì œê±°
            document.querySelectorAll('#overview .chart-btn').forEach(btn => {
                btn.classList.remove('active');
            });
           
            // Overview ì—…ë°ì´íŠ¸
            await updateOverviewWithCurrentFilter();
        }

        // Usage ë‚ ì§œ í•„í„° ì ìš© í•¨ìˆ˜
        async function applyUsageDateFilter() {
            const startDateInput = document.getElementById('usage-start-date');
            const endDateInput = document.getElementById('usage-end-date');
           
            if (!startDateInput.value || !endDateInput.value) {
                alert('ì‹œì‘ ë‚ ì§œì™€ ì¢…ë£Œ ë‚ ì§œë¥¼ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
           
            const startDate = new Date(startDateInput.value).getTime();
            const endDate = new Date(endDateInput.value).getTime() + (24 * 60 * 60 * 1000 - 1); // í•˜ë£¨ ëê¹Œì§€
           
            if (startDate > endDate) {
                alert('ì‹œì‘ ë‚ ì§œëŠ” ì¢…ë£Œ ë‚ ì§œë³´ë‹¤ ë¹ ë¥¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
           
            console.log(`Usage ì‚¬ìš©ì ì •ì˜ ë‚ ì§œ ë²”ìœ„ ì ìš©: ${new Date(startDate).toLocaleDateString()} ~ ${new Date(endDate).toLocaleDateString()}`);
           
            // í˜„ì¬ ë‚ ì§œ ë²”ìœ„ ì €ì¥
            currentUsageDateRange = { startDate, endDate };
           
            // ë²„íŠ¼ active ìƒíƒœ ì œê±°
            document.querySelectorAll('#usage .chart-btn').forEach(btn => {
                btn.classList.remove('active');
            });
           
            // Usage ì—…ë°ì´íŠ¸
            await updateUsageWithDateRange(startDate, endDate);
        }

        // í˜„ì¬ í•„í„° ì„¤ì •ìœ¼ë¡œ Overview ì—…ë°ì´íŠ¸
        async function updateOverviewWithCurrentFilter() {
            try {
                console.log('=== í˜„ì¬ í•„í„°ë¡œ Overview ì—…ë°ì´íŠ¸ ì‹œì‘ ===');
               
                // ë‚ ì§œ ë²”ìœ„ ê²°ì •
                let dateRange;
                if (currentDateRange) {
                    dateRange = currentDateRange;
                    console.log('ì‚¬ìš©ì ì •ì˜ ë‚ ì§œ ë²”ìœ„ ì‚¬ìš©');
                } else {
                    const filterDays = getCurrentFilterDays();
                    dateRange = getDateRange(filterDays);
                    console.log(`ê¸°ë³¸ í•„í„° ê¸°ê°„ ì‚¬ìš©: ${filterDays}ì¼`);
                }
               
                // íŒ€ì› ì •ë³´ ê°€ì ¸ì˜¤ê¸°
                const membersData = await getTeamMembers();
                if (!membersData || !membersData.teamMembers) {
                    console.error('íŒ€ì› ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                currentMembers = membersData.teamMembers;
               
                // í™œë™ ì´ë²¤íŠ¸ ê°€ì ¸ì˜¤ê¸°
                const eventsData = await getFilteredEvents(dateRange.startDate, dateRange.endDate);
               
                // ì§€ì¶œ ë°ì´í„°ë¡œ í†µê³„ ê³„ì‚° (ì„ íƒëœ ê¸°ê°„)
                const spendingData = await getTeamSpendingData();
               
                // ì§€ì¶œ ë°ì´í„° ë§¤í•‘
                const memberSpendMap = {};
                if (spendingData && spendingData.teamMemberSpend) {
                    console.log('ğŸ” ì›ë³¸ ì§€ì¶œ ë°ì´í„°:', spendingData.teamMemberSpend);
                    spendingData.teamMemberSpend.forEach(spendInfo => {
                        memberSpendMap[spendInfo.email] = {
                            premiumRequests: spendInfo.fastPremiumRequests || 0,
                            spend: (spendInfo.spendCents || 0) / 100,
                            hardLimitOverride: spendInfo.hardLimitOverrideDollars || 0
                        };
                        console.log(`ğŸ’° ${spendInfo.email}: requests=${spendInfo.fastPremiumRequests}, spend=$${((spendInfo.spendCents || 0) / 100).toFixed(2)}, limit=$${spendInfo.hardLimitOverrideDollars || 0}`);
                    });
                    console.log('ğŸ“Š ìµœì¢… ì§€ì¶œ ë°ì´í„° ë§µ:', memberSpendMap);
                }
               
                if (eventsData && eventsData.usageEvents) {
                    console.log(`âœ… ${eventsData.usageEvents.length}ê±´ì˜ í™œë™ ì´ë²¤íŠ¸ë¥¼ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.`);
                    currentActivities = createActivityListWithLastActivity(eventsData.usageEvents, membersData.teamMembers, memberSpendMap);
                   
                    // ì„ íƒëœ ê¸°ê°„ ë‚´ ì‹¤ì œ í™œì„± ë©¤ë²„ ê³„ì‚°
                    const periodActiveMembers = calculatePeriodActiveMembers(eventsData.usageEvents);
                    const totalMembers = membersData.teamMembers.length;
                    const inactiveMembers = totalMembers - periodActiveMembers;
                   
                    console.log(`í†µê³„ ê³„ì‚° ê²°ê³¼: ì „ì²´ ${totalMembers}ëª…, í™œì„± ${periodActiveMembers}ëª…, ë¹„í™œì„± ${inactiveMembers}ëª…`);
                    console.log(`í™œë™ ë¦¬ìŠ¤íŠ¸ì— ì‹¤ì œ í‘œì‹œë  ë©¤ë²„ ìˆ˜: ${currentActivities.length}ëª…`);
                   
                    // í†µê³„ ì¹´ë“œ ì—…ë°ì´íŠ¸
                    updateStatsCards(totalMembers, periodActiveMembers, inactiveMembers);
                   
                    // í˜„ì¬ ì„ íƒëœ íƒ€ì…ì— ë”°ë¼ í•„í„°ë§
                    const filteredActivities = filterActivitiesByType(currentActivities, currentFilterType);
                    currentActivityPage = 1; // í˜ì´ì§€ë„¤ì´ì…˜ ì´ˆê¸°í™”
                    updateActivityList(filteredActivities);
                    // ì œëª©ì€ ë™ì ìœ¼ë¡œ ìƒì„±ë¨
                } else {
                    console.log('í™œë™ ì´ë²¤íŠ¸ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                    currentActivities = [];
                    const totalMembers = membersData ? membersData.teamMembers.length : 0;
                    updateStatsCards(totalMembers, 0, totalMembers);
                    currentActivityPage = 1; // í˜ì´ì§€ë„¤ì´ì…˜ ì´ˆê¸°í™”
                    updateActivityList([]);
                }
               
                console.log('=== í˜„ì¬ í•„í„°ë¡œ Overview ì—…ë°ì´íŠ¸ ì™„ë£Œ ===');
            } catch (error) {
                console.error('âŒ Overview ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);
            }
        }

        // ì„ íƒëœ ê¸°ê°„ ë‚´ í™œì„± ë©¤ë²„ ìˆ˜ ê³„ì‚° (ì‹¤ì œ í™œë™ ê¸°ì¤€)
        function calculatePeriodActiveMembers(events) {
            const activeUsers = new Set();
            events.forEach(event => {
                // ì‹¤ì œ í™œë™ì´ ìˆëŠ” ì‚¬ìš©ìë§Œ ì¹´ìš´íŠ¸ (ìš”ì²­ ë¹„ìš©ì´ 0ë³´ë‹¤ í¬ê±°ë‚˜ í† í° ê¸°ë°˜ í˜¸ì¶œ)
                if (event.userEmail && event.requestsCosts > 0) {
                    activeUsers.add(event.userEmail);
                }
            });
            console.log(`ì„ íƒëœ ê¸°ê°„ ë‚´ í™œì„± ë©¤ë²„: ${activeUsers.size}ëª…`, Array.from(activeUsers));
            return activeUsers.size;
        }

        // Overview í™œë™ ë¦¬ìŠ¤íŠ¸ë§Œ ì—…ë°ì´íŠ¸ (ê¸°ì¡´ í•¨ìˆ˜ í˜¸í™˜ì„± ìœ ì§€)
        async function updateOverviewActivityList() {
            await updateOverviewWithCurrentFilter();
        }

        // ì „ì²´ ì‹¤ì œ API ë°ì´í„° ìƒˆë¡œê³ ì¹¨
        async function refreshAllRealData() {
            // ë¡œë”© ìƒíƒœ í‘œì‹œ
            showLoadingStatus(true);
           
            // Overviewì™€ Membersë¥¼ ë™ì‹œì— ë¡œë“œí•˜ì—¬ ì‹œê°„ ë‹¨ì¶•
            await Promise.all([
                updateOverviewWithRealData(),
                updateMembersWithRealData()
            ]);
           
            // ë¡œë”© ìƒíƒœ í•´ì œ
            showLoadingStatus(false);
        }

        // ìµœì í™”ëœ ë¡œë”© ìƒíƒœ í‘œì‹œ/í•´ì œ
        function showLoadingStatus(isLoading) {
            const pageTitle = document.getElementById('page-title');
           
            if (isLoading) {
                // Overview ì„¹ì…˜ì—ì„œëŠ” ë¡œë”© ë©”ì‹œì§€ë¥¼ í‘œì‹œí•˜ì§€ ì•ŠìŒ
                if (pageTitle.textContent === 'Overview' || pageTitle.textContent === 'Dashboard Overview') {
                    return;
                }
                pageTitle.innerHTML = 'ğŸ”„ Loading Real API Data...';
            } else {
                // ì›ë˜ ì œëª©ìœ¼ë¡œ ë³µì›
                if (pageTitle.textContent === 'ğŸ”„ Loading Real API Data...') {
                    pageTitle.textContent = 'Dashboard Overview';
                }
            }
        }

        // ì „ì—­ ë³€ìˆ˜
        let currentFilterType = 'total'; // í˜„ì¬ ì„ íƒëœ í•„í„° íƒ€ì…
        let currentActivities = []; // í˜„ì¬ í™œë™ ë°ì´í„°
        let currentMembers = []; // í˜„ì¬ ë©¤ë²„ ë°ì´í„°
        let currentDateRange = null; // í˜„ì¬ ì„ íƒëœ ë‚ ì§œ ë²”ìœ„ (Overviewìš©)
        let currentUsageDateRange = null; // í˜„ì¬ ì„ íƒëœ ë‚ ì§œ ë²”ìœ„ (Usageìš©)
        let currentRawEventsData = []; // í˜„ì¬ Raw Events ì „ì²´ ë°ì´í„°
        let currentRawEventsPage = 1; // í˜„ì¬ Raw Events í˜ì´ì§€
        let currentRawEventsPageSize = 10; // í˜„ì¬ Raw Events í˜ì´ì§€ í¬ê¸°
        
        // Usage ë°ì´í„° ë¡œë”© ìƒíƒœ ì¶”ì 
        let isUsageDataLoaded = false; // Usage ë°ì´í„°ê°€ í•œ ë²ˆì´ë¼ë„ ë¡œë“œë˜ì—ˆëŠ”ì§€ í™•ì¸
        let isUsageLoading = false; // Usage ë°ì´í„° ë¡œë”© ì¤‘ì¸ì§€ í™•ì¸
        
        // í™œë™ë¦¬ìŠ¤íŠ¸ í˜ì´ì§€ë„¤ì´ì…˜ ë³€ìˆ˜
        let currentActivityPage = 1; // í˜„ì¬ í™œë™ë¦¬ìŠ¤íŠ¸ í˜ì´ì§€
        let currentActivityPageSize = 20; // í˜„ì¬ í™œë™ë¦¬ìŠ¤íŠ¸ í˜ì´ì§€ í¬ê¸°
        let currentActivityData = []; // í˜„ì¬ í™œë™ë¦¬ìŠ¤íŠ¸ ë°ì´í„°
        
        // ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ í˜ì´ì§€ë„¤ì´ì…˜ ë³€ìˆ˜
        let currentUserCumulativePage = 1; // í˜„ì¬ ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ í˜ì´ì§€
        let currentUserCumulativePageSize = 20; // í˜„ì¬ ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ í˜ì´ì§€ í¬ê¸°
        let currentUserCumulativeData = []; // í˜„ì¬ ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ ë°ì´í„°
        let currentUserCumulativeStartDate = null; // í˜„ì¬ ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ ì‹œì‘ ë‚ ì§œ
        let currentUserCumulativeEndDate = null; // í˜„ì¬ ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ ì¢…ë£Œ ë‚ ì§œ
        
        // Members í˜ì´ì§€ë„¤ì´ì…˜ ë³€ìˆ˜
        let currentMembersPage = 1; // í˜„ì¬ Members í˜ì´ì§€
        let currentMembersPageSize = 20; // í˜„ì¬ Members í˜ì´ì§€ í¬ê¸°
        let currentMembersData = []; // í˜„ì¬ Members ë°ì´í„°
        let originalMembersData = []; // ì›ë³¸ ë©¤ë²„ ë°ì´í„° (í•„í„°ë§ìš©)

        // ============================================================================
        // ì„±ëŠ¥ ìµœì í™” ì‹œìŠ¤í…œ (2025.07.29 ì¶”ê°€)
        // ============================================================================









        // API í˜¸ì¶œì„ ìœ„í•œ ì„¤ì •
        const API_CONFIG = {
            baseUrl: 'http://localhost:8001', // ë¡œì»¬ í”„ë¡ì‹œ ì„œë²„
            apiKey: 'key_e46368ce482125bbd568b7d55090c657e30e4b73c824f522cbc9ef9b1bf3f0d3',
            headers: {
                'Content-Type': 'application/json'
            }
        };

        // API í˜¸ì¶œ í•¨ìˆ˜ (ì‹¤ì œ API í˜¸ì¶œ)
        async function callAPI(endpoint, method = 'GET', data = null) {
            try {
                // Basic Auth ì„¤ì •
                const credentials = `${API_CONFIG.apiKey}:`;
                const encodedCredentials = btoa(credentials);
                
                const options = {
                    method: method,
                    headers: {
                        ...API_CONFIG.headers,
                        'Authorization': `Basic ${encodedCredentials}`
                    }
                };

                if (data && method === 'POST') {
                    options.body = JSON.stringify(data);
                }

                console.log(`ì‹¤ì œ Cursor Admin API í˜¸ì¶œ: ${method} ${API_CONFIG.baseUrl}${endpoint}`, data);
               
                const response = await fetch(API_CONFIG.baseUrl + endpoint, options);
               
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`API í˜¸ì¶œ ì‹¤íŒ¨: ${response.status} - ${response.statusText}\n${errorText}`);
                }

                const result = await response.json();
                console.log('ì‹¤ì œ API ì‘ë‹µ ë°ì´í„°:', result);
               
                // API ì‘ë‹µì— ì˜¤ë¥˜ê°€ ìˆëŠ”ì§€ í™•ì¸
                if (result.error) {
                    throw new Error(`API ì˜¤ë¥˜: ${result.error} - ${result.message}`);
                }
               
                return result;
               
            } catch (error) {
                console.error('API í˜¸ì¶œ ì˜¤ë¥˜:', error);
                throw error; // ì˜¤ë¥˜ë¥¼ ë‹¤ì‹œ ë˜ì ¸ì„œ í˜¸ì¶œìê°€ ì²˜ë¦¬í•˜ë„ë¡ í•¨
            }
        }



        // API ì—°ê²° ìƒíƒœ í™•ì¸
        async function checkAPIConnection() {
            try {
                const response = await fetch(API_CONFIG.baseUrl + '/teams/members', {
                    method: 'GET',
                    headers: API_CONFIG.headers
                });
                return response.ok;
            } catch (error) {
                return false;
            }
        }

        // íŒ€ì› ì •ë³´ ê°€ì ¸ì˜¤ê¸°
        async function getTeamMembers() {
            return await callAPI('/teams/members');
        }

        // ì‚¬ìš©ëŸ‰ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        async function getUsageData(startDate, endDate) {
            return await callAPI('/teams/daily-usage-data', 'POST', {
                startDate: startDate,
                endDate: endDate
            });
        }

        // íŒ€ ì§€ì¶œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° (ì „ì²´ ë©¤ë²„)
        async function getTeamSpendingData() {
            try {
                console.log('ğŸ” ì „ì²´ ë©¤ë²„ ì§€ì¶œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì‹œì‘...');
                
                // ì§ì ‘ í° pageSizeë¡œ ëª¨ë“  ë©¤ë²„ ë°ì´í„° ìš”ì²­
                console.log('ğŸ“¡ API í˜¸ì¶œ: /teams/spend (pageSize: 1000)');
                const spendingData = await callAPI('/teams/spend', 'POST', {
                    page: 1,
                    pageSize: 1000
                });
                
                if (!spendingData || !spendingData.teamMemberSpend) {
                    throw new Error('ì§€ì¶œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }
                
                const retrievedCount = spendingData.teamMemberSpend.length;
                const totalMembers = spendingData.totalMembers || retrievedCount;
                const totalPages = spendingData.totalPages || 1;
                
                console.log(`âœ… ì§€ì¶œ ë°ì´í„° ì¡°íšŒ ì™„ë£Œ:`);
                console.log(`   - ì¡°íšŒëœ ë©¤ë²„: ${retrievedCount}ëª…`);
                console.log(`   - ì „ì²´ ë©¤ë²„: ${totalMembers}ëª…`);
                console.log(`   - ì „ì²´ í˜ì´ì§€: ${totalPages}í˜ì´ì§€`);
                
                // ëª¨ë“  ë°ì´í„°ë¥¼ ê°€ì ¸ì™”ëŠ”ì§€ í™•ì¸
                if (retrievedCount < totalMembers && totalPages > 1) {
                    console.log('âš ï¸ ì¶”ê°€ ë°ì´í„°ê°€ ìˆìŠµë‹ˆë‹¤. ë” í° pageSizeë¡œ ì¬ìš”ì²­...');
                    
                    const largerData = await callAPI('/teams/spend', 'POST', {
                        page: 1,
                        pageSize: Math.max(totalMembers + 100, 2000) // ì—¬ìœ ìˆê²Œ ì„¤ì •
                    });
                    
                    if (largerData && largerData.teamMemberSpend && largerData.teamMemberSpend.length > retrievedCount) {
                        console.log(`âœ… ì¬ìš”ì²­ ì„±ê³µ: ${largerData.teamMemberSpend.length}ëª…ì˜ ë°ì´í„° í™•ë³´`);
                        return largerData;
                    }
                }
                
                console.log(`ğŸ¯ ìµœì¢… ê²°ê³¼: ${retrievedCount}ëª…ì˜ ë©¤ë²„ ë°ì´í„° ë°˜í™˜`);
                return spendingData;
                
            } catch (error) {
                console.error('âŒ ì§€ì¶œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', error);
                throw error;
            }
        }

        // í•„í„°ë§ëœ ì´ë²¤íŠ¸ ê°€ì ¸ì˜¤ê¸° (ëª¨ë“  í˜ì´ì§€ ë°ì´í„° ìˆ˜ì§‘)
        async function getFilteredEvents(startDate, endDate) {
            try {
                console.log('=== í•„í„°ë§ëœ ì´ë²¤íŠ¸ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì‹œì‘ ===');
                
                // ì²« ë²ˆì§¸ í˜ì´ì§€ ìš”ì²­
                let allEvents = [];
                let currentPage = 1;
                let hasMorePages = true;
                
                while (hasMorePages) {
                    console.log(`ğŸ“„ í˜ì´ì§€ ${currentPage} ìš”ì²­ ì¤‘...`);
                    
                    const pageData = await callAPI('/teams/filtered-usage-events', 'POST', {
                        startDate: startDate,
                        endDate: endDate,
                        page: currentPage,
                        pageSize: 1000
                    });
                    
                    if (pageData && pageData.usageEvents) {
                        allEvents = allEvents.concat(pageData.usageEvents);
                        console.log(`âœ… í˜ì´ì§€ ${currentPage}: ${pageData.usageEvents.length}ê°œ ì´ë²¤íŠ¸ ìˆ˜ì§‘ (ëˆ„ì : ${allEvents.length}ê°œ)`);
                        
                        // ë” ë§ì€ í˜ì´ì§€ê°€ ìˆëŠ”ì§€ í™•ì¸
                        hasMorePages = pageData.pagination && pageData.pagination.hasNextPage;
                        currentPage++;
                        
                        // ë¬´í•œ ë£¨í”„ ë°©ì§€ (ìµœëŒ€ 10í˜ì´ì§€)
                        if (currentPage > 10) {
                            console.log('âš ï¸ ìµœëŒ€ í˜ì´ì§€ ìˆ˜ ë„ë‹¬ - ë¬´í•œ ë£¨í”„ ë°©ì§€');
                            break;
                        }
                    } else {
                        console.log(`âŒ í˜ì´ì§€ ${currentPage} ë°ì´í„° ì—†ìŒ`);
                        hasMorePages = false;
                    }
                }
                
                console.log(`=== í•„í„°ë§ëœ ì´ë²¤íŠ¸ ë°ì´í„° ìˆ˜ì§‘ ì™„ë£Œ: ì´ ${allEvents.length}ê°œ ì´ë²¤íŠ¸ ===`);
                
                // ê¸°ì¡´ í˜•ì‹ìœ¼ë¡œ ë°˜í™˜
                return {
                    totalUsageEventsCount: allEvents.length,
                    usageEvents: allEvents,
                    period: {
                        startDate: startDate,
                        endDate: endDate
                    }
                };
                
            } catch (error) {
                console.error('âŒ í•„í„°ë§ëœ ì´ë²¤íŠ¸ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', error);
                throw error;
            }
        }

        // í˜„ì¬ ì„ íƒëœ í•„í„° ê¸°ê°„ ê°€ì ¸ì˜¤ê¸°
        function getCurrentFilterDays() {
            const activeBtn = document.querySelector('#overview .chart-btn.active');
            if (!activeBtn) return 30; // ê¸°ë³¸ê°’ 30ì¼
           
            const days = activeBtn.getAttribute('data-days');
            return days ? parseInt(days) : 30;
        }

        // ë‚ ì§œë¥¼ epoch millisecondsë¡œ ë³€í™˜
        function getDateRange(days = 7) {
            const endDate = new Date();
            const startDate = new Date();
            startDate.setDate(startDate.getDate() - days);
           
            return {
                startDate: startDate.getTime(),
                endDate: endDate.getTime()
            };
        }

        // Overview ë°ì´í„° ì—…ë°ì´íŠ¸ (ì´ˆê¸° ë¡œë“œìš©)
        async function updateOverviewWithRealData() {
            try {
                console.log('=== ì‹¤ì œ Cursor Admin API ë°ì´í„°ë¡œ Overview ì´ˆê¸° ë¡œë“œ ì‹œì‘ ===');
               
                // ì´ˆê¸°í™”
                currentFilterType = 'total';
                currentDateRange = null;
               
                // í˜„ì¬ í•„í„°ë¡œ ì—…ë°ì´íŠ¸
                await updateOverviewWithCurrentFilter();

                // ì°¨íŠ¸ ë°ì´í„° ìƒì„± (ìµœê·¼ 7ì¼ ì‚¬ìš©ëŸ‰ ë°ì´í„°)
                console.log('ì°¨íŠ¸ìš© ì¼ë³„ ì‚¬ìš©ëŸ‰ ë°ì´í„° API í˜¸ì¶œ ì¤‘...');
                const chartDateRange = getDateRange(7);
                const usageData = await getUsageData(chartDateRange.startDate, chartDateRange.endDate);
               
                if (usageData && usageData.data) {
                    const chartData = createChartData(usageData.data);
                    updateChart(chartData);
                    console.log(`âœ… ${usageData.data.length}ê±´ì˜ ì°¨íŠ¸ ë°ì´í„°ë¥¼ ì²˜ë¦¬í–ˆìŠµë‹ˆë‹¤.`);
                    
                    // ì‚¬ìš©ëŸ‰ ì¹´ë“œ ì—…ë°ì´íŠ¸ (Overview ì„¹ì…˜ì˜ ì¹´ë“œë“¤ë„ í¬í•¨)
                    console.log('ì‚¬ìš©ëŸ‰ ì¹´ë“œ ì—…ë°ì´íŠ¸ ì¤‘...');
                    const eventsData = await getFilteredEvents(chartDateRange.startDate, chartDateRange.endDate);
                    updateUsageCards(usageData, eventsData);
                    console.log('âœ… ì‚¬ìš©ëŸ‰ ì¹´ë“œ ì—…ë°ì´íŠ¸ ì™„ë£Œ');
                }

                // í•„í„° ê¸°ê°„ í‘œì‹œ
                updateFilterPeriod(chartDateRange.startDate, chartDateRange.endDate);

                // ì´ˆê¸° ë¡œë“œ í›„ ê¸°ë³¸ ì„ íƒëœ 'total' ì¹´ë“œì— ë§ëŠ” ì‹¤ì œ ë°ì´í„° í‘œì‹œ
                console.log('ì´ˆê¸° ë¡œë“œ í›„ ì „ì²´ ë©¤ë²„ ë°ì´í„° í‘œì‹œ');
                await updateMembersByTypeWithRealData('total');
               
                // ì„ íƒ ìƒíƒœì™€ ë°ì´í„° ì¼ì¹˜ í™•ì¸
                console.log(`í˜„ì¬ ì„ íƒëœ íƒ€ì…: ${currentFilterType}`);
                console.log('ì „ì²´ ë©¤ë²„ ì¹´ë“œ ì„ íƒ ìƒíƒœ í™•ì¸ ì™„ë£Œ');

                console.log('=== ì‹¤ì œ API ë°ì´í„°ë¡œ Overview ì´ˆê¸° ë¡œë“œ ì™„ë£Œ! ===');
            } catch (error) {
                console.error('âŒ Overview ì´ˆê¸° ë¡œë“œ ì‹¤íŒ¨:', error);
                alert('Overview ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë„¤íŠ¸ì›Œí¬ ì—°ê²°ê³¼ API ì„œë²„ ìƒíƒœë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.');
            }
        }

        // í†µê³„ ì¹´ë“œ ì—…ë°ì´íŠ¸ (ì‹¤ì œ API ë°ì´í„° ì‚¬ìš©)
        function updateStatsCards(total, active, inactive) {
            const totalBox = document.querySelector('.overview-stat-box[data-type="total"] .stat-number');
            const activeBox = document.querySelector('.overview-stat-box[data-type="active"] .stat-number');
            const inactiveBox = document.querySelector('.overview-stat-box[data-type="inactive"] .stat-number');

            if (totalBox) {
                totalBox.textContent = total;
                console.log(`âœ… ì´ ë©¤ë²„ ìˆ˜ ì—…ë°ì´íŠ¸: ${total}ëª…`);
            }
            if (activeBox) {
                activeBox.textContent = active;
                console.log(`âœ… í™œì„± ë©¤ë²„ ìˆ˜ ì—…ë°ì´íŠ¸: ${active}ëª…`);
            }
            if (inactiveBox) {
                inactiveBox.textContent = inactive;
                console.log(`âœ… ë¹„í™œì„± ë©¤ë²„ ìˆ˜ ì—…ë°ì´íŠ¸: ${inactive}ëª…`);
            }

            // ë©¤ë²„ ìˆ˜ ì¹´ìš´í„° ì—…ë°ì´íŠ¸
            const memberCount = document.getElementById('member-count');
            if (memberCount) {
                memberCount.textContent = `(${total}ëª…)`;
            }
        }

        // ì°¨íŠ¸ ë°ì´í„° ìƒì„± (ì¼ë³„ ì§‘ê³„)
        function createChartData(usageData) {
            const dailyTotals = {};
           
            // ì¼ë³„ë¡œ ëª¨ë“  ì‚¬ìš©ìì˜ í™œë™ ì§‘ê³„
            usageData.forEach(dayData => {
                const dateKey = new Date(dayData.date).toDateString();
               
                if (!dailyTotals[dateKey]) {
                    dailyTotals[dateKey] = {
                        date: dayData.date,
                        totalApplies: 0,
                        totalAccepts: 0,
                        chatRequests: 0,
                        agentRequests: 0
                    };
                }
               
                dailyTotals[dateKey].totalApplies += (dayData.totalApplies || 0);
                dailyTotals[dateKey].totalAccepts += (dayData.totalAccepts || 0);
                dailyTotals[dateKey].chatRequests += (dayData.chatRequests || 0);
                dailyTotals[dateKey].agentRequests += (dayData.agentRequests || 0);
            });
           
            // ì°¨íŠ¸ ë°ì´í„° ìƒì„±
            const chartData = Object.values(dailyTotals)
                .sort((a, b) => a.date - b.date)
                .map(dayTotal => {
                    const date = new Date(dayTotal.date);
                    const activityScore = dayTotal.totalApplies + dayTotal.totalAccepts +
                                        dayTotal.chatRequests + dayTotal.agentRequests;
                   
                    return {
                        date: date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }),
                        activity: activityScore,
                        applies: dayTotal.totalApplies,
                        accepts: dayTotal.totalAccepts,
                        chats: dayTotal.chatRequests,
                        agents: dayTotal.agentRequests
                    };
                });

            console.log('ì°¨íŠ¸ ë°ì´í„° ìƒì„±:', chartData);
            return chartData;
        }

        // ì°¨íŠ¸ ì—…ë°ì´íŠ¸
        function updateChart(chartData) {
            const canvas = document.getElementById('overviewChart');
            if (!canvas || !chartData.length) return;

            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;

            // ê¸°ì¡´ ì°¨íŠ¸ ì§€ìš°ê¸°
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, width, height);

            // ê·¸ë¦¬ë“œ ê·¸ë¦¬ê¸°
            ctx.strokeStyle = '#3a3a3a';
            ctx.lineWidth = 1;
           
            // ì„¸ë¡œ ê·¸ë¦¬ë“œ
            for (let i = 0; i <= chartData.length; i++) {
                const x = (width / chartData.length) * i;
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, height);
                ctx.stroke();
            }

            // ê°€ë¡œ ê·¸ë¦¬ë“œ
            for (let i = 0; i <= 5; i++) {
                const y = (height / 5) * i;
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(width, y);
                ctx.stroke();
            }

            // ë°ì´í„° í¬ì¸íŠ¸ ê³„ì‚°
            const maxActivity = Math.max(...chartData.map(d => d.activity));
            const dataPoints = chartData.map((data, index) => ({
                x: (width / (chartData.length - 1)) * index,
                y: height - (height * (data.activity / maxActivity))
            }));

            // ì„  ê·¸ë˜í”„ ê·¸ë¦¬ê¸°
            if (dataPoints.length > 1) {
                ctx.strokeStyle = '#4a9eff';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.moveTo(dataPoints[0].x, dataPoints[0].y);
               
                for (let i = 1; i < dataPoints.length; i++) {
                    ctx.lineTo(dataPoints[i].x, dataPoints[i].y);
                }
                ctx.stroke();
            }

            // ë°ì´í„° í¬ì¸íŠ¸ ì› ê·¸ë¦¬ê¸°
            dataPoints.forEach(point => {
                ctx.fillStyle = '#4a9eff';
                ctx.beginPath();
                ctx.arc(point.x, point.y, 4, 0, Math.PI * 2);
                ctx.fill();
            });

            // ë‚ ì§œ ë ˆì´ë¸”
            ctx.fillStyle = '#7a7a7a';
            ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'center';
           
            chartData.forEach((data, index) => {
                const x = (width / (chartData.length - 1)) * index;
                ctx.fillText(data.date, x, height - 10);
            });
        }

        // í™œë™ ë¦¬ìŠ¤íŠ¸ ìƒì„± (ì‹¤ì œ í™œë™ì´ ìˆëŠ” ë©¤ë²„ë§Œ, ì •í™•í•œ í†µê³„ ë°˜ì˜)
        function createActivityListWithLastActivity(events, members, memberSpendMap = {}) {
            console.log('=== í™œë™ ë¦¬ìŠ¤íŠ¸ ìƒì„± ì‹œì‘ ===');
            console.log(`ì „ì²´ ì´ë²¤íŠ¸ ìˆ˜: ${events.length}ê°œ`);
            console.log(`ì „ì²´ ë©¤ë²„ ìˆ˜: ${members.length}ëª…`);
            console.log('ì§€ì¶œ ë°ì´í„° ë§µ:', memberSpendMap);
           
            // ì‚¬ìš©ìë³„ ë§ˆì§€ë§‰ í™œë™ ë‚ ì§œ ë° í†µê³„ ê³„ì‚°
            const userActivity = {};
           
            events.forEach(event => {
                const userEmail = event.userEmail;
                const timestamp = parseInt(event.timestamp);
                const requestCost = event.requestsCosts || 0;
               
                if (!userActivity[userEmail]) {
                    userActivity[userEmail] = {
                        lastTimestamp: timestamp,
                        totalRequests: 0,
                        events: []
                    };
                }
               
                // ë§ˆì§€ë§‰ í™œë™ ì‹œê°„ ì—…ë°ì´íŠ¸
                if (timestamp > userActivity[userEmail].lastTimestamp) {
                    userActivity[userEmail].lastTimestamp = timestamp;
                }
               
                // ìš”ì²­ ìˆ˜ë§Œ ëˆ„ì  (ì‹¤ì œ ì§€ì¶œì€ /teams/spend APIì—ì„œ ê°€ì ¸ì˜´)
                userActivity[userEmail].totalRequests += requestCost;
                userActivity[userEmail].events.push(event);
            });
           
            console.log('ì‚¬ìš©ìë³„ í™œë™ í†µê³„:', userActivity);
           
            // ëª¨ë“  ë©¤ë²„ë¥¼ í¬í•¨í•˜ì—¬ í™œë™ ì •ë³´ ìƒì„± (í™œì„± + ë¹„í™œì„±)
            const activities = [];
            let activeCount = 0;
            let inactiveCount = 0;
           
            members.forEach(member => {
                const userStats = userActivity[member.email];
                const spendData = memberSpendMap[member.email] || {};
                
                // ì‹¤ì œ ì§€ì¶œ ë°ì´í„° ì‚¬ìš© (/teams/spend APIì—ì„œ)
                const actualSpend = spendData.spend || 0;
                const premiumRequests = spendData.premiumRequests || 0;
                const hardLimit = spendData.hardLimitOverride || 0;
                const limitDisplay = hardLimit > 0 ? `$${hardLimit}` : '$0';
               
                if (userStats && userStats.totalRequests > 0) {
                    // í™œë™ì´ ìˆëŠ” ë©¤ë²„
                    const lastActivityDate = new Date(userStats.lastTimestamp);
                   
                    // ì˜¤ëŠ˜ ë‚ ì§œ ê¸°ì¤€ìœ¼ë¡œ ì •í™•í•œ ì¼ìˆ˜ ì°¨ì´ ê³„ì‚°
                    const today = new Date();
                    today.setHours(0, 0, 0, 0);
                   
                    const activityDate = new Date(userStats.lastTimestamp);
                    activityDate.setHours(0, 0, 0, 0);
                   
                    const daysDiff = Math.floor((today - activityDate) / (1000 * 60 * 60 * 24));
                   
                    activeCount++;
                   
                    activities.push({
                        date: lastActivityDate.toLocaleDateString('ko-KR', {
                            month: '2-digit',
                            day: '2-digit'
                        }) + ` (${daysDiff === 0 ? 'ì˜¤ëŠ˜' : daysDiff + 'ì¼ ì „'})`,
                        timestamp: userStats.lastTimestamp,
                        email: member.email,
                        name: member.name || 'Unnamed',
                        type: 'active',
                        kind: userStats.events.length > 0 ? userStats.events[0].kindLabel || 'Unknown' : 'Unknown',
                        request: premiumRequests, // Premium Requests ì‚¬ìš©
                        spend: `$${actualSpend.toFixed(2)}`, // ì‹¤ì œ ì§€ì¶œ ë°ì´í„° ì‚¬ìš©
                        limit: limitDisplay
                    });
                } else {
                    // í™œë™ì´ ì—†ëŠ” ë©¤ë²„ (ë¹„í™œì„±)
                    inactiveCount++;
                   
                    activities.push({
                        date: 'No Activity',
                        timestamp: 0,
                        email: member.email,
                        name: member.name || 'Unnamed',
                        type: 'inactive',
                        kind: 'No Activity',
                        request: 0,
                        spend: `$${actualSpend.toFixed(2)}`, // ì‹¤ì œ ì§€ì¶œ ë°ì´í„° ì‚¬ìš©
                        limit: limitDisplay
                    });
                }
            });
           
            console.log(`í™œë™ ë¦¬ìŠ¤íŠ¸ ê²°ê³¼: ì´ ${activities.length}ëª… (í™œì„±: ${activeCount}ëª…, ë¹„í™œì„±: ${inactiveCount}ëª…)`);
           
            // ë§ˆì§€ë§‰ í™œë™ ë‚ ì§œ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ (ìµœì‹ ìˆœ - ë‚´ë¦¼ì°¨ìˆœ)
            return activities.sort((a, b) => {
                return b.timestamp - a.timestamp;
            });
        }

        // ê¸°ì¡´ í™œë™ ë¦¬ìŠ¤íŠ¸ ìƒì„± (í˜¸í™˜ì„± ìœ ì§€)
        function createActivityList(events) {
            return events.slice(0, 20).map(event => {
                const timestamp = new Date(parseInt(event.timestamp));
                return {
                    date: timestamp.toLocaleDateString('ko-KR', {
                        month: '2-digit',
                        day: '2-digit',
                        hour: '2-digit',
                        minute: '2-digit'
                    }),
                    email: event.userEmail || 'Unknown',
                    type: event.isTokenBasedCall ? 'active' : 'inactive',
                    kind: event.kindLabel || 'Unknown',
                    request: event.requestsCosts || 0,
                    spend: event.isTokenBasedCall ?
                        `$${(event.tokenUsage?.totalCents || 0) / 100}` :
                        '$0.00'
                };
            });
        }



        // ì´ë©”ì¼ í´ë¦­ ì‹œ Usage ì„¹ì…˜ìœ¼ë¡œ ì´ë™ ë° ê²€ìƒ‰
        function navigateToUsageWithEmail(email) {
            console.log(`ì´ë©”ì¼ í´ë¦­: ${email} - Usage ì„¹ì…˜ìœ¼ë¡œ ì´ë™ ì‹œì‘`);
            
            // ê²€ìƒ‰ ì˜ˆì • í”Œë˜ê·¸ ì„¤ì • (ìë™ ìƒˆë¡œê³ ì¹¨ ë°©ì§€ìš©)
            window.pendingEmailSearch = email;
            
            // ìˆ˜ë™ìœ¼ë¡œ ì„¹ì…˜ ì „í™˜ (ìë™ ë°ì´í„° ë¡œë“œ ë°©ì§€)
            const usageMenuItem = document.querySelector('.menu-item[data-section="usage"]');
            const allMenuItems = document.querySelectorAll('.menu-item');
            const allSections = document.querySelectorAll('.content-section');
            
            // ë©”ë‰´ ìƒíƒœ ì—…ë°ì´íŠ¸
            allMenuItems.forEach(menu => menu.classList.remove('active'));
            if (usageMenuItem) {
                usageMenuItem.classList.add('active');
            }
            
            // ì„¹ì…˜ ì „í™˜
            allSections.forEach(section => section.classList.remove('active'));
            const usageSection = document.getElementById('usage');
            if (usageSection) {
                usageSection.classList.add('active');
            }
            
            // í˜ì´ì§€ ì œëª© ì—…ë°ì´íŠ¸
            const pageTitle = document.getElementById('page-title');
            if (pageTitle) {
                pageTitle.textContent = 'Usage Analytics';
            }
            
            // Usage ë°ì´í„°ê°€ ì´ë¯¸ ë¡œë“œë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
            const hasData = currentRawEventsData && currentRawEventsData.length > 0;
            
            if (hasData) {
                // ë°ì´í„°ê°€ ì´ë¯¸ ìˆìœ¼ë©´ ì¦‰ì‹œ ê²€ìƒ‰ ì‹¤í–‰
                executeEmailSearch(email);
            } else {
                // ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ë¨¼ì € ë¡œë“œí•œ í›„ ê²€ìƒ‰
                console.log('Usage ë°ì´í„°ë¥¼ ë¨¼ì € ë¡œë“œí•©ë‹ˆë‹¤...');
                updateUsageWithCurrentFilter(30).then(() => {
                    // ë°ì´í„° ë¡œë“œ ì™„ë£Œ í›„ ê²€ìƒ‰ ì‹¤í–‰
                    setTimeout(() => {
                        executeEmailSearch(email);
                    }, 500);
                }).catch(error => {
                    console.error('Usage ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                    // ë¡œë“œ ì‹¤íŒ¨í•´ë„ ê²€ìƒ‰ì€ ì‹œë„
                    executeEmailSearch(email);
                });
            }
            
            console.log(`ğŸ“§ ì´ë©”ì¼ í´ë¦­ ì²˜ë¦¬ ì™„ë£Œ: ${email}`);
        }
        
        // ì´ë©”ì¼ ê²€ìƒ‰ ì‹¤í–‰ í•¨ìˆ˜
        function executeEmailSearch(email) {
            const searchBox = document.querySelector('#usage .search-box');
            if (searchBox) {
                searchBox.value = email;
                // X ë²„íŠ¼ í‘œì‹œ
                toggleSearchClearBtn('usage-search');
                filterUsageMembers(email);
                console.log(`âœ… ì´ë©”ì¼ ê²€ìƒ‰ ì™„ë£Œ: ${email}`);
                
                // ê²€ìƒ‰ ì™„ë£Œ í›„ í”Œë˜ê·¸ ì œê±°
                delete window.pendingEmailSearch;
            } else {
                console.error('âŒ Usage ì„¹ì…˜ì˜ ê²€ìƒ‰ì°½ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
        }

        // í™œë™ ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ (Members ìŠ¤íƒ€ì¼ í˜ì´ì§€ë„¤ì´ì…˜)
        function updateActivityList(activities) {
            currentActivityData = activities; // ë°ì´í„° ì €ì¥
            renderOverviewActivityTableWithPagination(activities);
        }

        // Overview í™œë™ë¦¬ìŠ¤íŠ¸ í…Œì´ë¸” ë Œë”ë§ (Members ìŠ¤íƒ€ì¼)
        function renderOverviewActivityTableWithPagination(activities) {
            // í—¤ë” ì—…ë°ì´íŠ¸
            const headerElement = document.querySelector('.overview-activity-header');
            if (headerElement) {
                if (!activities || activities.length === 0) {
                    headerElement.innerHTML = 'ğŸ“‹ í™œë™ ë¦¬ìŠ¤íŠ¸';
                } else {
                    const totalActivities = activities.length;
                    const totalPages = Math.ceil(totalActivities / currentActivityPageSize);
                    const startIndex = (currentActivityPage - 1) * currentActivityPageSize;
                    const endIndex = Math.min(startIndex + currentActivityPageSize, totalActivities);
                    
                    // í˜„ì¬ í•„í„° íƒ€ì…ì— ë”°ë¥¸ ì œëª© ê²°ì •
                    const titleInfo = updateOverviewActivityTitle(currentFilterType, totalActivities, totalActivities);
                    const periodText = getCurrentOverviewPeriodText();
                    
                    headerElement.innerHTML = `
                        <span>${titleInfo.emoji} ${titleInfo.title} (${periodText})(${startIndex + 1}-${endIndex} of ${totalActivities})</span>
                        <select id="overviewActivityPageSize" onchange="changeOverviewActivityPageSize(this.value)" style="background: #3a3a3a; color: #fff; border: 1px solid #4a4a4a; padding: 5px 10px; border-radius: 4px; font-size: 12px;">
                            <option value="10" ${currentActivityPageSize === 10 ? 'selected' : ''}>10ê°œ ë³´ê¸°</option>
                            <option value="20" ${currentActivityPageSize === 20 ? 'selected' : ''}>20ê°œ ë³´ê¸°</option>
                            <option value="30" ${currentActivityPageSize === 30 ? 'selected' : ''}>30ê°œ ë³´ê¸°</option>
                            <option value="50" ${currentActivityPageSize === 50 ? 'selected' : ''}>50ê°œ ë³´ê¸°</option>
                            <option value="100" ${currentActivityPageSize === 100 ? 'selected' : ''}>100ê°œ ë³´ê¸°</option>
                        </select>
                    `;
                }
            }
            
            if (!activities || activities.length === 0) {
                const container = document.getElementById('overview-activity-container');
                if (container) {
                    container.innerHTML = `
                        <div style="padding: 20px; text-align: center; color: #7a7a7a; background-color: #1a1a1a;">
                            í™œë™ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.
                        </div>
                    `;
                }
                // í˜ì´ì§€ë„¤ì´ì…˜ ìˆ¨ê¸°ê¸°
                const pagination = document.getElementById('overview-activity-pagination');
                if (pagination) pagination.style.display = 'none';
                return;
            }

            // í˜ì´ì§€ë„¤ì´ì…˜ ê³„ì‚°
            const totalActivities = activities.length;
            const totalPages = Math.ceil(totalActivities / currentActivityPageSize);
            const startIndex = (currentActivityPage - 1) * currentActivityPageSize;
            const endIndex = Math.min(startIndex + currentActivityPageSize, totalActivities);
            const pageActivities = activities.slice(startIndex, endIndex);

            console.log(`ğŸ“„ Overview í™œë™ë¦¬ìŠ¤íŠ¸ í˜ì´ì§€ë„¤ì´ì…˜: ${startIndex + 1}-${endIndex} of ${totalActivities} (í˜ì´ì§€ ${currentActivityPage}/${totalPages})`);

            // í…Œì´ë¸” ë‚´ìš©ë§Œ ì—…ë°ì´íŠ¸
            const tableContent = pageActivities.map(activity => `
                <div class="member-item">
                    <div class="member-date">${activity.date}</div>
                    <div class="member-email clickable-email" title="View usage for ${activity.email}" onclick="navigateToUsageWithEmail('${activity.email}')">${activity.email}</div>
                    <div class="member-type ${activity.type}">${activity.type === 'active' ? 'í™œì„±' : 'ë¹„í™œì„±'}</div>
                    <div class="member-kind">${activity.kind}</div>
                    <div class="member-request">${activity.request}</div>
                    <div class="member-spend">${activity.spend}</div>
                    <div class="member-limit">${activity.limit || '$0'}</div>
                </div>
            `).join('');

            // ì»¨í…Œì´ë„ˆì— í…Œì´ë¸” ë‚´ìš©ë§Œ ì‚½ì…
            const container = document.getElementById('overview-activity-container');
            if (container) {
                container.innerHTML = tableContent;
            }

            // í˜ì´ì§€ë„¤ì´ì…˜ ì—…ë°ì´íŠ¸
            const paginationContainer = document.getElementById('overview-activity-pagination');
            if (paginationContainer && totalPages > 1) {
                paginationContainer.innerHTML = generateOverviewActivityPagination(totalPages);
                paginationContainer.style.display = 'block';
            } else if (paginationContainer) {
                paginationContainer.style.display = 'none';
            }
           
            // í†µê³„ ì—…ë°ì´íŠ¸
            const activeCount = activities.filter(a => a.type === 'active').length;
            const totalRequests = activities.reduce((sum, a) => sum + (typeof a.request === 'number' ? a.request : 0), 0);
           
            console.log(`ğŸ“Š Overview í™œë™ ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸: ì´ ${activities.length}ëª…, í™œì„± ${activeCount}ëª…, ì´ ìš”ì²­ ${totalRequests}ê±´ (í˜ì´ì§€ ${currentActivityPage}/${totalPages})`);
        }



        // í•„í„° ê¸°ê°„ ì—…ë°ì´íŠ¸
        function updateFilterPeriod(startDate, endDate) {
            const start = new Date(startDate).toLocaleDateString('en-US', {
                month: 'short',
                day: 'numeric'
            });
            const end = new Date(endDate).toLocaleDateString('en-US', {
                month: 'short',
                day: 'numeric'
            });
           
            const dateFilterBtn = document.querySelector('.date-filter-btn');
            if (dateFilterBtn) {
                dateFilterBtn.textContent = `${start} - ${end}`;
            }
        }



        // ë©¤ë²„ í…Œì´ë¸”ì„ ì‹¤ì œ API ë°ì´í„°ë¡œ ì—…ë°ì´íŠ¸
        async function updateMembersWithRealData() {
            try {
                console.log('=== ì‹¤ì œ Cursor Admin API ë°ì´í„°ë¡œ ë©¤ë²„ í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì‹œì‘ ===');
               
                // 1. ì‹¤ì œ íŒ€ì› ì •ë³´ ê°€ì ¸ì˜¤ê¸°
                console.log('1. íŒ€ì› ì •ë³´ API í˜¸ì¶œ ì¤‘...');
                const membersData = await getTeamMembers();
                console.log('íŒ€ì› ë°ì´í„° ì‘ë‹µ:', membersData);
               
                if (!membersData || !membersData.teamMembers) {
                    throw new Error('íŒ€ì› ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }

                console.log(`âœ… ì´ ${membersData.teamMembers.length}ëª…ì˜ íŒ€ì› ì •ë³´ë¥¼ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.`);

                // 2. ì‹¤ì œ ì§€ì¶œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° (ì˜¬ë°”ë¥¸ API ì‚¬ìš©)
                console.log('2. íŒ€ ì§€ì¶œ ë°ì´í„° API í˜¸ì¶œ ì¤‘... (/teams/spend)');
                const spendingData = await getTeamSpendingData();
                console.log('ì§€ì¶œ ë°ì´í„° ì‘ë‹µ:', spendingData);
               
                if (!spendingData || !spendingData.teamMemberSpend) {
                    throw new Error('ì§€ì¶œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }

                console.log(`âœ… ${spendingData.teamMemberSpend.length}ëª…ì˜ ì§€ì¶œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.`);
                console.log(`ğŸ“Š API ì‘ë‹µ ì •ë³´: ì´ ë©¤ë²„ ${spendingData.totalMembers || 'ì •ë³´ì—†ìŒ'}ëª…, ì´ í˜ì´ì§€ ${spendingData.totalPages || 'ì •ë³´ì—†ìŒ'}ê°œ`);
                
                // ì‹¤ì œë¡œ ê°€ì ¸ì˜¨ ë©¤ë²„ ìˆ˜ì™€ API ë©¤ë²„ ìˆ˜ ë¹„êµ ë¡œê¹…
                if (membersData.teamMembers.length !== spendingData.teamMemberSpend.length) {
                    console.log(`âš ï¸ ë©¤ë²„ ìˆ˜ ë¶ˆì¼ì¹˜: ë©¤ë²„ API ${membersData.teamMembers.length}ëª… vs ì§€ì¶œ API ${spendingData.teamMemberSpend.length}ëª…`);
                }

                // 3. ì´ë©”ì¼ ê¸°ì¤€ìœ¼ë¡œ ë©¤ë²„ì™€ ì§€ì¶œ ë°ì´í„° ë§¤í•‘
                console.log('3. ë©¤ë²„ì™€ ì§€ì¶œ ë°ì´í„° ë§¤í•‘ ì¤‘...');
                const memberSpendMap = {};
               
                spendingData.teamMemberSpend.forEach(spendInfo => {
                    memberSpendMap[spendInfo.email] = {
                        premiumRequests: spendInfo.fastPremiumRequests || 0,
                        spend: (spendInfo.spendCents || 0) / 100, // centsë¥¼ dollarsë¡œ ë³€í™˜
                        hardLimitOverride: spendInfo.hardLimitOverrideDollars || 0
                    };
                });

                console.log('ì§€ì¶œ ë°ì´í„° ë§¤í•‘ ê²°ê³¼:', memberSpendMap);

                // 4. Fast Requests ë¦¬ì…‹ ë‚ ì§œ í‘œì‹œ
                console.log('4. Fast Requests ë¦¬ì…‹ ë‚ ì§œ í‘œì‹œ ì¤‘...');
                updateFastRequestsResetDate(spendingData.teamMemberSpend);
                
                // 5. ë©¤ë²„ í…Œì´ë¸” ì—…ë°ì´íŠ¸
                console.log('5. ë©¤ë²„ í…Œì´ë¸” UI ì—…ë°ì´íŠ¸ ì¤‘...');
                updateMembersTable(membersData.teamMembers, memberSpendMap);
               
                console.log('=== ì‹¤ì œ API ë°ì´í„°ë¡œ ë©¤ë²„ í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì™„ë£Œ! ===');
               
            } catch (error) {
                console.error('âŒ ì‹¤ì œ API ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                
                // ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼
                alert(`ì‹¤ì œ API ë°ì´í„° ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤:\n${error.message}\n\ní”„ë¡ì‹œ ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•˜ì„¸ìš”.`);
            }
        }

        // Fast Requests ë¦¬ì…‹ ë‚ ì§œ í‘œì‹œ
        function updateFastRequestsResetDate(teamMemberSpend) {
            try {
                // Premium Requestsê°€ 0ì¸ ë©¤ë²„ë“¤ì„ ì°¾ì•„ì„œ ë¦¬ì…‹ ë‚ ì§œ ê³„ì‚°
                const zeroRequestMembers = teamMemberSpend.filter(member => 
                    member.fastPremiumRequests === 0
                );
                
                // ì‹¤ì œë¡œëŠ” APIì—ì„œ ì œê³µí•˜ëŠ” ë¦¬ì…‹ ë‚ ì§œ ì •ë³´ê°€ í•„ìš”í•˜ì§€ë§Œ,
                // í˜„ì¬ë¡œì„œëŠ” ê³ ì •ëœ ë‚ ì§œë¥¼ ì‚¬ìš©
                const resetDate = '2025ë…„ 7ì›” 22ì¼';
                
                const resetDateElement = document.getElementById('fast-requests-reset-date');
                if (resetDateElement) {
                    resetDateElement.textContent = resetDate;
                }
                
                // í•œêµ­ ì‹œê°„ ê¸°ì¤€ ì˜¤ëŠ˜ ë‚ ì§œ ì—…ë°ì´íŠ¸
                updateTodayDate();
                
                console.log(`ğŸ“… Fast Requests ë¦¬ì…‹ ë‚ ì§œ: ${resetDate} (Premium Requests 0ì¸ ë©¤ë²„: ${zeroRequestMembers.length}ëª…)`);
            } catch (error) {
                console.error('âŒ Fast Requests ë¦¬ì…‹ ë‚ ì§œ ê³„ì‚° ì˜¤ë¥˜:', error);
                const resetDateElement = document.getElementById('fast-requests-reset-date');
                if (resetDateElement) {
                    resetDateElement.textContent = '2025ë…„ 7ì›” 22ì¼';
                }
                // ì˜¤ë¥˜ ë°œìƒ ì‹œì—ë„ ì˜¤ëŠ˜ ë‚ ì§œëŠ” ì—…ë°ì´íŠ¸
                updateTodayDate();
            }
        }

        // í•œêµ­ ì‹œê°„ ê¸°ì¤€ ì˜¤ëŠ˜ ë‚ ì§œ ì—…ë°ì´íŠ¸
        function updateTodayDate() {
            try {
                // í•œêµ­ ì‹œê°„ ê¸°ì¤€ (UTC+9)
                const now = new Date();
                const koreaTime = new Date(now.getTime() + (9 * 60 * 60 * 1000)); // UTC+9
                const todayDate = koreaTime.toISOString().split('T')[0]; // YYYY-MM-DD í˜•ì‹
                
                const todayDateElement = document.getElementById('today-date');
                if (todayDateElement) {
                    todayDateElement.textContent = todayDate;
                    todayDateElement.style.color = '#ff9800'; // ì˜¤ë Œì§€ìƒ‰
                }
                
                console.log(`ğŸ“… ì˜¤ëŠ˜ ë‚ ì§œ (í•œêµ­ ì‹œê°„): ${todayDate}`);
            } catch (error) {
                console.error('âŒ ì˜¤ëŠ˜ ë‚ ì§œ ê³„ì‚° ì˜¤ë¥˜:', error);
                const todayDateElement = document.getElementById('today-date');
                if (todayDateElement) {
                    todayDateElement.textContent = '2025-08-03';
                    todayDateElement.style.color = '#ff9800'; // ì˜¤ë Œì§€ìƒ‰
                }
            }
        }

        // Export CSV ê¸°ëŠ¥
        function exportMembersToCSV() {
            try {
                if (!currentMembersData || currentMembersData.length === 0) {
                    alert('ë‚´ë³´ë‚¼ ë©¤ë²„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                
                // CSV í—¤ë”
                const headers = ['Name', 'Email', 'Role', 'Premium Requests', 'Spend ($)', 'Hard Limit Override ($)'];
                
                // CSV ë°ì´í„° ìƒì„±
                const csvData = currentMembersData.map(member => [
                    member.name || '',
                    member.email || '',
                    member.role || '',
                    member.spendData?.premiumRequests || 0,
                    (member.spendData?.spend || 0).toFixed(2),
                    (member.spendData?.hardLimitOverride || 0).toFixed(2)
                ]);
                
                // CSV ë¬¸ìì—´ ìƒì„±
                const csvContent = [
                    headers.join(','),
                    ...csvData.map(row => row.join(','))
                ].join('\n');
                
                // íŒŒì¼ ë‹¤ìš´ë¡œë“œ
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', `members_export_${new Date().toISOString().split('T')[0]}.csv`);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                console.log(`ğŸ“Š CSV ë‚´ë³´ë‚´ê¸° ì™„ë£Œ: ${currentMembersData.length}ëª…ì˜ ë©¤ë²„ ë°ì´í„°`);
            } catch (error) {
                console.error('âŒ CSV ë‚´ë³´ë‚´ê¸° ì˜¤ë¥˜:', error);
                alert('CSV ë‚´ë³´ë‚´ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ë©¤ë²„ í…Œì´ë¸” ì—…ë°ì´íŠ¸ (ì‹¤ì œ ì§€ì¶œ ë°ì´í„° ì‚¬ìš©)
        function updateMembersTable(members, memberSpendMap) {
            console.log(`ğŸ”„ ë©¤ë²„ í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì‹œì‘: ${members.length}ëª…ì˜ ë©¤ë²„ ë°ì´í„°`);
            console.log('ğŸ“Š ì§€ì¶œ ë°ì´í„° ë§¤í•‘ ì •ë³´:', Object.keys(memberSpendMap));
           
            // ë©¤ë²„ ì •ë³´ì™€ ì‹¤ì œ ì§€ì¶œ ë°ì´í„° ê²°í•©
            const membersWithSpending = members.map(member => {
                const spendData = memberSpendMap[member.email] || {
                    premiumRequests: 0,
                    spend: 0,
                    hardLimitOverride: 0
                };
               
                return {
                    ...member,
                    spendData: spendData
                };
            });
           
            console.log(`ğŸ“‹ ì²˜ë¦¬ëœ ë©¤ë²„ ë°ì´í„°: ${membersWithSpending.length}ëª…`);
           
            // Premium Requests ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ (ë†’ì€ ìˆœ)
            membersWithSpending.sort((a, b) => b.spendData.premiumRequests - a.spendData.premiumRequests);
           
            // ì „ì—­ ë°ì´í„° ì €ì¥
            currentMembersData = membersWithSpending;
            originalMembersData = [...membersWithSpending]; // ì›ë³¸ ë°ì´í„° ë³´ì¡´
            currentMembersPage = 1; // í˜ì´ì§€ ë¦¬ì…‹
            
            // í˜ì´ì§€ë„¤ì´ì…˜ê³¼ í•¨ê»˜ ë Œë”ë§
            renderMembersTableWithPagination(membersWithSpending);
        }
        
        // Members í…Œì´ë¸” í˜ì´ì§€ë„¤ì´ì…˜ê³¼ í•¨ê»˜ ë Œë”ë§ (All Raw Events ìŠ¤íƒ€ì¼)
        function renderMembersTableWithPagination(membersWithSpending) {
            const tableContainer = document.querySelector('#members-table-container');
            if (!tableContainer) {
                console.error('âŒ ë©¤ë²„ í…Œì´ë¸” ì»¨í…Œì´ë„ˆë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // í˜ì´ì§€ë„¤ì´ì…˜ ì ìš©
            const totalMembers = membersWithSpending.length;
            const totalPages = Math.ceil(totalMembers / currentMembersPageSize);
            const startIndex = (currentMembersPage - 1) * currentMembersPageSize;
            const endIndex = Math.min(startIndex + currentMembersPageSize, totalMembers);
            const pageMembers = membersWithSpending.slice(startIndex, endIndex);
            
            console.log(`ğŸ“„ í˜ì´ì§€ë„¤ì´ì…˜: ${startIndex + 1}-${endIndex} of ${totalMembers} (í˜ì´ì§€ ${currentMembersPage}/${totalPages})`);
           
            // í…Œì´ë¸” ì œëª© ë™ì  ìƒì„±
            const getTableTitle = () => {
                if (currentFilterType === 'active') {
                    return `ğŸ‘¥ í™œì„± ë©¤ë²„ ë³´ê¸° (${startIndex + 1}-${endIndex} of ${totalMembers})`;
                } else if (currentFilterType === 'inactive') {
                    return `ğŸ‘¥ ë¹„í™œì„± ë©¤ë²„ ë³´ê¸° (${startIndex + 1}-${endIndex} of ${totalMembers})`;
                } else {
                    return `ğŸ‘¥ ì „ì²´ ë©¤ë²„ ë³´ê¸° (${startIndex + 1}-${endIndex} of ${totalMembers})`;
                }
            };

            // í…Œì´ë¸” HTML ìƒì„± (All Raw Events ìŠ¤íƒ€ì¼)
            const tableHtml = `
                <div class="user-cumulative-header" style="display: flex; justify-content: space-between; align-items: center;">
                    <span>${getTableTitle()}</span>
                    <select id="membersPageSize" onchange="changeMembersPageSize(this.value)" style="background: #3a3a3a; color: #fff; border: 1px solid #4a4a4a; padding: 5px 10px; border-radius: 4px; font-size: 12px;">
                        <option value="10" ${currentMembersPageSize === 10 ? 'selected' : ''}>10ê°œ ë³´ê¸°</option>
                        <option value="20" ${currentMembersPageSize === 20 ? 'selected' : ''}>20ê°œ ë³´ê¸°</option>
                        <option value="30" ${currentMembersPageSize === 30 ? 'selected' : ''}>30ê°œ ë³´ê¸°</option>
                        <option value="50" ${currentMembersPageSize === 50 ? 'selected' : ''}>50ê°œ ë³´ê¸°</option>
                        <option value="100" ${currentMembersPageSize === 100 ? 'selected' : ''}>100ê°œ ë³´ê¸°</option>
                    </select>
                </div>
                <div class="table-header">
                    <div onclick="sortMembers('name')" style="cursor: pointer;">NAME â†•</div>
                    <div onclick="sortMembers('email')" style="cursor: pointer;">EMAIL â†•</div>
                    <div onclick="sortMembers('requests')" style="cursor: pointer;">PREMIUM REQUESTS â†•</div>
                    <div onclick="sortMembers('spend')" style="cursor: pointer;">SPEND â†•</div>
                    <div onclick="sortMembers('role')" style="cursor: pointer;">ROLE â†•</div>
                    <div></div>
                </div>
                ${pageMembers.length > 0 ? pageMembers.map(member => {
                const roleBadgeClass = member.role === 'owner' ? 'admin' : '';
                const roleText = member.role === 'owner' ? 'Admin' : 'Member';
                const requestColor = member.spendData.premiumRequests > 100 ? '#4caf50' :
                                   member.spendData.premiumRequests > 20 ? '#ff9800' :
                                   member.spendData.premiumRequests > 0 ? '#2196f3' : '#f44336';
               
                    return `
                        <div class="table-row">
                    <div>${member.name || 'Unnamed'}</div>
                    <div class="clickable-email" title="View usage for ${member.email}" onclick="navigateToUsageWithEmail('${member.email}')">${member.email}</div>
                    <div style="color: ${requestColor}; font-weight: 600;">${member.spendData.premiumRequests}</div>
                    <div>$${member.spendData.spend.toFixed(2)}</div>
                    <div><span class="role-badge ${roleBadgeClass}">${roleText}</span></div>
                    <div>â‹¯</div>
                        </div>
                    `;
                }).join('') : '<div style="padding: 20px; text-align: center; color: #7a7a7a; background-color: #1a1a1a; grid-column: 1 / -1;">ë©¤ë²„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>'}
            `;
            
            tableContainer.innerHTML = tableHtml;
            
            // í˜ì´ì§€ë„¤ì´ì…˜ í‘œì‹œ/ìˆ¨ê¹€
            const paginationContainer = document.getElementById('members-pagination');
            if (paginationContainer) {
                if (totalMembers > currentMembersPageSize) {
                    paginationContainer.style.display = 'block';
                    paginationContainer.innerHTML = generateMembersPagination(totalPages);
                } else {
                    paginationContainer.style.display = 'none';
                }
            }
            
            console.log(`âœ… Members í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì™„ë£Œ: í˜ì´ì§€ ${currentMembersPage}/${totalPages}, ${pageMembers.length}ê°œ ë©¤ë²„ í‘œì‹œ`);
           
            // í†µê³„ ì •ë³´ í‘œì‹œ
            const totalRequests = membersWithSpending.reduce((sum, member) => sum + member.spendData.premiumRequests, 0);
            const totalSpend = membersWithSpending.reduce((sum, member) => sum + member.spendData.spend, 0);
            const activeMembers = membersWithSpending.filter(member => member.spendData.premiumRequests > 0).length;
           
            console.log(`ğŸ“Š ë©¤ë²„ í†µê³„ (ì‹¤ì œ API ë°ì´í„°):`);
            console.log(`   - ì´ ë©¤ë²„: ${membersWithSpending.length}ëª…`);
            console.log(`   - í™œì„± ë©¤ë²„: ${activeMembers}ëª… (Premium Requests > 0)`);
            console.log(`   - ì´ Premium Requests: ${totalRequests}ê±´`);
            console.log(`   - ì´ ì§€ì¶œ: $${totalSpend.toFixed(2)}`);
        }
        
        // ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ í˜ì´ì§€ë„¤ì´ì…˜ ìƒì„± (All Raw Events ìŠ¤íƒ€ì¼)
        function generateUserCumulativePagination(totalPages) {
            let pagination = '';
            
            // ì´ì „ ë²„íŠ¼
            if (currentUserCumulativePage > 1) {
                pagination += `<button onclick="changeUserCumulativePage(${currentUserCumulativePage - 1})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin: 0 2px;">â€¹</button>`;
            }
            
            // í˜ì´ì§€ ë²ˆí˜¸ë“¤
            let startPage = Math.max(1, currentUserCumulativePage - 2);
            let endPage = Math.min(totalPages, currentUserCumulativePage + 2);
            
            // ì²« í˜ì´ì§€ê°€ ë²”ìœ„ì— ì—†ìœ¼ë©´ ì¶”ê°€
            if (startPage > 1) {
                pagination += `<button onclick="changeUserCumulativePage(1)" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin: 0 2px;">1</button>`;
                if (startPage > 2) {
                    pagination += `<span style="color: #7a7a7a; padding: 0 5px;">...</span>`;
                }
            }
            
            // í˜„ì¬ ë²”ìœ„ì˜ í˜ì´ì§€ë“¤
            for (let i = startPage; i <= endPage; i++) {
                const isActive = i === currentUserCumulativePage;
                pagination += `<button onclick="changeUserCumulativePage(${i})" style="background: ${isActive ? '#4a9eff' : '#3a3a3a'}; border: 1px solid ${isActive ? '#4a9eff' : '#4a4a4a'}; color: ${isActive ? 'white' : '#e1e1e1'}; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: ${isActive ? '600' : 'normal'}; margin: 0 2px;">${i}</button>`;
            }
            
            // ë§ˆì§€ë§‰ í˜ì´ì§€ê°€ ë²”ìœ„ì— ì—†ìœ¼ë©´ ì¶”ê°€
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    pagination += `<span style="color: #7a7a7a; padding: 0 5px;">...</span>`;
                }
                pagination += `<button onclick="changeUserCumulativePage(${totalPages})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin: 0 2px;">${totalPages}</button>`;
            }
            
            // ë‹¤ìŒ ë²„íŠ¼
            if (currentUserCumulativePage < totalPages) {
                pagination += `<button onclick="changeUserCumulativePage(${currentUserCumulativePage + 1})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin: 0 2px;">â€º</button>`;
            }
            
            return pagination;
        }

        // Overview í™œë™ë¦¬ìŠ¤íŠ¸ í˜ì´ì§€ë„¤ì´ì…˜ ìƒì„± (Membersì™€ ë™ì¼)
        function generateOverviewActivityPagination(totalPages) {
            let pagination = '';
            
            // ì´ì „ ë²„íŠ¼
            if (currentActivityPage > 1) {
                pagination += `<button onclick="changeOverviewActivityPage(${currentActivityPage - 1})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin: 0 2px;">â€¹</button>`;
            }
            
            // í˜ì´ì§€ ë²ˆí˜¸ë“¤
            let startPage = Math.max(1, currentActivityPage - 2);
            let endPage = Math.min(totalPages, currentActivityPage + 2);
            
            // ì²« í˜ì´ì§€ê°€ ë²”ìœ„ì— ì—†ìœ¼ë©´ ì¶”ê°€
            if (startPage > 1) {
                pagination += `<button onclick="changeOverviewActivityPage(1)" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin: 0 2px;">1</button>`;
                if (startPage > 2) {
                    pagination += `<span style="color: #7a7a7a; padding: 0 5px;">...</span>`;
                }
            }
            
            // í˜„ì¬ ë²”ìœ„ì˜ í˜ì´ì§€ë“¤
            for (let i = startPage; i <= endPage; i++) {
                const isActive = i === currentActivityPage;
                pagination += `<button onclick="changeOverviewActivityPage(${i})" style="background: ${isActive ? '#4a9eff' : '#3a3a3a'}; border: 1px solid ${isActive ? '#4a9eff' : '#4a4a4a'}; color: ${isActive ? 'white' : '#e1e1e1'}; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: ${isActive ? '600' : 'normal'}; margin: 0 2px;">${i}</button>`;
            }
            
            // ë§ˆì§€ë§‰ í˜ì´ì§€ê°€ ë²”ìœ„ì— ì—†ìœ¼ë©´ ì¶”ê°€
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    pagination += `<span style="color: #7a7a7a; padding: 0 5px;">...</span>`;
                }
                pagination += `<button onclick="changeOverviewActivityPage(${totalPages})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin: 0 2px;">${totalPages}</button>`;
            }
            
            // ë‹¤ìŒ ë²„íŠ¼
            if (currentActivityPage < totalPages) {
                pagination += `<button onclick="changeOverviewActivityPage(${currentActivityPage + 1})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin: 0 2px;">â€º</button>`;
            }
            
            return pagination;
        }

        // Overview í™œë™ë¦¬ìŠ¤íŠ¸ í˜ì´ì§€ ë³€ê²½
        function changeOverviewActivityPage(page) {
            currentActivityPage = page;
            renderOverviewActivityTableWithPagination(currentActivityData);
        }

        // Overview í™œë™ë¦¬ìŠ¤íŠ¸ í˜ì´ì§€ í¬ê¸° ë³€ê²½
        function changeOverviewActivityPageSize(pageSize) {
            currentActivityPageSize = parseInt(pageSize);
            currentActivityPage = 1; // í˜ì´ì§€ í¬ê¸° ë³€ê²½ì‹œ ì²« í˜ì´ì§€ë¡œ ì´ë™
            renderOverviewActivityTableWithPagination(currentActivityData);
        }

        // Members í˜ì´ì§€ë„¤ì´ì…˜ ìƒì„± (All Raw Eventsì™€ ë™ì¼)
        function generateMembersPagination(totalPages) {
            let pagination = '';
            
            // ì´ì „ ë²„íŠ¼
            if (currentMembersPage > 1) {
                pagination += `<button onclick="changeMembersPage(${currentMembersPage - 1})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin: 0 2px;">â€¹</button>`;
            }
            
            // í˜ì´ì§€ ë²ˆí˜¸ë“¤
            let startPage = Math.max(1, currentMembersPage - 2);
            let endPage = Math.min(totalPages, currentMembersPage + 2);
            
            // ì²« í˜ì´ì§€ê°€ ë²”ìœ„ì— ì—†ìœ¼ë©´ ì¶”ê°€
            if (startPage > 1) {
                pagination += `<button onclick="changeMembersPage(1)" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin: 0 2px;">1</button>`;
                if (startPage > 2) {
                    pagination += `<span style="color: #7a7a7a; padding: 0 5px;">...</span>`;
                }
            }
            
            // í˜„ì¬ ë²”ìœ„ì˜ í˜ì´ì§€ë“¤
            for (let i = startPage; i <= endPage; i++) {
                const isActive = i === currentMembersPage;
                pagination += `<button onclick="changeMembersPage(${i})" style="background: ${isActive ? '#4a9eff' : '#3a3a3a'}; border: 1px solid ${isActive ? '#4a9eff' : '#4a4a4a'}; color: ${isActive ? 'white' : '#e1e1e1'}; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: ${isActive ? '600' : 'normal'}; margin: 0 2px;">${i}</button>`;
            }
            
            // ë§ˆì§€ë§‰ í˜ì´ì§€ê°€ ë²”ìœ„ì— ì—†ìœ¼ë©´ ì¶”ê°€
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    pagination += `<span style="color: #7a7a7a; padding: 0 5px;">...</span>`;
                }
                pagination += `<button onclick="changeMembersPage(${totalPages})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin: 0 2px;">${totalPages}</button>`;
            }
            
            // ë‹¤ìŒ ë²„íŠ¼
            if (currentMembersPage < totalPages) {
                pagination += `<button onclick="changeMembersPage(${currentMembersPage + 1})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin: 0 2px;">â€º</button>`;
            }
            
            return pagination;
        }

        // Members í˜ì´ì§€ ë³€ê²½
        function changeMembersPage(page) {
            currentMembersPage = page;
            renderMembersTableWithPagination(currentMembersData);
        }

        // Members í˜ì´ì§€ í¬ê¸° ë³€ê²½
        function changeMembersPageSize(pageSize) {
            currentMembersPageSize = parseInt(pageSize);
            currentMembersPage = 1; // í˜ì´ì§€ í¬ê¸° ë³€ê²½ì‹œ ì²« í˜ì´ì§€ë¡œ ì´ë™
            renderMembersTableWithPagination(currentMembersData);
        }

        // ê²€ìƒ‰ì°½ X ë²„íŠ¼ í‘œì‹œ/ìˆ¨ê¹€ í† ê¸€
        function toggleSearchClearBtn(searchId) {
            const searchInput = document.getElementById(searchId);
            const clearBtn = document.getElementById(searchId + '-clear');
            
            if (searchInput && clearBtn) {
                if (searchInput.value.length > 0) {
                    clearBtn.style.display = 'flex';
                } else {
                    clearBtn.style.display = 'none';
                }
            }
        }

        // ê²€ìƒ‰ì°½ ë¹„ìš°ê¸°
        function clearSearch(searchId) {
            const searchInput = document.getElementById(searchId);
            const clearBtn = document.getElementById(searchId + '-clear');
            const autocomplete = document.getElementById(searchId.replace('-search', '-autocomplete'));
            
            if (searchInput) {
                searchInput.value = '';
                clearBtn.style.display = 'none';
                
                // ìë™ì™„ì„± ë“œë¡­ë‹¤ìš´ ìˆ¨ê¸°ê¸°
                if (autocomplete) {
                    autocomplete.style.display = 'none';
                }
                
                // ê²€ìƒ‰ í•„í„° ì´ˆê¸°í™”
                if (searchId === 'members-search') {
                    filterMembers('');
                } else if (searchId === 'usage-search') {
                    filterUsageMembers('');
                }
            }
        }

        // ìë™ì™„ì„± ë“œë¡­ë‹¤ìš´ í‘œì‹œ
        function showAutocomplete(searchId) {
            const searchInput = document.getElementById(searchId);
            const autocomplete = document.getElementById(searchId.replace('-search', '-autocomplete'));
            
            if (!searchInput || !autocomplete) return;
            
            const searchTerm = searchInput.value.toLowerCase().trim();
            
            if (searchTerm.length === 0) {
                autocomplete.style.display = 'none';
                return;
            }
            
            // ì‚¬ìš©ì ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            let users = [];
            if (searchId === 'members-search') {
                users = getMembersUsers();
            } else if (searchId === 'usage-search') {
                users = getUsageUsers();
            }
            
            // ê²€ìƒ‰ì–´ì™€ ë§¤ì¹­ë˜ëŠ” ì‚¬ìš©ì í•„í„°ë§
            const filteredUsers = users.filter(user => 
                user.name.toLowerCase().includes(searchTerm) || 
                user.email.toLowerCase().includes(searchTerm)
            );
            
            if (filteredUsers.length === 0) {
                autocomplete.style.display = 'none';
                return;
            }
            
            // ë“œë¡­ë‹¤ìš´ HTML ìƒì„±
            const dropdownHTML = filteredUsers.map(user => `
                <div class="autocomplete-item" onclick="selectUser('${searchId}', '${user.email}')">
                    <div class="user-name">${user.name}</div>
                    <div class="user-email">${user.email}</div>
                </div>
            `).join('');
            
            autocomplete.innerHTML = dropdownHTML;
            autocomplete.style.display = 'block';
        }

        // ì‚¬ìš©ì ì„ íƒ
        function selectUser(searchId, userEmail) {
            const searchInput = document.getElementById(searchId);
            const autocomplete = document.getElementById(searchId.replace('-search', '-autocomplete'));
            
            if (searchInput) {
                searchInput.value = userEmail;
                
                // ê²€ìƒ‰ ì‹¤í–‰
                if (searchId === 'members-search') {
                    filterMembers(userEmail);
                } else if (searchId === 'usage-search') {
                    filterUsageMembers(userEmail);
                }
                
                // X ë²„íŠ¼ í‘œì‹œ
                toggleSearchClearBtn(searchId);
            }
            
            // ë“œë¡­ë‹¤ìš´ ìˆ¨ê¸°ê¸°
            if (autocomplete) {
                autocomplete.style.display = 'none';
            }
        }

        // Members ì„¹ì…˜ ì‚¬ìš©ì ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        function getMembersUsers() {
            if (!currentMembersData || currentMembersData.length === 0) {
                return [];
            }
            
            return currentMembersData.map(member => ({
                name: member.name || 'Unnamed',
                email: member.email
            }));
        }

        // Usage ì„¹ì…˜ ì‚¬ìš©ì ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        function getUsageUsers() {
            if (!currentUserCumulativeData || currentUserCumulativeData.length === 0) {
                return [];
            }
            
            return currentUserCumulativeData.map(user => ({
                name: user.name || 'Unnamed',
                email: user.email
            }));
        }

        // ë©¤ë²„ ê²€ìƒ‰ ê¸°ëŠ¥
        function filterMembers(searchTerm) {
            const rows = document.querySelectorAll('#members .table-row');
            const searchLower = searchTerm.toLowerCase();
           
            rows.forEach(row => {
                const name = row.children[0].textContent.toLowerCase();
                const email = row.children[1].textContent.toLowerCase();
               
                if (name.includes(searchLower) || email.includes(searchLower)) {
                    row.style.display = 'grid';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        // Usage ì„¹ì…˜ í˜„ì¬ í•„í„°ë¡œ ì—…ë°ì´íŠ¸
        async function updateUsageWithCurrentFilter(days = 30, showLoading = true) {
            try {
                // ì´ë¯¸ ë¡œë”© ì¤‘ì´ë©´ ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€
                if (isUsageLoading) {
                    console.log('âš ï¸ Usage ë°ì´í„° ë¡œë”© ì¤‘ - ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€');
                    return;
                }
                
                console.log(`=== Usage ì„¹ì…˜ ${days}ì¼ í•„í„°ë¡œ ì—…ë°ì´íŠ¸ ì‹œì‘ (ë¡œë”© í‘œì‹œ: ${showLoading}) ===`);
                
                isUsageLoading = true;
                
                // ë‚ ì§œ ë²”ìœ„ ê³„ì‚°
                const dateRange = getDateRange(days);
                currentUsageDateRange = null; // ì‚¬ìš©ì ì •ì˜ ë²”ìœ„ ì´ˆê¸°í™”
                
                await updateUsageWithDateRange(dateRange.startDate, dateRange.endDate, showLoading);
                
                // ì²« ë²ˆì§¸ ë¡œë”© ì™„ë£Œ í‘œì‹œ
                if (showLoading) {
                    isUsageDataLoaded = true;
                }
                
                isUsageLoading = false;
                console.log(`=== Usage ì„¹ì…˜ ${days}ì¼ í•„í„° ì—…ë°ì´íŠ¸ ì™„ë£Œ ===`);
            } catch (error) {
                console.error('âŒ Usage í•„í„° ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);
                isUsageLoading = false;
            }
        }

        // Usage ì„¹ì…˜ íŠ¹ì • ë‚ ì§œ ë²”ìœ„ë¡œ ì—…ë°ì´íŠ¸
        async function updateUsageWithDateRange(startDate, endDate, showLoading = true) {
            try {
                console.log(`=== Usage ì„¹ì…˜ ë‚ ì§œ ë²”ìœ„ ì—…ë°ì´íŠ¸ ì‹œì‘: ${new Date(startDate).toLocaleDateString()} ~ ${new Date(endDate).toLocaleDateString()} (ë¡œë”© í‘œì‹œ: ${showLoading}) ===`);
                
                // ë¡œë”© ìƒíƒœ í‘œì‹œ (ì²« ë²ˆì§¸ ë¡œë”©ì—ë§Œ)
                if (showLoading) {
                    showUsageLoadingState(true);
                }
                
                // API ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                const [membersData, eventsData, usageData, spendingData] = await Promise.all([
                    getTeamMembers(),
                    getFilteredEvents(startDate, endDate),
                    getUsageData(startDate, endDate),
                    getTeamSpendingData()
                ]);
                
                // Usage ì¹´ë“œ ì—…ë°ì´íŠ¸
                updateUsageCards(usageData, eventsData);
                
                // ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ ì—…ë°ì´íŠ¸
                updateUserCumulativeInfo(membersData, eventsData, spendingData, startDate, endDate);
                
                // All Raw Events ì—…ë°ì´íŠ¸ (í˜ì´ì§€ ì´ˆê¸°í™”)
                currentRawEventsPage = 1;
                updateRawEventsTable(eventsData);
                
                // ë¡œë”© ìƒíƒœ í•´ì œ (ì²« ë²ˆì§¸ ë¡œë”©ì—ë§Œ)
                if (showLoading) {
                    showUsageLoadingState(false);
                }
                
                console.log(`=== Usage ì„¹ì…˜ ë‚ ì§œ ë²”ìœ„ ì—…ë°ì´íŠ¸ ì™„ë£Œ ===`);
            } catch (error) {
                console.error('âŒ Usage ë‚ ì§œ ë²”ìœ„ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);
                if (showLoading) {
                    showUsageLoadingState(false);
                }
            }
        }

        // Usage ë¡œë”© ìƒíƒœ í‘œì‹œ/í•´ì œ
        function showUsageLoadingState(isLoading) {
            const usageCards = document.querySelectorAll('#usage .usage-card-number');
            const userTables = document.querySelectorAll('#usage .user-cumulative-info');
            
            if (isLoading) {
                usageCards.forEach(card => {
                    card.textContent = '-';
                });
                userTables.forEach(table => {
                    table.style.opacity = '0.5';
                });
            } else {
                userTables.forEach(table => {
                    table.style.opacity = '1';
                });
            }
        }

        // Usage ì¹´ë“œ ì—…ë°ì´íŠ¸ (Overviewì™€ Usage ì„¹ì…˜ ëª¨ë‘)
        function updateUsageCards(usageData, eventsData) {
            // Overview ì„¹ì…˜ê³¼ Usage ì„¹ì…˜ ëª¨ë‘ì˜ ì¹´ë“œë¥¼ ì°¾ìŒ
            const overviewCards = document.querySelectorAll('#overview .usage-card-number');
            const usageCards = document.querySelectorAll('#usage .usage-card-number');
            const allCards = [...overviewCards, ...usageCards];
            
            if (!usageData || !usageData.data) {
                allCards.forEach((card, index) => {
                    const cardIndex = index % 4; // 4ê°œ ì¹´ë“œ ë°˜ë³µ
                    card.textContent = '0';
                });
                console.log('ğŸ“Š Usage ì¹´ë“œ ì—…ë°ì´íŠ¸: ë°ì´í„° ì—†ìŒ - ëª¨ë“  ê°’ì„ 0ìœ¼ë¡œ ì„¤ì •');
                return;
            }
            
            // ì‹¤ì œ í™œë™í•œ ì‚¬ìš©ì ìˆ˜ ê³„ì‚°
            const activeUsers = new Set();
            if (eventsData && eventsData.usageEvents) {
                eventsData.usageEvents.forEach(event => {
                    if (event.userEmail && event.requestsCosts > 0) {
                        activeUsers.add(event.userEmail);
                    }
                });
            }
            
            // ì§‘ê³„ ê³„ì‚°
            let totalLinesAdded = 0;
            let totalLinesAccepted = 0;
            let totalTabsAccepted = 0;
            let totalChats = 0;
            
            usageData.data.forEach(dayData => {
                totalLinesAdded += (dayData.totalLinesAdded || 0);
                totalLinesAccepted += (dayData.acceptedLinesAdded || 0);
                totalTabsAccepted += (dayData.totalTabsAccepted || 0);
                totalChats += (dayData.chatRequests || 0);
            });
            
            // ì¹´ë“œ ì—…ë°ì´íŠ¸ (Overviewì™€ Usage ì„¹ì…˜ ëª¨ë‘)
            const values = [
                activeUsers.size.toLocaleString(), // Total Users
                (totalLinesAdded + totalLinesAccepted).toLocaleString(), // Lines of Agent Edits
                totalTabsAccepted.toLocaleString(), // Tabs Accepted
                totalChats.toLocaleString() // Chats
            ];
            
            allCards.forEach((card, index) => {
                const cardIndex = index % 4; // 4ê°œ ì¹´ë“œ ë°˜ë³µ
                card.textContent = values[cardIndex];
            });
            
            console.log(`Usage ì¹´ë“œ ì—…ë°ì´íŠ¸: ì‚¬ìš©ì ${activeUsers.size}ëª…, ë¼ì¸ ${totalLinesAdded + totalLinesAccepted}ì¤„, íƒ­ ${totalTabsAccepted}ê°œ, ì±„íŒ… ${totalChats}ê±´`);
        }

        // ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ í…Œì´ë¸” ë Œë”ë§ (All Raw Events ìŠ¤íƒ€ì¼)
        function renderUserCumulativeTableWithPagination(userInfos, startDate, endDate) {
            console.log('ğŸ¨ renderUserCumulativeTableWithPagination í•¨ìˆ˜ í˜¸ì¶œë¨');
            console.log('ğŸ“Š ë Œë”ë§ ë°ì´í„°:', {
                userInfos: userInfos ? `${userInfos.length}ëª…` : 'null',
                startDate: startDate,
                endDate: endDate
            });
            
            // í—¤ë” ì—…ë°ì´íŠ¸
            const headerElement = document.querySelector('.user-cumulative-info .user-cumulative-header');
            if (headerElement) {
                if (!userInfos || userInfos.length === 0) {
                    headerElement.innerHTML = 'ğŸ“Š ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´';
                } else {
                    const totalUsers = userInfos.length;
                    const totalPages = Math.ceil(totalUsers / currentUserCumulativePageSize);
                    const startIndex = (currentUserCumulativePage - 1) * currentUserCumulativePageSize;
                    const endIndex = Math.min(startIndex + currentUserCumulativePageSize, totalUsers);
                    
                    // ë‚ ì§œ í˜•ì‹ ë³€ê²½ (ë‚ ì§œ ëì˜ "." ì œê±°)
                    const cleanStartDate = new Date(startDate).toLocaleDateString('ko-KR').replace(/\.$/, '');
                    const cleanEndDate = new Date(endDate).toLocaleDateString('ko-KR').replace(/\.$/, '');
                    
                    headerElement.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span>ğŸ“Š ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ (${cleanStartDate} ~ ${cleanEndDate})(${startIndex + 1}-${endIndex} of ${totalUsers})</span>
                            <select id="userCumulativePageSize" onchange="changeUserCumulativePageSize(this.value)" style="background: #3a3a3a; color: #fff; border: 1px solid #4a4a4a; padding: 5px 10px; border-radius: 4px; font-size: 12px;">
                                <option value="10" ${currentUserCumulativePageSize === 10 ? 'selected' : ''}>10ê°œ ë³´ê¸°</option>
                                <option value="20" ${currentUserCumulativePageSize === 20 ? 'selected' : ''}>20ê°œ ë³´ê¸°</option>
                                <option value="30" ${currentUserCumulativePageSize === 30 ? 'selected' : ''}>30ê°œ ë³´ê¸°</option>
                                <option value="50" ${currentUserCumulativePageSize === 50 ? 'selected' : ''}>50ê°œ ë³´ê¸°</option>
                                <option value="100" ${currentUserCumulativePageSize === 100 ? 'selected' : ''}>100ê°œ ë³´ê¸°</option>
                            </select>
                        </div>
                    `;
                }
            }
            
            if (!userInfos || userInfos.length === 0) {
                const container = document.getElementById('user-cumulative-container');
                if (container) {
                    container.innerHTML = `
                        <div style="padding: 20px; text-align: center; color: #7a7a7a; background-color: #1a1a1a;">
                            ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.
                        </div>
                    `;
                }
                // í˜ì´ì§€ë„¤ì´ì…˜ ìˆ¨ê¸°ê¸°
                const pagination = document.getElementById('user-cumulative-pagination');
                if (pagination) pagination.style.display = 'none';
                return;
            }
            
            // í˜ì´ì§€ë„¤ì´ì…˜ ê³„ì‚°
            const totalUsers = userInfos.length;
            const totalPages = Math.ceil(totalUsers / currentUserCumulativePageSize);
            const startIndex = (currentUserCumulativePage - 1) * currentUserCumulativePageSize;
            const endIndex = Math.min(startIndex + currentUserCumulativePageSize, totalUsers);
            const pageUsers = userInfos.slice(startIndex, endIndex);

            console.log(`ğŸ“„ ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ í˜ì´ì§€ë„¤ì´ì…˜: ${startIndex + 1}-${endIndex} of ${totalUsers} (í˜ì´ì§€ ${currentUserCumulativePage}/${totalPages})`);
            
            // í…Œì´ë¸” ë‚´ìš©ë§Œ ì—…ë°ì´íŠ¸
            const tableContent = pageUsers.map(user => `
                <div class="user-cumulative-row">
                    <div>${user.name}</div>
                    <div class="user-email clickable-email" title="View usage for ${user.email}" onclick="navigateToUsageWithEmail('${user.email}')">${user.email}</div>
                    <div><span class="role-badge ${user.role === 'owner' ? 'admin' : ''}">${user.role === 'owner' ? 'Admin' : 'Member'}</span></div>
                    <div style="font-weight: 600;">${user.periodRequests}</div>
                    <div>$${user.spend.toFixed(2)}</div>
                    <div>${user.lastActivity}</div>
                </div>
            `).join('');
            
            // ì»¨í…Œì´ë„ˆì— í…Œì´ë¸” ë‚´ìš©ë§Œ ì‚½ì…
            const container = document.getElementById('user-cumulative-container');
            if (container) {
                container.innerHTML = tableContent;
            }

            // í˜ì´ì§€ë„¤ì´ì…˜ ì—…ë°ì´íŠ¸
            const paginationContainer = document.getElementById('user-cumulative-pagination');
            if (paginationContainer && totalPages > 1) {
                paginationContainer.innerHTML = generateUserCumulativePagination(totalPages);
                paginationContainer.style.display = 'block';
            } else if (paginationContainer) {
                paginationContainer.style.display = 'none';
            }
            
            console.log('âœ… ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ í…Œì´ë¸” HTML ë Œë”ë§ ì™„ë£Œ');
            console.log(`ğŸ“Š ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ ì—…ë°ì´íŠ¸: ì´ ${userInfos.length}ëª… (í˜ì´ì§€ ${currentUserCumulativePage}/${totalPages})`);
        }
        

        
        // ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ í˜ì´ì§€ ë³€ê²½ (All Raw Events ìŠ¤íƒ€ì¼)
        function changeUserCumulativePage(page) {
            currentUserCumulativePage = page;
            renderUserCumulativeTableWithPagination(currentUserCumulativeData, currentUserCumulativeStartDate, currentUserCumulativeEndDate);
        }
        
        // ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ í˜ì´ì§€ í¬ê¸° ë³€ê²½ (All Raw Events ìŠ¤íƒ€ì¼)
        function changeUserCumulativePageSize(pageSize) {
            currentUserCumulativePageSize = parseInt(pageSize);
            currentUserCumulativePage = 1; // í˜ì´ì§€ í¬ê¸° ë³€ê²½ì‹œ ì²« í˜ì´ì§€ë¡œ ì´ë™
            renderUserCumulativeTableWithPagination(currentUserCumulativeData, currentUserCumulativeStartDate, currentUserCumulativeEndDate);
        }

        // ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ ì—…ë°ì´íŠ¸
        function updateUserCumulativeInfo(membersData, eventsData, spendingData, startDate, endDate) {
            console.log('ğŸ” updateUserCumulativeInfo í•¨ìˆ˜ í˜¸ì¶œë¨');
            console.log('ğŸ“Š ì „ë‹¬ë°›ì€ ë°ì´í„°:', {
                membersData: membersData ? `${membersData.teamMembers?.length || 0}ëª…` : 'null',
                eventsData: eventsData ? `${eventsData.usageEvents?.length || 0}ê°œ ì´ë²¤íŠ¸` : 'null',
                spendingData: spendingData ? `${spendingData.teamMemberSpend?.length || 0}ê°œ ì§€ì¶œ` : 'null',
                startDate: startDate,
                endDate: endDate
            });
            
            if (!membersData || !membersData.teamMembers) {
                console.log('âš ï¸ ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´: ë©¤ë²„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                console.log('ìƒì„¸ ì •ë³´:', {
                    membersData: !!membersData,
                    teamMembers: membersData?.teamMembers?.length || 0
                });
                return;
            }
            
            console.log('=== ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ ì—…ë°ì´íŠ¸ ì‹œì‘ ===');
            
            // ì§€ì¶œ ë°ì´í„° ë§¤í•‘
            const memberSpendMap = {};
            if (spendingData && spendingData.teamMemberSpend) {
                spendingData.teamMemberSpend.forEach(spendInfo => {
                    memberSpendMap[spendInfo.email] = {
                        premiumRequests: spendInfo.fastPremiumRequests || 0,
                        spend: (spendInfo.spendCents || 0) / 100,
                        hardLimitOverride: spendInfo.hardLimitOverrideDollars || 0
                    };
                });
            }
            
            // ì„ íƒëœ ê¸°ê°„ ë‚´ ì‚¬ìš©ìë³„ í™œë™ í†µê³„ ê³„ì‚°
            const userPeriodStats = {};
            if (eventsData && eventsData.usageEvents) {
                eventsData.usageEvents.forEach(event => {
                    const userEmail = event.userEmail;
                    const timestamp = parseInt(event.timestamp);
                    
                    if (!userPeriodStats[userEmail]) {
                        userPeriodStats[userEmail] = {
                            lastTimestamp: timestamp,
                            periodRequests: 0
                        };
                    }
                    
                    // ë§ˆì§€ë§‰ í™œë™ ì‹œê°„ ì—…ë°ì´íŠ¸
                    if (timestamp > userPeriodStats[userEmail].lastTimestamp) {
                        userPeriodStats[userEmail].lastTimestamp = timestamp;
                    }
                    
                    // ì„ íƒëœ ê¸°ê°„ ë‚´ ìš”ì²­ ë¹„ìš© ëˆ„ì  (All Raw Eventsì˜ COSTê°’ê³¼ ë™ì¼)
                    const requestCost = event.requestsCosts || 0;
                    userPeriodStats[userEmail].periodRequests += requestCost;
                    
                    // ë””ë²„ê¹…ì„ ìœ„í•œ ë¡œê·¸ (ì²˜ìŒ 5ê°œ ì´ë²¤íŠ¸ë§Œ)
                    if (Object.keys(userPeriodStats).length <= 5 && userPeriodStats[userEmail].periodRequests <= requestCost * 3) {
                        console.log(`ğŸ’° ${userEmail}: +${requestCost} (ëˆ„ì : ${userPeriodStats[userEmail].periodRequests})`);
                    }
                });
            }
            
            // ì‚¬ìš©ì ì •ë³´ ìƒì„±
            const userInfos = membersData.teamMembers.map(member => {
                const spendData = memberSpendMap[member.email] || {};
                const periodStats = userPeriodStats[member.email] || {};
                const actualSpend = spendData.spend || 0;
                const totalPremiumRequests = spendData.premiumRequests || 0; // ì „ì²´ ê¸°ê°„ Premium Requests
                const periodRequests = periodStats.periodRequests || 0; // ì„ íƒëœ ê¸°ê°„ ë‚´ ìš”ì²­ ìˆ˜
                
                // ë§ˆì§€ë§‰ í™œë™ ë‚ ì§œ ê³„ì‚°
                let lastActivityText = 'No Activity';
                if (periodStats.lastTimestamp) {
                    const lastDate = new Date(periodStats.lastTimestamp);
                    const today = new Date();
                    const daysDiff = Math.floor((today - lastDate) / (1000 * 60 * 60 * 24));
                    
                    if (daysDiff === 0) {
                        lastActivityText = 'ì˜¤ëŠ˜';
                    } else if (daysDiff === 1) {
                        lastActivityText = 'ì–´ì œ';
                    } else {
                        lastActivityText = `${daysDiff}ì¼ ì „`;
                    }
                }
                
                return {
                    name: member.name || 'Unnamed',
                    email: member.email,
                    role: member.role,
                    totalPremiumRequests: totalPremiumRequests, // ì „ì²´ Premium Requests
                    periodRequests: periodRequests, // ì„ íƒëœ ê¸°ê°„ ë‚´ ìš”ì²­ ìˆ˜
                    spend: actualSpend,
                    lastActivity: lastActivityText,
                    lastTimestamp: periodStats.lastTimestamp || 0
                };
            });
            
            // 1. Last Act ìµœì‹ ìˆœ, 2. Request ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ ì •ë ¬
            userInfos.sort((a, b) => {
                // 1ì°¨ ì •ë ¬: Last Act (ë§ˆì§€ë§‰ í™œë™) ìµœì‹ ìˆœ - timestamp ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ
                if (b.lastTimestamp !== a.lastTimestamp) {
                    return b.lastTimestamp - a.lastTimestamp;
                }
                // 2ì°¨ ì •ë ¬: Request ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ
                return b.periodRequests - a.periodRequests;
            });
            
            // ë°ì´í„° ì €ì¥ ë° í˜ì´ì§€ë„¤ì´ì…˜ ì ìš©
            currentUserCumulativeData = userInfos;
            currentUserCumulativeStartDate = startDate;
            currentUserCumulativeEndDate = endDate;
            currentUserCumulativePage = 1; // ì²« í˜ì´ì§€ë¡œ ë¦¬ì…‹
            
            // í˜ì´ì§€ë„¤ì´ì…˜ ì ìš©
            renderUserCumulativeTableWithPagination(userInfos, startDate, endDate);
            
            console.log(`ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ ì—…ë°ì´íŠ¸ ì™„ë£Œ: ${userInfos.length}ëª…`);
            console.log(`ì„ íƒëœ ê¸°ê°„ ë‚´ ì´ ìš”ì²­ ìˆ˜: ${userInfos.reduce((sum, user) => sum + user.periodRequests, 0)}ê±´`);
        }

        // All Raw Events í…Œì´ë¸” ì—…ë°ì´íŠ¸
        function updateRawEventsTable(eventsData) {
            const tableContainer = document.querySelector('#usage .user-cumulative-info:last-child');
            if (!tableContainer || !eventsData || !eventsData.usageEvents) return;
            
            // ê²€ìƒ‰ ì¤‘ì¸ ê²½ìš° ìë™ ì—…ë°ì´íŠ¸ ë°©ì§€
            if (window.pendingEmailSearch) {
                console.log(`â³ ì´ë©”ì¼ ê²€ìƒ‰ ëŒ€ê¸° ì¤‘ (${window.pendingEmailSearch}) - Raw Events í…Œì´ë¸” ìë™ ì—…ë°ì´íŠ¸ ê±´ë„ˆëœ€`);
                // ë°ì´í„°ëŠ” ì €ì¥í•˜ë˜ í…Œì´ë¸” ë Œë”ë§ì€ í•˜ì§€ ì•ŠìŒ
                currentRawEventsData = eventsData.usageEvents.sort((a, b) => {
                    const timestampA = parseInt(a.timestamp) || 0;
                    const timestampB = parseInt(b.timestamp) || 0;
                    return timestampB - timestampA; // ë‚´ë¦¼ì°¨ìˆœ (ìµœì‹  â†’ ê³¼ê±°)
                });
                return;
            }
            
            // ì „ì²´ ë°ì´í„° ì €ì¥ ë° DATE ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬ (ìµœì‹ ìˆœ)
            currentRawEventsData = eventsData.usageEvents.sort((a, b) => {
                const timestampA = parseInt(a.timestamp) || 0;
                const timestampB = parseInt(b.timestamp) || 0;
                return timestampB - timestampA; // ë‚´ë¦¼ì°¨ìˆœ (ìµœì‹  â†’ ê³¼ê±°)
            });
            
            // í˜ì´ì§€ë„¤ì´ì…˜ ì ìš©
            renderRawEventsTableWithPagination();
        }

        // Raw Events í…Œì´ë¸” í˜ì´ì§€ë„¤ì´ì…˜ê³¼ í•¨ê»˜ ë Œë”ë§
        function renderRawEventsTableWithPagination() {
            const tableContainer = document.querySelector('#usage .user-cumulative-info:last-child');
            if (!tableContainer || !currentRawEventsData.length) return;
            
            const totalEvents = currentRawEventsData.length;
            const totalPages = Math.ceil(totalEvents / currentRawEventsPageSize);
            const startIndex = (currentRawEventsPage - 1) * currentRawEventsPageSize;
            const endIndex = Math.min(startIndex + currentRawEventsPageSize, totalEvents);
            const pageEvents = currentRawEventsData.slice(startIndex, endIndex);
            
            const tableHtml = `
                <div class="user-cumulative-header" style="display: flex; justify-content: space-between; align-items: center;">
                    <span>ğŸ“‹ All Raw Events (${startIndex + 1}-${endIndex} of ${totalEvents})</span>
                    <select id="rawEventsPageSize" onchange="changeRawEventsPageSize(this.value)" style="background: #3a3a3a; color: #fff; border: 1px solid #4a4a4a; padding: 5px 10px; border-radius: 4px; font-size: 12px;">
                        <option value="10" ${currentRawEventsPageSize === 10 ? 'selected' : ''}>10ê°œ ë³´ê¸°</option>
                        <option value="20" ${currentRawEventsPageSize === 20 ? 'selected' : ''}>20ê°œ ë³´ê¸°</option>
                        <option value="30" ${currentRawEventsPageSize === 30 ? 'selected' : ''}>30ê°œ ë³´ê¸°</option>
                        <option value="50" ${currentRawEventsPageSize === 50 ? 'selected' : ''}>50ê°œ ë³´ê¸°</option>
                        <option value="100" ${currentRawEventsPageSize === 100 ? 'selected' : ''}>100ê°œ ë³´ê¸°</option>
                    </select>
                </div>
                <div class="user-cumulative-table">
                    <div>DATE</div>
                    <div>USER</div>
                    <div>KIND</div>
                    <div>MAX_MODEL</div>
                    <div>MODEL</div>
                    <div>TOKENS</div>
                    <div>COST</div>
                </div>
                ${pageEvents.map(event => {
                    const date = new Date(parseInt(event.timestamp));
                    const dateText = date.toLocaleDateString('en-US', { 
                        month: 'short', 
                        day: 'numeric', 
                        hour: '2-digit', 
                        minute: '2-digit' 
                    });
                    
                    // í† í° ì •ë³´ ê³„ì‚°
                    let tokensText = 'N/A';
                    if (event.tokenUsage) {
                        const inputTokens = event.tokenUsage.inputTokens || 0;
                        const outputTokens = event.tokenUsage.outputTokens || 0;
                        const totalTokens = inputTokens + outputTokens;
                        tokensText = totalTokens.toLocaleString();
                    }
                    
                    return `
                        <div class="user-cumulative-row">
                            <div>${dateText}</div>
                            <div class="user-email">${event.userEmail}</div>
                            <div>${(event.kindLabel || 'Unknown').substring(0, 15)}${(event.kindLabel || '').length > 15 ? '...' : ''}</div>
                            <div>${event.maxMode ? 'Yes' : 'No'}</div>
                            <div>${(event.model || 'auto').substring(0, 10)}${(event.model || '').length > 10 ? '...' : ''}</div>
                            <div>${tokensText}</div>
                            <div>${event.requestsCosts || 0}</div>
                        </div>
                    `;
                }).join('')}
                ${totalPages > 1 ? `
                    <div style="padding: 15px 20px; background-color: #2a2a2a; border-top: 1px solid #3a3a3a; display: flex; justify-content: center; align-items: center; gap: 10px;">
                        ${generateRawEventsPagination(totalPages)}
                    </div>
                ` : ''}
            `;
            
            tableContainer.innerHTML = tableHtml;
            
            console.log(`Raw Events í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì™„ë£Œ: í˜ì´ì§€ ${currentRawEventsPage}/${totalPages}, ${pageEvents.length}ê°œ ì´ë²¤íŠ¸ í‘œì‹œ`);
        }

        // Raw Events í˜ì´ì§€ë„¤ì´ì…˜ ìƒì„±
        function generateRawEventsPagination(totalPages) {
            let pagination = '';
            
            // ì´ì „ ë²„íŠ¼
            if (currentRawEventsPage > 1) {
                pagination += `<button onclick="changeRawEventsPage(${currentRawEventsPage - 1})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">â€¹</button>`;
            }
            
            // í˜ì´ì§€ ë²ˆí˜¸ë“¤
            let startPage = Math.max(1, currentRawEventsPage - 2);
            let endPage = Math.min(totalPages, currentRawEventsPage + 2);
            
            // ì²« í˜ì´ì§€ê°€ ë²”ìœ„ì— ì—†ìœ¼ë©´ ì¶”ê°€
            if (startPage > 1) {
                pagination += `<button onclick="changeRawEventsPage(1)" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">1</button>`;
                if (startPage > 2) {
                    pagination += `<span style="color: #7a7a7a; padding: 0 5px;">...</span>`;
                }
            }
            
            // í˜„ì¬ ë²”ìœ„ì˜ í˜ì´ì§€ë“¤
            for (let i = startPage; i <= endPage; i++) {
                const isActive = i === currentRawEventsPage;
                pagination += `<button onclick="changeRawEventsPage(${i})" style="background: ${isActive ? '#4a9eff' : '#3a3a3a'}; border: 1px solid ${isActive ? '#4a9eff' : '#4a4a4a'}; color: ${isActive ? 'white' : '#e1e1e1'}; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: ${isActive ? '600' : 'normal'};">${i}</button>`;
            }
            
            // ë§ˆì§€ë§‰ í˜ì´ì§€ê°€ ë²”ìœ„ì— ì—†ìœ¼ë©´ ì¶”ê°€
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    pagination += `<span style="color: #7a7a7a; padding: 0 5px;">...</span>`;
                }
                pagination += `<button onclick="changeRawEventsPage(${totalPages})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">${totalPages}</button>`;
            }
            
            // ë‹¤ìŒ ë²„íŠ¼
            if (currentRawEventsPage < totalPages) {
                pagination += `<button onclick="changeRawEventsPage(${currentRawEventsPage + 1})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">â€º</button>`;
            }
            
            return pagination;
        }

        // Raw Events í˜ì´ì§€ ë³€ê²½
        function changeRawEventsPage(page) {
            currentRawEventsPage = page;
            renderRawEventsTableWithPagination();
        }

        // Raw Events í˜ì´ì§€ í¬ê¸° ë³€ê²½
        function changeRawEventsPageSize(pageSize) {
            currentRawEventsPageSize = parseInt(pageSize);
            currentRawEventsPage = 1; // í˜ì´ì§€ í¬ê¸° ë³€ê²½ì‹œ ì²« í˜ì´ì§€ë¡œ ì´ë™
            renderRawEventsTableWithPagination();
        }

        // í•„í„°ë§ëœ Raw Events í…Œì´ë¸” ë Œë”ë§ (í˜ì´ì§€ë„¤ì´ì…˜ í¬í•¨)
        function renderFilteredRawEventsTable(filteredEvents, container) {
            if (!container || !filteredEvents) return;
            
            // í˜ì´ì§€ë„¤ì´ì…˜ ì„¤ì • - ê¸°ì¡´ ì„¤ì •ì´ ìˆìœ¼ë©´ ì‚¬ìš©, ì—†ìœ¼ë©´ ê¸°ë³¸ê°’
            const pageSize = window.currentFilteredEventsPageSize || 20;
            const currentPage = window.currentFilteredEventsPage || 1;
            const totalPages = Math.ceil(filteredEvents.length / pageSize);
            
            // í˜„ì¬ í˜ì´ì§€ì˜ ì´ë²¤íŠ¸ë§Œ ì¶”ì¶œ
            const startIndex = (currentPage - 1) * pageSize;
            const endIndex = Math.min(startIndex + pageSize, filteredEvents.length);
            const pageEvents = filteredEvents.slice(startIndex, endIndex);
            
            console.log(`ğŸ“„ í•„í„°ë§ëœ Raw Events í˜ì´ì§€ë„¤ì´ì…˜: ${startIndex + 1}-${endIndex} of ${filteredEvents.length} (í˜ì´ì§€ ${currentPage}/${totalPages})`);
            
            // ì¼ë°˜ í…Œì´ë¸”ê³¼ ë™ì¼í•œ êµ¬ì¡°ë¡œ HTML ìƒì„± (í˜ì´ì§€ë„¤ì´ì…˜ í¬í•¨)
            const tableHtml = `
                <div class="user-cumulative-header" style="display: flex; justify-content: space-between; align-items: center;">
                    <span>ğŸ“‹ All Raw Events - ê²€ìƒ‰ ê²°ê³¼ (${startIndex + 1}-${endIndex} of ${filteredEvents.length})</span>
                    <select onchange="changeFilteredEventsPageSize(this.value)" style="background: #3a3a3a; color: #fff; border: 1px solid #4a4a4a; padding: 5px 10px; border-radius: 4px; font-size: 12px;">
                        <option value="10" ${pageSize === 10 ? 'selected' : ''}>10ê°œ ë³´ê¸°</option>
                        <option value="20" ${pageSize === 20 ? 'selected' : ''}>20ê°œ ë³´ê¸°</option>
                        <option value="30" ${pageSize === 30 ? 'selected' : ''}>30ê°œ ë³´ê¸°</option>
                        <option value="50" ${pageSize === 50 ? 'selected' : ''}>50ê°œ ë³´ê¸°</option>
                        <option value="100" ${pageSize === 100 ? 'selected' : ''}>100ê°œ ë³´ê¸°</option>
                    </select>
                </div>
                <div class="user-cumulative-table">
                    <div>DATE</div>
                    <div>USER</div>
                    <div>KIND</div>
                    <div>MAX_MODEL</div>
                    <div>MODEL</div>
                    <div>TOKENS</div>
                    <div>COST</div>
                </div>
                ${pageEvents.map(event => {
                    const date = new Date(parseInt(event.timestamp));
                    const dateText = date.toLocaleDateString('en-US', { 
                        month: 'short', 
                        day: 'numeric', 
                        hour: '2-digit', 
                        minute: '2-digit' 
                    });
                    
                    // í† í° ì •ë³´ ê³„ì‚°
                    let tokensText = 'N/A';
                    if (event.tokenUsage) {
                        const inputTokens = event.tokenUsage.inputTokens || 0;
                        const outputTokens = event.tokenUsage.outputTokens || 0;
                        const totalTokens = inputTokens + outputTokens;
                        tokensText = totalTokens.toLocaleString();
                    }
                    
                    return `
                        <div class="user-cumulative-row">
                            <div>${dateText}</div>
                            <div class="user-email">${event.userEmail}</div>
                            <div>${(event.kindLabel || 'Unknown').substring(0, 15)}${(event.kindLabel || '').length > 15 ? '...' : ''}</div>
                            <div>${event.maxMode ? 'Yes' : 'No'}</div>
                            <div>${(event.model || 'auto').substring(0, 10)}${(event.model || '').length > 10 ? '...' : ''}</div>
                            <div>${tokensText}</div>
                            <div>${event.requestsCosts || 0}</div>
                        </div>
                    `;
                }).join('')}
                ${totalPages > 1 ? `
                    <div style="padding: 15px 20px; background-color: #2a2a2a; border-top: 1px solid #3a3a3a; display: flex; justify-content: center; align-items: center; gap: 10px;">
                        ${generateFilteredEventsPagination(totalPages, currentPage)}
                    </div>
                ` : ''}
            `;
            
            container.innerHTML = tableHtml;
            
            // í•„í„°ë§ëœ ì´ë²¤íŠ¸ ë°ì´í„° ì €ì¥ (í˜ì´ì§€ë„¤ì´ì…˜ìš©)
            window.currentFilteredEvents = filteredEvents;
            window.currentFilteredEventsPage = currentPage;
            window.currentFilteredEventsPageSize = pageSize;
            
            console.log(`í•„í„°ë§ëœ Raw Events í…Œì´ë¸” ë Œë”ë§ ì™„ë£Œ: ${filteredEvents.length}ê°œ ì´ë²¤íŠ¸ (í˜ì´ì§€ ${currentPage}/${totalPages}, í˜ì´ì§€ë‹¹ ${pageSize}ê°œ)`);
        }

        // ë¹ˆ Raw Events í…Œì´ë¸” ë Œë”ë§
        function renderEmptyRawEventsTable(container, searchedEmails) {
            if (!container) return;
            
            const emailList = searchedEmails.join(', ');
            
            const tableHtml = `
                <div class="user-cumulative-header">
                    <span>ğŸ“‹ All Raw Events - ê²€ìƒ‰ ê²°ê³¼ (0ê°œ)</span>
                </div>
                <div class="user-cumulative-table">
                    <div>DATE</div>
                    <div>USER</div>
                    <div>KIND</div>
                    <div>MAX_MODEL</div>
                    <div>MODEL</div>
                    <div>TOKENS</div>
                    <div>COST</div>
                </div>
                <div style="padding: 40px 20px; text-align: center; color: #7a7a7a; background-color: #1a1a1a; grid-column: 1 / -1;">
                    <h3 style="color: #e1e1e1; margin-bottom: 10px;">ê²€ìƒ‰ëœ ì‚¬ìš©ìì˜ í™œë™ì´ ì—†ìŠµë‹ˆë‹¤</h3>
                    <p style="margin-bottom: 15px;">ê²€ìƒ‰ ëŒ€ìƒ: <strong style="color: #4a9eff;">${emailList}</strong></p>
                    <p style="font-size: 14px; line-height: 1.4;">
                        â€¢ í•´ë‹¹ ì‚¬ìš©ìê°€ ì„ íƒëœ ê¸°ê°„ì— í™œë™í•˜ì§€ ì•Šì•˜ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤<br>
                        â€¢ ë‹¤ë¥¸ ë‚ ì§œ ë²”ìœ„ë¥¼ ì„ íƒí•´ë³´ì„¸ìš”<br>
                        â€¢ ë˜ëŠ” ë‹¤ë¥¸ ì‚¬ìš©ìë¥¼ ê²€ìƒ‰í•´ë³´ì„¸ìš”
                    </p>
                </div>
            `;
            
            container.innerHTML = tableHtml;
            console.log(`ë¹ˆ Raw Events í…Œì´ë¸” ë Œë”ë§ ì™„ë£Œ (ê²€ìƒ‰ ëŒ€ìƒ: ${emailList})`);
        }

        // í•„í„°ë§ëœ ì´ë²¤íŠ¸ í˜ì´ì§€ë„¤ì´ì…˜ ìƒì„± (ì¼ë°˜ í…Œì´ë¸”ê³¼ ë™ì¼í•œ êµ¬ì¡°)
        function generateFilteredEventsPagination(totalPages, currentPage) {
            let pagination = '';
            
            // ì´ì „ í˜ì´ì§€ ë²„íŠ¼
            if (currentPage > 1) {
                pagination += `<button onclick="changeFilteredEventsPage(${currentPage - 1})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">â€¹</button>`;
            }
            
            // í˜ì´ì§€ ë²ˆí˜¸ ë²„íŠ¼ë“¤
            let startPage = Math.max(1, currentPage - 2);
            let endPage = Math.min(totalPages, currentPage + 2);
            
            // ì‹œì‘ í˜ì´ì§€ê°€ 1ì´ ì•„ë‹ˆë©´ ì²« í˜ì´ì§€ ë²„íŠ¼ ì¶”ê°€
            if (startPage > 1) {
                pagination += `<button onclick="changeFilteredEventsPage(1)" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">1</button>`;
                if (startPage > 2) {
                    pagination += `<span style="color: #7a7a7a; padding: 0 5px;">...</span>`;
                }
            }
            
            // í˜ì´ì§€ ë²ˆí˜¸ë“¤
            for (let i = startPage; i <= endPage; i++) {
                const isActive = i === currentPage;
                pagination += `<button onclick="changeFilteredEventsPage(${i})" style="background: ${isActive ? '#4a9eff' : '#3a3a3a'}; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">${i}</button>`;
            }
            
            // ë í˜ì´ì§€ê°€ totalPagesê°€ ì•„ë‹ˆë©´ ë§ˆì§€ë§‰ í˜ì´ì§€ ë²„íŠ¼ ì¶”ê°€
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    pagination += `<span style="color: #7a7a7a; padding: 0 5px;">...</span>`;
                }
                pagination += `<button onclick="changeFilteredEventsPage(${totalPages})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">${totalPages}</button>`;
            }
            
            // ë‹¤ìŒ í˜ì´ì§€ ë²„íŠ¼
            if (currentPage < totalPages) {
                pagination += `<button onclick="changeFilteredEventsPage(${currentPage + 1})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">â€º</button>`;
            }
            
            return pagination;
        }

        // í•„í„°ë§ëœ ì´ë²¤íŠ¸ í˜ì´ì§€ ë³€ê²½
        function changeFilteredEventsPage(page) {
            if (!window.currentFilteredEvents) {
                console.log('âš ï¸ í•„í„°ë§ëœ ì´ë²¤íŠ¸ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            window.currentFilteredEventsPage = page;
            const filteredEvents = window.currentFilteredEvents;
            const container = document.querySelector('#usage .user-cumulative-info:last-child');
            
            console.log(`ğŸ“„ í•„í„°ë§ëœ Raw Events í˜ì´ì§€ ë³€ê²½: í˜ì´ì§€ ${page}ë¡œ ì´ë™`);
            console.log(`ğŸ“„ ì»¨í…Œì´ë„ˆ ë°œê²¬: ${!!container}, í•„í„°ë§ëœ ì´ë²¤íŠ¸ ìˆ˜: ${filteredEvents.length}`);
            
            if (container) {
                // renderFilteredRawEventsTable í•¨ìˆ˜ë¥¼ ì¬ì‚¬ìš©
                renderFilteredRawEventsTable(filteredEvents, container);
            } else {
                console.error('âŒ Raw Events ì»¨í…Œì´ë„ˆë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
        }

        // í•„í„°ë§ëœ ì´ë²¤íŠ¸ í˜ì´ì§€ í¬ê¸° ë³€ê²½
        function changeFilteredEventsPageSize(newPageSize) {
            console.log(`ğŸ”§ changeFilteredEventsPageSize í˜¸ì¶œë¨: ${newPageSize}`);
            console.log(`ğŸ“Š í˜„ì¬ ìƒíƒœ: currentFilteredEvents=${!!window.currentFilteredEvents}, currentFilteredEventsPage=${window.currentFilteredEventsPage}, currentFilteredEventsPageSize=${window.currentFilteredEventsPageSize}`);
            
            if (!window.currentFilteredEvents) {
                console.log('âš ï¸ í•„í„°ë§ëœ ì´ë²¤íŠ¸ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            window.currentFilteredEventsPageSize = parseInt(newPageSize);
            window.currentFilteredEventsPage = 1; // í˜ì´ì§€ í¬ê¸° ë³€ê²½ì‹œ ì²« í˜ì´ì§€ë¡œ ì´ë™
            
            const filteredEvents = window.currentFilteredEvents;
            const container = document.querySelector('#usage .user-cumulative-info:last-child');
            
            console.log(`ğŸ“„ í•„í„°ë§ëœ Raw Events í˜ì´ì§€ í¬ê¸° ë³€ê²½: ${newPageSize}ê°œë¡œ ë³€ê²½, ì²« í˜ì´ì§€ë¡œ ì´ë™`);
            console.log(`ğŸ“„ ì»¨í…Œì´ë„ˆ ë°œê²¬: ${!!container}, í•„í„°ë§ëœ ì´ë²¤íŠ¸ ìˆ˜: ${filteredEvents.length}`);
            
            if (container) {
                // renderFilteredRawEventsTable í•¨ìˆ˜ë¥¼ ì¬ì‚¬ìš©
                renderFilteredRawEventsTable(filteredEvents, container);
            } else {
                console.error('âŒ Raw Events ì»¨í…Œì´ë„ˆë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
        }
        
        // ë””ë²„ê¹…ìš© ì „ì—­ í•¨ìˆ˜
        window.debugFilteredEvents = function() {
            console.log('=== í•„í„°ë§ëœ ì´ë²¤íŠ¸ ìƒíƒœ ë””ë²„ê¹… ===');
            console.log('currentFilteredEvents:', window.currentFilteredEvents ? window.currentFilteredEvents.length + 'ê°œ' : 'null');
            console.log('currentFilteredEventsPage:', window.currentFilteredEventsPage);
            console.log('currentFilteredEventsPageSize:', window.currentFilteredEventsPageSize);
            console.log('ì»¨í…Œì´ë„ˆ:', document.querySelector('#usage .user-cumulative-info:last-child'));
            console.log('==============================');
        };



        // Usage ë©¤ë²„ ê²€ìƒ‰ ê¸°ëŠ¥ (ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ì™€ All Raw Events í…Œì´ë¸” ì—°ë™)
        function filterUsageMembers(searchTerm) {
            const searchLower = searchTerm.toLowerCase().trim();
            
            console.log(`ğŸ” Usage ë©¤ë²„ ê²€ìƒ‰ ì‹œì‘: "${searchTerm}"`);
            
            // ê²€ìƒ‰ì–´ê°€ ë¹„ì–´ìˆìœ¼ë©´ ëª¨ë“  í–‰ í‘œì‹œ
            if (searchLower === '') {
                const allRows = document.querySelectorAll('#usage .user-cumulative-row');
                allRows.forEach(row => {
                    row.style.display = 'grid';
                });
                
                // ì „ì²´ ì´ë²¤íŠ¸ ë¡œê·¸ í…Œì´ë¸”ë„ í•¨ê»˜ ê°±ì‹ 
                if (currentRawEventsData && currentRawEventsData.length > 0) {
                    // í•„í„°ë§ëœ ì´ë²¤íŠ¸ ë³€ìˆ˜ë“¤ ì •ë¦¬
                    delete window.currentFilteredEvents;
                    delete window.currentFilteredEventsPage;
                    delete window.currentFilteredEventsPageSize;
                    
                    renderRawEventsTableWithPagination();
                    console.log('âœ… ê²€ìƒ‰ì–´ ì—†ìŒ - ì „ì²´ Raw Events í˜ì´ì§€ë„¤ì´ì…˜ ë³µì›');
                }
                
                console.log('âœ… ê²€ìƒ‰ì–´ ì—†ìŒ - ëª¨ë“  í–‰ í‘œì‹œ ë° ì „ì²´ ì´ë²¤íŠ¸ ë¡œê·¸ ê°±ì‹ ');
                return;
            }
            
            // ì´ë©”ì¼ ì£¼ì†Œì¸ì§€ í™•ì¸ (@ í¬í•¨ ì—¬ë¶€ë¡œ íŒë‹¨)
            const isEmailSearch = searchLower.includes('@');
            
            // ëª¨ë“  Usage ì„¹ì…˜ì˜ user-cumulative-info ì»¨í…Œì´ë„ˆ ê°€ì ¸ì˜¤ê¸°
            const userInfoContainers = document.querySelectorAll('#usage .user-cumulative-info');
            
            if (userInfoContainers.length === 0) {
                console.log('âš ï¸ Usage ì„¹ì…˜ì˜ user-cumulative-info ì»¨í…Œì´ë„ˆë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            console.log(`ğŸ“‹ ë°œê²¬ëœ í…Œì´ë¸” ì»¨í…Œì´ë„ˆ: ${userInfoContainers.length}ê°œ`);
            
            // ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ í…Œì´ë¸” (ì²« ë²ˆì§¸ ì»¨í…Œì´ë„ˆ)ê³¼ All Raw Events í…Œì´ë¸” (ë‘ ë²ˆì§¸ ì»¨í…Œì´ë„ˆ) êµ¬ë¶„
            const userCumulativeContainer = userInfoContainers[0]; // ì²« ë²ˆì§¸: ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´
            const rawEventsContainer = userInfoContainers[1]; // ë‘ ë²ˆì§¸: All Raw Events
            
            // 1. ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ í…Œì´ë¸”ì—ì„œ í•„í„°ë§í•˜ê³  ë§¤ì¹­ëœ ì´ë©”ì¼ ìˆ˜ì§‘
            const matchedEmails = new Set();
            
            // ì •í™•í•œ ì´ë©”ì¼ ë§¤ì¹­ì´ ìˆëŠ”ì§€ ë¨¼ì € í™•ì¸
            let hasExactMatch = false;
            if (isEmailSearch) {
                const allEmailElements = userCumulativeContainer.querySelectorAll('.user-cumulative-row .user-email, .user-cumulative-row div:nth-child(2)');
                hasExactMatch = Array.from(allEmailElements).some(element => 
                    element.textContent.toLowerCase().trim() === searchLower
                );
                console.log(`ğŸ” ì •í™•í•œ ì´ë©”ì¼ ë§¤ì¹­ í™•ì¸: ${hasExactMatch ? 'ë°œê²¬ë¨' : 'ì—†ìŒ'}`);
            }
            
            // ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ í…Œì´ë¸” í•„í„°ë§
            const userCumulativeRows = userCumulativeContainer.querySelectorAll('.user-cumulative-row');
            console.log(`ğŸ“Š ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´: ${userCumulativeRows.length}ê°œ í–‰ ë°œê²¬`);
            
            userCumulativeRows.forEach(row => {
                if (row.children.length < 2) return; // ì¶©ë¶„í•œ ì»¬ëŸ¼ì´ ì—†ìœ¼ë©´ ìŠ¤í‚µ
                
                const name = row.children[0].textContent.toLowerCase().trim();
                const email = row.children[1].textContent.toLowerCase().trim();
                
                let shouldShow = false;
                
                if (isEmailSearch) {
                    if (hasExactMatch) {
                        // ì •í™•í•œ ë§¤ì¹­ì´ ìˆìœ¼ë©´ ì •í™•í•œ ë§¤ì¹­ë§Œ í‘œì‹œ
                        shouldShow = email === searchLower;
                    } else {
                        // ì •í™•í•œ ë§¤ì¹­ì´ ì—†ìœ¼ë©´ ë¶€ë¶„ ë§¤ì¹­ í—ˆìš©
                        shouldShow = email.includes(searchLower);
                    }
                } else {
                    // ì¼ë°˜ ê²€ìƒ‰: ì´ë¦„ ë˜ëŠ” ì´ë©”ì¼ ë¶€ë¶„ ë§¤ì¹­
                    shouldShow = name.includes(searchLower) || email.includes(searchLower);
                }
                
                if (shouldShow) {
                    row.style.display = 'grid';
                    // ë§¤ì¹­ëœ ì´ë©”ì¼ì„ ìˆ˜ì§‘ (ì›ë³¸ ì´ë©”ì¼ ì €ì¥)
                    const originalEmail = row.children[1].textContent.trim();
                    matchedEmails.add(originalEmail);
                } else {
                    row.style.display = 'none';
                }
            });
            
            console.log(`ğŸ“§ ë§¤ì¹­ëœ ì´ë©”ì¼: ${Array.from(matchedEmails).join(', ')}`);
            
            // 2. All Raw Events í…Œì´ë¸” ì—°ë™ í•„í„°ë§ (ì „ì²´ ë°ì´í„°ì—ì„œ ê²€ìƒ‰)
            if (rawEventsContainer && currentRawEventsData && currentRawEventsData.length > 0) {
                console.log(`ğŸ“‹ All Raw Events ì „ì²´ ë°ì´í„°: ${currentRawEventsData.length}ê°œ ì´ë²¤íŠ¸`);
                console.log(`ğŸ” ë§¤ì¹­ ëŒ€ìƒ ì´ë©”ì¼: ${Array.from(matchedEmails).join(', ')}`);
                
                // ê²€ìƒ‰ì–´ê°€ ìˆìœ¼ë©´ ë§¤ì¹­ëœ ì´ë©”ì¼ì˜ ì´ë²¤íŠ¸ë§Œ í•„í„°ë§
                if (matchedEmails.size > 0) {
                    // ìƒˆë¡œìš´ ê²€ìƒ‰ ì‹œì‘ ì‹œ í˜ì´ì§€ë„¤ì´ì…˜ ë³€ìˆ˜ ì´ˆê¸°í™”
                    window.currentFilteredEventsPage = 1;
                    window.currentFilteredEventsPageSize = window.currentFilteredEventsPageSize || 20;
                    
                    const filteredEvents = currentRawEventsData.filter(event => {
                        const eventUserEmail = event.userEmail?.trim() || '';
                        
                        // ì •í™•í•œ ì´ë©”ì¼ ë§¤ì¹­ë§Œ ìˆ˜í–‰ (ëŒ€ì†Œë¬¸ì ë¬´ì‹œ)
                        return Array.from(matchedEmails).some(email => {
                            const emailLower = email.toLowerCase().trim();
                            const eventEmailLower = eventUserEmail.toLowerCase().trim();
                            return emailLower === eventEmailLower;
                        });
                    });
                    
                    console.log(`âœ… í•„í„°ë§ëœ Raw Events: ${filteredEvents.length}ê°œ`);
                    
                    if (filteredEvents.length > 0) {
                        // í•„í„°ë§ëœ ë°ì´í„°ë¡œ í…Œì´ë¸” ë‹¤ì‹œ ë Œë”ë§
                        renderFilteredRawEventsTable(filteredEvents, rawEventsContainer);
                        console.log(`âœ… ${filteredEvents.length}ê°œì˜ ë§¤ì¹­ëœ ì´ë²¤íŠ¸ë¥¼ í‘œì‹œí–ˆìŠµë‹ˆë‹¤.`);
                        console.log(`ğŸ“Š ì „ì—­ ë³€ìˆ˜ ìƒíƒœ: currentFilteredEvents=${!!window.currentFilteredEvents}, currentFilteredEventsPage=${window.currentFilteredEventsPage}, currentFilteredEventsPageSize=${window.currentFilteredEventsPageSize}`);
                    } else {
                        // ë§¤ì¹­ëœ ì´ë²¤íŠ¸ê°€ ì—†ìœ¼ë©´ ë¹ˆ í…Œì´ë¸” í‘œì‹œ
                        renderEmptyRawEventsTable(rawEventsContainer, Array.from(matchedEmails));
                        console.log('âš ï¸ ë§¤ì¹­ëœ ì‚¬ìš©ìì˜ Raw Eventsê°€ ì—†ìŠµë‹ˆë‹¤.');
                        console.log('ğŸ’¡ í•´ë‹¹ ì‚¬ìš©ìê°€ ì„ íƒëœ ê¸°ê°„ì— í™œë™í•˜ì§€ ì•Šì•˜ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                    }
                } else {
                    // ê²€ìƒ‰ì–´ê°€ ì—†ìœ¼ë©´ ì›ë˜ í˜ì´ì§€ë„¤ì´ì…˜ ë°©ì‹ìœ¼ë¡œ ë³µì›
                    renderRawEventsTableWithPagination();
                    console.log('âœ… ê²€ìƒ‰ì–´ ì—†ìŒ - ì „ì²´ Raw Events í˜ì´ì§€ë„¤ì´ì…˜ ë³µì›');
                }
            } else {
                console.log('âš ï¸ All Raw Events ì»¨í…Œì´ë„ˆ ë˜ëŠ” ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                console.log(`   - ì»¨í…Œì´ë„ˆ ì¡´ì¬: ${!!rawEventsContainer}`);
                console.log(`   - ë°ì´í„° ì¡´ì¬: ${!!currentRawEventsData}`);
                console.log(`   - ë°ì´í„° ê¸¸ì´: ${currentRawEventsData?.length || 0}`);
            }
            
            const matchingType = isEmailSearch ? (hasExactMatch ? 'ì •í™•í•œ ì´ë©”ì¼ ë§¤ì¹­' : 'ì´ë©”ì¼ ë¶€ë¶„ ë§¤ì¹­') : 'ë¶€ë¶„ ë§¤ì¹­';
            console.log(`âœ… Usage ê²€ìƒ‰ ì™„ë£Œ: "${searchTerm}" - ${matchingType}ìœ¼ë¡œ ë‘ í…Œì´ë¸” ì—°ë™ í•„í„°ë§ ì™„ë£Œ (ë§¤ì¹­ëœ ì‚¬ìš©ì ${matchedEmails.size}ëª…)`);
            
            // ê²€ìƒ‰ ì™„ë£Œ í›„ ëŒ€ê¸° ì¤‘ì¸ ì´ë©”ì¼ ê²€ìƒ‰ í”Œë˜ê·¸ ì œê±°
            if (window.pendingEmailSearch) {
                console.log(`ğŸ”„ ì´ë©”ì¼ ê²€ìƒ‰ í”Œë˜ê·¸ ì œê±°: ${window.pendingEmailSearch}`);
                delete window.pendingEmailSearch;
            }
        }

        // ë©¤ë²„ ì •ë ¬ ê¸°ëŠ¥
        let currentSortField = 'requests';
        let currentSortDirection = 'desc';

        function sortMembers(field) {
            const dataTable = document.querySelector('#members .data-table');
            const rows = Array.from(dataTable.querySelectorAll('.table-row'));
           
            // ì •ë ¬ ë°©í–¥ í† ê¸€
            if (currentSortField === field) {
                currentSortDirection = currentSortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                currentSortField = field;
                currentSortDirection = 'asc';
            }
           
            // ì •ë ¬ í•¨ìˆ˜
            rows.sort((a, b) => {
                let aValue, bValue;
               
                switch(field) {
                    case 'name':
                        aValue = a.children[0].textContent.toLowerCase();
                        bValue = b.children[0].textContent.toLowerCase();
                        break;
                    case 'email':
                        aValue = a.children[1].textContent.toLowerCase();
                        bValue = b.children[1].textContent.toLowerCase();
                        break;
                    case 'requests':
                        aValue = parseInt(a.children[2].textContent.replace(/,/g, '')) || 0;
                        bValue = parseInt(b.children[2].textContent.replace(/,/g, '')) || 0;
                        break;
                    case 'spend':
                        aValue = parseFloat(a.children[3].textContent.replace('$', '')) || 0;
                        bValue = parseFloat(b.children[3].textContent.replace('$', '')) || 0;
                        break;
                    case 'role':
                        aValue = a.children[4].textContent.toLowerCase();
                        bValue = b.children[4].textContent.toLowerCase();
                        break;
                    default:
                        return 0;
                }
               
                if (currentSortDirection === 'asc') {
                    return aValue > bValue ? 1 : -1;
                } else {
                    return aValue < bValue ? 1 : -1;
                }
            });
           
            // ì •ë ¬ëœ í–‰ë“¤ì„ ë‹¤ì‹œ ì¶”ê°€
            rows.forEach(row => dataTable.appendChild(row));
           
            // í—¤ë” ì—…ë°ì´íŠ¸
            updateSortHeaders(field);
        }

        // ì •ë ¬ í—¤ë” ì—…ë°ì´íŠ¸
        function updateSortHeaders(field) {
            const headers = document.querySelectorAll('#members .table-header > div');
            headers.forEach((header, index) => {
                if (index < 5) { // ë§ˆì§€ë§‰ ë¹ˆ ì—´ ì œì™¸
                    const text = header.textContent.replace(/[â†‘â†“]/, '');
                    if (index === 0 && field === 'name') header.textContent = text + (currentSortDirection === 'asc' ? ' â†‘' : ' â†“');
                    else if (index === 1 && field === 'email') header.textContent = text + (currentSortDirection === 'asc' ? ' â†‘' : ' â†“');
                    else if (index === 2 && field === 'requests') header.textContent = text + (currentSortDirection === 'asc' ? ' â†‘' : ' â†“');
                    else if (index === 3 && field === 'spend') header.textContent = text + (currentSortDirection === 'asc' ? ' â†‘' : ' â†“');
                    else if (index === 4 && field === 'role') header.textContent = text + (currentSortDirection === 'asc' ? ' â†‘' : ' â†“');
                    else header.textContent = text + ' â†•';
                }
            });
        }

        // ê²€ìƒ‰ì°½ ì™¸ë¶€ í´ë¦­ ì‹œ ìë™ì™„ì„± ë“œë¡­ë‹¤ìš´ ìˆ¨ê¸°ê¸°
        document.addEventListener('click', function(e) {
            const autocompleteDropdowns = document.querySelectorAll('.autocomplete-dropdown');
            const searchContainers = document.querySelectorAll('.search-container');
            
            let clickedInsideSearch = false;
            searchContainers.forEach(container => {
                if (container.contains(e.target)) {
                    clickedInsideSearch = true;
                }
            });
            
            if (!clickedInsideSearch) {
                autocompleteDropdowns.forEach(dropdown => {
                    dropdown.style.display = 'none';
                });
            }
        });

        // ìµœì í™”ëœ í˜ì´ì§€ ì´ˆê¸°í™” (Progressive Loading)
        document.addEventListener('DOMContentLoaded', async function() {
            PerformanceMonitor.start('í˜ì´ì§€ ì „ì²´ ë¡œë“œ');
            console.log('ğŸš€ ìµœì í™”ëœ ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” ì‹œì‘');
           
            try {
                // 1ë‹¨ê³„: ì¦‰ì‹œ ìŠ¤ì¼ˆë ˆí†¤ UI í‘œì‹œ (0ms)
                SkeletonUI.show('overview');
                updatePerformanceIndicator('loading', 'UI ì´ˆê¸°í™”');
                console.log('ğŸ’€ ìŠ¤ì¼ˆë ˆí†¤ UI í‘œì‹œ ì™„ë£Œ');
               
                // 2ë‹¨ê³„: ê¸°ë³¸ UI ì´ˆê¸°í™” (ì¦‰ì‹œ)
                initOverviewStats();
               
                // Overview í•„í„° ê¸°ë³¸ê°’ì„ 30ì¼ë¡œ ì„¤ì •
                document.querySelectorAll('#overview .chart-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector('#overview .chart-btn[data-days="30"]').classList.add('active');
               
                createOverviewChart(); // ë¹ˆ ì°¨íŠ¸ ë¨¼ì € í‘œì‹œ
               
                // 3ë‹¨ê³„: ë°±ê·¸ë¼ìš´ë“œì—ì„œ ë°ì´í„° ë¡œë“œ ì‹œì‘ (ë¹„ë™ê¸°)
                console.log('ğŸ“¡ ë°±ê·¸ë¼ìš´ë“œ ë°ì´í„° ë¡œë“œ ì‹œì‘...');
               
                // ìºì‹œ í™•ì¸ ë° ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥í•œ ë°ì´í„°ê°€ ìˆë‹¤ë©´ ë¨¼ì € í‘œì‹œ
                if (DataCache.isValid('members') && DataCache.members) {
                    console.log('ğŸš€ ìºì‹œëœ ë©¤ë²„ ë°ì´í„°ë¡œ ì¦‰ì‹œ ê¸°ë³¸ UI ì—…ë°ì´íŠ¸');
                    updatePerformanceIndicator('cached', 'ìºì‹œ ì‚¬ìš©');
                    const totalMembers = DataCache.members.teamMembers?.length || 0;
                    updateStatsCards(totalMembers, 0, 0); // ê¸°ë³¸ê°’ìœ¼ë¡œ ë¨¼ì € í‘œì‹œ
                } else {
                    updatePerformanceIndicator('loading', 'API í˜¸ì¶œ');
                }
               
                // 4ë‹¨ê³„: ì‹¤ì œ API ë°ì´í„° ë¡œë“œ ë° ì—…ë°ì´íŠ¸
                await refreshAllRealData();
               
                // ì´ˆê¸° ë¡œë“œ ì™„ë£Œ í›„ ê¸°ë³¸ ì„ íƒ ìƒíƒœ ì„¤ì • (ì „ì²´ ë©¤ë²„)
                console.log('ì´ˆê¸° ë¡œë“œ ì™„ë£Œ í›„ ì „ì²´ ë©¤ë²„ ê¸°ë³¸ ì„ íƒ');
                document.querySelectorAll('.overview-stat-box').forEach(box => {
                    box.classList.remove('selected');
                });
                document.querySelector('.overview-stat-box[data-type="total"]').classList.add('selected');
                currentFilterType = 'total';
                
                // ë‚ ì§œ ì…ë ¥ í•„ë“œ ë³€ê²½ ì‹œ ìë™ ìƒˆë¡œê³ ì¹¨ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
                setupAutoRefreshEvents();
               
                const totalLoadTime = PerformanceMonitor.end('í˜ì´ì§€ ì „ì²´ ë¡œë“œ');
                updatePerformanceIndicator('ready', `${totalLoadTime}ms`);
                console.log('âœ… ìµœì í™”ëœ ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” ì™„ë£Œ!');
               
            } catch (error) {
                PerformanceMonitor.end('í˜ì´ì§€ ì „ì²´ ë¡œë“œ');
                updatePerformanceIndicator('error', error.message.substring(0, 20));
                console.error('âŒ ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
               
                // ì—ëŸ¬ ë°œìƒ ì‹œì—ë„ ê¸°ë³¸ UIëŠ” í‘œì‹œ
                const errorMessage = `
                    <div style="text-align: center; padding: 50px; color: #ff6b6b;">
                        <h3>âš ï¸ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨</h3>
                        <p>${error.message}</p>
                        <button onclick="location.reload()" style="margin-top: 20px; padding: 10px 20px; background: #4a9eff; color: white; border: none; border-radius: 4px; cursor: pointer;">
                            ìƒˆë¡œê³ ì¹¨
                        </button>
                    </div>
                `;
               
                const overviewSection = document.getElementById('overview');
                if (overviewSection) {
                    overviewSection.innerHTML = errorMessage;
                }
            }
        });

        // ìºì‹œ ìƒˆë¡œê³ ì¹¨ í•¨ìˆ˜ (ë²„íŠ¼ìš©)
        function forceCacheRefresh() {
            console.log('ğŸ—‘ï¸ ìºì‹œ ê°•ì œ ìƒˆë¡œê³ ì¹¨ ì‹œì‘');
            DataCache.clear();
            location.reload();
        }

        // Refresh ì‹¤í–‰ ìƒíƒœ ê´€ë¦¬ (ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€)
        let isRefreshInProgress = false;

        // ì§„í–‰ë°” ì œì–´ í•¨ìˆ˜ë“¤
        function showRefreshProgress() {
            const progressContainer = document.querySelector('.refresh-progress');
            const progressBar = document.querySelector('.refresh-progress-bar');
            if (progressContainer && progressBar) {
                progressContainer.style.display = 'block';
                progressBar.style.width = '0%';
            }
        }

        function updateRefreshProgress(percentage) {
            const progressBar = document.querySelector('.refresh-progress-bar');
            if (progressBar) {
                progressBar.style.width = percentage + '%';
            }
        }

        function hideRefreshProgress() {
            const progressContainer = document.querySelector('.refresh-progress');
            if (progressContainer) {
                progressContainer.style.display = 'none';
            }
        }

        // Refresh ë©”ë‰´ í´ë¦­ í•¸ë“¤ëŸ¬ (ì™„ì „ ë°±ê·¸ë¼ìš´ë“œ ë™ì‘)
        async function handleRefreshClick() {
            // ì´ë¯¸ refreshê°€ ì§„í–‰ ì¤‘ì´ë©´ ë¬´ì‹œ
            if (isRefreshInProgress) {
                console.log('ğŸ”„ Refresh ì´ë¯¸ ì§„í–‰ ì¤‘ - ìš”ì²­ ë¬´ì‹œ');
                return;
            }

            // ì§„í–‰ë°” í‘œì‹œ
            showRefreshProgress();
            
            // Refresh ì‹œì‘ (ì‚¬ìš©ìì—ê²ŒëŠ” ì•„ë¬´ ë³€í™” ì—†ìŒ)
            isRefreshInProgress = true;
            
            try {
                console.log('ğŸ”„ Refresh ì‹œì‘ - ë°±ê·¸ë¼ìš´ë“œ ë°ì´í„° ê°±ì‹  (ì‚¬ìš©ì í™”ë©´ ë³€í™” ì—†ìŒ)');
                
                // í˜„ì¬ í™œì„±í™”ëœ ì„¹ì…˜ í™•ì¸
                const activeSection = document.querySelector('.content-section.active');
                const activeSectionId = activeSection ? activeSection.id : 'overview';
                
                console.log(`í˜„ì¬ í™œì„± ì„¹ì…˜: ${activeSectionId}`);
                
                // ë°±ê·¸ë¼ìš´ë“œì—ì„œ ëª¨ë“  ë°ì´í„° ìƒˆë¡œê³ ì¹¨ (ë³‘ë ¬ ì²˜ë¦¬)
                console.log('ğŸ“¡ ë°±ê·¸ë¼ìš´ë“œ API ë°ì´í„° ë¡œë“œ ì‹œì‘...');
                
                // ì§„í–‰ë°” ë‹¨ê³„ë³„ ì—…ë°ì´íŠ¸
                updateRefreshProgress(20);
                await refreshOverviewData();
                updateRefreshProgress(50);
                await refreshMembersData();
                updateRefreshProgress(80);
                await refreshUsageData();
                updateRefreshProgress(90);
                
                // í˜„ì¬ ì„¹ì…˜ì´ í™œì„±í™”ë˜ì–´ ìˆë‹¤ë©´ í™”ë©´ ì—…ë°ì´íŠ¸
                await updateCurrentSectionDisplay(activeSectionId);
                updateRefreshProgress(100);
                
                console.log('âœ… Refresh ì™„ë£Œ - ëª¨ë“  ë°ì´í„°ê°€ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ê°±ì‹ ë¨');
                
            } catch (error) {
                console.error('âŒ Refresh ì‹¤íŒ¨:', error);
                // ì—ëŸ¬ ë°œìƒ ì‹œì—ë„ ì‚¬ìš©ì í™”ë©´ì—ëŠ” ë³€í™” ì—†ìŒ (ì½˜ì†”ì—ë§Œ ë¡œê·¸)
            } finally {
                // ì§„í–‰ë°” ìˆ¨ê¸°ê¸°
                setTimeout(() => {
                    hideRefreshProgress();
                }, 500);
                
                // Refresh ì™„ë£Œ ìƒíƒœë¡œ ë³€ê²½
                isRefreshInProgress = false;
            }
        }

        // Overview ë°ì´í„° ë°±ê·¸ë¼ìš´ë“œ ìƒˆë¡œê³ ì¹¨
        async function refreshOverviewData() {
            try {
                console.log('ğŸ“Š Overview ë°ì´í„° ë°±ê·¸ë¼ìš´ë“œ ê°±ì‹  ì¤‘...');
                await updateOverviewWithRealData();
                console.log('âœ… Overview ë°ì´í„° ê°±ì‹  ì™„ë£Œ');
            } catch (error) {
                console.error('âŒ Overview ë°ì´í„° ê°±ì‹  ì‹¤íŒ¨:', error);
                throw error;
            }
        }

        // Members ë°ì´í„° ë°±ê·¸ë¼ìš´ë“œ ìƒˆë¡œê³ ì¹¨
        async function refreshMembersData() {
            try {
                console.log('ğŸ‘¥ Members ë°ì´í„° ë°±ê·¸ë¼ìš´ë“œ ê°±ì‹  ì¤‘...');
                await updateMembersWithRealData();
                console.log('âœ… Members ë°ì´í„° ê°±ì‹  ì™„ë£Œ');
            } catch (error) {
                console.error('âŒ Members ë°ì´í„° ê°±ì‹  ì‹¤íŒ¨:', error);
                throw error;
            }
        }

        // Usage ë°ì´í„° ë°±ê·¸ë¼ìš´ë“œ ìƒˆë¡œê³ ì¹¨ (í™”ë©´ ë³€í™” ì—†ì´ ìºì‹œë§Œ ê°±ì‹ )
        async function refreshUsageData() {
            try {
                console.log('ğŸ“ˆ Usage ë°ì´í„° ë°±ê·¸ë¼ìš´ë“œ ê°±ì‹  ì¤‘ (í™”ë©´ ë³€í™” ì—†ìŒ)...');
                
                // ë‚ ì§œ ë²”ìœ„ ê³„ì‚°
                const dateRange = getDateRange(30);
                
                // API ë°ì´í„°ë§Œ ê°€ì ¸ì™€ì„œ ìºì‹œì— ì €ì¥ (í™”ë©´ ì—…ë°ì´íŠ¸ ì—†ìŒ)
                const [membersData, eventsData, usageData, spendingData] = await Promise.all([
                    getTeamMembers(),
                    getFilteredEvents(dateRange.startDate, dateRange.endDate),
                    getUsageData(dateRange.startDate, dateRange.endDate),
                    getTeamSpendingData()
                ]);
                
                // ìºì‹œì—ë§Œ ì €ì¥í•˜ê³  í™”ë©´ì€ ì—…ë°ì´íŠ¸í•˜ì§€ ì•ŠìŒ
                console.log('ğŸ’¾ Usage ë°ì´í„°ë¥¼ ìºì‹œì— ì €ì¥ (í™”ë©´ ì—…ë°ì´íŠ¸ ì•ˆí•¨)');
                
                // ì „ì—­ ë³€ìˆ˜ì— ë°ì´í„° ì €ì¥ (í™”ë©´ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ë“¤ í˜¸ì¶œí•˜ì§€ ì•ŠìŒ)
                // ì´ë ‡ê²Œ í•˜ë©´ ë°ì´í„°ëŠ” ìµœì‹ ìœ¼ë¡œ ìœ ì§€ë˜ì§€ë§Œ í™”ë©´ì€ ë³€ê²½ë˜ì§€ ì•ŠìŒ
                
                console.log('âœ… Usage ë°ì´í„° ë°±ê·¸ë¼ìš´ë“œ ê°±ì‹  ì™„ë£Œ (ìºì‹œë§Œ ì—…ë°ì´íŠ¸)');
            } catch (error) {
                console.error('âŒ Usage ë°ì´í„° ê°±ì‹  ì‹¤íŒ¨:', error);
                throw error;
            }
        }

        // í˜„ì¬ ì„¹ì…˜ í™”ë©´ ì—…ë°ì´íŠ¸ (ë°±ê·¸ë¼ìš´ë“œ ê°±ì‹  í›„)
        async function updateCurrentSectionDisplay(activeSectionId) {
            try {
                console.log(`ğŸ–¥ï¸ í˜„ì¬ ì„¹ì…˜ í™”ë©´ ì—…ë°ì´íŠ¸: ${activeSectionId}`);
                switch(activeSectionId) {
                    case 'overview':
                        await updateOverviewWithCurrentFilter();
                        break;
                    case 'members':
                        // MembersëŠ” ì´ë¯¸ refreshMembersData()ì—ì„œ ê°±ì‹ ë¨
                        // ì¶”ê°€ í™”ë©´ ì—…ë°ì´íŠ¸ ì—†ìŒ
                        break;
                    case 'usage':
                        // UsageëŠ” ë°±ê·¸ë¼ìš´ë“œì—ì„œë§Œ ë°ì´í„° ê°±ì‹ ë¨
                        // í™”ë©´ ì—…ë°ì´íŠ¸ í•˜ì§€ ì•ŠìŒ (ì‚¬ìš©ìê°€ ë³´ê³  ìˆëŠ” í™”ë©´ ìœ ì§€)
                        console.log('Usage ì„¹ì…˜: í™”ë©´ ì—…ë°ì´íŠ¸ ì•ˆí•¨ (ë°±ê·¸ë¼ìš´ë“œ ê°±ì‹ ë§Œ)');
                        break;
                    case 'settings':
                        // SettingsëŠ” ë³„ë„ API ë°ì´í„°ê°€ ì—†ìŒ
                        break;
                }
                console.log(`âœ… ${activeSectionId} ì„¹ì…˜ í™”ë©´ ì—…ë°ì´íŠ¸ ì™„ë£Œ`);
            } catch (error) {
                console.error(`âŒ ${activeSectionId} ì„¹ì…˜ í™”ë©´ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:`, error);
            }
        }

        // ìë™ ìƒˆë¡œê³ ì¹¨ ì´ë²¤íŠ¸ ì„¤ì •
        function setupAutoRefreshEvents() {
            console.log('ìë™ ìƒˆë¡œê³ ì¹¨ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • ì¤‘...');
            
            // Overview ë‚ ì§œ ì…ë ¥ í•„ë“œ
            const overviewStartDate = document.getElementById('start-date');
            const overviewEndDate = document.getElementById('end-date');
            
            if (overviewStartDate && overviewEndDate) {
                overviewStartDate.addEventListener('change', debounce(async () => {
                    if (overviewStartDate.value && overviewEndDate.value) {
                        console.log('Overview ì‹œì‘ ë‚ ì§œ ë³€ê²½ë¨ - ìë™ ìƒˆë¡œê³ ì¹¨');
                        await applyDateFilter();
                    }
                }, 500));
                
                overviewEndDate.addEventListener('change', debounce(async () => {
                    if (overviewStartDate.value && overviewEndDate.value) {
                        console.log('Overview ì¢…ë£Œ ë‚ ì§œ ë³€ê²½ë¨ - ìë™ ìƒˆë¡œê³ ì¹¨');
                        await applyDateFilter();
                    }
                }, 500));
            }
            
            // Usage ë‚ ì§œ ì…ë ¥ í•„ë“œ
            const usageStartDate = document.getElementById('usage-start-date');
            const usageEndDate = document.getElementById('usage-end-date');
            
            if (usageStartDate && usageEndDate) {
                usageStartDate.addEventListener('change', debounce(async () => {
                    if (usageStartDate.value && usageEndDate.value) {
                        console.log('Usage ì‹œì‘ ë‚ ì§œ ë³€ê²½ë¨ - ìë™ ìƒˆë¡œê³ ì¹¨');
                        await applyUsageDateFilter();
                    }
                }, 500));
                
                usageEndDate.addEventListener('change', debounce(async () => {
                    if (usageStartDate.value && usageEndDate.value) {
                        console.log('Usage ì¢…ë£Œ ë‚ ì§œ ë³€ê²½ë¨ - ìë™ ìƒˆë¡œê³ ì¹¨');
                        await applyUsageDateFilter();
                    }
                }, 500));
            }
            
            console.log('ìë™ ìƒˆë¡œê³ ì¹¨ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • ì™„ë£Œ');
        }

        // ë””ë°”ìš´ìŠ¤ í•¨ìˆ˜ (ì—°ì† í˜¸ì¶œ ë°©ì§€)
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        document.addEventListener('DOMContentLoaded', function() {
            // ê¸°ë³¸ ì„¤ì • í›„
            setTimeout(async () => {
                createOverviewChart();
                console.log('=== í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ì‹¤ì œ API ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì‹œì‘ ===');
                await refreshAllRealData(); // ìë™ ìƒˆë¡œê³ ì¹¨
            }, 100);
        });

    </script>
</body>
</html>
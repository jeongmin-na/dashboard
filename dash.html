<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Samsung AI Experience Group Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #1a1a1a;
            color: #e1e1e1;
            overflow-x: hidden;
        }

        .dashboard-container {
            display: flex;
            height: 100vh;
            align-items: stretch;
        }

        /* ì‚¬ì´ë“œë°” ìŠ¤íƒ€ì¼ */
        .sidebar {
            width: 250px;
            background-color: #2a2a2a;
            color: #b1b1b1;
            border-right: 1px solid #3a3a3a;
            display: flex;
            flex-direction: column;
        }

        .logo {
            padding: 0 20px;
            border-bottom: 1px solid #3a3a3a;
            margin-bottom: 0;
            height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            box-sizing: border-box;
        }

        .logo-name {
            font-size: 16px;
            font-weight: 600;
            color: #fff;
        }

        .logo-business {
            font-size: 12px;
            color: #7a7a7a;
            margin-top: 2px;
        }

        .logo-group {
            font-size: 12px;
            color: #7a7a7a;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: #b1b1b1;
            text-decoration: none;
            transition: all 0.2s ease;
            font-size: 14px;
            cursor: pointer;
            user-select: none;
        }

        .menu-item:hover {
            background-color: #3a3a3a;
            color: #fff;
        }

        .menu-item.active {
            background-color: #4a4a4a;
            color: #fff;
        }

        .menu-icon {
            width: 16px;
            height: 16px;
            margin-right: 12px;
            opacity: 0.7;
        }

        /* ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ */
        .main-content {
            flex: 1;
            background-color: #1a1a1a;
            display: flex;
            flex-direction: column;
        }

        .header {
            background-color: #1a1a1a; /* ë°°ê²½ìƒ‰ ê²€ì •ìœ¼ë¡œ ë³€ê²½ */
            padding: 20px 30px;
            height: 80px;
            box-sizing: border-box;
            position: relative;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* í—¤ë” ì•„ë˜ ì„ ì— ì—¬ë°± ì¶”ê°€ */
        .header::after {
            content: '';
            position: absolute;
            left: 30px;
            right: 30px;
            bottom: 0;
            height: 1px;
            background-color: #3a3a3a;
        }

        .header-left h1 {
            color: #fff;
            font-size: 24px;
            font-weight: 600;
        }

        .content-area {
            padding: 30px;
            min-height: calc(100vh - 80px);
            overflow-y: auto;
        }

        /* ê¸°ë³¸ ìˆ¨ê¹€ ì²˜ë¦¬ */
        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        /* Overview í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
        .overview-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .overview-stat-box {
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 8px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .overview-stat-box:hover {
            background-color: #3a3a3a;
            border-color: #4a4a4a;
        }

        .overview-stat-box.clickable {
            cursor: pointer;
        }

        .overview-stat-box.selected {
            background-color: #3a3a3a;
            border-color: #5a9eff;
            box-shadow: 0 0 10px rgba(90, 158, 255, 0.3);
        }

        .overview-stat-box.selected .stat-number,
        .overview-stat-box.selected .stat-label,
        .overview-stat-box.selected .stat-description {
            color: white;
        }

        .overview-stat-box .stat-number {
            font-size: 36px;
            font-weight: 700;
            color: #fff;
            margin-bottom: 8px;
        }

        .overview-stat-box .stat-label {
            font-size: 16px;
            font-weight: 600;
            color: #e1e1e1;
            margin-bottom: 4px;
        }

        .overview-stat-box .stat-description {
            font-size: 12px;
            color: #b1b1b1;
        }

        .overview-chart-container {
            background-color: #1a1a1a;
            border: 1px solid #3a3a3a;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-header h3 {
            color: #fff;
            font-size: 18px;
            font-weight: 600;
            background-color: transparent;
        }

        .chart-controls {
            display: flex;
            gap: 8px;
        }

        .chart-btn {
            background-color: #3a3a3a;
            border: 1px solid #4a4a4a;
            color: #b1b1b1;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .chart-btn:hover {
            background-color: #4a4a4a;
            color: #fff;
        }

        .chart-btn.active {
            background-color: #4a9eff;
            border-color: #4a9eff;
            color: white;
        }

        .overview-member-details {
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 4px;
            overflow: hidden;
        }

        .member-details-header {
            background-color: #1a1a1a;
            color: #fff;
            padding: 15px 20px;
            margin: 0;
            border-bottom: 1px solid #3a3a3a;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .member-details-header h3 {
            font-size: 18px;
            font-weight: 600;
        }

        .member-count {
            background-color: #3a3a3a;
            color: #e1e1e1;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .member-list {
            display: grid;
            gap: 0;
        }

        .member-list-header {
            display: grid;
            grid-template-columns: 1.5fr 2fr 1fr 1.5fr 1fr 1fr 1fr;
            gap: 20px;
            padding: 12px 20px;
            background-color: #2a2a2a;
            color: #b1b1b1;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            border-bottom: 2px solid #3a3a3a;
        }

        .member-item {
            display: grid;
            grid-template-columns: 1.5fr 2fr 1fr 1.5fr 1fr 1fr 1fr;
            gap: 20px;
            align-items: center;
            padding: 12px 20px;
            background-color: #1a1a1a;
            border-bottom: 1px solid #3a3a3a;
            font-size: 14px;
        }

        .member-item:hover {
            background-color: #2a2a2a;
        }

        .member-item:last-child {
            border-bottom: none;
        }

        .member-date {
            color: #b1b1b1;
            font-size: 13px;
        }

        .member-email {
            color: #b1b1b1;
        }

        .clickable-email {
            color: #4a9eff;
            cursor: pointer;
            text-decoration: none;
            transition: color 0.2s ease;
        }

        .clickable-email:hover {
            color: #2196f3;
            text-decoration: underline;
        }

        .member-type {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .member-type.active {
            background-color: rgba(76, 175, 80, 0.2);
            color: #4caf50;
        }

        .member-type.inactive {
            background-color: rgba(255, 152, 0, 0.2);
            color: #ff9800;
        }

        .member-kind {
            color: #e1e1e1;
            font-size: 13px;
        }

        .member-request {
            color: #fff;
            font-weight: 500;
        }

        .member-spend {
            color: #4a9eff;
            font-weight: 600;
        }

        /* í•„í„° ë° ê²€ìƒ‰ ì˜ì—­ */
        .filter-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 15px 0;
            border-bottom: 1px solid #3a3a3a;
        }

        /* Members ì„¹ì…˜ì—ì„œ êµ¬ë¶„ì„  ì œê±° ë° ê°„ê²© ì¶•ì†Œ */
        #members .filter-controls {
            border-bottom: none;
            margin-bottom: 15px;
            padding: 10px 0;
        }

        .filter-controls         .chart-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .date-picker {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .date-picker input[type="date"] {
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 4px;
            padding: 8px 12px;
            color: #fff;
            font-size: 14px;
        }

        /* ë‹¬ë ¥ ì•„ì´ì½˜ ìƒ‰ìƒ ë³€ê²½ */
        .date-picker input[type="date"]::-webkit-calendar-picker-indicator {
            filter: invert(1) brightness(1.5) sepia(1) saturate(5) hue-rotate(45deg);
            cursor: pointer;
        }

        .date-picker input[type="date"]::-moz-calendar-picker-indicator {
            filter: invert(1) brightness(1.5) sepia(1) saturate(5) hue-rotate(45deg);
            cursor: pointer;
        }

        .date-picker span {
            color: #ccc;
            font-weight: 500;
        }

        .filter-controls .chart-btn {
            min-width: 40px;
        }

        .date-filter-btn {
            background: #2a2a2a;
            border: 1px solid #3a3a3a;
            color: #e1e1e1;
            padding: 6px 16px;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .date-filter-btn:hover {
            background-color: #3a3a3a;
        }

        .analytics-btn {
            background: transparent;
            border: 1px solid #4a4a4a;
            color: #e1e1e1;
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
            height: 32px;
        }

        .analytics-btn:hover {
            background-color: #2a2a2a;
        }

        /* ë°°ì§€ ìŠ¤íƒ€ì¼ */
        .role-badge {
            background-color: #3a3a3a;
            color: #e1e1e1;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
            display: inline-block;
        }

        .role-badge.admin {
            background-color: #4a9eff;
            color: white;
        }

        /* Members í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
        .data-table {
            background-color: #1a1a1a;
            border: 1px solid #3a3a3a;
            border-radius: 8px;
            overflow: hidden;
            width: 100%;
        }

        .table-header {
            background-color: #2a2a2a;
            padding: 15px 20px;
            border-bottom: 1px solid #3a3a3a;
            display: grid;
            grid-template-columns: 2fr 2fr 1fr 1fr 1fr 0.5fr;
            gap: 20px;
            font-size: 12px;
            font-weight: 600;
            color: #b1b1b1;
            text-transform: uppercase;
        }

        .table-row {
            padding: 15px 20px;
            border-bottom: 1px solid #3a3a3a;
            display: grid;
            grid-template-columns: 2fr 2fr 1fr 1fr 1fr 0.5fr;
            gap: 20px;
            align-items: center;
            font-size: 14px;
            background-color: #1a1a1a;
        }

        .table-row:hover {
            background-color: #2a2a2a;
        }

        .table-row:last-child {
            border-bottom: none;
        }

        /* Usage í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
        .usage-cards {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .usage-card {
            background-color: #2a2a2a;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #3a3a3a;
        }

        .usage-card-number {
            font-size: 32px;
            font-weight: 700;
            color: #fff;
            margin-bottom: 8px;
        }

        .usage-card-label {
            color: #b1b1b1;
            font-size: 14px;
        }

        .search-box {
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 6px;
            padding: 8px 12px;
            color: #e1e1e1;
            font-size: 14px;
            width: 250px;
        }

        .user-cumulative-info {
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 8px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .user-cumulative-header {
            background-color: #1a1a1a;
            color: #fff;
            padding: 15px 20px;
            margin: 0;
            border-bottom: 1px solid #3a3a3a;
            font-size: 18px;
            font-weight: 600;
        }

        .user-cumulative-table {
            background-color: #2a2a2a;
            padding: 15px 20px;
            border-bottom: 1px solid #3a3a3a;
            display: grid;
            grid-template-columns: 1.5fr 2fr 1fr 1.5fr 1fr 1fr;
            gap: 20px;
            font-size: 12px;
            font-weight: 600;
            color: #b1b1b1;
            text-transform: uppercase;
        }

        .user-cumulative-row {
            padding: 15px 20px;
            border-bottom: 1px solid #3a3a3a;
            display: grid;
            grid-template-columns: 1.5fr 2fr 1fr 1.5fr 1fr 1fr;
            gap: 20px;
            align-items: center;
            font-size: 14px;
            background-color: #1a1a1a;
        }

        .user-cumulative-row:hover {
            background-color: #2a2a2a;
        }

        .user-cumulative-row:last-child {
            border-bottom: none;
        }

        .user-email {
            color: #4a9eff;
            font-weight: 600;
        }

        /* Settings í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
        .settings-section {
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 8px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .accordion-header {
            background-color: #2a2a2a;
            padding: 20px;
            border-bottom: 1px solid #3a3a3a;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.2s ease;
        }

        .accordion-header:hover {
            background-color: #3a3a3a;
        }

        .accordion-title {
            font-size: 18px;
            font-weight: 600;
            color: #fff;
        }

        .accordion-arrow {
            font-size: 16px;
            color: #b1b1b1;
            transition: transform 0.2s ease;
        }

        .accordion-content {
            display: none;
            padding: 20px;
            background-color: #1a1a1a;
        }

        .accordion-content.active {
            display: block;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #3a3a3a;
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-label {
            color: #fff;
            margin-bottom: 4px;
        }

        .setting-description {
            color: #7a7a7a;
            font-size: 12px;
        }

        .toggle-switch {
            width: 44px;
            height: 24px;
            background-color: #4a9eff;
            border-radius: 12px;
            position: relative;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .toggle-switch.off {
            background-color: #5a5a5a;
        }

        .toggle-switch::after {
            content: '';
            width: 20px;
            height: 20px;
            background-color: white;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            right: 2px;
            transition: all 0.2s ease;
        }

        .toggle-switch.off::after {
            right: 22px;
        }

        .setting-select {
            background: #3a3a3a;
            color: #fff;
            border: 1px solid #4a4a4a;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 14px;
        }

        .export-btn {
            background: #4a9eff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.2s;
        }

        .export-btn:hover {
            background: #3a8edf;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .sidebar {
                width: 70px;
            }
           
            .menu-text {
                display: none;
            }

            .overview-stats {
                grid-template-columns: 1fr;
            }

            .member-item,
            .member-list-header,
            .table-row,
            .table-header,
            .user-cumulative-row,
            .user-cumulative-table {
                grid-template-columns: 1fr;
                gap: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- ì‚¬ì´ë“œë°” -->
        <nav class="sidebar">
            <div class="logo">
                <div class="logo-name">na jeongmin</div>
                <div class="logo-business">Business â€¢ greenmold@samsung.com</div>
                <div class="logo-group">AIExperienceGroup</div>
            </div>
            <a href="javascript:void(0)" class="menu-item active" data-section="overview">
                <span class="menu-icon">ğŸ“Š</span>
                <span class="menu-text">Overview</span>
            </a>
            <a href="javascript:void(0)" class="menu-item" data-section="settings">
                <span class="menu-icon">âš™ï¸</span>
                <span class="menu-text">Settings</span>
            </a>
            <a href="javascript:void(0)" class="menu-item" data-section="members">
                <span class="menu-icon">ğŸ‘¥</span>
                <span class="menu-text">Members</span>
            </a>
            <a href="javascript:void(0)" class="menu-item" data-section="usage">
                <span class="menu-icon">ğŸ“ˆ</span>
                <span class="menu-text">Usage</span>
            </a>
        </nav>

        <!-- ë©”ì¸ ì½˜í…ì¸  -->
        <main class="main-content">
            <header class="header">
                <div class="header-left">
                    <h1 id="page-title">Dashboard Overview</h1>
                </div>
                <div class="header-right">
                    <!-- Clear Cache button and Ready status removed -->
                </div>
            </header>

            <div class="content-area">
                <!-- Overview ì„¹ì…˜ -->
                <div id="overview" class="content-section active">
                    <!-- 2.1.1 í•„í„°ë§ ê¸°ëŠ¥ -->
                    <div class="filter-controls">
                        <div class="chart-controls">
                            <button class="chart-btn" data-days="1">1d</button>
                            <button class="chart-btn" data-days="7">7d</button>
                            <button class="chart-btn active" data-days="30">30d</button>
                            <div class="date-picker">
                                <input type="date" id="start-date" />
                                <span>~</span>
                                <input type="date" id="end-date" />
                                <button class="analytics-btn" onclick="applyDateFilter()">ì ìš©</button>
                            </div>
                        </div>
                        <div>
                            <!-- Refresh ë²„íŠ¼ ì œê±° - í•„í„° ë³€ê²½ ì‹œ ìë™ ìƒˆë¡œê³ ì¹¨ -->
                        </div>
                    </div>

                    <!-- 2.1.2 í†µê³„ ì¹´ë“œ -->
                    <div class="overview-stats">
                        <div class="overview-stat-box clickable" data-type="total" onclick="filterOverviewMembersByType('total')">
                            <div class="stat-number">20</div>
                            <div class="stat-label">
                                <span class="role-badge" style="background-color: #4a9eff; color: white;">ì „ì²´ ë©¤ë²„</span>
                            </div>
                            <div class="stat-description">ëª¨ë“  ë©¤ë²„ì˜ í™œë™ ê¸°ë¡</div>
                        </div>
                        <div class="overview-stat-box clickable" data-type="active" onclick="filterOverviewMembersByType('active')">
                            <div class="stat-number">13</div>
                            <div class="stat-label">
                                <span class="role-badge" style="background-color: #4caf50; color: white;">í™œì„± ë©¤ë²„</span>
                            </div>
                            <div class="stat-description">í™œì„± ë©¤ë²„ì˜ í™œë™ ê¸°ë¡</div>
                        </div>
                        <div class="overview-stat-box clickable" data-type="inactive" onclick="filterOverviewMembersByType('inactive')">
                            <div class="stat-number">7</div>
                            <div class="stat-label">
                                <span class="role-badge" style="background-color: #ff9800; color: white;">ë¹„í™œì„± ë©¤ë²„</span>
                            </div>
                            <div class="stat-description">ë¹„í™œì„± ë©¤ë²„ì˜ í™œë™ ê¸°ë¡</div>
                        </div>
                    </div>

                    <!-- ê·¸ë˜í”„ ì˜ì—­ -->
                    <div class="overview-chart-container">
                        <div class="chart-header">
                            <h3>ì¼ë³„ í™œë™ ì¶”ì´</h3>
                        </div>
                        <canvas id="overviewChart" style="width: 100%; height: 300px;"></canvas>
                    </div>

                    <!-- ë©¤ë²„ ì„¸ë¶€ ë¦¬ìŠ¤íŠ¸ -->
                    <div class="overview-member-details">
                        <div class="member-details-header">
                            <h3 id="member-list-title">ğŸ“Š ì „ì²´ í™œë™ ë¦¬ìŠ¤íŠ¸</h3>
                            <div class="member-count" id="member-count">(20ê±´)</div>
                        </div>
                        <div class="member-list" id="member-list">
                            <!-- í™œë™ ë¦¬ìŠ¤íŠ¸ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤ -->
                            <div style="padding: 20px; text-align: center; color: #7a7a7a; background-color: #1a1a1a;">
                                ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Members ì„¹ì…˜ -->
                <div id="members" class="content-section">
                    <div class="filter-controls" style="margin-bottom: 10px;">
                        <div class="chart-controls">
                            <!-- Refresh ë²„íŠ¼ ì œê±° - Members ë©”ë‰´ í´ë¦­ ì‹œ ìë™ ìƒˆë¡œê³ ì¹¨ -->
                        </div>
                        <div>
                            <input type="text" class="search-box" placeholder="Search members..." onkeyup="filterMembers(this.value)">
                        </div>
                    </div>
                    <div class="data-table">
                        <div class="table-header">
                            <div onclick="sortMembers('name')" style="cursor: pointer;">NAME â†•</div>
                            <div onclick="sortMembers('email')" style="cursor: pointer;">EMAIL â†•</div>
                            <div onclick="sortMembers('requests')" style="cursor: pointer;">PREMIUM REQUESTS â†•</div>
                            <div onclick="sortMembers('spend')" style="cursor: pointer;">SPEND â†•</div>
                            <div onclick="sortMembers('role')" style="cursor: pointer;">ROLE â†•</div>
                            <div></div>
                        </div>
                        <div style="padding: 20px; text-align: center; color: #7a7a7a; background-color: #1a1a1a;">
                            ì‹¤ì œ ë©¤ë²„ ë°ì´í„°ë¥¼ ë¡œë”©í•˜ëŠ” ì¤‘...
                        </div>
                    </div>
                </div>

                <!-- Usage ì„¹ì…˜ -->
                <div id="usage" class="content-section">
                    <div class="usage-cards">
                        <div class="usage-card">
                            <div class="usage-card-number">-</div>
                            <div class="usage-card-label">Total Users</div>
                        </div>
                        <div class="usage-card">
                            <div class="usage-card-number">-</div>
                            <div class="usage-card-label">Lines of Agent Edits</div>
                        </div>
                        <div class="usage-card">
                            <div class="usage-card-number">-</div>
                            <div class="usage-card-label">Tabs Accepted</div>
                        </div>
                        <div class="usage-card">
                            <div class="usage-card-number">-</div>
                            <div class="usage-card-label">Chats</div>
                        </div>
                    </div>

                    <!-- ë‚ ì§œ í•„í„°ì™€ ê²€ìƒ‰ -->
                    <div class="filter-controls">
                        <div class="chart-controls">
                            <button class="chart-btn" data-days="1">1d</button>
                            <button class="chart-btn" data-days="7">7d</button>
                            <button class="chart-btn active" data-days="30">30d</button>
                            <div class="date-picker">
                                <input type="date" id="usage-start-date" />
                                <span>~</span>
                                <input type="date" id="usage-end-date" />
                                <button class="analytics-btn" onclick="applyUsageDateFilter()">ì ìš©</button>
                            </div>
                        </div>
                        <div>
                            <input type="text" class="search-box" placeholder="Search member" onkeyup="filterUsageMembers(this.value)">
                        </div>
                    </div>

                    <!-- ì‚¬ìš©ìë³„ ëˆ„ì  ì •ë³´ -->
                    <div class="user-cumulative-info">
                        <div class="user-cumulative-header">ğŸ“Š ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´</div>
                        <div class="user-cumulative-table">
                            <div>NAME</div>
                            <div>EMAIL</div>
                            <div>ROLE</div>
                            <div>REQUEST</div>
                            <div>SPEND</div>
                            <div>LAST ACT</div>
                        </div>
                        <div style="padding: 20px; text-align: center; color: #7a7a7a; background-color: #1a1a1a;">
                            ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                        </div>
                    </div>

                    <!-- All Raw Events í…Œì´ë¸” -->
                    <div class="user-cumulative-info">
                        <div class="user-cumulative-header">ğŸ“‹ All Raw Events</div>
                        <div class="user-cumulative-table">
                            <div>DATE</div>
                            <div>USER</div>
                            <div>KIND</div>
                            <div>MAX_MODEL</div>
                            <div>MODEL</div>
                            <div>COST</div>
                        </div>
                        <div style="padding: 20px; text-align: center; color: #7a7a7a; background-color: #1a1a1a;">
                            ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                        </div>
                    </div>
                </div>

                <!-- Settings ì„¹ì…˜ -->
                <div id="settings" class="content-section">
                    <!-- í™œì„± ê¸°ê°„ ì„¤ì • -->
                    <div class="settings-section">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <div class="accordion-title">í™œì„± ê¸°ê°„ ì„¤ì •</div>
                            <div class="accordion-arrow">â–¼</div>
                        </div>
                        <div class="accordion-content">
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">í™œì„± ìƒíƒœ ìë™ ì „í™˜</div>
                                    <div class="setting-description">ì§€ì •ëœ ê¸°ê°„ ë™ì•ˆ í™œë™ì´ ì—†ìœ¼ë©´ ìë™ìœ¼ë¡œ ë¹„í™œì„± ìƒíƒœë¡œ ì „í™˜ë©ë‹ˆë‹¤</div>
                                </div>
                                <div class="toggle-switch" onclick="toggleSwitch(this)"></div>
                            </div>
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">ë¹„í™œì„± ì „í™˜ ê¸°ê°„</div>
                                    <div class="setting-description">í™œë™ì´ ì—†ì„ ê²½ìš° ë¹„í™œì„±ìœ¼ë¡œ ì „í™˜ë˜ëŠ” ê¸°ê°„</div>
                                </div>
                                <select class="setting-select">
                                    <option>7ì¼</option>
                                    <option>14ì¼</option>
                                    <option selected>30ì¼</option>
                                    <option>60ì¼</option>
                                    <option>90ì¼</option>
                                </select>
                            </div>
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">í™œì„± ìƒíƒœ ì•Œë¦¼</div>
                                    <div class="setting-description">ë¹„í™œì„± ì „í™˜ ì „ ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼ì„ ë°œì†¡í•©ë‹ˆë‹¤</div>
                                </div>
                                <div class="toggle-switch" onclick="toggleSwitch(this)"></div>
                            </div>
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">ì•Œë¦¼ ë°œì†¡ ì‹œì </div>
                                    <div class="setting-description">ë¹„í™œì„± ì „í™˜ ëª‡ ì¼ ì „ì— ì•Œë¦¼ì„ ë°œì†¡í• ì§€ ì„¤ì •</div>
                                </div>
                                <select class="setting-select">
                                    <option>1ì¼ ì „</option>
                                    <option selected>3ì¼ ì „</option>
                                    <option>7ì¼ ì „</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Email Report ì„¤ì • -->
                    <div class="settings-section">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <div class="accordion-title">Email Report ì„¤ì •</div>
                            <div class="accordion-arrow">â–¼</div>
                        </div>
                        <div class="accordion-content">
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">ìë™ ë¦¬í¬íŠ¸ ë°œì†¡</div>
                                    <div class="setting-description">ì •ê¸°ì ìœ¼ë¡œ ì‚¬ìš© í˜„í™© ë¦¬í¬íŠ¸ë¥¼ ì´ë©”ì¼ë¡œ ë°œì†¡í•©ë‹ˆë‹¤</div>
                                </div>
                                <div class="toggle-switch" onclick="toggleSwitch(this)"></div>
                            </div>
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">ë°œì†¡ ì£¼ê¸°</div>
                                    <div class="setting-description">ë¦¬í¬íŠ¸ ë°œì†¡ ì£¼ê¸°ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤</div>
                                </div>
                                <select class="setting-select">
                                    <option>ë§¤ì¼</option>
                                    <option selected>ë§¤ì£¼</option>
                                    <option>ë§¤ì›”</option>
                                    <option>ë¶„ê¸°ë³„</option>
                                </select>
                            </div>
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">ìˆ˜ì‹ ì ê·¸ë£¹</div>
                                    <div class="setting-description">ë¦¬í¬íŠ¸ë¥¼ ë°›ì„ ëŒ€ìƒì„ ì„¤ì •í•©ë‹ˆë‹¤</div>
                                </div>
                                <div style="display: flex; gap: 10px;">
                                    <label style="display: flex; align-items: center; gap: 5px;">
                                        <input type="checkbox" checked style="width: 16px; height: 16px;">
                                        <span style="color: #e1e1e1; font-size: 14px;">ê´€ë¦¬ì</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 5px;">
                                        <input type="checkbox" style="width: 16px; height: 16px;">
                                        <span style="color: #e1e1e1; font-size: 14px;">ì „ì²´ ë©¤ë²„</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Export Documents ì„¤ì • -->
                    <div class="settings-section">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <div class="accordion-title">Export Documents ì„¤ì •</div>
                            <div class="accordion-arrow">â–¼</div>
                        </div>
                        <div class="accordion-content">
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">ìë™ ë°±ì—…</div>
                                    <div class="setting-description">ë°ì´í„°ë¥¼ ì •ê¸°ì ìœ¼ë¡œ ìë™ ë°±ì—…í•©ë‹ˆë‹¤</div>
                                </div>
                                <div class="toggle-switch" onclick="toggleSwitch(this)"></div>
                            </div>
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">Export í˜•ì‹</div>
                                    <div class="setting-description">ë¬¸ì„œë¥¼ ë‚´ë³´ë‚¼ íŒŒì¼ í˜•ì‹ì„ ì„ íƒí•©ë‹ˆë‹¤</div>
                                </div>
                                <select class="setting-select">
                                    <option>CSV</option>
                                    <option selected>Excel (XLSX)</option>
                                    <option>PDF</option>
                                    <option>JSON</option>
                                </select>
                            </div>
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">Export ë²”ìœ„</div>
                                    <div class="setting-description">ë‚´ë³´ë‚¼ ë°ì´í„°ì˜ ê¸°ê°„ì„ ì„¤ì •í•©ë‹ˆë‹¤</div>
                                </div>
                                <select class="setting-select">
                                    <option>ìµœê·¼ 7ì¼</option>
                                    <option selected>ìµœê·¼ 30ì¼</option>
                                    <option>ìµœê·¼ 90ì¼</option>
                                    <option>ì „ì²´ ê¸°ê°„</option>
                                    <option>ì‚¬ìš©ì ì§€ì •</option>
                                </select>
                            </div>
                            <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #3a3a3a;">
                                <button class="export-btn">ğŸ“¥ ì§€ê¸ˆ Export í•˜ê¸°</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // ë©¤ë²„ í™œë™ ë°ì´í„°
        const memberData = {
            total: [
                { date: "25ë…„ 7ì›” 25ì¼ (ì˜¤ëŠ˜)", email: "greenmold@samsung.com", type: "active", kind: "Chat Request", request: "3", spend: "$0.05" },
                { date: "25ë…„ 7ì›” 25ì¼ (ì˜¤ëŠ˜)", email: "ck9104.lee@samsung.com", type: "active", kind: "Code Generation", request: "2", spend: "$0.03" },
                { date: "25ë…„ 7ì›” 25ì¼ (ì˜¤ëŠ˜)", email: "by07.so@samsung.com", type: "active", kind: "Analysis", request: "5", spend: "$0.08" },
                { date: "25ë…„ 7ì›” 24ì¼ (1ì¼ì „)", email: "dynamic.choi@samsung.com", type: "inactive", kind: "Chat Request", request: "1", spend: "$0.01" },
                { date: "25ë…„ 7ì›” 24ì¼ (1ì¼ì „)", email: "darney.jeon@samsung.com", type: "inactive", kind: "Code Review", request: "2", spend: "$0.02" },
                { date: "25ë…„ 7ì›” 24ì¼ (1ì¼ì „)", email: "j0117.lee@samsung.com", type: "active", kind: "Documentation", request: "4", spend: "$0.04" },
                { date: "25ë…„ 7ì›” 24ì¼ (1ì¼ì „)", email: "kaeul.kim@samsung.com", type: "active", kind: "Chat Request", request: "6", spend: "$0.06" },
                { date: "25ë…„ 7ì›” 24ì¼ (1ì¼ì „)", email: "nw.aioffice@samsung.com", type: "inactive", kind: "Analysis", request: "1", spend: "$0.01" },
                { date: "25ë…„ 7ì›” 24ì¼ (1ì¼ì „)", email: "sh.ryan.park@samsung.com", type: "active", kind: "Code Generation", request: "7", spend: "$0.07" },
                { date: "25ë…„ 7ì›” 24ì¼ (1ì¼ì „)", email: "sejin.seo@samsung.com", type: "active", kind: "Chat Request", request: "3", spend: "$0.03" },
                { date: "25ë…„ 7ì›” 23ì¼ (2ì¼ì „)", email: "sol22.lee@samsung.com", type: "inactive", kind: "Documentation", request: "2", spend: "$0.02" },
                { date: "25ë…„ 7ì›” 23ì¼ (2ì¼ì „)", email: "shee.lim@samsung.com", type: "inactive", kind: "Analysis", request: "1", spend: "$0.01" },
                { date: "25ë…„ 7ì›” 23ì¼ (2ì¼ì „)", email: "joseph2.jeon@samsung.com", type: "active", kind: "Code Review", request: "5", spend: "$0.05" },
                { date: "25ë…„ 7ì›” 23ì¼ (2ì¼ì „)", email: "taewoo.bang@samsung.com", type: "inactive", kind: "Chat Request", request: "1", spend: "$0.01" },
                { date: "25ë…„ 7ì›” 23ì¼ (2ì¼ì „)", email: "baewj@samsung.com", type: "inactive", kind: "Code Generation", request: "3", spend: "$0.03" },
                { date: "25ë…„ 7ì›” 22ì¼ (3ì¼ì „)", email: "yj7.park@samsung.com", type: "active", kind: "Analysis", request: "4", spend: "$0.04" },
                { date: "25ë…„ 7ì›” 22ì¼ (3ì¼ì „)", email: "nemo.kim@samsung.com", type: "active", kind: "Chat Request", request: "6", spend: "$0.06" },
                { date: "25ë…„ 7ì›” 22ì¼ (3ì¼ì „)", email: "ms0402.kim@samsung.com", type: "active", kind: "Documentation", request: "3", spend: "$0.03" },
                { date: "25ë…„ 7ì›” 21ì¼ (4ì¼ì „)", email: "shx.kim@samsung.com", type: "active", kind: "Code Review", request: "5", spend: "$0.05" },
                { date: "25ë…„ 7ì›” 21ì¼ (4ì¼ì „)", email: "greenmold@samsung.com", type: "active", kind: "Analysis", request: "8", spend: "$0.08" }
            ]
        };

        // í™œì„±/ë¹„í™œì„± ë©¤ë²„ í™œë™ ë¶„ë¥˜
        memberData.active = memberData.total.filter(activity => activity.type === "active");
        memberData.inactive = memberData.total.filter(activity => activity.type === "inactive");

        // ë©¤ë²„ ë¦¬ìŠ¤íŠ¸ ë Œë”ë§
        function renderMemberList(type) {
            const memberList = document.getElementById('member-list');
            const memberListTitle = document.getElementById('member-list-title');
            const memberCount = document.getElementById('member-count');
           
            let activities = [];
            let title = "";
            let icon = "";
           
            switch(type) {
                case 'active':
                    activities = memberData.active;
                    title = "í™œì„± ë©¤ë²„ í™œë™ ë¦¬ìŠ¤íŠ¸";
                    icon = "ğŸŸ¢";
                    break;
                case 'inactive':
                    activities = memberData.inactive;
                    title = "ë¹„í™œì„± ë©¤ë²„ í™œë™ ë¦¬ìŠ¤íŠ¸";
                    icon = "ğŸŸ ";
                    break;
                default:
                    activities = memberData.total;
                    title = "ì „ì²´ í™œë™ ë¦¬ìŠ¤íŠ¸";
                    icon = "ğŸ“Š";
            }
           
            memberListTitle.textContent = `${icon} ${title}`;
            memberCount.textContent = `(${activities.length}ê±´)`;
           
            memberList.innerHTML = `
                <div class="member-list-header">
                    <div>DATE</div>
                    <div>EMAIL</div>
                    <div>TYPE</div>
                    <div>KIND</div>
                    <div>REQUEST</div>
                    <div>SPEND</div>
                </div>
                ${activities.map(activity => `
                    <div class="member-item">
                        <div class="member-date">${activity.date}</div>
                        <div class="member-email">${activity.email}</div>
                        <div class="member-type ${activity.type}">${activity.type === 'active' ? 'í™œì„±' : 'ë¹„í™œì„±'}</div>
                        <div class="member-kind">${activity.kind}</div>
                        <div class="member-request">${activity.request}</div>
                        <div class="member-spend">${activity.spend}</div>
                    </div>
                `).join('')}
            `;
        }

        // í†µê³„ ë°•ìŠ¤ í´ë¦­ ì´ë²¤íŠ¸
        function initOverviewStats() {
            const statBoxes = document.querySelectorAll('.overview-stat-box');
           
            statBoxes.forEach(box => {
                box.addEventListener('click', function() {
                    // ëª¨ë“  ë°•ìŠ¤ì—ì„œ selected í´ë˜ìŠ¤ ì œê±°
                    statBoxes.forEach(b => b.classList.remove('selected'));
                   
                    // í´ë¦­ëœ ë°•ìŠ¤ì— selected í´ë˜ìŠ¤ ì¶”ê°€
                    this.classList.add('selected');
                   
                    // í•´ë‹¹ íƒ€ì…ì˜ ë©¤ë²„ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
                    const type = this.getAttribute('data-type');
                    renderMemberList(type);
                });
            });
           
            // ì´ˆê¸° ë¡œë“œ ì‹œ ì „ì²´ ë©¤ë²„ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
            renderMemberList('total');
        }

        // ì°¨íŠ¸ ìƒì„± (Overviewìš©)
        function createOverviewChart() {
            const canvas = document.getElementById('overviewChart');
            if (!canvas) return;
           
            // Canvas í¬ê¸° ì„¤ì •
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = 300;
           
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
           
            // ë°°ê²½ ì„¤ì •
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, width, height);
           
            // ê·¸ë¦¬ë“œ ê·¸ë¦¬ê¸°
            ctx.strokeStyle = '#3a3a3a';
            ctx.lineWidth = 1;
           
            // ì„¸ë¡œ ê·¸ë¦¬ë“œ
            for (let i = 0; i <= 6; i++) {
                const x = (width / 6) * i;
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, height);
                ctx.stroke();
            }
           
            // ê°€ë¡œ ê·¸ë¦¬ë“œ
            for (let i = 0; i <= 5; i++) {
                const y = (height / 5) * i;
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(width, y);
                ctx.stroke();
            }
           
            // ë°ì´í„° í¬ì¸íŠ¸ (ì˜ˆì‹œ)
            const dataPoints = [
                {x: width * 0.1, y: height * 0.8},
                {x: width * 0.25, y: height * 0.7},
                {x: width * 0.4, y: height * 0.6},
                {x: width * 0.55, y: height * 0.3},
                {x: width * 0.7, y: height * 0.4},
                {x: width * 0.85, y: height * 0.5}
            ];
           
            // ì„  ê·¸ë˜í”„ ê·¸ë¦¬ê¸°
            ctx.strokeStyle = '#4a9eff';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(dataPoints[0].x, dataPoints[0].y);
           
            for (let i = 1; i < dataPoints.length; i++) {
                ctx.lineTo(dataPoints[i].x, dataPoints[i].y);
            }
            ctx.stroke();
           
            // ë°ì´í„° í¬ì¸íŠ¸ ì› ê·¸ë¦¬ê¸°
            dataPoints.forEach(point => {
                ctx.fillStyle = '#4a9eff';
                ctx.beginPath();
                ctx.arc(point.x, point.y, 4, 0, Math.PI * 2);
                ctx.fill();
            });
           
            // ë‚ ì§œ ë ˆì´ë¸”
            const dates = ['Jul 18', 'Jul 19', 'Jul 20', 'Jul 21', 'Jul 22', 'Jul 23', 'Jul 24'];
            ctx.fillStyle = '#7a7a7a';
            ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'center';
           
            dates.forEach((date, index) => {
                const x = (width / 6) * index;
                ctx.fillText(date, x, height - 10);
            });
        }

        // ë©”ë‰´ í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬
        document.querySelectorAll('.menu-item').forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
               
                // ëª¨ë“  ë©”ë‰´ ì•„ì´í…œì—ì„œ active í´ë˜ìŠ¤ ì œê±°
                document.querySelectorAll('.menu-item').forEach(menu => {
                    menu.classList.remove('active');
                });
               
                // í´ë¦­ëœ ë©”ë‰´ì— active í´ë˜ìŠ¤ ì¶”ê°€
                this.classList.add('active');
               
                // ëª¨ë“  ì½˜í…ì¸  ì„¹ì…˜ ìˆ¨ê¸°ê¸°
                document.querySelectorAll('.content-section').forEach(section => {
                    section.classList.remove('active');
                });
               
                // ì„ íƒëœ ì„¹ì…˜ í‘œì‹œ
                const sectionName = this.getAttribute('data-section');
                const targetSection = document.getElementById(sectionName);
                if (targetSection) {
                    targetSection.classList.add('active');
                }
               
                // í—¤ë” ì œëª© ì—…ë°ì´íŠ¸
                const pageTitle = document.getElementById('page-title');
               
                switch(sectionName) {
                    case 'overview':
                        pageTitle.textContent = 'Dashboard Overview';
                        // í•„í„° ê¸°ë³¸ê°’ ì„¤ì • í›„
                        setTimeout(async () => {
                            createOverviewChart();
                            console.log('=== Overview ë©”ë‰´ í´ë¦­ ì‹œ ìë™ ì‹¤ì œ API ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì‹œì‘ ===');
                            await refreshAllRealData(); // ìë™ ìƒˆë¡œê³ ì¹¨
                        }, 100);
                        break;
                    case 'members':
                        pageTitle.textContent = 'Members';
                        // Members ë©”ë‰´ í´ë¦­ ì‹œ ìë™ ìƒˆë¡œê³ ì¹¨
                        setTimeout(async () => {
                            console.log('=== Members ë©”ë‰´ í´ë¦­ ì‹œ ìë™ ì‹¤ì œ API ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì‹œì‘ ===');
                            await updateMembersWithRealData();
                        }, 100);
                        break;
                    case 'usage':
                        pageTitle.textContent = 'Usage Analytics';
                        // Usage ë©”ë‰´ í´ë¦­ ì‹œ ìë™ ìƒˆë¡œê³ ì¹¨
                        setTimeout(async () => {
                            console.log('=== Usage ë©”ë‰´ í´ë¦­ ì‹œ ìë™ ì‹¤ì œ API ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì‹œì‘ ===');
                            await updateUsageWithCurrentFilter(30); // ê¸°ë³¸ 30ì¼
                        }, 100);
                        break;
                    case 'settings':
                        pageTitle.textContent = 'Settings';
                        break;
                    default:
                        pageTitle.textContent = sectionName.charAt(0).toUpperCase() + sectionName.slice(1);
                }
            });
        });

        // ì•„ì½”ë””ì–¸ í† ê¸€ í•¨ìˆ˜
        function toggleAccordion(header) {
            const content = header.nextElementSibling;
            const arrow = header.querySelector('.accordion-arrow');
           
            // ë‹¤ë¥¸ ëª¨ë“  ì•„ì½”ë””ì–¸ ë‹«ê¸°
            document.querySelectorAll('.accordion-content').forEach(otherContent => {
                if (otherContent !== content) {
                    otherContent.classList.remove('active');
                    otherContent.previousElementSibling.querySelector('.accordion-arrow').textContent = 'â–¼';
                }
            });
           
            // í˜„ì¬ ì•„ì½”ë””ì–¸ í† ê¸€
            if (content.classList.contains('active')) {
                content.classList.remove('active');
                arrow.textContent = 'â–¼';
            } else {
                content.classList.add('active');
                arrow.textContent = 'â–²';
            }
        }

        // í† ê¸€ ìŠ¤ìœ„ì¹˜ í•¨ìˆ˜
        function toggleSwitch(toggle) {
            toggle.classList.toggle('off');
        }

        // Overview í†µê³„ ì¹´ë“œ í´ë¦­ ì‹œ ë©¤ë²„ íƒ€ì…ë³„ í•„í„°ë§
        async function filterOverviewMembersByType(type) {
            console.log(`=== Overview í†µê³„ ì¹´ë“œ í´ë¦­: ${type} ===`);
            
            // ì„ íƒ ìƒíƒœ ì—…ë°ì´íŠ¸
            updateOverviewSelection(type);
            currentFilterType = type;
           
            // í´ë¦­ ì¦‰ì‹œ ë¡œë”© ìƒíƒœ í‘œì‹œ
            updateActivityList([]);
            updateMemberListTitle(type, 0);
           
            // ì‹¤ì œ API ë°ì´í„° ìƒˆë¡œ ê°€ì ¸ì™€ì„œ í‘œì‹œ
            await updateMembersByTypeWithRealData(type);
        }

        // Overview í†µê³„ ì¹´ë“œ ì„ íƒ ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateOverviewSelection(type) {
            // ëª¨ë“  í†µê³„ ì¹´ë“œì—ì„œ selected í´ë˜ìŠ¤ ì œê±°
            document.querySelectorAll('.overview-stat-box').forEach(box => {
                box.classList.remove('selected');
            });
            
            // í´ë¦­ëœ ì¹´ë“œì— selected í´ë˜ìŠ¤ ì¶”ê°€
            const targetBox = document.querySelector(`.overview-stat-box[data-type="${type}"]`);
            if (targetBox) {
                targetBox.classList.add('selected');
            }
            
            console.log(`í†µê³„ ì¹´ë“œ ì„ íƒ ìƒíƒœ ì—…ë°ì´íŠ¸: ${type}`);
        }

        // íƒ€ì…ë³„ ë©¤ë²„ ë°ì´í„°ë¥¼ ì‹¤ì œ APIì—ì„œ ê°€ì ¸ì™€ì„œ í‘œì‹œ
        async function updateMembersByTypeWithRealData(type) {
            console.log(`=== ${type} ë©¤ë²„ ì‹¤ì œ API ë°ì´í„° ë¡œë“œ ì‹œì‘ ===`);
            console.log(`ìš”ì²­ëœ íƒ€ì…: ${type}, í˜„ì¬ í•„í„° íƒ€ì…: ${currentFilterType}`);
           
            // í˜„ì¬ í•„í„° ê¸°ê°„ ê²°ì •
            let dateRange;
            if (currentDateRange) {
                dateRange = currentDateRange;
            } else {
                const filterDays = getCurrentFilterDays();
                dateRange = getDateRange(filterDays);
            }
           
            console.log(`í•„í„° ê¸°ê°„: ${new Date(dateRange.startDate).toLocaleDateString()} ~ ${new Date(dateRange.endDate).toLocaleDateString()}`);
           
            // ì‹¤ì œ API ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            const [membersData, eventsData] = await Promise.all([
                getTeamMembers(),
                getFilteredEvents(dateRange.startDate, dateRange.endDate)
            ]);
           
            if (!membersData || !membersData.teamMembers) {
                throw new Error('ë©¤ë²„ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
           
            console.log(`API ì‘ë‹µ: ë©¤ë²„ ${membersData.teamMembers.length}ëª…, ì´ë²¤íŠ¸ ${eventsData?.usageEvents?.length || 0}ê°œ`);
           
            if (type === 'inactive') {
                // ë¹„í™œì„± ë©¤ë²„ ì²˜ë¦¬
                await showInactiveMembersWithData(membersData, eventsData);
            } else if (type === 'active') {
                // í™œì„± ë©¤ë²„ ì²˜ë¦¬
                await showActiveMembersWithData(membersData, eventsData, 'active');
            } else if (type === 'total') {
                // ì „ì²´ ë©¤ë²„ ì²˜ë¦¬
                await showActiveMembersWithData(membersData, eventsData, 'total');
            } else {
                console.error(`ì•Œ ìˆ˜ ì—†ëŠ” íƒ€ì…: ${type}`);
                updateActivityList([]);
                updateMemberListTitle(type, 0);
            }
           
            console.log(`=== ${type} ë©¤ë²„ ì‹¤ì œ API ë°ì´í„° ë¡œë“œ ì™„ë£Œ ===`);
        }

        // í™œì„± ë©¤ë²„ ë˜ëŠ” ì „ì²´ ë©¤ë²„ í‘œì‹œ
        async function showActiveMembersWithData(membersData, eventsData, type) {
            console.log(`=== ${type} ë©¤ë²„ ë°ì´í„° í‘œì‹œ ì‹œì‘ ===`);
           
            if (!eventsData || !eventsData.usageEvents) {
                console.log('í™œë™ ì´ë²¤íŠ¸ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                updateActivityList([]);
                updateMemberListTitle(type, 0);
                return;
            }
           
            // ì§€ì¶œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            const spendingData = await getTeamSpendingData();
            const memberSpendMap = {};
            if (spendingData && spendingData.teamMemberSpend) {
                spendingData.teamMemberSpend.forEach(spendInfo => {
                    memberSpendMap[spendInfo.email] = {
                        premiumRequests: spendInfo.fastPremiumRequests || 0,
                        spend: (spendInfo.spendCents || 0) / 100,
                        hardLimitOverride: spendInfo.hardLimitOverrideDollars || 0
                    };
                });
            }
           
            // ì‹¤ì œ í™œë™ ë¦¬ìŠ¤íŠ¸ ìƒì„±
            const activities = createActivityListWithLastActivity(eventsData.usageEvents, membersData.teamMembers, memberSpendMap);
            console.log(`ìƒì„±ëœ í™œë™ ë¦¬ìŠ¤íŠ¸: ${activities.length}ëª…`);
           
            let filteredActivities;
            if (type === 'active') {
                // í™œì„± ë©¤ë²„: request > 0ì¸ ë©¤ë²„ë§Œ
                filteredActivities = activities.filter(activity => activity.request > 0);
            } else if (type === 'total') {
                // ì „ì²´ ë©¤ë²„: ì‹¤ì œ í™œë™ì´ ìˆëŠ” ëª¨ë“  ë©¤ë²„
                filteredActivities = activities;
            } else {
                // ê¸°ë³¸ê°’: ì „ì²´ ë©¤ë²„
                filteredActivities = activities;
                console.log(`ê¸°ë³¸ ì „ì²´ ë©¤ë²„ í‘œì‹œ: ${filteredActivities.length}ëª…`);
            }
           
            console.log(`${type} ë©¤ë²„ ìµœì¢… ë°ì´í„°: ${filteredActivities.length}ëª…`);
            console.log('í‘œì‹œë  ë©¤ë²„ ëª©ë¡:', filteredActivities.map(a => `${a.email} (${a.request} requests)`));
           
            updateActivityList(filteredActivities);
            updateMemberListTitle(type, filteredActivities.length);
           
            console.log(`=== ${type} ë©¤ë²„ ë°ì´í„° í‘œì‹œ ì™„ë£Œ ===`);
        }

        // ë¹„í™œì„± ë©¤ë²„ í‘œì‹œ í•¨ìˆ˜ (ë°ì´í„°ì™€ í•¨ê»˜)
        async function showInactiveMembersWithData(membersData, eventsData) {
            console.log('=== ë¹„í™œì„± ë©¤ë²„ í‘œì‹œ ì‹œì‘ ===');
           
            // ì§€ì¶œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            const spendingData = await getTeamSpendingData();
            const memberSpendMap = {};
            if (spendingData && spendingData.teamMemberSpend) {
                spendingData.teamMemberSpend.forEach(spendInfo => {
                    memberSpendMap[spendInfo.email] = {
                        premiumRequests: spendInfo.fastPremiumRequests || 0,
                        spend: (spendInfo.spendCents || 0) / 100,
                        hardLimitOverride: spendInfo.hardLimitOverrideDollars || 0
                    };
                });
            }
           
            // í™œë™ì´ ìˆëŠ” ì‚¬ìš©ì ëª©ë¡ ìƒì„±
            const activeUserEmails = new Set();
            if (eventsData && eventsData.usageEvents) {
                eventsData.usageEvents.forEach(event => {
                    if (event.userEmail && event.requestsCosts > 0) {
                        activeUserEmails.add(event.userEmail);
                    }
                });
            }
           
            // ë¹„í™œì„± ë©¤ë²„ í•„í„°ë§
            const inactiveMembers = membersData.teamMembers.filter(member =>
                !activeUserEmails.has(member.email)
            );
           
            console.log(`ë¹„í™œì„± ë©¤ë²„: ${inactiveMembers.length}ëª…`);
            console.log('ë¹„í™œì„± ë©¤ë²„ ëª©ë¡:', inactiveMembers.map(m => m.email));
           
            // ë¹„í™œì„± ë©¤ë²„ë¥¼ í™œë™ ë¦¬ìŠ¤íŠ¸ í˜•íƒœë¡œ ë³€í™˜
            const inactiveActivities = inactiveMembers.map(member => {
                const spendData = memberSpendMap[member.email] || {};
                const actualSpend = spendData.spend || 0; // ì‹¤ì œ ì§€ì¶œ ë°ì´í„° ì‚¬ìš©
                const premiumRequests = spendData.premiumRequests || 0;
                const hardLimit = spendData.hardLimitOverride || 0;
                const limitDisplay = hardLimit > 0 ? `$${hardLimit}` : '$0';
               
                return {
                    date: 'No Activity',
                    timestamp: 0,
                    email: member.email,
                    name: member.name || 'Unnamed',
                    type: 'inactive',
                    kind: 'No Activity',
                    request: premiumRequests, // Premium Requests ì‚¬ìš©
                    spend: `$${actualSpend.toFixed(2)}`, // ì‹¤ì œ ì§€ì¶œ ë°ì´í„° ì‚¬ìš©
                    limit: limitDisplay
                };
            });
           
            updateActivityList(inactiveActivities);
            updateMemberListTitle('inactive', inactiveActivities.length);
        }

        // ë¹„í™œì„± ë©¤ë²„ í‘œì‹œ í•¨ìˆ˜ (ê¸°ì¡´ í˜¸í™˜ì„± ìœ ì§€)
        async function showInactiveMembers() {
            try {
                console.log('=== ë¹„í™œì„± ë©¤ë²„ í‘œì‹œ ì‹œì‘ (ê¸°ì¡´ í•¨ìˆ˜) ===');
               
                // í˜„ì¬ í•„í„° ê¸°ê°„ì˜ ì´ë²¤íŠ¸ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                let dateRange;
                if (currentDateRange) {
                    dateRange = currentDateRange;
                } else {
                    const filterDays = getCurrentFilterDays();
                    dateRange = getDateRange(filterDays);
                }
               
                const [membersData, eventsData] = await Promise.all([
                    getTeamMembers(),
                    getFilteredEvents(dateRange.startDate, dateRange.endDate)
                ]);
               
                if (!membersData || !membersData.teamMembers) {
                    console.error('ë©¤ë²„ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
               
                await showInactiveMembersWithData(membersData, eventsData);
               
            } catch (error) {
                console.error('âŒ ë¹„í™œì„± ë©¤ë²„ í‘œì‹œ ì‹¤íŒ¨:', error);
            }
        }

        // í™œë™ ë°ì´í„°ë¥¼ íƒ€ì…ë³„ë¡œ í•„í„°ë§ (ì‹¤ì œ í™œë™ ê¸°ì¤€) - ì‚¬ìš© ì¤‘ë‹¨ë¨
        // ì´ì œ ê° í†µê³„ ì¹´ë“œ í´ë¦­ ì‹œ ì‹¤ì œ API ë°ì´í„°ë¥¼ ìƒˆë¡œ ê°€ì ¸ì™€ì„œ í‘œì‹œí•¨
        function filterActivitiesByType(activities, type) {
            console.log(`âš ï¸ filterActivitiesByType ì‚¬ìš© ì¤‘ë‹¨ë¨. ëŒ€ì‹  updateMembersByTypeWithRealData ì‚¬ìš©`);
            console.log(`í•„í„°ë§ ìš”ì²­: ${type}, ì „ì²´ í™œë™ ìˆ˜: ${activities.length}`);
           
            let filteredActivities;
            switch (type) {
                case 'active':
                    filteredActivities = activities.filter(activity => activity.type === 'active' && activity.request > 0);
                    break;
                case 'inactive':
                    // ë¹„í™œì„± ë©¤ë²„ë„ í‘œì‹œí•˜ë„ë¡ ìˆ˜ì •
                    filteredActivities = activities.filter(activity => activity.type === 'inactive');
                    break;
                case 'total':
                default:
                    filteredActivities = activities;
                    break;
            }
           
            console.log(`í•„í„°ë§ ê²°ê³¼: ${filteredActivities.length}ëª…`);
            return filteredActivities;
        }

        // ë©¤ë²„ ë¦¬ìŠ¤íŠ¸ ì œëª© ì—…ë°ì´íŠ¸ (Usage ì„¹ì…˜ê³¼ ë™ì¼í•œ í˜•ì‹)
        function updateMemberListTitle(type, count) {
            const titleElement = document.getElementById('member-list-title');
            const countElement = document.getElementById('member-count');
           
            let title, emoji;
            switch (type) {
                case 'active':
                    title = 'í™œì„± ë©¤ë²„ í™œë™ ë¦¬ìŠ¤íŠ¸';
                    emoji = 'âœ…';
                    break;
                case 'inactive':
                    title = 'ë¹„í™œì„± ë©¤ë²„ í™œë™ ë¦¬ìŠ¤íŠ¸';
                    emoji = 'ğŸ’¤';
                    break;
                case 'total':
                default:
                    title = 'ì „ì²´ í™œë™ ë¦¬ìŠ¤íŠ¸';
                    emoji = 'ğŸ“Š';
                    break;
            }
           
            // Usage ì„¹ì…˜ê³¼ ë™ì¼í•œ í˜•ì‹ìœ¼ë¡œ ì œëª©ì— ê¸°ê°„ ì •ë³´ í¬í•¨
            const periodText = getCurrentOverviewPeriodText();
            if (titleElement) titleElement.textContent = `${emoji} ${title} (${periodText})`;
            if (countElement) countElement.textContent = `(${count}ëª…)`;
        }

        // í˜„ì¬ Overview í•„í„° ê¸°ê°„ì„ í…ìŠ¤íŠ¸ë¡œ ë°˜í™˜
        function getCurrentOverviewPeriodText() {
            let dateRange;
            if (currentDateRange) {
                dateRange = currentDateRange;
            } else {
                const filterDays = getCurrentFilterDays();
                dateRange = getDateRange(filterDays);
            }
            
            const startDate = new Date(dateRange.startDate).toLocaleDateString('ko-KR');
            const endDate = new Date(dateRange.endDate).toLocaleDateString('ko-KR');
            
            return `${startDate} ~ ${endDate}`;
        }

        // ì°¨íŠ¸ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('chart-btn')) {
                // í˜„ì¬ ì„¹ì…˜ì˜ ì°¨íŠ¸ ë²„íŠ¼ë“¤ë§Œ ì²˜ë¦¬
                const parentSection = e.target.closest('.content-section');
                if (parentSection) {
                    parentSection.querySelectorAll('.chart-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    e.target.classList.add('active');
                   
                    // Overview ì„¹ì…˜ì˜ í•„í„° ë²„íŠ¼ì¸ ê²½ìš° í™œë™ ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
                    if (parentSection.id === 'overview') {
                        const days = e.target.getAttribute('data-days') || 1;
                        console.log(`Overview í•„í„° ë²„íŠ¼ í´ë¦­: ${days}ì¼`);
                        updateOverviewWithCurrentFilter();
                    }
                    // Usage ì„¹ì…˜ì˜ í•„í„° ë²„íŠ¼ì¸ ê²½ìš° ì‚¬ìš©ëŸ‰ ë°ì´í„° ì—…ë°ì´íŠ¸
                    else if (parentSection.id === 'usage') {
                        const days = e.target.getAttribute('data-days') || 30;
                        console.log(`Usage í•„í„° ë²„íŠ¼ í´ë¦­: ${days}ì¼`);
                        updateUsageWithCurrentFilter(days);
                    }
                }
            }
        });

        // ë‚ ì§œ í•„í„° ì ìš© í•¨ìˆ˜
        async function applyDateFilter() {
            const startDateInput = document.getElementById('start-date');
            const endDateInput = document.getElementById('end-date');
           
            if (!startDateInput.value || !endDateInput.value) {
                alert('ì‹œì‘ ë‚ ì§œì™€ ì¢…ë£Œ ë‚ ì§œë¥¼ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
           
            const startDate = new Date(startDateInput.value).getTime();
            const endDate = new Date(endDateInput.value).getTime() + (24 * 60 * 60 * 1000 - 1); // í•˜ë£¨ ëê¹Œì§€
           
            if (startDate > endDate) {
                alert('ì‹œì‘ ë‚ ì§œëŠ” ì¢…ë£Œ ë‚ ì§œë³´ë‹¤ ë¹ ë¥¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
           
            console.log(`Overview ì‚¬ìš©ì ì •ì˜ ë‚ ì§œ ë²”ìœ„ ì ìš©: ${new Date(startDate).toLocaleDateString()} ~ ${new Date(endDate).toLocaleDateString()}`);
           
            // í˜„ì¬ ë‚ ì§œ ë²”ìœ„ ì €ì¥
            currentDateRange = { startDate, endDate };
           
            // ë²„íŠ¼ active ìƒíƒœ ì œê±°
            document.querySelectorAll('#overview .chart-btn').forEach(btn => {
                btn.classList.remove('active');
            });
           
            // Overview ì—…ë°ì´íŠ¸
            await updateOverviewWithCurrentFilter();
        }

        // Usage ë‚ ì§œ í•„í„° ì ìš© í•¨ìˆ˜
        async function applyUsageDateFilter() {
            const startDateInput = document.getElementById('usage-start-date');
            const endDateInput = document.getElementById('usage-end-date');
           
            if (!startDateInput.value || !endDateInput.value) {
                alert('ì‹œì‘ ë‚ ì§œì™€ ì¢…ë£Œ ë‚ ì§œë¥¼ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
           
            const startDate = new Date(startDateInput.value).getTime();
            const endDate = new Date(endDateInput.value).getTime() + (24 * 60 * 60 * 1000 - 1); // í•˜ë£¨ ëê¹Œì§€
           
            if (startDate > endDate) {
                alert('ì‹œì‘ ë‚ ì§œëŠ” ì¢…ë£Œ ë‚ ì§œë³´ë‹¤ ë¹ ë¥¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
           
            console.log(`Usage ì‚¬ìš©ì ì •ì˜ ë‚ ì§œ ë²”ìœ„ ì ìš©: ${new Date(startDate).toLocaleDateString()} ~ ${new Date(endDate).toLocaleDateString()}`);
           
            // í˜„ì¬ ë‚ ì§œ ë²”ìœ„ ì €ì¥
            currentUsageDateRange = { startDate, endDate };
           
            // ë²„íŠ¼ active ìƒíƒœ ì œê±°
            document.querySelectorAll('#usage .chart-btn').forEach(btn => {
                btn.classList.remove('active');
            });
           
            // Usage ì—…ë°ì´íŠ¸
            await updateUsageWithDateRange(startDate, endDate);
        }

        // í˜„ì¬ í•„í„° ì„¤ì •ìœ¼ë¡œ Overview ì—…ë°ì´íŠ¸
        async function updateOverviewWithCurrentFilter() {
            try {
                console.log('=== í˜„ì¬ í•„í„°ë¡œ Overview ì—…ë°ì´íŠ¸ ì‹œì‘ ===');
               
                // ë‚ ì§œ ë²”ìœ„ ê²°ì •
                let dateRange;
                if (currentDateRange) {
                    dateRange = currentDateRange;
                    console.log('ì‚¬ìš©ì ì •ì˜ ë‚ ì§œ ë²”ìœ„ ì‚¬ìš©');
                } else {
                    const filterDays = getCurrentFilterDays();
                    dateRange = getDateRange(filterDays);
                    console.log(`ê¸°ë³¸ í•„í„° ê¸°ê°„ ì‚¬ìš©: ${filterDays}ì¼`);
                }
               
                // íŒ€ì› ì •ë³´ ê°€ì ¸ì˜¤ê¸°
                const membersData = await getTeamMembers();
                if (!membersData || !membersData.teamMembers) {
                    console.error('íŒ€ì› ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                currentMembers = membersData.teamMembers;
               
                // í™œë™ ì´ë²¤íŠ¸ ê°€ì ¸ì˜¤ê¸°
                const eventsData = await getFilteredEvents(dateRange.startDate, dateRange.endDate);
               
                // ì§€ì¶œ ë°ì´í„°ë¡œ í†µê³„ ê³„ì‚° (ì„ íƒëœ ê¸°ê°„)
                const spendingData = await getTeamSpendingData();
               
                // ì§€ì¶œ ë°ì´í„° ë§¤í•‘
                const memberSpendMap = {};
                if (spendingData && spendingData.teamMemberSpend) {
                    console.log('ğŸ” ì›ë³¸ ì§€ì¶œ ë°ì´í„°:', spendingData.teamMemberSpend);
                    spendingData.teamMemberSpend.forEach(spendInfo => {
                        memberSpendMap[spendInfo.email] = {
                            premiumRequests: spendInfo.fastPremiumRequests || 0,
                            spend: (spendInfo.spendCents || 0) / 100,
                            hardLimitOverride: spendInfo.hardLimitOverrideDollars || 0
                        };
                        console.log(`ğŸ’° ${spendInfo.email}: requests=${spendInfo.fastPremiumRequests}, spend=$${((spendInfo.spendCents || 0) / 100).toFixed(2)}, limit=$${spendInfo.hardLimitOverrideDollars || 0}`);
                    });
                    console.log('ğŸ“Š ìµœì¢… ì§€ì¶œ ë°ì´í„° ë§µ:', memberSpendMap);
                }
               
                if (eventsData && eventsData.usageEvents) {
                    console.log(`âœ… ${eventsData.usageEvents.length}ê±´ì˜ í™œë™ ì´ë²¤íŠ¸ë¥¼ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.`);
                    currentActivities = createActivityListWithLastActivity(eventsData.usageEvents, membersData.teamMembers, memberSpendMap);
                   
                    // ì„ íƒëœ ê¸°ê°„ ë‚´ ì‹¤ì œ í™œì„± ë©¤ë²„ ê³„ì‚°
                    const periodActiveMembers = calculatePeriodActiveMembers(eventsData.usageEvents);
                    const totalMembers = membersData.teamMembers.length;
                    const inactiveMembers = totalMembers - periodActiveMembers;
                   
                    console.log(`í†µê³„ ê³„ì‚° ê²°ê³¼: ì „ì²´ ${totalMembers}ëª…, í™œì„± ${periodActiveMembers}ëª…, ë¹„í™œì„± ${inactiveMembers}ëª…`);
                    console.log(`í™œë™ ë¦¬ìŠ¤íŠ¸ì— ì‹¤ì œ í‘œì‹œë  ë©¤ë²„ ìˆ˜: ${currentActivities.length}ëª…`);
                   
                    // í†µê³„ ì¹´ë“œ ì—…ë°ì´íŠ¸
                    updateStatsCards(totalMembers, periodActiveMembers, inactiveMembers);
                   
                    // í˜„ì¬ ì„ íƒëœ íƒ€ì…ì— ë”°ë¼ í•„í„°ë§
                    const filteredActivities = filterActivitiesByType(currentActivities, currentFilterType);
                    updateActivityList(filteredActivities);
                    updateMemberListTitle(currentFilterType, filteredActivities.length);
                } else {
                    console.log('í™œë™ ì´ë²¤íŠ¸ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                    currentActivities = [];
                    const totalMembers = membersData ? membersData.teamMembers.length : 0;
                    updateStatsCards(totalMembers, 0, totalMembers);
                    updateActivityList([]);
                }
               
                console.log('=== í˜„ì¬ í•„í„°ë¡œ Overview ì—…ë°ì´íŠ¸ ì™„ë£Œ ===');
            } catch (error) {
                console.error('âŒ Overview ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);
            }
        }

        // ì„ íƒëœ ê¸°ê°„ ë‚´ í™œì„± ë©¤ë²„ ìˆ˜ ê³„ì‚° (ì‹¤ì œ í™œë™ ê¸°ì¤€)
        function calculatePeriodActiveMembers(events) {
            const activeUsers = new Set();
            events.forEach(event => {
                // ì‹¤ì œ í™œë™ì´ ìˆëŠ” ì‚¬ìš©ìë§Œ ì¹´ìš´íŠ¸ (ìš”ì²­ ë¹„ìš©ì´ 0ë³´ë‹¤ í¬ê±°ë‚˜ í† í° ê¸°ë°˜ í˜¸ì¶œ)
                if (event.userEmail && event.requestsCosts > 0) {
                    activeUsers.add(event.userEmail);
                }
            });
            console.log(`ì„ íƒëœ ê¸°ê°„ ë‚´ í™œì„± ë©¤ë²„: ${activeUsers.size}ëª…`, Array.from(activeUsers));
            return activeUsers.size;
        }

        // Overview í™œë™ ë¦¬ìŠ¤íŠ¸ë§Œ ì—…ë°ì´íŠ¸ (ê¸°ì¡´ í•¨ìˆ˜ í˜¸í™˜ì„± ìœ ì§€)
        async function updateOverviewActivityList() {
            await updateOverviewWithCurrentFilter();
        }

        // ì „ì²´ ì‹¤ì œ API ë°ì´í„° ìƒˆë¡œê³ ì¹¨
        async function refreshAllRealData() {
            // ë¡œë”© ìƒíƒœ í‘œì‹œ
            showLoadingStatus(true);
           
            // Overviewì™€ Membersë¥¼ ë™ì‹œì— ë¡œë“œí•˜ì—¬ ì‹œê°„ ë‹¨ì¶•
            await Promise.all([
                updateOverviewWithRealData(),
                updateMembersWithRealData()
            ]);
           
            // ë¡œë”© ìƒíƒœ í•´ì œ
            showLoadingStatus(false);
        }

        // ìµœì í™”ëœ ë¡œë”© ìƒíƒœ í‘œì‹œ/í•´ì œ
        function showLoadingStatus(isLoading) {
            const pageTitle = document.getElementById('page-title');
           
            if (isLoading) {
                // Overview ì„¹ì…˜ì—ì„œëŠ” ë¡œë”© ë©”ì‹œì§€ë¥¼ í‘œì‹œí•˜ì§€ ì•ŠìŒ
                if (pageTitle.textContent === 'Overview' || pageTitle.textContent === 'Dashboard Overview') {
                    return;
                }
                pageTitle.innerHTML = 'ğŸ”„ Loading Real API Data...';
            } else {
                // ì›ë˜ ì œëª©ìœ¼ë¡œ ë³µì›
                if (pageTitle.textContent === 'ğŸ”„ Loading Real API Data...') {
                    pageTitle.textContent = 'Dashboard Overview';
                }
            }
        }

        // ì „ì—­ ë³€ìˆ˜
        let currentFilterType = 'total'; // í˜„ì¬ ì„ íƒëœ í•„í„° íƒ€ì…
        let currentActivities = []; // í˜„ì¬ í™œë™ ë°ì´í„°
        let currentMembers = []; // í˜„ì¬ ë©¤ë²„ ë°ì´í„°
        let currentDateRange = null; // í˜„ì¬ ì„ íƒëœ ë‚ ì§œ ë²”ìœ„ (Overviewìš©)
        let currentUsageDateRange = null; // í˜„ì¬ ì„ íƒëœ ë‚ ì§œ ë²”ìœ„ (Usageìš©)
        let currentRawEventsData = []; // í˜„ì¬ Raw Events ì „ì²´ ë°ì´í„°
        let currentRawEventsPage = 1; // í˜„ì¬ Raw Events í˜ì´ì§€
        let currentRawEventsPageSize = 10; // í˜„ì¬ Raw Events í˜ì´ì§€ í¬ê¸°

        // ============================================================================
        // ì„±ëŠ¥ ìµœì í™” ì‹œìŠ¤í…œ (2025.07.29 ì¶”ê°€)
        // ============================================================================









        // API í˜¸ì¶œì„ ìœ„í•œ ì„¤ì •
        const API_CONFIG = {
            baseUrl: 'http://localhost:8000', // ë¡œì»¬ í”„ë¡ì‹œ ì„œë²„
            apiKey: 'key_e46368ce482125bbd568b7d55090c657e30e4b73c824f522cbc9ef9b1bf3f0d3',
            headers: {
                'Content-Type': 'application/json'
            }
        };

        // API í˜¸ì¶œ í•¨ìˆ˜ (ì‹¤ì œ API í˜¸ì¶œ)
        async function callAPI(endpoint, method = 'GET', data = null) {
            try {
                // Basic Auth ì„¤ì •
                const credentials = `${API_CONFIG.apiKey}:`;
                const encodedCredentials = btoa(credentials);
                
                const options = {
                    method: method,
                    headers: {
                        ...API_CONFIG.headers,
                        'Authorization': `Basic ${encodedCredentials}`
                    }
                };

                if (data && method === 'POST') {
                    options.body = JSON.stringify(data);
                }

                console.log(`ì‹¤ì œ Cursor Admin API í˜¸ì¶œ: ${method} ${API_CONFIG.baseUrl}${endpoint}`, data);
               
                const response = await fetch(API_CONFIG.baseUrl + endpoint, options);
               
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`API í˜¸ì¶œ ì‹¤íŒ¨: ${response.status} - ${response.statusText}\n${errorText}`);
                }

                const result = await response.json();
                console.log('ì‹¤ì œ API ì‘ë‹µ ë°ì´í„°:', result);
               
                // API ì‘ë‹µì— ì˜¤ë¥˜ê°€ ìˆëŠ”ì§€ í™•ì¸
                if (result.error) {
                    throw new Error(`API ì˜¤ë¥˜: ${result.error} - ${result.message}`);
                }
               
                return result;
               
            } catch (error) {
                console.error('API í˜¸ì¶œ ì˜¤ë¥˜:', error);
                throw error; // ì˜¤ë¥˜ë¥¼ ë‹¤ì‹œ ë˜ì ¸ì„œ í˜¸ì¶œìê°€ ì²˜ë¦¬í•˜ë„ë¡ í•¨
            }
        }



        // API ì—°ê²° ìƒíƒœ í™•ì¸
        async function checkAPIConnection() {
            try {
                const response = await fetch(API_CONFIG.baseUrl + '/teams/members', {
                    method: 'GET',
                    headers: API_CONFIG.headers
                });
                return response.ok;
            } catch (error) {
                return false;
            }
        }

        // íŒ€ì› ì •ë³´ ê°€ì ¸ì˜¤ê¸°
        async function getTeamMembers() {
            return await callAPI('/teams/members');
        }

        // ì‚¬ìš©ëŸ‰ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        async function getUsageData(startDate, endDate) {
            return await callAPI('/teams/daily-usage-data', 'POST', {
                startDate: startDate,
                endDate: endDate
            });
        }

        // íŒ€ ì§€ì¶œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° (ì „ì²´ ë©¤ë²„)
        async function getTeamSpendingData() {
            try {
                console.log('ğŸ” ì „ì²´ ë©¤ë²„ ì§€ì¶œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì‹œì‘...');
                
                // ì§ì ‘ í° pageSizeë¡œ ëª¨ë“  ë©¤ë²„ ë°ì´í„° ìš”ì²­
                console.log('ğŸ“¡ API í˜¸ì¶œ: /teams/spend (pageSize: 1000)');
                const spendingData = await callAPI('/teams/spend', 'POST', {
                    page: 1,
                    pageSize: 1000
                });
                
                if (!spendingData || !spendingData.teamMemberSpend) {
                    throw new Error('ì§€ì¶œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }
                
                const retrievedCount = spendingData.teamMemberSpend.length;
                const totalMembers = spendingData.totalMembers || retrievedCount;
                const totalPages = spendingData.totalPages || 1;
                
                console.log(`âœ… ì§€ì¶œ ë°ì´í„° ì¡°íšŒ ì™„ë£Œ:`);
                console.log(`   - ì¡°íšŒëœ ë©¤ë²„: ${retrievedCount}ëª…`);
                console.log(`   - ì „ì²´ ë©¤ë²„: ${totalMembers}ëª…`);
                console.log(`   - ì „ì²´ í˜ì´ì§€: ${totalPages}í˜ì´ì§€`);
                
                // ëª¨ë“  ë°ì´í„°ë¥¼ ê°€ì ¸ì™”ëŠ”ì§€ í™•ì¸
                if (retrievedCount < totalMembers && totalPages > 1) {
                    console.log('âš ï¸ ì¶”ê°€ ë°ì´í„°ê°€ ìˆìŠµë‹ˆë‹¤. ë” í° pageSizeë¡œ ì¬ìš”ì²­...');
                    
                    const largerData = await callAPI('/teams/spend', 'POST', {
                        page: 1,
                        pageSize: Math.max(totalMembers + 100, 2000) // ì—¬ìœ ìˆê²Œ ì„¤ì •
                    });
                    
                    if (largerData && largerData.teamMemberSpend && largerData.teamMemberSpend.length > retrievedCount) {
                        console.log(`âœ… ì¬ìš”ì²­ ì„±ê³µ: ${largerData.teamMemberSpend.length}ëª…ì˜ ë°ì´í„° í™•ë³´`);
                        return largerData;
                    }
                }
                
                console.log(`ğŸ¯ ìµœì¢… ê²°ê³¼: ${retrievedCount}ëª…ì˜ ë©¤ë²„ ë°ì´í„° ë°˜í™˜`);
                return spendingData;
                
            } catch (error) {
                console.error('âŒ ì§€ì¶œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', error);
                throw error;
            }
        }

        // í•„í„°ë§ëœ ì´ë²¤íŠ¸ ê°€ì ¸ì˜¤ê¸°
        async function getFilteredEvents(startDate, endDate) {
            return await callAPI('/teams/filtered-usage-events', 'POST', {
                startDate: startDate,
                endDate: endDate,
                pageSize: 1000
            });
        }

        // í˜„ì¬ ì„ íƒëœ í•„í„° ê¸°ê°„ ê°€ì ¸ì˜¤ê¸°
        function getCurrentFilterDays() {
            const activeBtn = document.querySelector('#overview .chart-btn.active');
            if (!activeBtn) return 30; // ê¸°ë³¸ê°’ 30ì¼
           
            const days = activeBtn.getAttribute('data-days');
            return days ? parseInt(days) : 30;
        }

        // ë‚ ì§œë¥¼ epoch millisecondsë¡œ ë³€í™˜
        function getDateRange(days = 7) {
            const endDate = new Date();
            const startDate = new Date();
            startDate.setDate(startDate.getDate() - days);
           
            return {
                startDate: startDate.getTime(),
                endDate: endDate.getTime()
            };
        }

        // Overview ë°ì´í„° ì—…ë°ì´íŠ¸ (ì´ˆê¸° ë¡œë“œìš©)
        async function updateOverviewWithRealData() {
            try {
                console.log('=== ì‹¤ì œ Cursor Admin API ë°ì´í„°ë¡œ Overview ì´ˆê¸° ë¡œë“œ ì‹œì‘ ===');
               
                // ì´ˆê¸°í™”
                currentFilterType = 'total';
                currentDateRange = null;
               
                // í˜„ì¬ í•„í„°ë¡œ ì—…ë°ì´íŠ¸
                await updateOverviewWithCurrentFilter();

                // ì°¨íŠ¸ ë°ì´í„° ìƒì„± (ìµœê·¼ 7ì¼ ì‚¬ìš©ëŸ‰ ë°ì´í„°)
                console.log('ì°¨íŠ¸ìš© ì¼ë³„ ì‚¬ìš©ëŸ‰ ë°ì´í„° API í˜¸ì¶œ ì¤‘...');
                const chartDateRange = getDateRange(7);
                const usageData = await getUsageData(chartDateRange.startDate, chartDateRange.endDate);
               
                if (usageData && usageData.data) {
                    const chartData = createChartData(usageData.data);
                    updateChart(chartData);
                    console.log(`âœ… ${usageData.data.length}ê±´ì˜ ì°¨íŠ¸ ë°ì´í„°ë¥¼ ì²˜ë¦¬í–ˆìŠµë‹ˆë‹¤.`);
                }

                // í•„í„° ê¸°ê°„ í‘œì‹œ
                updateFilterPeriod(chartDateRange.startDate, chartDateRange.endDate);

                // ì´ˆê¸° ë¡œë“œ í›„ ê¸°ë³¸ ì„ íƒëœ 'total' ì¹´ë“œì— ë§ëŠ” ì‹¤ì œ ë°ì´í„° í‘œì‹œ
                console.log('ì´ˆê¸° ë¡œë“œ í›„ ì „ì²´ ë©¤ë²„ ë°ì´í„° í‘œì‹œ');
                await updateMembersByTypeWithRealData('total');
               
                // ì„ íƒ ìƒíƒœì™€ ë°ì´í„° ì¼ì¹˜ í™•ì¸
                console.log(`í˜„ì¬ ì„ íƒëœ íƒ€ì…: ${currentFilterType}`);
                console.log('ì „ì²´ ë©¤ë²„ ì¹´ë“œ ì„ íƒ ìƒíƒœ í™•ì¸ ì™„ë£Œ');

                console.log('=== ì‹¤ì œ API ë°ì´í„°ë¡œ Overview ì´ˆê¸° ë¡œë“œ ì™„ë£Œ! ===');
            } catch (error) {
                console.error('âŒ Overview ì´ˆê¸° ë¡œë“œ ì‹¤íŒ¨:', error);
                alert('Overview ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë„¤íŠ¸ì›Œí¬ ì—°ê²°ê³¼ API ì„œë²„ ìƒíƒœë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.');
            }
        }

        // í†µê³„ ì¹´ë“œ ì—…ë°ì´íŠ¸ (ì‹¤ì œ API ë°ì´í„° ì‚¬ìš©)
        function updateStatsCards(total, active, inactive) {
            const totalBox = document.querySelector('.overview-stat-box[data-type="total"] .stat-number');
            const activeBox = document.querySelector('.overview-stat-box[data-type="active"] .stat-number');
            const inactiveBox = document.querySelector('.overview-stat-box[data-type="inactive"] .stat-number');

            if (totalBox) {
                totalBox.textContent = total;
                console.log(`âœ… ì´ ë©¤ë²„ ìˆ˜ ì—…ë°ì´íŠ¸: ${total}ëª…`);
            }
            if (activeBox) {
                activeBox.textContent = active;
                console.log(`âœ… í™œì„± ë©¤ë²„ ìˆ˜ ì—…ë°ì´íŠ¸: ${active}ëª…`);
            }
            if (inactiveBox) {
                inactiveBox.textContent = inactive;
                console.log(`âœ… ë¹„í™œì„± ë©¤ë²„ ìˆ˜ ì—…ë°ì´íŠ¸: ${inactive}ëª…`);
            }

            // ë©¤ë²„ ìˆ˜ ì¹´ìš´í„° ì—…ë°ì´íŠ¸
            const memberCount = document.getElementById('member-count');
            if (memberCount) {
                memberCount.textContent = `(${total}ëª…)`;
            }
        }

        // ì°¨íŠ¸ ë°ì´í„° ìƒì„± (ì¼ë³„ ì§‘ê³„)
        function createChartData(usageData) {
            const dailyTotals = {};
           
            // ì¼ë³„ë¡œ ëª¨ë“  ì‚¬ìš©ìì˜ í™œë™ ì§‘ê³„
            usageData.forEach(dayData => {
                const dateKey = new Date(dayData.date).toDateString();
               
                if (!dailyTotals[dateKey]) {
                    dailyTotals[dateKey] = {
                        date: dayData.date,
                        totalApplies: 0,
                        totalAccepts: 0,
                        chatRequests: 0,
                        agentRequests: 0
                    };
                }
               
                dailyTotals[dateKey].totalApplies += (dayData.totalApplies || 0);
                dailyTotals[dateKey].totalAccepts += (dayData.totalAccepts || 0);
                dailyTotals[dateKey].chatRequests += (dayData.chatRequests || 0);
                dailyTotals[dateKey].agentRequests += (dayData.agentRequests || 0);
            });
           
            // ì°¨íŠ¸ ë°ì´í„° ìƒì„±
            const chartData = Object.values(dailyTotals)
                .sort((a, b) => a.date - b.date)
                .map(dayTotal => {
                    const date = new Date(dayTotal.date);
                    const activityScore = dayTotal.totalApplies + dayTotal.totalAccepts +
                                        dayTotal.chatRequests + dayTotal.agentRequests;
                   
                    return {
                        date: date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }),
                        activity: activityScore,
                        applies: dayTotal.totalApplies,
                        accepts: dayTotal.totalAccepts,
                        chats: dayTotal.chatRequests,
                        agents: dayTotal.agentRequests
                    };
                });

            console.log('ì°¨íŠ¸ ë°ì´í„° ìƒì„±:', chartData);
            return chartData;
        }

        // ì°¨íŠ¸ ì—…ë°ì´íŠ¸
        function updateChart(chartData) {
            const canvas = document.getElementById('overviewChart');
            if (!canvas || !chartData.length) return;

            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;

            // ê¸°ì¡´ ì°¨íŠ¸ ì§€ìš°ê¸°
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, width, height);

            // ê·¸ë¦¬ë“œ ê·¸ë¦¬ê¸°
            ctx.strokeStyle = '#3a3a3a';
            ctx.lineWidth = 1;
           
            // ì„¸ë¡œ ê·¸ë¦¬ë“œ
            for (let i = 0; i <= chartData.length; i++) {
                const x = (width / chartData.length) * i;
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, height);
                ctx.stroke();
            }

            // ê°€ë¡œ ê·¸ë¦¬ë“œ
            for (let i = 0; i <= 5; i++) {
                const y = (height / 5) * i;
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(width, y);
                ctx.stroke();
            }

            // ë°ì´í„° í¬ì¸íŠ¸ ê³„ì‚°
            const maxActivity = Math.max(...chartData.map(d => d.activity));
            const dataPoints = chartData.map((data, index) => ({
                x: (width / (chartData.length - 1)) * index,
                y: height - (height * (data.activity / maxActivity))
            }));

            // ì„  ê·¸ë˜í”„ ê·¸ë¦¬ê¸°
            if (dataPoints.length > 1) {
                ctx.strokeStyle = '#4a9eff';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.moveTo(dataPoints[0].x, dataPoints[0].y);
               
                for (let i = 1; i < dataPoints.length; i++) {
                    ctx.lineTo(dataPoints[i].x, dataPoints[i].y);
                }
                ctx.stroke();
            }

            // ë°ì´í„° í¬ì¸íŠ¸ ì› ê·¸ë¦¬ê¸°
            dataPoints.forEach(point => {
                ctx.fillStyle = '#4a9eff';
                ctx.beginPath();
                ctx.arc(point.x, point.y, 4, 0, Math.PI * 2);
                ctx.fill();
            });

            // ë‚ ì§œ ë ˆì´ë¸”
            ctx.fillStyle = '#7a7a7a';
            ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'center';
           
            chartData.forEach((data, index) => {
                const x = (width / (chartData.length - 1)) * index;
                ctx.fillText(data.date, x, height - 10);
            });
        }

        // í™œë™ ë¦¬ìŠ¤íŠ¸ ìƒì„± (ì‹¤ì œ í™œë™ì´ ìˆëŠ” ë©¤ë²„ë§Œ, ì •í™•í•œ í†µê³„ ë°˜ì˜)
        function createActivityListWithLastActivity(events, members, memberSpendMap = {}) {
            console.log('=== í™œë™ ë¦¬ìŠ¤íŠ¸ ìƒì„± ì‹œì‘ ===');
            console.log(`ì „ì²´ ì´ë²¤íŠ¸ ìˆ˜: ${events.length}ê°œ`);
            console.log(`ì „ì²´ ë©¤ë²„ ìˆ˜: ${members.length}ëª…`);
            console.log('ì§€ì¶œ ë°ì´í„° ë§µ:', memberSpendMap);
           
            // ì‚¬ìš©ìë³„ ë§ˆì§€ë§‰ í™œë™ ë‚ ì§œ ë° í†µê³„ ê³„ì‚°
            const userActivity = {};
           
            events.forEach(event => {
                const userEmail = event.userEmail;
                const timestamp = parseInt(event.timestamp);
                const requestCost = event.requestsCosts || 0;
               
                if (!userActivity[userEmail]) {
                    userActivity[userEmail] = {
                        lastTimestamp: timestamp,
                        totalRequests: 0,
                        events: []
                    };
                }
               
                // ë§ˆì§€ë§‰ í™œë™ ì‹œê°„ ì—…ë°ì´íŠ¸
                if (timestamp > userActivity[userEmail].lastTimestamp) {
                    userActivity[userEmail].lastTimestamp = timestamp;
                }
               
                // ìš”ì²­ ìˆ˜ë§Œ ëˆ„ì  (ì‹¤ì œ ì§€ì¶œì€ /teams/spend APIì—ì„œ ê°€ì ¸ì˜´)
                userActivity[userEmail].totalRequests += requestCost;
                userActivity[userEmail].events.push(event);
            });
           
            console.log('ì‚¬ìš©ìë³„ í™œë™ í†µê³„:', userActivity);
           
            // ëª¨ë“  ë©¤ë²„ë¥¼ í¬í•¨í•˜ì—¬ í™œë™ ì •ë³´ ìƒì„± (í™œì„± + ë¹„í™œì„±)
            const activities = [];
            let activeCount = 0;
            let inactiveCount = 0;
           
            members.forEach(member => {
                const userStats = userActivity[member.email];
                const spendData = memberSpendMap[member.email] || {};
                
                // ì‹¤ì œ ì§€ì¶œ ë°ì´í„° ì‚¬ìš© (/teams/spend APIì—ì„œ)
                const actualSpend = spendData.spend || 0;
                const premiumRequests = spendData.premiumRequests || 0;
                const hardLimit = spendData.hardLimitOverride || 0;
                const limitDisplay = hardLimit > 0 ? `$${hardLimit}` : '$0';
               
                if (userStats && userStats.totalRequests > 0) {
                    // í™œë™ì´ ìˆëŠ” ë©¤ë²„
                    const lastActivityDate = new Date(userStats.lastTimestamp);
                   
                    // ì˜¤ëŠ˜ ë‚ ì§œ ê¸°ì¤€ìœ¼ë¡œ ì •í™•í•œ ì¼ìˆ˜ ì°¨ì´ ê³„ì‚°
                    const today = new Date();
                    today.setHours(0, 0, 0, 0);
                   
                    const activityDate = new Date(userStats.lastTimestamp);
                    activityDate.setHours(0, 0, 0, 0);
                   
                    const daysDiff = Math.floor((today - activityDate) / (1000 * 60 * 60 * 24));
                   
                    activeCount++;
                   
                    activities.push({
                        date: lastActivityDate.toLocaleDateString('ko-KR', {
                            month: '2-digit',
                            day: '2-digit'
                        }) + ` (${daysDiff === 0 ? 'ì˜¤ëŠ˜' : daysDiff + 'ì¼ ì „'})`,
                        timestamp: userStats.lastTimestamp,
                        email: member.email,
                        name: member.name || 'Unnamed',
                        type: 'active',
                        kind: userStats.events.length > 0 ? userStats.events[0].kindLabel || 'Unknown' : 'Unknown',
                        request: premiumRequests, // Premium Requests ì‚¬ìš©
                        spend: `$${actualSpend.toFixed(2)}`, // ì‹¤ì œ ì§€ì¶œ ë°ì´í„° ì‚¬ìš©
                        limit: limitDisplay
                    });
                } else {
                    // í™œë™ì´ ì—†ëŠ” ë©¤ë²„ (ë¹„í™œì„±)
                    inactiveCount++;
                   
                    activities.push({
                        date: 'No Activity',
                        timestamp: 0,
                        email: member.email,
                        name: member.name || 'Unnamed',
                        type: 'inactive',
                        kind: 'No Activity',
                        request: 0,
                        spend: `$${actualSpend.toFixed(2)}`, // ì‹¤ì œ ì§€ì¶œ ë°ì´í„° ì‚¬ìš©
                        limit: limitDisplay
                    });
                }
            });
           
            console.log(`í™œë™ ë¦¬ìŠ¤íŠ¸ ê²°ê³¼: ì´ ${activities.length}ëª… (í™œì„±: ${activeCount}ëª…, ë¹„í™œì„±: ${inactiveCount}ëª…)`);
           
            // ë§ˆì§€ë§‰ í™œë™ ë‚ ì§œ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ (ìµœì‹ ìˆœ - ë‚´ë¦¼ì°¨ìˆœ)
            return activities.sort((a, b) => {
                return b.timestamp - a.timestamp;
            });
        }

        // ê¸°ì¡´ í™œë™ ë¦¬ìŠ¤íŠ¸ ìƒì„± (í˜¸í™˜ì„± ìœ ì§€)
        function createActivityList(events) {
            return events.slice(0, 20).map(event => {
                const timestamp = new Date(parseInt(event.timestamp));
                return {
                    date: timestamp.toLocaleDateString('ko-KR', {
                        month: '2-digit',
                        day: '2-digit',
                        hour: '2-digit',
                        minute: '2-digit'
                    }),
                    email: event.userEmail || 'Unknown',
                    type: event.isTokenBasedCall ? 'active' : 'inactive',
                    kind: event.kindLabel || 'Unknown',
                    request: event.requestsCosts || 0,
                    spend: event.isTokenBasedCall ?
                        `$${(event.tokenUsage?.totalCents || 0) / 100}` :
                        '$0.00'
                };
            });
        }



        // ì´ë©”ì¼ í´ë¦­ ì‹œ Usage ì„¹ì…˜ìœ¼ë¡œ ì´ë™ ë° ê²€ìƒ‰
        function navigateToUsageWithEmail(email) {
            console.log(`ì´ë©”ì¼ í´ë¦­: ${email} - Usage ì„¹ì…˜ìœ¼ë¡œ ì´ë™ ì‹œì‘`);
            
            // ê²€ìƒ‰ ì˜ˆì • í”Œë˜ê·¸ ì„¤ì • (ìë™ ìƒˆë¡œê³ ì¹¨ ë°©ì§€ìš©)
            window.pendingEmailSearch = email;
            
            // ìˆ˜ë™ìœ¼ë¡œ ì„¹ì…˜ ì „í™˜ (ìë™ ë°ì´í„° ë¡œë“œ ë°©ì§€)
            const usageMenuItem = document.querySelector('.menu-item[data-section="usage"]');
            const allMenuItems = document.querySelectorAll('.menu-item');
            const allSections = document.querySelectorAll('.content-section');
            
            // ë©”ë‰´ ìƒíƒœ ì—…ë°ì´íŠ¸
            allMenuItems.forEach(menu => menu.classList.remove('active'));
            if (usageMenuItem) {
                usageMenuItem.classList.add('active');
            }
            
            // ì„¹ì…˜ ì „í™˜
            allSections.forEach(section => section.classList.remove('active'));
            const usageSection = document.getElementById('usage');
            if (usageSection) {
                usageSection.classList.add('active');
            }
            
            // í˜ì´ì§€ ì œëª© ì—…ë°ì´íŠ¸
            const pageTitle = document.getElementById('page-title');
            if (pageTitle) {
                pageTitle.textContent = 'Usage Analytics';
            }
            
            // Usage ë°ì´í„°ê°€ ì´ë¯¸ ë¡œë“œë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
            const hasData = currentRawEventsData && currentRawEventsData.length > 0;
            
            if (hasData) {
                // ë°ì´í„°ê°€ ì´ë¯¸ ìˆìœ¼ë©´ ì¦‰ì‹œ ê²€ìƒ‰ ì‹¤í–‰
                executeEmailSearch(email);
            } else {
                // ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ë¨¼ì € ë¡œë“œí•œ í›„ ê²€ìƒ‰
                console.log('Usage ë°ì´í„°ë¥¼ ë¨¼ì € ë¡œë“œí•©ë‹ˆë‹¤...');
                updateUsageWithCurrentFilter(30).then(() => {
                    // ë°ì´í„° ë¡œë“œ ì™„ë£Œ í›„ ê²€ìƒ‰ ì‹¤í–‰
                    setTimeout(() => {
                        executeEmailSearch(email);
                    }, 500);
                }).catch(error => {
                    console.error('Usage ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                    // ë¡œë“œ ì‹¤íŒ¨í•´ë„ ê²€ìƒ‰ì€ ì‹œë„
                    executeEmailSearch(email);
                });
            }
            
            console.log(`ğŸ“§ ì´ë©”ì¼ í´ë¦­ ì²˜ë¦¬ ì™„ë£Œ: ${email}`);
        }
        
        // ì´ë©”ì¼ ê²€ìƒ‰ ì‹¤í–‰ í•¨ìˆ˜
        function executeEmailSearch(email) {
            const searchBox = document.querySelector('#usage .search-box');
            if (searchBox) {
                searchBox.value = email;
                filterUsageMembers(email);
                console.log(`âœ… ì´ë©”ì¼ ê²€ìƒ‰ ì™„ë£Œ: ${email}`);
                
                // ê²€ìƒ‰ ì™„ë£Œ í›„ í”Œë˜ê·¸ ì œê±°
                delete window.pendingEmailSearch;
            } else {
                console.error('âŒ Usage ì„¹ì…˜ì˜ ê²€ìƒ‰ì°½ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
        }

        // í™œë™ ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
        function updateActivityList(activities) {
            const memberList = document.getElementById('member-list');
            if (!memberList) return;

            const header = `
                <div class="member-list-header">
                    <div>ë§ˆì§€ë§‰ í™œë™</div>
                    <div>ì‚¬ìš©ì</div>
                    <div>ìƒíƒœ</div>
                    <div>í™œë™ ìœ í˜•</div>
                    <div>ìš”ì²­ ìˆ˜</div>
                    <div>ë¹„ìš©</div>
                    <div>ì œí•œ</div>
                </div>
            `;

            if (!activities || activities.length === 0) {
                memberList.innerHTML = header + '<div class="member-item"><div colspan="7">í™œë™ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</div></div>';
                return;
            }

            const activitiesHtml = activities.map(activity => `
                <div class="member-item">
                    <div class="member-date">${activity.date}</div>
                    <div class="member-email clickable-email" title="View usage for ${activity.email}" onclick="navigateToUsageWithEmail('${activity.email}')">${activity.email}</div>
                    <div class="member-type ${activity.type}">${activity.type === 'active' ? 'í™œì„±' : 'ë¹„í™œì„±'}</div>
                    <div class="member-kind">${activity.kind}</div>
                    <div class="member-request">${activity.request}</div>
                    <div class="member-spend">${activity.spend}</div>
                    <div class="member-limit">${activity.limit || '$0'}</div>
                </div>
            `).join('');

            memberList.innerHTML = header + activitiesHtml;
           
            // í†µê³„ ì—…ë°ì´íŠ¸
            const activeCount = activities.filter(a => a.type === 'active').length;
            const totalRequests = activities.reduce((sum, a) => sum + (typeof a.request === 'number' ? a.request : 0), 0);
           
            console.log(`í™œë™ ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸: ì´ ${activities.length}ëª…, í™œì„± ${activeCount}ëª…, ì´ ìš”ì²­ ${totalRequests}ê±´`);
        }

        // í•„í„° ê¸°ê°„ ì—…ë°ì´íŠ¸
        function updateFilterPeriod(startDate, endDate) {
            const start = new Date(startDate).toLocaleDateString('en-US', {
                month: 'short',
                day: 'numeric'
            });
            const end = new Date(endDate).toLocaleDateString('en-US', {
                month: 'short',
                day: 'numeric'
            });
           
            const dateFilterBtn = document.querySelector('.date-filter-btn');
            if (dateFilterBtn) {
                dateFilterBtn.textContent = `${start} - ${end}`;
            }
        }



        // ë©¤ë²„ í…Œì´ë¸”ì„ ì‹¤ì œ API ë°ì´í„°ë¡œ ì—…ë°ì´íŠ¸
        async function updateMembersWithRealData() {
            try {
                console.log('=== ì‹¤ì œ Cursor Admin API ë°ì´í„°ë¡œ ë©¤ë²„ í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì‹œì‘ ===');
               
                // 1. ì‹¤ì œ íŒ€ì› ì •ë³´ ê°€ì ¸ì˜¤ê¸°
                console.log('1. íŒ€ì› ì •ë³´ API í˜¸ì¶œ ì¤‘...');
                const membersData = await getTeamMembers();
                console.log('íŒ€ì› ë°ì´í„° ì‘ë‹µ:', membersData);
               
                if (!membersData || !membersData.teamMembers) {
                    throw new Error('íŒ€ì› ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }

                console.log(`âœ… ì´ ${membersData.teamMembers.length}ëª…ì˜ íŒ€ì› ì •ë³´ë¥¼ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.`);

                // 2. ì‹¤ì œ ì§€ì¶œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° (ì˜¬ë°”ë¥¸ API ì‚¬ìš©)
                console.log('2. íŒ€ ì§€ì¶œ ë°ì´í„° API í˜¸ì¶œ ì¤‘... (/teams/spend)');
                const spendingData = await getTeamSpendingData();
                console.log('ì§€ì¶œ ë°ì´í„° ì‘ë‹µ:', spendingData);
               
                if (!spendingData || !spendingData.teamMemberSpend) {
                    throw new Error('ì§€ì¶œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }

                console.log(`âœ… ${spendingData.teamMemberSpend.length}ëª…ì˜ ì§€ì¶œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.`);
                console.log(`ğŸ“Š API ì‘ë‹µ ì •ë³´: ì´ ë©¤ë²„ ${spendingData.totalMembers || 'ì •ë³´ì—†ìŒ'}ëª…, ì´ í˜ì´ì§€ ${spendingData.totalPages || 'ì •ë³´ì—†ìŒ'}ê°œ`);
                
                // ì‹¤ì œë¡œ ê°€ì ¸ì˜¨ ë©¤ë²„ ìˆ˜ì™€ API ë©¤ë²„ ìˆ˜ ë¹„êµ ë¡œê¹…
                if (membersData.teamMembers.length !== spendingData.teamMemberSpend.length) {
                    console.log(`âš ï¸ ë©¤ë²„ ìˆ˜ ë¶ˆì¼ì¹˜: ë©¤ë²„ API ${membersData.teamMembers.length}ëª… vs ì§€ì¶œ API ${spendingData.teamMemberSpend.length}ëª…`);
                }

                // 3. ì´ë©”ì¼ ê¸°ì¤€ìœ¼ë¡œ ë©¤ë²„ì™€ ì§€ì¶œ ë°ì´í„° ë§¤í•‘
                console.log('3. ë©¤ë²„ì™€ ì§€ì¶œ ë°ì´í„° ë§¤í•‘ ì¤‘...');
                const memberSpendMap = {};
               
                spendingData.teamMemberSpend.forEach(spendInfo => {
                    memberSpendMap[spendInfo.email] = {
                        premiumRequests: spendInfo.fastPremiumRequests || 0,
                        spend: (spendInfo.spendCents || 0) / 100, // centsë¥¼ dollarsë¡œ ë³€í™˜
                        hardLimitOverride: spendInfo.hardLimitOverrideDollars || 0
                    };
                });

                console.log('ì§€ì¶œ ë°ì´í„° ë§¤í•‘ ê²°ê³¼:', memberSpendMap);

                // 4. ë©¤ë²„ í…Œì´ë¸” ì—…ë°ì´íŠ¸
                console.log('4. ë©¤ë²„ í…Œì´ë¸” UI ì—…ë°ì´íŠ¸ ì¤‘...');
                updateMembersTable(membersData.teamMembers, memberSpendMap);
               
                console.log('=== ì‹¤ì œ API ë°ì´í„°ë¡œ ë©¤ë²„ í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì™„ë£Œ! ===');
               
            } catch (error) {
                console.error('âŒ ì‹¤ì œ API ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                
                // ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼
                alert(`ì‹¤ì œ API ë°ì´í„° ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤:\n${error.message}\n\ní”„ë¡ì‹œ ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•˜ì„¸ìš”.`);
            }
        }

        // ë©¤ë²„ í…Œì´ë¸” ì—…ë°ì´íŠ¸ (ì‹¤ì œ ì§€ì¶œ ë°ì´í„° ì‚¬ìš©)
        function updateMembersTable(members, memberSpendMap) {
            const dataTable = document.querySelector('#members .data-table');
            if (!dataTable) {
                console.error('âŒ ë©¤ë²„ í…Œì´ë¸”ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            console.log(`ğŸ”„ ë©¤ë²„ í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì‹œì‘: ${members.length}ëª…ì˜ ë©¤ë²„ ë°ì´í„°`);
            console.log('ğŸ“Š ì§€ì¶œ ë°ì´í„° ë§¤í•‘ ì •ë³´:', Object.keys(memberSpendMap));

            // í—¤ë”ëŠ” ìœ ì§€
            const header = dataTable.querySelector('.table-header');
           
            // ê¸°ì¡´ í–‰ë“¤ê³¼ ë¡œë”© ë©”ì‹œì§€ ì œê±°
            const existingRows = dataTable.querySelectorAll('.table-row');
            const loadingMessages = dataTable.querySelectorAll('div[style*="padding: 20px"]');
            console.log(`ğŸ—‘ï¸ ê¸°ì¡´ ${existingRows.length}ê°œ í–‰ê³¼ ${loadingMessages.length}ê°œ ë¡œë”© ë©”ì‹œì§€ ì œê±°`);
            existingRows.forEach(row => row.remove());
            loadingMessages.forEach(msg => msg.remove());
           
            // ë©¤ë²„ ì •ë³´ì™€ ì‹¤ì œ ì§€ì¶œ ë°ì´í„° ê²°í•©
            const membersWithSpending = members.map(member => {
                const spendData = memberSpendMap[member.email] || {
                    premiumRequests: 0,
                    spend: 0,
                    hardLimitOverride: 0
                };
               
                return {
                    ...member,
                    spendData: spendData
                };
            });
           
            console.log(`ğŸ“‹ ì²˜ë¦¬ëœ ë©¤ë²„ ë°ì´í„°: ${membersWithSpending.length}ëª…`);
            membersWithSpending.forEach((member, index) => {
                console.log(`   ${index + 1}. ${member.name || 'Unnamed'} (${member.email}) - Premium: ${member.spendData.premiumRequests}, Spend: $${member.spendData.spend}`);
            });
           
            // Premium Requests ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ (ë†’ì€ ìˆœ)
            membersWithSpending.sort((a, b) => b.spendData.premiumRequests - a.spendData.premiumRequests);
           
            // ìƒˆë¡œìš´ í–‰ë“¤ ì¶”ê°€
            let addedRows = 0;
            membersWithSpending.forEach(member => {
                const row = document.createElement('div');
                row.className = 'table-row';
               
                const roleBadgeClass = member.role === 'owner' ? 'admin' : '';
                const roleText = member.role === 'owner' ? 'Admin' : 'Member';
               
                // Premium Requestsì— ë”°ë¥¸ ìƒ‰ìƒ í‘œì‹œ
                const requestColor = member.spendData.premiumRequests > 100 ? '#4caf50' :
                                   member.spendData.premiumRequests > 20 ? '#ff9800' :
                                   member.spendData.premiumRequests > 0 ? '#2196f3' : '#f44336';
               
                row.innerHTML = `
                    <div>${member.name || 'Unnamed'}</div>
                    <div class="clickable-email" title="View usage for ${member.email}" onclick="navigateToUsageWithEmail('${member.email}')">${member.email}</div>
                    <div style="color: ${requestColor}; font-weight: 600;">${member.spendData.premiumRequests}</div>
                    <div>$${member.spendData.spend.toFixed(2)}</div>
                    <div><span class="role-badge ${roleBadgeClass}">${roleText}</span></div>
                    <div>â‹¯</div>
                `;
               
                dataTable.appendChild(row);
                addedRows++;
            });
           
            console.log(`âœ… í…Œì´ë¸”ì— ${addedRows}ê°œ í–‰ ì¶”ê°€ ì™„ë£Œ`);
            
            // ë°ì´í„°ê°€ ì—†ì„ ë•Œ ë©”ì‹œì§€ í‘œì‹œ
            if (addedRows === 0) {
                const noDataRow = document.createElement('div');
                noDataRow.style.cssText = 'padding: 20px; text-align: center; color: #7a7a7a; background-color: #1a1a1a; grid-column: 1 / -1;';
                noDataRow.textContent = 'ë©¤ë²„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.';
                dataTable.appendChild(noDataRow);
                console.log('ğŸ“ ë°ì´í„° ì—†ìŒ ë©”ì‹œì§€ í‘œì‹œ');
            }
           
            // í†µê³„ ì •ë³´ í‘œì‹œ
            const totalRequests = membersWithSpending.reduce((sum, member) => sum + member.spendData.premiumRequests, 0);
            const totalSpend = membersWithSpending.reduce((sum, member) => sum + member.spendData.spend, 0);
            const activeMembers = membersWithSpending.filter(member => member.spendData.premiumRequests > 0).length;
           
            console.log(`ğŸ“Š ë©¤ë²„ í†µê³„ (ì‹¤ì œ API ë°ì´í„°):`);
            console.log(`   - ì´ ë©¤ë²„: ${membersWithSpending.length}ëª…`);
            console.log(`   - í™œì„± ë©¤ë²„: ${activeMembers}ëª… (Premium Requests > 0)`);
            console.log(`   - ì´ Premium Requests: ${totalRequests}ê±´`);
            console.log(`   - ì´ ì§€ì¶œ: $${totalSpend.toFixed(2)}`);
        }

        // ë©¤ë²„ ê²€ìƒ‰ ê¸°ëŠ¥
        function filterMembers(searchTerm) {
            const rows = document.querySelectorAll('#members .table-row');
            const searchLower = searchTerm.toLowerCase();
           
            rows.forEach(row => {
                const name = row.children[0].textContent.toLowerCase();
                const email = row.children[1].textContent.toLowerCase();
               
                if (name.includes(searchLower) || email.includes(searchLower)) {
                    row.style.display = 'grid';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        // Usage ì„¹ì…˜ í˜„ì¬ í•„í„°ë¡œ ì—…ë°ì´íŠ¸
        async function updateUsageWithCurrentFilter(days = 30) {
            try {
                console.log(`=== Usage ì„¹ì…˜ ${days}ì¼ í•„í„°ë¡œ ì—…ë°ì´íŠ¸ ì‹œì‘ ===`);
                
                // ë‚ ì§œ ë²”ìœ„ ê³„ì‚°
                const dateRange = getDateRange(days);
                currentUsageDateRange = null; // ì‚¬ìš©ì ì •ì˜ ë²”ìœ„ ì´ˆê¸°í™”
                
                await updateUsageWithDateRange(dateRange.startDate, dateRange.endDate);
                
                console.log(`=== Usage ì„¹ì…˜ ${days}ì¼ í•„í„° ì—…ë°ì´íŠ¸ ì™„ë£Œ ===`);
            } catch (error) {
                console.error('âŒ Usage í•„í„° ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);
            }
        }

        // Usage ì„¹ì…˜ íŠ¹ì • ë‚ ì§œ ë²”ìœ„ë¡œ ì—…ë°ì´íŠ¸
        async function updateUsageWithDateRange(startDate, endDate) {
            try {
                console.log(`=== Usage ì„¹ì…˜ ë‚ ì§œ ë²”ìœ„ ì—…ë°ì´íŠ¸ ì‹œì‘: ${new Date(startDate).toLocaleDateString()} ~ ${new Date(endDate).toLocaleDateString()} ===`);
                
                // ë¡œë”© ìƒíƒœ í‘œì‹œ
                showUsageLoadingState(true);
                
                // API ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                const [membersData, eventsData, usageData, spendingData] = await Promise.all([
                    getTeamMembers(),
                    getFilteredEvents(startDate, endDate),
                    getUsageData(startDate, endDate),
                    getTeamSpendingData()
                ]);
                
                // Usage ì¹´ë“œ ì—…ë°ì´íŠ¸
                updateUsageCards(usageData, eventsData);
                
                // ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ ì—…ë°ì´íŠ¸
                updateUserCumulativeInfo(membersData, eventsData, spendingData, startDate, endDate);
                
                // All Raw Events ì—…ë°ì´íŠ¸ (í˜ì´ì§€ ì´ˆê¸°í™”)
                currentRawEventsPage = 1;
                updateRawEventsTable(eventsData);
                
                // ë¡œë”© ìƒíƒœ í•´ì œ
                showUsageLoadingState(false);
                
                console.log(`=== Usage ì„¹ì…˜ ë‚ ì§œ ë²”ìœ„ ì—…ë°ì´íŠ¸ ì™„ë£Œ ===`);
            } catch (error) {
                console.error('âŒ Usage ë‚ ì§œ ë²”ìœ„ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);
                showUsageLoadingState(false);
            }
        }

        // Usage ë¡œë”© ìƒíƒœ í‘œì‹œ/í•´ì œ
        function showUsageLoadingState(isLoading) {
            const usageCards = document.querySelectorAll('#usage .usage-card-number');
            const userTables = document.querySelectorAll('#usage .user-cumulative-info');
            
            if (isLoading) {
                usageCards.forEach(card => {
                    card.textContent = '-';
                });
                userTables.forEach(table => {
                    table.style.opacity = '0.5';
                });
            } else {
                userTables.forEach(table => {
                    table.style.opacity = '1';
                });
            }
        }

        // Usage ì¹´ë“œ ì—…ë°ì´íŠ¸
        function updateUsageCards(usageData, eventsData) {
            const cards = document.querySelectorAll('#usage .usage-card-number');
            
            if (!usageData || !usageData.data) {
                cards[0].textContent = '0'; // Total Users
                cards[1].textContent = '0'; // Lines of Agent Edits
                cards[2].textContent = '0'; // Tabs Accepted
                cards[3].textContent = '0'; // Chats
                console.log('ğŸ“Š Usage ì¹´ë“œ ì—…ë°ì´íŠ¸: ë°ì´í„° ì—†ìŒ - ëª¨ë“  ê°’ì„ 0ìœ¼ë¡œ ì„¤ì •');
                return;
            }
            
            // ì‹¤ì œ í™œë™í•œ ì‚¬ìš©ì ìˆ˜ ê³„ì‚°
            const activeUsers = new Set();
            if (eventsData && eventsData.usageEvents) {
                eventsData.usageEvents.forEach(event => {
                    if (event.userEmail && event.requestsCosts > 0) {
                        activeUsers.add(event.userEmail);
                    }
                });
            }
            
            // ì§‘ê³„ ê³„ì‚°
            let totalLinesAdded = 0;
            let totalLinesAccepted = 0;
            let totalTabsAccepted = 0;
            let totalChats = 0;
            
            usageData.data.forEach(dayData => {
                totalLinesAdded += (dayData.totalLinesAdded || 0);
                totalLinesAccepted += (dayData.acceptedLinesAdded || 0);
                totalTabsAccepted += (dayData.totalTabsAccepted || 0);
                totalChats += (dayData.chatRequests || 0);
            });
            
            // ì¹´ë“œ ì—…ë°ì´íŠ¸
            cards[0].textContent = activeUsers.size.toLocaleString(); // Total Users
            cards[1].textContent = (totalLinesAdded + totalLinesAccepted).toLocaleString(); // Lines of Agent Edits
            cards[2].textContent = totalTabsAccepted.toLocaleString(); // Tabs Accepted
            cards[3].textContent = totalChats.toLocaleString(); // Chats
            
            console.log(`Usage ì¹´ë“œ ì—…ë°ì´íŠ¸: ì‚¬ìš©ì ${activeUsers.size}ëª…, ë¼ì¸ ${totalLinesAdded + totalLinesAccepted}ì¤„, íƒ­ ${totalTabsAccepted}ê°œ, ì±„íŒ… ${totalChats}ê±´`);
        }

        // ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ ì—…ë°ì´íŠ¸
        function updateUserCumulativeInfo(membersData, eventsData, spendingData, startDate, endDate) {
            const tableContainer = document.querySelector('#usage .user-cumulative-info');
            if (!tableContainer || !membersData || !membersData.teamMembers) return;
            
            console.log('=== ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ ì—…ë°ì´íŠ¸ ì‹œì‘ ===');
            
            // ì§€ì¶œ ë°ì´í„° ë§¤í•‘
            const memberSpendMap = {};
            if (spendingData && spendingData.teamMemberSpend) {
                spendingData.teamMemberSpend.forEach(spendInfo => {
                    memberSpendMap[spendInfo.email] = {
                        premiumRequests: spendInfo.fastPremiumRequests || 0,
                        spend: (spendInfo.spendCents || 0) / 100,
                        hardLimitOverride: spendInfo.hardLimitOverrideDollars || 0
                    };
                });
            }
            
            // ì„ íƒëœ ê¸°ê°„ ë‚´ ì‚¬ìš©ìë³„ í™œë™ í†µê³„ ê³„ì‚°
            const userPeriodStats = {};
            if (eventsData && eventsData.usageEvents) {
                eventsData.usageEvents.forEach(event => {
                    const userEmail = event.userEmail;
                    const timestamp = parseInt(event.timestamp);
                    
                    if (!userPeriodStats[userEmail]) {
                        userPeriodStats[userEmail] = {
                            lastTimestamp: timestamp,
                            periodRequests: 0
                        };
                    }
                    
                    // ë§ˆì§€ë§‰ í™œë™ ì‹œê°„ ì—…ë°ì´íŠ¸
                    if (timestamp > userPeriodStats[userEmail].lastTimestamp) {
                        userPeriodStats[userEmail].lastTimestamp = timestamp;
                    }
                    
                    // ì„ íƒëœ ê¸°ê°„ ë‚´ ìš”ì²­ ìˆ˜ ëˆ„ì 
                    userPeriodStats[userEmail].periodRequests += (event.requestsCosts || 0);
                });
            }
            
            // ì‚¬ìš©ì ì •ë³´ ìƒì„±
            const userInfos = membersData.teamMembers.map(member => {
                const spendData = memberSpendMap[member.email] || {};
                const periodStats = userPeriodStats[member.email] || {};
                const actualSpend = spendData.spend || 0;
                const totalPremiumRequests = spendData.premiumRequests || 0; // ì „ì²´ ê¸°ê°„ Premium Requests
                const periodRequests = periodStats.periodRequests || 0; // ì„ íƒëœ ê¸°ê°„ ë‚´ ìš”ì²­ ìˆ˜
                
                // ë§ˆì§€ë§‰ í™œë™ ë‚ ì§œ ê³„ì‚°
                let lastActivityText = 'No Activity';
                if (periodStats.lastTimestamp) {
                    const lastDate = new Date(periodStats.lastTimestamp);
                    const today = new Date();
                    const daysDiff = Math.floor((today - lastDate) / (1000 * 60 * 60 * 24));
                    
                    if (daysDiff === 0) {
                        lastActivityText = 'ì˜¤ëŠ˜';
                    } else if (daysDiff === 1) {
                        lastActivityText = 'ì–´ì œ';
                    } else {
                        lastActivityText = `${daysDiff}ì¼ ì „`;
                    }
                }
                
                return {
                    name: member.name || 'Unnamed',
                    email: member.email,
                    role: member.role,
                    totalPremiumRequests: totalPremiumRequests, // ì „ì²´ Premium Requests
                    periodRequests: periodRequests, // ì„ íƒëœ ê¸°ê°„ ë‚´ ìš”ì²­ ìˆ˜
                    spend: actualSpend,
                    lastActivity: lastActivityText,
                    lastTimestamp: periodStats.lastTimestamp || 0
                };
            });
            
            // 1. Last Act ìµœì‹ ìˆœ, 2. Request ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ ì •ë ¬
            userInfos.sort((a, b) => {
                // 1ì°¨ ì •ë ¬: Last Act (ë§ˆì§€ë§‰ í™œë™) ìµœì‹ ìˆœ - timestamp ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ
                if (b.lastTimestamp !== a.lastTimestamp) {
                    return b.lastTimestamp - a.lastTimestamp;
                }
                // 2ì°¨ ì •ë ¬: Request ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ
                return b.periodRequests - a.periodRequests;
            });
            
            // í…Œì´ë¸” ì—…ë°ì´íŠ¸
            const tableHtml = `
                <div class="user-cumulative-header">ğŸ“Š ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ (${new Date(startDate).toLocaleDateString()} ~ ${new Date(endDate).toLocaleDateString()})</div>
                <div class="user-cumulative-table">
                    <div>NAME</div>
                    <div>EMAIL</div>
                    <div>ROLE</div>
                    <div>REQUEST</div>
                    <div>SPEND</div>
                    <div>LAST ACT</div>
                </div>
                ${userInfos.map(user => `
                    <div class="user-cumulative-row">
                        <div>${user.name}</div>
                        <div class="user-email">${user.email}</div>
                        <div><span class="role-badge ${user.role === 'owner' ? 'admin' : ''}">${user.role === 'owner' ? 'Admin' : 'Member'}</span></div>
                        <div style="font-weight: 600;">${user.periodRequests}</div>
                        <div>$${user.spend.toFixed(2)}</div>
                        <div>${user.lastActivity}</div>
                    </div>
                `).join('')}
            `;
            
            tableContainer.innerHTML = tableHtml;
            
            console.log(`ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ ì—…ë°ì´íŠ¸ ì™„ë£Œ: ${userInfos.length}ëª…`);
            console.log(`ì„ íƒëœ ê¸°ê°„ ë‚´ ì´ ìš”ì²­ ìˆ˜: ${userInfos.reduce((sum, user) => sum + user.periodRequests, 0)}ê±´`);
        }

        // All Raw Events í…Œì´ë¸” ì—…ë°ì´íŠ¸
        function updateRawEventsTable(eventsData) {
            const tableContainer = document.querySelector('#usage .user-cumulative-info:last-child');
            if (!tableContainer || !eventsData || !eventsData.usageEvents) return;
            
            // ê²€ìƒ‰ ì¤‘ì¸ ê²½ìš° ìë™ ì—…ë°ì´íŠ¸ ë°©ì§€
            if (window.pendingEmailSearch) {
                console.log(`â³ ì´ë©”ì¼ ê²€ìƒ‰ ëŒ€ê¸° ì¤‘ (${window.pendingEmailSearch}) - Raw Events í…Œì´ë¸” ìë™ ì—…ë°ì´íŠ¸ ê±´ë„ˆëœ€`);
                // ë°ì´í„°ëŠ” ì €ì¥í•˜ë˜ í…Œì´ë¸” ë Œë”ë§ì€ í•˜ì§€ ì•ŠìŒ
                currentRawEventsData = eventsData.usageEvents.sort((a, b) => {
                    const timestampA = parseInt(a.timestamp) || 0;
                    const timestampB = parseInt(b.timestamp) || 0;
                    return timestampB - timestampA; // ë‚´ë¦¼ì°¨ìˆœ (ìµœì‹  â†’ ê³¼ê±°)
                });
                return;
            }
            
            // ì „ì²´ ë°ì´í„° ì €ì¥ ë° DATE ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬ (ìµœì‹ ìˆœ)
            currentRawEventsData = eventsData.usageEvents.sort((a, b) => {
                const timestampA = parseInt(a.timestamp) || 0;
                const timestampB = parseInt(b.timestamp) || 0;
                return timestampB - timestampA; // ë‚´ë¦¼ì°¨ìˆœ (ìµœì‹  â†’ ê³¼ê±°)
            });
            
            // í˜ì´ì§€ë„¤ì´ì…˜ ì ìš©
            renderRawEventsTableWithPagination();
        }

        // Raw Events í…Œì´ë¸” í˜ì´ì§€ë„¤ì´ì…˜ê³¼ í•¨ê»˜ ë Œë”ë§
        function renderRawEventsTableWithPagination() {
            const tableContainer = document.querySelector('#usage .user-cumulative-info:last-child');
            if (!tableContainer || !currentRawEventsData.length) return;
            
            const totalEvents = currentRawEventsData.length;
            const totalPages = Math.ceil(totalEvents / currentRawEventsPageSize);
            const startIndex = (currentRawEventsPage - 1) * currentRawEventsPageSize;
            const endIndex = Math.min(startIndex + currentRawEventsPageSize, totalEvents);
            const pageEvents = currentRawEventsData.slice(startIndex, endIndex);
            
            const tableHtml = `
                <div class="user-cumulative-header" style="display: flex; justify-content: space-between; align-items: center;">
                    <span>ğŸ“‹ All Raw Events (${startIndex + 1}-${endIndex} of ${totalEvents})</span>
                    <select id="rawEventsPageSize" onchange="changeRawEventsPageSize(this.value)" style="background: #3a3a3a; color: #fff; border: 1px solid #4a4a4a; padding: 5px 10px; border-radius: 4px; font-size: 12px;">
                        <option value="10" ${currentRawEventsPageSize === 10 ? 'selected' : ''}>10ê°œ ë³´ê¸°</option>
                        <option value="20" ${currentRawEventsPageSize === 20 ? 'selected' : ''}>20ê°œ ë³´ê¸°</option>
                        <option value="30" ${currentRawEventsPageSize === 30 ? 'selected' : ''}>30ê°œ ë³´ê¸°</option>
                        <option value="50" ${currentRawEventsPageSize === 50 ? 'selected' : ''}>50ê°œ ë³´ê¸°</option>
                        <option value="100" ${currentRawEventsPageSize === 100 ? 'selected' : ''}>100ê°œ ë³´ê¸°</option>
                    </select>
                </div>
                <div class="user-cumulative-table">
                    <div>DATE</div>
                    <div>USER</div>
                    <div>KIND</div>
                    <div>MAX_MODEL</div>
                    <div>MODEL</div>
                    <div>COST</div>
                </div>
                ${pageEvents.map(event => {
                    const date = new Date(parseInt(event.timestamp));
                    const dateText = date.toLocaleDateString('en-US', { 
                        month: 'short', 
                        day: 'numeric', 
                        hour: '2-digit', 
                        minute: '2-digit' 
                    });
                    
                    return `
                        <div class="user-cumulative-row">
                            <div>${dateText}</div>
                            <div class="user-email">${event.userEmail}</div>
                            <div>${(event.kindLabel || 'Unknown').substring(0, 15)}${(event.kindLabel || '').length > 15 ? '...' : ''}</div>
                            <div>${event.maxMode ? 'Yes' : 'No'}</div>
                            <div>${(event.model || 'auto').substring(0, 10)}${(event.model || '').length > 10 ? '...' : ''}</div>
                            <div>${event.requestsCosts || 0}</div>
                        </div>
                    `;
                }).join('')}
                ${totalPages > 1 ? `
                    <div style="padding: 15px 20px; background-color: #2a2a2a; border-top: 1px solid #3a3a3a; display: flex; justify-content: center; align-items: center; gap: 10px;">
                        ${generateRawEventsPagination(totalPages)}
                    </div>
                ` : ''}
            `;
            
            tableContainer.innerHTML = tableHtml;
            
            console.log(`Raw Events í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì™„ë£Œ: í˜ì´ì§€ ${currentRawEventsPage}/${totalPages}, ${pageEvents.length}ê°œ ì´ë²¤íŠ¸ í‘œì‹œ`);
        }

        // Raw Events í˜ì´ì§€ë„¤ì´ì…˜ ìƒì„±
        function generateRawEventsPagination(totalPages) {
            let pagination = '';
            
            // ì´ì „ ë²„íŠ¼
            if (currentRawEventsPage > 1) {
                pagination += `<button onclick="changeRawEventsPage(${currentRawEventsPage - 1})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">â€¹</button>`;
            }
            
            // í˜ì´ì§€ ë²ˆí˜¸ë“¤
            let startPage = Math.max(1, currentRawEventsPage - 2);
            let endPage = Math.min(totalPages, currentRawEventsPage + 2);
            
            // ì²« í˜ì´ì§€ê°€ ë²”ìœ„ì— ì—†ìœ¼ë©´ ì¶”ê°€
            if (startPage > 1) {
                pagination += `<button onclick="changeRawEventsPage(1)" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">1</button>`;
                if (startPage > 2) {
                    pagination += `<span style="color: #7a7a7a; padding: 0 5px;">...</span>`;
                }
            }
            
            // í˜„ì¬ ë²”ìœ„ì˜ í˜ì´ì§€ë“¤
            for (let i = startPage; i <= endPage; i++) {
                const isActive = i === currentRawEventsPage;
                pagination += `<button onclick="changeRawEventsPage(${i})" style="background: ${isActive ? '#4a9eff' : '#3a3a3a'}; border: 1px solid ${isActive ? '#4a9eff' : '#4a4a4a'}; color: ${isActive ? 'white' : '#e1e1e1'}; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: ${isActive ? '600' : 'normal'};">${i}</button>`;
            }
            
            // ë§ˆì§€ë§‰ í˜ì´ì§€ê°€ ë²”ìœ„ì— ì—†ìœ¼ë©´ ì¶”ê°€
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    pagination += `<span style="color: #7a7a7a; padding: 0 5px;">...</span>`;
                }
                pagination += `<button onclick="changeRawEventsPage(${totalPages})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">${totalPages}</button>`;
            }
            
            // ë‹¤ìŒ ë²„íŠ¼
            if (currentRawEventsPage < totalPages) {
                pagination += `<button onclick="changeRawEventsPage(${currentRawEventsPage + 1})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">â€º</button>`;
            }
            
            return pagination;
        }

        // Raw Events í˜ì´ì§€ ë³€ê²½
        function changeRawEventsPage(page) {
            currentRawEventsPage = page;
            renderRawEventsTableWithPagination();
        }

        // Raw Events í˜ì´ì§€ í¬ê¸° ë³€ê²½
        function changeRawEventsPageSize(pageSize) {
            currentRawEventsPageSize = parseInt(pageSize);
            currentRawEventsPage = 1; // í˜ì´ì§€ í¬ê¸° ë³€ê²½ì‹œ ì²« í˜ì´ì§€ë¡œ ì´ë™
            renderRawEventsTableWithPagination();
        }

        // í•„í„°ë§ëœ Raw Events í…Œì´ë¸” ë Œë”ë§
        function renderFilteredRawEventsTable(filteredEvents, container) {
            if (!container || !filteredEvents) return;
            
            const tableHtml = `
                <div class="user-cumulative-header" style="display: flex; justify-content: space-between; align-items: center;">
                    <span>ğŸ“‹ All Raw Events - ê²€ìƒ‰ ê²°ê³¼ (${filteredEvents.length}ê°œ)</span>
                    <button onclick="clearUsageSearch()" style="background: #4a9eff; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">
                        ì „ì²´ ë³´ê¸°
                    </button>
                </div>
                <div class="user-cumulative-table">
                    <div>DATE</div>
                    <div>USER</div>
                    <div>KIND</div>
                    <div>MAX_MODEL</div>
                    <div>MODEL</div>
                    <div>COST</div>
                </div>
                ${filteredEvents.map(event => {
                    const date = new Date(parseInt(event.timestamp));
                    const dateText = date.toLocaleDateString('en-US', { 
                        month: 'short', 
                        day: 'numeric', 
                        hour: '2-digit', 
                        minute: '2-digit' 
                    });
                    
                    return `
                        <div class="user-cumulative-row">
                            <div>${dateText}</div>
                            <div class="user-email">${event.userEmail}</div>
                            <div>${(event.kindLabel || 'Unknown').substring(0, 15)}${(event.kindLabel || '').length > 15 ? '...' : ''}</div>
                            <div>${event.maxMode ? 'Yes' : 'No'}</div>
                            <div>${(event.model || 'auto').substring(0, 10)}${(event.model || '').length > 10 ? '...' : ''}</div>
                            <div>${event.requestsCosts || 0}</div>
                        </div>
                    `;
                }).join('')}
            `;
            
            container.innerHTML = tableHtml;
            console.log(`í•„í„°ë§ëœ Raw Events í…Œì´ë¸” ë Œë”ë§ ì™„ë£Œ: ${filteredEvents.length}ê°œ ì´ë²¤íŠ¸`);
        }

        // ë¹ˆ Raw Events í…Œì´ë¸” ë Œë”ë§
        function renderEmptyRawEventsTable(container, searchedEmails) {
            if (!container) return;
            
            const emailList = searchedEmails.join(', ');
            
            const tableHtml = `
                <div class="user-cumulative-header" style="display: flex; justify-content: space-between; align-items: center;">
                    <span>ğŸ“‹ All Raw Events - ê²€ìƒ‰ ê²°ê³¼ (0ê°œ)</span>
                    <button onclick="clearUsageSearch()" style="background: #4a9eff; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">
                        ì „ì²´ ë³´ê¸°
                    </button>
                </div>
                <div class="user-cumulative-table">
                    <div>DATE</div>
                    <div>USER</div>
                    <div>KIND</div>
                    <div>MAX_MODEL</div>
                    <div>MODEL</div>
                    <div>COST</div>
                </div>
                <div style="padding: 40px 20px; text-align: center; color: #7a7a7a; background-color: #1a1a1a; grid-column: 1 / -1;">
                    <h3 style="color: #e1e1e1; margin-bottom: 10px;">ê²€ìƒ‰ëœ ì‚¬ìš©ìì˜ í™œë™ì´ ì—†ìŠµë‹ˆë‹¤</h3>
                    <p style="margin-bottom: 15px;">ê²€ìƒ‰ ëŒ€ìƒ: <strong style="color: #4a9eff;">${emailList}</strong></p>
                    <p style="font-size: 14px; line-height: 1.4;">
                        â€¢ í•´ë‹¹ ì‚¬ìš©ìê°€ ì„ íƒëœ ê¸°ê°„ì— í™œë™í•˜ì§€ ì•Šì•˜ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤<br>
                        â€¢ ë‹¤ë¥¸ ë‚ ì§œ ë²”ìœ„ë¥¼ ì„ íƒí•´ë³´ì„¸ìš”<br>
                        â€¢ ë˜ëŠ” ë‹¤ë¥¸ ì‚¬ìš©ìë¥¼ ê²€ìƒ‰í•´ë³´ì„¸ìš”
                    </p>
                </div>
            `;
            
            container.innerHTML = tableHtml;
            console.log(`ë¹ˆ Raw Events í…Œì´ë¸” ë Œë”ë§ ì™„ë£Œ (ê²€ìƒ‰ ëŒ€ìƒ: ${emailList})`);
        }

        // Usage ê²€ìƒ‰ ì´ˆê¸°í™”
        function clearUsageSearch() {
            const searchBox = document.querySelector('#usage .search-box');
            if (searchBox) {
                searchBox.value = '';
                
                // ê²€ìƒ‰ í”Œë˜ê·¸ ì œê±°
                if (window.pendingEmailSearch) {
                    console.log(`ğŸ”„ ì „ì²´ ë³´ê¸° í´ë¦­ìœ¼ë¡œ ì´ë©”ì¼ ê²€ìƒ‰ í”Œë˜ê·¸ ì œê±°: ${window.pendingEmailSearch}`);
                    delete window.pendingEmailSearch;
                }
                
                filterUsageMembers(''); // ë¹ˆ ê²€ìƒ‰ì–´ë¡œ í•„í„°ë§ (ì „ì²´ í‘œì‹œ)
            }
        }

        // Usage ë©¤ë²„ ê²€ìƒ‰ ê¸°ëŠ¥ (ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ì™€ All Raw Events í…Œì´ë¸” ì—°ë™)
        function filterUsageMembers(searchTerm) {
            const searchLower = searchTerm.toLowerCase().trim();
            
            console.log(`ğŸ” Usage ë©¤ë²„ ê²€ìƒ‰ ì‹œì‘: "${searchTerm}"`);
            
            // ê²€ìƒ‰ì–´ê°€ ë¹„ì–´ìˆìœ¼ë©´ ëª¨ë“  í–‰ í‘œì‹œ
            if (searchLower === '') {
                const allRows = document.querySelectorAll('#usage .user-cumulative-row');
                allRows.forEach(row => {
                    row.style.display = 'grid';
                });
                console.log('âœ… ê²€ìƒ‰ì–´ ì—†ìŒ - ëª¨ë“  í–‰ í‘œì‹œ');
                return;
            }
            
            // ì´ë©”ì¼ ì£¼ì†Œì¸ì§€ í™•ì¸ (@ í¬í•¨ ì—¬ë¶€ë¡œ íŒë‹¨)
            const isEmailSearch = searchLower.includes('@');
            
            // ëª¨ë“  Usage ì„¹ì…˜ì˜ user-cumulative-info ì»¨í…Œì´ë„ˆ ê°€ì ¸ì˜¤ê¸°
            const userInfoContainers = document.querySelectorAll('#usage .user-cumulative-info');
            
            if (userInfoContainers.length === 0) {
                console.log('âš ï¸ Usage ì„¹ì…˜ì˜ user-cumulative-info ì»¨í…Œì´ë„ˆë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            console.log(`ğŸ“‹ ë°œê²¬ëœ í…Œì´ë¸” ì»¨í…Œì´ë„ˆ: ${userInfoContainers.length}ê°œ`);
            
            // ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ í…Œì´ë¸” (ì²« ë²ˆì§¸ ì»¨í…Œì´ë„ˆ)ê³¼ All Raw Events í…Œì´ë¸” (ë‘ ë²ˆì§¸ ì»¨í…Œì´ë„ˆ) êµ¬ë¶„
            const userCumulativeContainer = userInfoContainers[0]; // ì²« ë²ˆì§¸: ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´
            const rawEventsContainer = userInfoContainers[1]; // ë‘ ë²ˆì§¸: All Raw Events
            
            // 1. ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ í…Œì´ë¸”ì—ì„œ í•„í„°ë§í•˜ê³  ë§¤ì¹­ëœ ì´ë©”ì¼ ìˆ˜ì§‘
            const matchedEmails = new Set();
            
            // ì •í™•í•œ ì´ë©”ì¼ ë§¤ì¹­ì´ ìˆëŠ”ì§€ ë¨¼ì € í™•ì¸
            let hasExactMatch = false;
            if (isEmailSearch) {
                const allEmailElements = userCumulativeContainer.querySelectorAll('.user-cumulative-row .user-email, .user-cumulative-row div:nth-child(2)');
                hasExactMatch = Array.from(allEmailElements).some(element => 
                    element.textContent.toLowerCase().trim() === searchLower
                );
                console.log(`ğŸ” ì •í™•í•œ ì´ë©”ì¼ ë§¤ì¹­ í™•ì¸: ${hasExactMatch ? 'ë°œê²¬ë¨' : 'ì—†ìŒ'}`);
            }
            
            // ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´ í…Œì´ë¸” í•„í„°ë§
            const userCumulativeRows = userCumulativeContainer.querySelectorAll('.user-cumulative-row');
            console.log(`ğŸ“Š ì‚¬ìš©ìë³„ ëˆ„ì  ì‚¬ìš©ëŸ‰ ì •ë³´: ${userCumulativeRows.length}ê°œ í–‰ ë°œê²¬`);
            
            userCumulativeRows.forEach(row => {
                if (row.children.length < 2) return; // ì¶©ë¶„í•œ ì»¬ëŸ¼ì´ ì—†ìœ¼ë©´ ìŠ¤í‚µ
                
                const name = row.children[0].textContent.toLowerCase().trim();
                const email = row.children[1].textContent.toLowerCase().trim();
                
                let shouldShow = false;
                
                if (isEmailSearch) {
                    if (hasExactMatch) {
                        // ì •í™•í•œ ë§¤ì¹­ì´ ìˆìœ¼ë©´ ì •í™•í•œ ë§¤ì¹­ë§Œ í‘œì‹œ
                        shouldShow = email === searchLower;
                    } else {
                        // ì •í™•í•œ ë§¤ì¹­ì´ ì—†ìœ¼ë©´ ë¶€ë¶„ ë§¤ì¹­ í—ˆìš©
                        shouldShow = email.includes(searchLower);
                    }
                } else {
                    // ì¼ë°˜ ê²€ìƒ‰: ì´ë¦„ ë˜ëŠ” ì´ë©”ì¼ ë¶€ë¶„ ë§¤ì¹­
                    shouldShow = name.includes(searchLower) || email.includes(searchLower);
                }
                
                if (shouldShow) {
                    row.style.display = 'grid';
                    // ë§¤ì¹­ëœ ì´ë©”ì¼ì„ ìˆ˜ì§‘ (ì›ë³¸ ì´ë©”ì¼ ì €ì¥)
                    const originalEmail = row.children[1].textContent.trim();
                    matchedEmails.add(originalEmail);
                } else {
                    row.style.display = 'none';
                }
            });
            
            console.log(`ğŸ“§ ë§¤ì¹­ëœ ì´ë©”ì¼: ${Array.from(matchedEmails).join(', ')}`);
            
            // 2. All Raw Events í…Œì´ë¸” ì—°ë™ í•„í„°ë§ (ì „ì²´ ë°ì´í„°ì—ì„œ ê²€ìƒ‰)
            if (rawEventsContainer && currentRawEventsData && currentRawEventsData.length > 0) {
                console.log(`ğŸ“‹ All Raw Events ì „ì²´ ë°ì´í„°: ${currentRawEventsData.length}ê°œ ì´ë²¤íŠ¸`);
                console.log(`ğŸ” ë§¤ì¹­ ëŒ€ìƒ ì´ë©”ì¼: ${Array.from(matchedEmails).join(', ')}`);
                
                // ê²€ìƒ‰ì–´ê°€ ìˆìœ¼ë©´ ë§¤ì¹­ëœ ì´ë©”ì¼ì˜ ì´ë²¤íŠ¸ë§Œ í•„í„°ë§
                if (matchedEmails.size > 0) {
                    const filteredEvents = currentRawEventsData.filter(event => {
                        const eventUserEmail = event.userEmail?.trim() || '';
                        
                        // ë§¤ì¹­ í™•ì¸ (ëŒ€ì†Œë¬¸ì ë¬´ì‹œ)
                        return Array.from(matchedEmails).some(email => {
                            const emailLower = email.toLowerCase();
                            const eventEmailLower = eventUserEmail.toLowerCase();
                            return emailLower === eventEmailLower || 
                                   emailLower.includes(eventEmailLower) || 
                                   eventEmailLower.includes(emailLower);
                        });
                    });
                    
                    console.log(`âœ… í•„í„°ë§ëœ Raw Events: ${filteredEvents.length}ê°œ`);
                    
                    if (filteredEvents.length > 0) {
                        // í•„í„°ë§ëœ ë°ì´í„°ë¡œ í…Œì´ë¸” ë‹¤ì‹œ ë Œë”ë§
                        renderFilteredRawEventsTable(filteredEvents, rawEventsContainer);
                        console.log(`âœ… ${filteredEvents.length}ê°œì˜ ë§¤ì¹­ëœ ì´ë²¤íŠ¸ë¥¼ í‘œì‹œí–ˆìŠµë‹ˆë‹¤.`);
                    } else {
                        // ë§¤ì¹­ëœ ì´ë²¤íŠ¸ê°€ ì—†ìœ¼ë©´ ë¹ˆ í…Œì´ë¸” í‘œì‹œ
                        renderEmptyRawEventsTable(rawEventsContainer, Array.from(matchedEmails));
                        console.log('âš ï¸ ë§¤ì¹­ëœ ì‚¬ìš©ìì˜ Raw Eventsê°€ ì—†ìŠµë‹ˆë‹¤.');
                        console.log('ğŸ’¡ í•´ë‹¹ ì‚¬ìš©ìê°€ ì„ íƒëœ ê¸°ê°„ì— í™œë™í•˜ì§€ ì•Šì•˜ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                    }
                } else {
                    // ê²€ìƒ‰ì–´ê°€ ì—†ìœ¼ë©´ ì›ë˜ í˜ì´ì§€ë„¤ì´ì…˜ ë°©ì‹ìœ¼ë¡œ ë³µì›
                    renderRawEventsTableWithPagination();
                    console.log('âœ… ê²€ìƒ‰ì–´ ì—†ìŒ - ì „ì²´ Raw Events í˜ì´ì§€ë„¤ì´ì…˜ ë³µì›');
                }
            } else {
                console.log('âš ï¸ All Raw Events ì»¨í…Œì´ë„ˆ ë˜ëŠ” ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                console.log(`   - ì»¨í…Œì´ë„ˆ ì¡´ì¬: ${!!rawEventsContainer}`);
                console.log(`   - ë°ì´í„° ì¡´ì¬: ${!!currentRawEventsData}`);
                console.log(`   - ë°ì´í„° ê¸¸ì´: ${currentRawEventsData?.length || 0}`);
            }
            
            const matchingType = isEmailSearch ? (hasExactMatch ? 'ì •í™•í•œ ì´ë©”ì¼ ë§¤ì¹­' : 'ì´ë©”ì¼ ë¶€ë¶„ ë§¤ì¹­') : 'ë¶€ë¶„ ë§¤ì¹­';
            console.log(`âœ… Usage ê²€ìƒ‰ ì™„ë£Œ: "${searchTerm}" - ${matchingType}ìœ¼ë¡œ ë‘ í…Œì´ë¸” ì—°ë™ í•„í„°ë§ ì™„ë£Œ (ë§¤ì¹­ëœ ì‚¬ìš©ì ${matchedEmails.size}ëª…)`);
            
            // ê²€ìƒ‰ ì™„ë£Œ í›„ ëŒ€ê¸° ì¤‘ì¸ ì´ë©”ì¼ ê²€ìƒ‰ í”Œë˜ê·¸ ì œê±°
            if (window.pendingEmailSearch) {
                console.log(`ğŸ”„ ì´ë©”ì¼ ê²€ìƒ‰ í”Œë˜ê·¸ ì œê±°: ${window.pendingEmailSearch}`);
                delete window.pendingEmailSearch;
            }
        }

        // ë©¤ë²„ ì •ë ¬ ê¸°ëŠ¥
        let currentSortField = 'requests';
        let currentSortDirection = 'desc';

        function sortMembers(field) {
            const dataTable = document.querySelector('#members .data-table');
            const rows = Array.from(dataTable.querySelectorAll('.table-row'));
           
            // ì •ë ¬ ë°©í–¥ í† ê¸€
            if (currentSortField === field) {
                currentSortDirection = currentSortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                currentSortField = field;
                currentSortDirection = 'asc';
            }
           
            // ì •ë ¬ í•¨ìˆ˜
            rows.sort((a, b) => {
                let aValue, bValue;
               
                switch(field) {
                    case 'name':
                        aValue = a.children[0].textContent.toLowerCase();
                        bValue = b.children[0].textContent.toLowerCase();
                        break;
                    case 'email':
                        aValue = a.children[1].textContent.toLowerCase();
                        bValue = b.children[1].textContent.toLowerCase();
                        break;
                    case 'requests':
                        aValue = parseInt(a.children[2].textContent.replace(/,/g, '')) || 0;
                        bValue = parseInt(b.children[2].textContent.replace(/,/g, '')) || 0;
                        break;
                    case 'spend':
                        aValue = parseFloat(a.children[3].textContent.replace('$', '')) || 0;
                        bValue = parseFloat(b.children[3].textContent.replace('$', '')) || 0;
                        break;
                    case 'role':
                        aValue = a.children[4].textContent.toLowerCase();
                        bValue = b.children[4].textContent.toLowerCase();
                        break;
                    default:
                        return 0;
                }
               
                if (currentSortDirection === 'asc') {
                    return aValue > bValue ? 1 : -1;
                } else {
                    return aValue < bValue ? 1 : -1;
                }
            });
           
            // ì •ë ¬ëœ í–‰ë“¤ì„ ë‹¤ì‹œ ì¶”ê°€
            rows.forEach(row => dataTable.appendChild(row));
           
            // í—¤ë” ì—…ë°ì´íŠ¸
            updateSortHeaders(field);
        }

        // ì •ë ¬ í—¤ë” ì—…ë°ì´íŠ¸
        function updateSortHeaders(field) {
            const headers = document.querySelectorAll('#members .table-header > div');
            headers.forEach((header, index) => {
                if (index < 5) { // ë§ˆì§€ë§‰ ë¹ˆ ì—´ ì œì™¸
                    const text = header.textContent.replace(/[â†‘â†“]/, '');
                    if (index === 0 && field === 'name') header.textContent = text + (currentSortDirection === 'asc' ? ' â†‘' : ' â†“');
                    else if (index === 1 && field === 'email') header.textContent = text + (currentSortDirection === 'asc' ? ' â†‘' : ' â†“');
                    else if (index === 2 && field === 'requests') header.textContent = text + (currentSortDirection === 'asc' ? ' â†‘' : ' â†“');
                    else if (index === 3 && field === 'spend') header.textContent = text + (currentSortDirection === 'asc' ? ' â†‘' : ' â†“');
                    else if (index === 4 && field === 'role') header.textContent = text + (currentSortDirection === 'asc' ? ' â†‘' : ' â†“');
                    else header.textContent = text + ' â†•';
                }
            });
        }

        // ìµœì í™”ëœ í˜ì´ì§€ ì´ˆê¸°í™” (Progressive Loading)
        document.addEventListener('DOMContentLoaded', async function() {
            PerformanceMonitor.start('í˜ì´ì§€ ì „ì²´ ë¡œë“œ');
            console.log('ğŸš€ ìµœì í™”ëœ ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” ì‹œì‘');
           
            try {
                // 1ë‹¨ê³„: ì¦‰ì‹œ ìŠ¤ì¼ˆë ˆí†¤ UI í‘œì‹œ (0ms)
                SkeletonUI.show('overview');
                updatePerformanceIndicator('loading', 'UI ì´ˆê¸°í™”');
                console.log('ğŸ’€ ìŠ¤ì¼ˆë ˆí†¤ UI í‘œì‹œ ì™„ë£Œ');
               
                // 2ë‹¨ê³„: ê¸°ë³¸ UI ì´ˆê¸°í™” (ì¦‰ì‹œ)
                initOverviewStats();
               
                // Overview í•„í„° ê¸°ë³¸ê°’ì„ 30ì¼ë¡œ ì„¤ì •
                document.querySelectorAll('#overview .chart-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector('#overview .chart-btn[data-days="30"]').classList.add('active');
               
                createOverviewChart(); // ë¹ˆ ì°¨íŠ¸ ë¨¼ì € í‘œì‹œ
               
                // 3ë‹¨ê³„: ë°±ê·¸ë¼ìš´ë“œì—ì„œ ë°ì´í„° ë¡œë“œ ì‹œì‘ (ë¹„ë™ê¸°)
                console.log('ğŸ“¡ ë°±ê·¸ë¼ìš´ë“œ ë°ì´í„° ë¡œë“œ ì‹œì‘...');
               
                // ìºì‹œ í™•ì¸ ë° ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥í•œ ë°ì´í„°ê°€ ìˆë‹¤ë©´ ë¨¼ì € í‘œì‹œ
                if (DataCache.isValid('members') && DataCache.members) {
                    console.log('ğŸš€ ìºì‹œëœ ë©¤ë²„ ë°ì´í„°ë¡œ ì¦‰ì‹œ ê¸°ë³¸ UI ì—…ë°ì´íŠ¸');
                    updatePerformanceIndicator('cached', 'ìºì‹œ ì‚¬ìš©');
                    const totalMembers = DataCache.members.teamMembers?.length || 0;
                    updateStatsCards(totalMembers, 0, 0); // ê¸°ë³¸ê°’ìœ¼ë¡œ ë¨¼ì € í‘œì‹œ
                } else {
                    updatePerformanceIndicator('loading', 'API í˜¸ì¶œ');
                }
               
                // 4ë‹¨ê³„: ì‹¤ì œ API ë°ì´í„° ë¡œë“œ ë° ì—…ë°ì´íŠ¸
                await refreshAllRealData();
               
                // ì´ˆê¸° ë¡œë“œ ì™„ë£Œ í›„ ê¸°ë³¸ ì„ íƒ ìƒíƒœ ì„¤ì • (ì „ì²´ ë©¤ë²„)
                console.log('ì´ˆê¸° ë¡œë“œ ì™„ë£Œ í›„ ì „ì²´ ë©¤ë²„ ê¸°ë³¸ ì„ íƒ');
                document.querySelectorAll('.overview-stat-box').forEach(box => {
                    box.classList.remove('selected');
                });
                document.querySelector('.overview-stat-box[data-type="total"]').classList.add('selected');
                currentFilterType = 'total';
                
                // ë‚ ì§œ ì…ë ¥ í•„ë“œ ë³€ê²½ ì‹œ ìë™ ìƒˆë¡œê³ ì¹¨ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
                setupAutoRefreshEvents();
               
                const totalLoadTime = PerformanceMonitor.end('í˜ì´ì§€ ì „ì²´ ë¡œë“œ');
                updatePerformanceIndicator('ready', `${totalLoadTime}ms`);
                console.log('âœ… ìµœì í™”ëœ ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” ì™„ë£Œ!');
               
            } catch (error) {
                PerformanceMonitor.end('í˜ì´ì§€ ì „ì²´ ë¡œë“œ');
                updatePerformanceIndicator('error', error.message.substring(0, 20));
                console.error('âŒ ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
               
                // ì—ëŸ¬ ë°œìƒ ì‹œì—ë„ ê¸°ë³¸ UIëŠ” í‘œì‹œ
                const errorMessage = `
                    <div style="text-align: center; padding: 50px; color: #ff6b6b;">
                        <h3>âš ï¸ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨</h3>
                        <p>${error.message}</p>
                        <button onclick="location.reload()" style="margin-top: 20px; padding: 10px 20px; background: #4a9eff; color: white; border: none; border-radius: 4px; cursor: pointer;">
                            ìƒˆë¡œê³ ì¹¨
                        </button>
                    </div>
                `;
               
                const overviewSection = document.getElementById('overview');
                if (overviewSection) {
                    overviewSection.innerHTML = errorMessage;
                }
            }
        });

        // ìºì‹œ ìƒˆë¡œê³ ì¹¨ í•¨ìˆ˜ (ë²„íŠ¼ìš©)
        function forceCacheRefresh() {
            console.log('ğŸ—‘ï¸ ìºì‹œ ê°•ì œ ìƒˆë¡œê³ ì¹¨ ì‹œì‘');
            DataCache.clear();
            location.reload();
        }

        // ìë™ ìƒˆë¡œê³ ì¹¨ ì´ë²¤íŠ¸ ì„¤ì •
        function setupAutoRefreshEvents() {
            console.log('ìë™ ìƒˆë¡œê³ ì¹¨ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • ì¤‘...');
            
            // Overview ë‚ ì§œ ì…ë ¥ í•„ë“œ
            const overviewStartDate = document.getElementById('start-date');
            const overviewEndDate = document.getElementById('end-date');
            
            if (overviewStartDate && overviewEndDate) {
                overviewStartDate.addEventListener('change', debounce(async () => {
                    if (overviewStartDate.value && overviewEndDate.value) {
                        console.log('Overview ì‹œì‘ ë‚ ì§œ ë³€ê²½ë¨ - ìë™ ìƒˆë¡œê³ ì¹¨');
                        await applyDateFilter();
                    }
                }, 500));
                
                overviewEndDate.addEventListener('change', debounce(async () => {
                    if (overviewStartDate.value && overviewEndDate.value) {
                        console.log('Overview ì¢…ë£Œ ë‚ ì§œ ë³€ê²½ë¨ - ìë™ ìƒˆë¡œê³ ì¹¨');
                        await applyDateFilter();
                    }
                }, 500));
            }
            
            // Usage ë‚ ì§œ ì…ë ¥ í•„ë“œ
            const usageStartDate = document.getElementById('usage-start-date');
            const usageEndDate = document.getElementById('usage-end-date');
            
            if (usageStartDate && usageEndDate) {
                usageStartDate.addEventListener('change', debounce(async () => {
                    if (usageStartDate.value && usageEndDate.value) {
                        console.log('Usage ì‹œì‘ ë‚ ì§œ ë³€ê²½ë¨ - ìë™ ìƒˆë¡œê³ ì¹¨');
                        await applyUsageDateFilter();
                    }
                }, 500));
                
                usageEndDate.addEventListener('change', debounce(async () => {
                    if (usageStartDate.value && usageEndDate.value) {
                        console.log('Usage ì¢…ë£Œ ë‚ ì§œ ë³€ê²½ë¨ - ìë™ ìƒˆë¡œê³ ì¹¨');
                        await applyUsageDateFilter();
                    }
                }, 500));
            }
            
            console.log('ìë™ ìƒˆë¡œê³ ì¹¨ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • ì™„ë£Œ');
        }

        // ë””ë°”ìš´ìŠ¤ í•¨ìˆ˜ (ì—°ì† í˜¸ì¶œ ë°©ì§€)
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        document.addEventListener('DOMContentLoaded', function() {
            // ê¸°ë³¸ ì„¤ì • í›„
            setTimeout(async () => {
                createOverviewChart();
                console.log('=== í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ì‹¤ì œ API ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì‹œì‘ ===');
                await refreshAllRealData(); // ìë™ ìƒˆë¡œê³ ì¹¨
            }, 100);
        });

    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Samsung AI Experience Group Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #1a1a1a;
            color: #e1e1e1;
            overflow-x: hidden;
        }

        /* ?ÔøΩÌÅ¨Î°§Î∞î ?ÔøΩÔøΩ??ÔøΩÎßÅ */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #1a1a1a;
        }

        ::-webkit-scrollbar-thumb {
            background: #2a2a2a;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #3a3a3a;
        }

        .dashboard-container {
            display: flex;
            height: 100vh;
            align-items: stretch;
        }

        /* ?ÔøΩÏù¥?ÔøΩÎ∞î ?ÔøΩÔøΩ???*/
        .sidebar {
            width: 250px;
            background-color: #2a2a2a;
            color: #b1b1b1;
            border-right: 1px solid #3a3a3a;
            display: flex;
            flex-direction: column;
        }



        .menu-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: #b1b1b1;
            text-decoration: none;
            transition: all 0.2s ease;
            font-size: 14px;
            cursor: pointer;
            user-select: none;
        }

        .menu-item:hover {
            background-color: #3a3a3a;
            color: #fff;
        }

        .menu-item.active {
            background-color: #4a4a4a;
            color: #fff;
        }

        .refresh-button {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: #b1b1b1;
            text-decoration: none;
            transition: all 0.2s ease;
            font-size: 14px;
            cursor: pointer;
            user-select: none;
        }

        .refresh-button:hover {
            background-color: #3a3a3a;
            color: #fff;
        }

        .refresh-progress {
            position: absolute;
            bottom: -10px;
            left: 20px;
            right: 20px;
            height: 6px;
            background-color: #2a2a2a;
            border-radius: 3px;
            overflow: hidden;
            display: none;
        }

        .refresh-progress-bar {
            height: 100%;
            background-color: #4a9eff;
            border-radius: 3px;
            width: 0%;
            transition: width 0.3s ease;
        }

        .refresh-button {
            position: relative;
        }

        .menu-icon {
            width: 16px;
            height: 16px;
            margin-right: 12px;
            opacity: 0.7;
        }

        /* Î©îÏù∏ ÏΩòÌÖêÔø??ÔøΩÏó≠ */
        .main-content {
            flex: 1;
            background-color: #1a1a1a;
            display: flex;
            flex-direction: column;
        }

        .header {
            background-color: #1a1a1a; /* Î∞∞Í≤Ω??Í≤Ä?ÔøΩÏúºÔø?Î≥ÄÔø?*/
            padding: 20px 30px;
            height: 80px;
            box-sizing: border-box;
            position: relative;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* ?ÔøΩÎçî ?ÔøΩÎûò ?ÔøΩÏóê ?ÔøΩÎ∞± Ï∂îÔøΩ? */
        .header::after {
            content: '';
            position: absolute;
            left: 30px;
            right: 30px;
            bottom: 0;
            height: 1px;
            background-color: #3a3a3a;
        }



        .header-left h1 {
            color: #fff;
            font-size: 24px;
            font-weight: 600;
        }

        .content-area {
            padding: 30px;
            min-height: calc(100vh - 80px);
            overflow-y: auto;
        }

        /* Í∏∞Î≥∏ ?ÔøΩÔøΩ? Ï≤òÎ¶¨ */
        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        /* Overview ?ÔøΩÏù¥ÏßÄ ?ÔøΩÔøΩ???*/
        .overview-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .overview-stat-box {
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 8px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .overview-stat-box:hover {
            background-color: #3a3a3a;
            border-color: #4a4a4a;
        }

        .overview-stat-box.clickable {
            cursor: pointer;
        }

        .overview-stat-box.selected {
            background-color: #3a3a3a;
            border-color: #5a9eff;
            box-shadow: 0 0 10px rgba(90, 158, 255, 0.3);
        }

        .overview-stat-box.selected .stat-number,
        .overview-stat-box.selected .stat-label,
        .overview-stat-box.selected .stat-description {
            color: white;
        }

        .overview-stat-box .stat-number {
            font-size: 36px;
            font-weight: 700;
            color: #fff;
            margin-bottom: 8px;
        }

        .overview-stat-box .stat-label {
            font-size: 16px;
            font-weight: 600;
            color: #e1e1e1;
            margin-bottom: 4px;
        }

        .overview-stat-box .stat-description {
            font-size: 12px;
            color: #b1b1b1;
        }

        .overview-chart-container {
            background-color: #1a1a1a;
            border: 1px solid #3a3a3a;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-header h3 {
            color: #fff;
            font-size: 18px;
            font-weight: 600;
            background-color: transparent;
        }

        .chart-controls {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .filter-period-display {
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 4px;
            padding: 8px 16px;
            margin-right: 8px;
            min-width: 220px;
        }

        .filter-period-display span {
            color: #ff9800;
            font-size: 14px;
            font-weight: 600;
        }

        .chart-btn {
            background-color: #3a3a3a;
            border: 1px solid #4a4a4a;
            color: #b1b1b1;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .chart-btn:hover {
            background-color: #4a4a4a;
            color: #fff;
        }

        .chart-btn.active {
            background-color: #4a9eff;
            border-color: #4a9eff;
            color: white;
        }

        .overview-member-details {
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 4px;
            overflow: hidden;
        }

        .member-details-header {
            background-color: #1a1a1a;
            color: #fff;
            padding: 15px 20px;
            margin: 0;
            border-bottom: 1px solid #3a3a3a;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .member-details-header h3 {
            font-size: 18px;
            font-weight: 600;
        }



        .member-list {
            display: grid;
            gap: 0;
        }

        .member-list-header {
            display: grid;
            grid-template-columns: 1.5fr 2fr 1fr 1.5fr 1fr 1fr 1fr;
            gap: 20px;
            padding: 12px 20px;
            background-color: #2a2a2a;
            color: #b1b1b1;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            border-bottom: 2px solid #3a3a3a;
        }

        .member-item {
            display: grid;
            grid-template-columns: 1.5fr 2fr 1fr 1.5fr 1fr 1fr 1fr;
            gap: 20px;
            align-items: center;
            padding: 12px 20px;
            background-color: #1a1a1a;
            border-bottom: 1px solid #3a3a3a;
            font-size: 14px;
        }

        .member-item:hover {
            background-color: #2a2a2a;
        }

        .member-item:last-child {
            border-bottom: none;
        }

        .member-date {
            color: #b1b1b1;
            font-size: 13px;
        }

        .member-email {
            color: #b1b1b1;
        }

        .clickable-email {
            color: #4a9eff;
            cursor: pointer;
            text-decoration: none;
            transition: color 0.2s ease;
        }

        .clickable-email:hover {
            color: #2196f3;
            text-decoration: underline;
        }

        .member-type {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .member-type.active {
            background-color: rgba(76, 175, 80, 0.2);
            color: #4caf50;
        }

        .member-type.inactive {
            background-color: rgba(255, 152, 0, 0.2);
            color: #ff9800;
        }

        .member-kind {
            color: #e1e1e1;
            font-size: 13px;
        }

        .member-request {
            color: #fff;
            font-weight: 500;
        }

        .member-spend {
            color: #4a9eff;
            font-weight: 600;
        }

        /* ?ÔøΩÎèôÎ¶¨Ïä§???ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥???ÔøΩÔøΩ???*/
        .activity-pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            padding: 15px 20px;
            background-color: #2a2a2a;
            border-top: 1px solid #3a3a3a;
        }

        .activity-pagination button {
            background: #3a3a3a;
            border: 1px solid #4a4a4a;
            color: #e1e1e1;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
        }

        .activity-pagination button:hover {
            background: #4a4a4a;
        }

        .activity-pagination button.active {
            background: #4a9eff;
            border-color: #4a9eff;
            color: white;
        }

        .activity-pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .activity-pagination .page-info {
            color: #b1b1b1;
            font-size: 12px;
            margin: 0 10px;
        }

        .activity-page-size-selector {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: auto;
        }

        .activity-page-size-selector select {
            background: #3a3a3a;
            color: #fff;
            border: 1px solid #4a4a4a;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
        }
        
        /* ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥ ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥???ÔøΩÔøΩ???*/
        .user-cumulative-pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            padding: 15px 20px;
            background-color: #2a2a2a;
            border-top: 1px solid #3a3a3a;
        }
        
        .user-cumulative-pagination button {
            background: #3a3a3a;
            color: #e1e1e1;
            border: 1px solid #4a4a4a;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
        }
        
        .user-cumulative-pagination button:hover:not(:disabled) {
            background: #4a4a4a;
            border-color: #5a5a5a;
        }
        
        .user-cumulative-pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .user-cumulative-pagination .page-info {
            color: #b1b1b1;
            font-size: 14px;
            min-width: 120px;
            text-align: center;
        }
        
        .user-cumulative-page-size-selector {
            display: flex;
            align-items: center;
        }

        /* Ï∞®Ìä∏ ?ÔøΩÌÉùÔø??ÔøΩÔøΩ???*/
        .chart-selector {
            margin-bottom: 20px;
        }

        .chart-selector select {
            padding: 10px 16px;
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 6px;
            color: #e1e1e1;
            font-size: 14px;
            cursor: pointer;
            min-width: 250px;
            transition: all 0.3s ease;
        }

        .chart-selector select:hover {
            border-color: #4a9eff;
        }

        .chart-selector select:focus {
            outline: none;
            border-color: #4a9eff;
            box-shadow: 0 0 0 2px rgba(74, 158, 255, 0.2);
        }

        .chart-content {
            display: none;
            background-color: #1a1a1a;
            border: 1px solid #3a3a3a;
            border-radius: 0 6px 6px 6px;
            padding: 20px;
        }

        .chart-content.active {
            display: block;
        }

        .user-cumulative-page-size-selector {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .user-cumulative-page-size-selector select {
            background: #3a3a3a;
            color: #fff;
            border: 1px solid #4a4a4a;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
        }

        /* Members ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥???ÔøΩÔøΩ???(All Raw Events?Ôø??ÔøΩÏùº) */
        #members-pagination button {
            background: #3a3a3a;
            border: 1px solid #4a4a4a;
            color: #e1e1e1;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            margin: 0 2px;
            transition: all 0.2s ease;
        }

        #members-pagination button:hover {
            background: #4a4a4a;
            border-color: #5a5a5a;
        }

        #members-pagination button.active {
            background: #4a9eff;
            border-color: #4a9eff;
            color: white;
            font-weight: 600;
        }

        #members-pagination span {
            color: #7a7a7a;
            padding: 0 5px;
        }

        /* ?ÔøΩÌÑ∞ Ôø?Í≤Ä???ÔøΩÏó≠ */
        .filter-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 15px 0;
            border-bottom: 1px solid #3a3a3a;
        }

        /* Members ?ÔøΩÏÖò?ÔøΩÏÑú Íµ¨Î∂Ñ???ÔøΩÍ±∞ Ôø?Í∞ÑÍ≤© Ï∂ïÏÜå */
        #members .filter-controls {
            border-bottom: none;
            margin-bottom: 15px;
            padding: 10px 0;
        }

        .filter-controls         .chart-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .date-picker {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .date-picker input[type="date"] {
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 4px;
            padding: 8px 12px;
            color: #fff;
            font-size: 14px;
        }

        /* ?ÔøΩÎ†• ?ÔøΩÏù¥Ôø??ÔøΩÏÉÅ Î≥ÄÔø?*/
        .date-picker input[type="date"]::-webkit-calendar-picker-indicator {
            filter: invert(1) brightness(1.5) sepia(1) saturate(5) hue-rotate(45deg);
            cursor: pointer;
        }

        .date-picker input[type="date"]::-moz-calendar-picker-indicator {
            filter: invert(1) brightness(1.5) sepia(1) saturate(5) hue-rotate(45deg);
            cursor: pointer;
        }

        .date-picker span {
            color: #ccc;
            font-weight: 500;
        }

        .filter-controls .chart-btn {
            min-width: 40px;
        }

        /* ?ÔøΩÏù¥??Î°úÎî© Î≤ÑÌäº ?ÔøΩÔøΩ???*/
        .data-loading-btn {
            background: linear-gradient(135deg, #4a9eff, #007bff);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(74, 158, 255, 0.3);
        }

        .data-loading-btn:hover {
            background: linear-gradient(135deg, #007bff, #0056b3);
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(74, 158, 255, 0.4);
        }

        .data-loading-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(74, 158, 255, 0.3);
        }

        .data-loading-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .date-filter-btn {
            background: #2a2a2a;
            border: 1px solid #3a3a3a;
            color: #e1e1e1;
            padding: 6px 16px;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .date-filter-btn:hover {
            background-color: #3a3a3a;
        }

        .analytics-btn {
            background: transparent;
            border: 1px solid #4a4a4a;
            color: #e1e1e1;
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
            height: 32px;
        }

        .analytics-btn:hover {
            background-color: #2a2a2a;
        }

        /* Î∞∞ÔøΩ? ?ÔøΩÔøΩ???*/
        .role-badge {
            background-color: #3a3a3a;
            color: #e1e1e1;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
            display: inline-block;
        }

        .role-badge.admin {
            background-color: #4a9eff;
            color: white;
        }

        /* Members ?ÔøΩÏù¥ÏßÄ ?ÔøΩÔøΩ???*/
        .data-table {
            background-color: #1a1a1a;
            border: 1px solid #3a3a3a;
            border-radius: 8px;
            overflow: hidden;
            width: 100%;
        }

        .table-header {
            background-color: #2a2a2a;
            padding: 15px 20px;
            border-bottom: 1px solid #3a3a3a;
            display: grid;
            grid-template-columns: 2fr 2fr 1fr 1fr 1fr 0.5fr;
            gap: 20px;
            font-size: 12px;
            font-weight: 600;
            color: #b1b1b1;
            text-transform: uppercase;
        }

        .table-row {
            padding: 15px 20px;
            border-bottom: 1px solid #3a3a3a;
            display: grid;
            grid-template-columns: 2fr 2fr 1fr 1fr 1fr 0.5fr;
            gap: 20px;
            align-items: center;
            font-size: 14px;
            background-color: #1a1a1a;
        }

        .table-row:hover {
            background-color: #2a2a2a;
        }

        .table-row:last-child {
            border-bottom: none;
        }

        /* Usage ?ÔøΩÏù¥ÏßÄ ?ÔøΩÔøΩ???*/
        .usage-cards {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .usage-card {
            background-color: #2a2a2a;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #3a3a3a;
        }

        .usage-card-number {
            font-size: 32px;
            font-weight: 700;
            color: #fff;
            margin-bottom: 8px;
        }

        .usage-card-label {
            color: #b1b1b1;
            font-size: 14px;
        }

        .search-box {
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 6px;
            padding: 8px 12px;
            color: #e1e1e1;
            font-size: 14px;
            width: 250px;
        }

        .search-container {
            position: relative;
            display: inline-block;
        }

        .search-clear-btn {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #f44336;
            cursor: pointer;
            padding: 4px;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            transition: all 0.2s ease;
        }

        .search-clear-btn:hover {
            background-color: #f44336;
            color: white;
        }

        .search-clear-btn:active {
            background-color: #d32f2f;
            color: white;
        }

        .autocomplete-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 6px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            margin-top: 2px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .autocomplete-item {
            padding: 10px 12px;
            cursor: pointer;
            border-bottom: 1px solid #3a3a3a;
            transition: background-color 0.2s ease;
        }

        .autocomplete-item:last-child {
            border-bottom: none;
        }

        .autocomplete-item:hover {
            background-color: #3a3a3a;
        }

        .autocomplete-item.selected {
            background-color: #4a9eff;
            color: white;
        }

        .autocomplete-item .user-name {
            font-weight: 600;
            color: #e1e1e1;
            font-size: 14px;
            margin-bottom: 2px;
        }

        .autocomplete-item .user-email {
            color: #b1b1b1;
            font-size: 12px;
        }

        .autocomplete-item.selected .user-name,
        .autocomplete-item.selected .user-email {
            color: white;
        }

        .user-cumulative-info {
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 8px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .user-cumulative-header {
            background-color: #1a1a1a;
            color: #fff;
            padding: 15px 20px;
            margin: 0;
            border-bottom: 1px solid #3a3a3a;
            font-size: 18px;
            font-weight: 600;
        }

        .user-cumulative-table {
            background-color: #2a2a2a;
            padding: 15px 20px;
            border-bottom: 1px solid #3a3a3a;
            display: grid;
            grid-template-columns: 1.5fr 2fr 1fr 1.5fr 1fr 1fr;
            gap: 20px;
            font-size: 12px;
            font-weight: 600;
            color: #b1b1b1;
            text-transform: uppercase;
        }

        /* Overview ?ÔøΩÎèô ?ÔøΩÏù¥Ôø??ÔøΩÔøΩ???*/
        .overview-activity-header {
            background-color: #1a1a1a;
            color: #fff;
            padding: 15px 20px;
            margin: 0;
            border-bottom: 1px solid #3a3a3a;
            font-size: 18px;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .overview-activity-table {
            background-color: #2a2a2a;
            padding: 15px 20px;
            border-bottom: 1px solid #3a3a3a;
            display: grid;
            grid-template-columns: 1.5fr 2fr 1fr 1.5fr 1fr 1fr 1fr;
            gap: 20px;
            font-size: 12px;
            font-weight: 600;
            color: #b1b1b1;
            text-transform: uppercase;
        }

        /* Export CSV Î≤ÑÌäº ?ÔøΩÎ≤Ñ ?ÔøΩÍ≥º */
        .export-csv-btn:hover {
            background-color: #45a049 !important;
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .export-csv-btn:active {
            transform: translateY(0);
            box-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }

        .user-cumulative-row {
            padding: 15px 20px;
            border-bottom: 1px solid #3a3a3a;
            display: grid;
            grid-template-columns: 1.5fr 2fr 1fr 1.5fr 1fr 1fr;
            gap: 20px;
            align-items: center;
            font-size: 14px;
            background-color: #1a1a1a;
        }

        .user-cumulative-row:hover {
            background-color: #2a2a2a;
        }

        .user-cumulative-row:last-child {
            border-bottom: none;
        }

        .user-email {
            color: #4a9eff;
            font-weight: 600;
        }

        /* Settings ?ÔøΩÏù¥ÏßÄ ?ÔøΩÔøΩ???*/
        .settings-section {
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 8px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .accordion-header {
            background-color: #2a2a2a;
            padding: 20px;
            border-bottom: 1px solid #3a3a3a;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.2s ease;
        }

        .accordion-header:hover {
            background-color: #3a3a3a;
        }

        .accordion-title {
            font-size: 18px;
            font-weight: 600;
            color: #fff;
        }

        .accordion-arrow {
            font-size: 16px;
            color: #b1b1b1;
            transition: transform 0.2s ease;
        }

        .accordion-content {
            display: none;
            padding: 20px;
            background-color: #1a1a1a;
        }

        .accordion-content.active {
            display: block;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #3a3a3a;
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-label {
            color: #fff;
            margin-bottom: 4px;
        }

        .setting-description {
            color: #7a7a7a;
            font-size: 12px;
        }

        .toggle-switch {
            width: 44px;
            height: 24px;
            background-color: #4a9eff;
            border-radius: 12px;
            position: relative;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .toggle-switch.off {
            background-color: #5a5a5a;
        }

        .toggle-switch::after {
            content: '';
            width: 20px;
            height: 20px;
            background-color: white;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            right: 2px;
            transition: all 0.2s ease;
        }

        .toggle-switch.off::after {
            right: 22px;
        }

        .setting-select {
            background: #3a3a3a;
            color: #fff;
            border: 1px solid #4a4a4a;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 14px;
        }

        .export-btn {
            background: #4a9eff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.2s;
        }

        .export-btn:hover {
            background: #3a8edf;
        }

        /* Î∞òÏùë??*/
        @media (max-width: 768px) {
            .sidebar {
                width: 70px;
            }
           
            .menu-text {
                display: none;
            }

            .overview-stats {
                grid-template-columns: 1fr;
            }

            .member-item,
            .member-list-header,
            .table-row,
            .table-header,
            .user-cumulative-row,
            .user-cumulative-table {
                grid-template-columns: 1fr;
                gap: 8px;
            }
        }

        /* Ï∞®Ìä∏ Í≤Ä?ÔøΩÏ∞Ω ?ÔøΩÔøΩ???Í∞úÏÑ† */
        #chart-search-input {
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        #chart-search-input:focus {
            border-color: #4a9eff !important;
            box-shadow: 0 0 0 2px rgba(74, 158, 255, 0.1) !important;
            outline: none;
        }

        /* Í≤Ä??clear Î≤ÑÌäº ?ÔøΩÔøΩ???*/
        .search-clear-btn:hover {
            background-color: #3a3a3a !important;
            color: #e1e1e1 !important;
        }

        /* ?ÔøΩÏù¥?ÔøΩÎ¶¨?ÔøΩÌä∏ ?ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÔøΩ???*/
        #heatmap-emails-datalist {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 8px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- ?ÔøΩÏù¥?ÔøΩÎ∞î -->
        <nav class="sidebar">
            <div style="height: 20px;"></div>
            <a href="javascript:void(0)" class="refresh-button" onclick="handleRefreshClick()">
                <span class="menu-icon">?ÔøΩÔøΩ</span>
                <span class="menu-text">?ÔøΩÏö©???ÔøΩÎ≥¥ ?ÔøΩÎç∞?ÔøΩÌä∏</span>
                <div class="refresh-progress">
                    <div class="refresh-progress-bar"></div>
                </div>
            </a>
            <div style="height: 1px; background-color: #3a3a3a; margin: 10px 20px;"></div>
            <a href="javascript:void(0)" class="menu-item active" data-section="overview">
                <span class="menu-icon">?ÔøΩÔøΩ</span>
                <span class="menu-text">Overview</span>
            </a>
            <a href="javascript:void(0)" class="menu-item" data-section="settings">
                <span class="menu-icon">?ÔøΩÔ∏è</span>
                <span class="menu-text">Settings</span>
            </a>
            <a href="javascript:void(0)" class="menu-item" data-section="members">
                <span class="menu-icon">?ÔøΩÔøΩ</span>
                <span class="menu-text">Members</span>
            </a>
            <a href="javascript:void(0)" class="menu-item" data-section="usage">
                <span class="menu-icon">?ÔøΩÔøΩ</span>
                <span class="menu-text">Usage</span>
            </a>
        </nav>

        <!-- Î©îÏù∏ ÏΩòÌÖêÔø?-->
        <main class="main-content">
            <header class="header">
                <div class="header-left">
                    <h1 id="page-title">Dashboard Overview</h1>
                </div>
                <div class="header-right">
                    <!-- Clear Cache button and Ready status removed -->
                </div>
            </header>

            <div class="content-area">
                <!-- Overview ?ÔøΩÏÖò -->
                <div id="overview" class="content-section active">
                    <!-- 2.1.1 ?ÔøΩÌÑ∞Ôø?Í∏∞Îä• -->
                    <div class="filter-controls">
                        <div class="chart-controls">
                            <div class="filter-period-display">
                                <span id="filter-period-text">2025-08-03 ~ 2025-08-03</span>
                            </div>
                            <button class="chart-btn" data-days="1">1d</button>
                            <button class="chart-btn" data-days="7">7d</button>
                            <button class="chart-btn active" data-days="30">30d</button>
                            <div class="date-picker">
                                <input type="date" id="start-date" />
                                <span>~</span>
                                <input type="date" id="end-date" />
                                <button class="analytics-btn" onclick="applyDateFilter()">?ÔøΩÏö©</button>
                            </div>
                        </div>

                    </div>

                    <!-- ?ÔøΩÏö©??Í∞úÏöî Ïπ¥Îìú (Usage?ÔøΩÏÑú ?ÔøΩÎèô) -->
                    <div class="usage-cards">
                        <div class="usage-card">
                            <div class="usage-card-number">-</div>
                            <div class="usage-card-label">?ÔøΩÌÉù??Í∏∞Í∞Ñ ???ÔøΩÏ†ú ?ÔøΩÎèô???ÔøΩÏö©????/div>
                        </div>
                        <div class="usage-card">
                            <div class="usage-card-number">-</div>
                            <div class="usage-card-label">?ÔøΩÌÉù??Í∏∞Í∞Ñ ???ÔøΩÏù¥?ÔøΩÌä∏ ?ÔøΩÏßë ?ÔøΩÏù∏ ??/div>
                        </div>
                        <div class="usage-card">
                            <div class="usage-card-number">-</div>
                            <div class="usage-card-label">?ÔøΩÌÉù??Í∏∞Í∞Ñ ???ÔøΩÎùΩ??????/div>
                        </div>
                        <div class="usage-card">
                            <div class="usage-card-number">-</div>
                            <div class="usage-card-label">?ÔøΩÌÉù??Í∏∞Í∞Ñ ??Ï±ÑÌåÖ ??/div>
                        </div>
                    </div>

                    <!-- Í∑∏Îûò???ÔøΩÏó≠ -->
                    <div class="overview-chart-container">
                        <div class="chart-header">
                            <div class="chart-selector">
                                <select id="chartSelect" onchange="handleChartChange(this.value)">
                                    <option value="activity-trend">?ÔøΩÔøΩ ?ÔøΩÎ≥Ñ ?ÔøΩÎèô Ï∂îÏù¥</option>
                                    <option value="model-distribution">?ÔøΩÔøΩ Î™®Îç∏ ?ÔøΩÏö© Î∂ÑÌè¨</option>
                                    <option value="cost-trend">?ÔøΩÔøΩ ÎπÑÏö© Ï∂îÏù¥</option>
                                    <option value="activity-type">?ÔøΩÔøΩ ?ÔøΩÎèô ?ÔøΩÌòï Î∂ÑÌè¨</option>
                                    <option value="user-heatmap">?ÔøΩÔøΩ ?ÔøΩÏö©???ÔøΩÎèô ?ÔøΩÌä∏Ôø?/option>
                                    <option value="cost-efficiency">?ÔøΩÔøΩ ÎπÑÏö© ?ÔøΩÏú®??Î∂ÑÏÑù</option>
                                    <option value="model-preference">?ÔøΩÔøΩ Î™®Îç∏ ?ÔøΩÌò∏??/option>
                                    <option value="user-performance">?ÔøΩÔøΩ ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÍ≥º</option>
                                    <option value="activity-type-detailed">?ÔøΩÔøΩ ?ÔøΩÎèô ?ÔøΩÌòï ?ÔøΩÏÑ∏</option>
                                </select>
                            </div>
                            <!-- Ï∞®Ìä∏Ôø?Í≤Ä?ÔøΩÏ∞Ω (Í∏∞Î≥∏?ÔøΩÏúºÔø??ÔøΩÔøΩ?) -->
                            <div id="chart-search-container" class="chart-search" style="display: none; margin-top: 10px;">
                                <div class="search-container">
                                    <div style="position: relative; display: flex; align-items: center; max-width: 300px;">
                                        <span style="position: absolute; left: 12px; color: #7a7a7a; font-size: 14px;">?ÔøΩÔøΩ</span>
                                        <input type="text" class="search-box" id="chart-search-input" placeholder="Search..." onkeyup="handleChartSearch(this.value)" oninput="toggleSearchClearBtn('chart-search-input')" autocomplete="off" style="padding-left: 35px; border-radius: 8px; border: 1px solid #3a3a3a; background-color: #2a2a2a; color: #e1e1e1; padding-right: 35px;">
                                        <button class="search-clear-btn" id="chart-search-input-clear" onclick="clearChartSearch('chart-search-input')" style="display: none; position: absolute; right: 8px; background: none; border: none; color: #7a7a7a; font-size: 18px; cursor: pointer; padding: 4px; border-radius: 50%; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center;">√ó</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="activity-trend-chart" class="chart-content active">
                            <canvas id="overviewChart" style="width: 100%; height: 300px;"></canvas>
                        </div>
                        <div id="model-distribution-chart" class="chart-content">
                            <canvas id="modelDistributionChart" style="width: 100%; height: 300px;"></canvas>
                        </div>
                        <div id="cost-trend-chart" class="chart-content">
                            <canvas id="costTrendChart" style="width: 100%; height: 300px;"></canvas>
                        </div>
                        <div id="activity-type-chart" class="chart-content">
                            <canvas id="activityTypeChart" style="width: 100%; height: 300px;"></canvas>
                        </div>
                        <div id="user-heatmap-chart" class="chart-content">
                            <canvas id="userHeatmapChart" style="width: 100%; height: 300px;"></canvas>
                        </div>
                        <div id="cost-efficiency-chart" class="chart-content">
                            <canvas id="costEfficiencyChart" style="width: 100%; height: 300px;"></canvas>
                        </div>
                        <div id="model-preference-chart" class="chart-content">
                            <canvas id="modelPreferenceChart" style="width: 100%; height: 300px;"></canvas>
                        </div>
                        <div id="user-performance-chart" class="chart-content">
                            <canvas id="userPerformanceChart" style="width: 100%; height: 300px;"></canvas>
                        </div>
                        <div id="activity-type-detailed-chart" class="chart-content">
                            <canvas id="activityTypeDetailedChart" style="width: 100%; height: 300px;"></canvas>
                        </div>
                    </div>

                    <!-- 2.1.2 ?ÔøΩÍ≥Ñ Ïπ¥Îìú -->
                    <div class="overview-stats">
                        <div class="overview-stat-box clickable" data-type="total" onclick="filterOverviewMembersByType('total')">
                            <div class="stat-number">20</div>
                            <div class="stat-label">
                                <span class="role-badge" style="background-color: #4a9eff; color: white;">?ÔøΩÏ≤¥ Î©§Î≤Ñ</span>
                            </div>
                            <div class="stat-description">Î™®Îì† Î©§Î≤Ñ???ÔøΩÎèô Í∏∞Î°ù</div>
                        </div>
                        <div class="overview-stat-box clickable" data-type="active" onclick="filterOverviewMembersByType('active')">
                            <div class="stat-number">13</div>
                            <div class="stat-label">
                                <span class="role-badge" style="background-color: #4caf50; color: white;">?ÔøΩÏÑ± Î©§Î≤Ñ</span>
                            </div>
                            <div class="stat-description">?ÔøΩÏÑ± Î©§Î≤Ñ???ÔøΩÎèô Í∏∞Î°ù</div>
                        </div>
                        <div class="overview-stat-box clickable" data-type="inactive" onclick="filterOverviewMembersByType('inactive')">
                            <div class="stat-number">7</div>
                            <div class="stat-label">
                                <span class="role-badge" style="background-color: #ff9800; color: white;">ÎπÑÌôú??Î©§Î≤Ñ</span>
                            </div>
                            <div class="stat-description">ÎπÑÌôú??Î©§Î≤Ñ???ÔøΩÎèô Í∏∞Î°ù</div>
                        </div>
                    </div>

                    <!-- Î©§Î≤Ñ ?ÔøΩÔøΩ? Î¶¨Ïä§??-->
                    <div class="overview-member-details">
                        <div class="overview-activity-header">?ÔøΩÔøΩ ?ÔøΩÎèô Î¶¨Ïä§??/div>
                        <div class="overview-activity-table">
                            <div>ÎßàÔøΩ?Ôø??ÔøΩÎèô</div>
                            <div>?ÔøΩÏö©??/div>
                            <div>?ÔøΩÌÉú</div>
                            <div>?ÔøΩÎèô ?ÔøΩÌòï</div>
                            <div>?ÔøΩÏ≤≠ ??/div>
                            <div>ÎπÑÏö©</div>
                            <div>?ÔøΩÌïú</div>
                        </div>
                        <div id="overview-activity-container">
                            <!-- ?ÔøΩÏ†Å?ÔøΩÎ°ú ?ÔøΩÏÑ±???ÔøΩÏù¥Ôø??ÔøΩÏö© -->
                            <div style="padding: 20px; text-align: center; color: #7a7a7a; background-color: #1a1a1a;">
                                ?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂àÎü¨?ÔøΩÎäî Ôø?..
                            </div>
                        </div>
                        
                        <!-- Overview ?ÔøΩÎèôÎ¶¨Ïä§???ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥??(Members ?ÔøΩÔøΩ??? -->
                        <div id="overview-activity-pagination" style="display: none; padding: 15px 20px; background-color: #2a2a2a; border-top: 1px solid #3a3a3a; text-align: center;">
                            <!-- ?ÔøΩÏûê ?ÔøΩÏù¥ÏßÄ Î≤ÑÌäº?ÔøΩÏù¥ ?ÔøΩÏ†Å?ÔøΩÎ°ú ?ÔøΩÏÑ±??-->
                        </div>
                    </div>
                </div>

                <!-- Members ?ÔøΩÏÖò -->
                <div id="members" class="content-section">
                    <div class="filter-controls" style="margin-bottom: 10px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                            <div style="color: #e1e1e1; font-size: 14px; font-weight: 500; margin-left: 20px;">
                                Fast Requests last reset on: <span id="fast-requests-reset-date" style="color: #ffffff; font-weight: 600;">2025??7??22??/span> (?ÔøΩÎäò ?ÔøΩÏßú: <span id="today-date" style="color: #ff9800; font-weight: 600;">2025-08-03</span>)
                            </div>
                            <div style="display: flex; align-items: center; gap: 15px; margin-left: auto;">
                                <div class="search-container">
                                    <div style="position: relative; display: flex; align-items: center;">
                                        <span style="position: absolute; left: 12px; color: #7a7a7a; font-size: 14px;">?ÔøΩÔøΩ</span>
                                        <input type="text" class="search-box" id="members-search" placeholder="Search name, email..." onkeyup="filterMembers(this.value)" oninput="toggleSearchClearBtn('members-search'); showAutocomplete('members-search')" autocomplete="off" style="padding-left: 35px;">
                                        <button class="search-clear-btn" id="members-search-clear" onclick="clearSearch('members-search')" style="display: none;">√ó</button>
                                    </div>
                                    <div id="members-autocomplete" class="autocomplete-dropdown" style="display: none;"></div>
                                </div>
                                <button class="export-csv-btn" onclick="exportMembersToCSV()" style="background: #4caf50; color: white; border: none; padding: 8px 16px; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: pointer; transition: background-color 0.2s ease;">
                                    ?ÔøΩÔøΩ Export CSV
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="data-table" id="members-table-container">
                        <!-- ?ÔøΩÏ†Å?ÔøΩÎ°ú ?ÔøΩÏÑ±???ÔøΩÏù¥Ôø??ÔøΩÎçî?Ôø??ÔøΩÏö© -->
                        <div style="padding: 20px; text-align: center; color: #7a7a7a; background-color: #1a1a1a;">
                            ?ÔøΩÏ†ú Î©§Î≤Ñ ?ÔøΩÏù¥?ÔøΩÔøΩ? Î°úÎî©?ÔøΩÎäî Ôø?..
                        </div>
                    </div>
                    
                    <!-- Members ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥??(All Raw Events ?ÔøΩÔøΩ??? -->
                    <div id="members-pagination" style="display: none; padding: 15px 20px; background-color: #2a2a2a; border-top: 1px solid #3a3a3a; text-align: center;">
                        <!-- ?ÔøΩÏûê ?ÔøΩÏù¥ÏßÄ Î≤ÑÌäº?ÔøΩÏù¥ ?ÔøΩÏ†Å?ÔøΩÎ°ú ?ÔøΩÏÑ±??-->
                    </div>
                </div>

                <!-- Usage ?ÔøΩÏÖò -->
                <div id="usage" class="content-section">
                    <!-- ?ÔøΩÏßú ?ÔøΩÌÑ∞?Ôø?Í≤Ä??-->
                    <div class="filter-controls">
                        <div class="chart-controls">
                            <div class="filter-period-display">
                                <span id="usage-filter-period-text">2025-08-03 ~ 2025-08-03</span>
                            </div>
                            <button class="chart-btn" data-days="1">1d</button>
                            <button class="chart-btn" data-days="7">7d</button>
                            <button class="chart-btn active" data-days="30">30d</button>
                            <div class="date-picker">
                                <input type="date" id="usage-start-date" />
                                <span>~</span>
                                <input type="date" id="usage-end-date" />
                                <button class="analytics-btn" onclick="applyUsageDateFilter()">?ÔøΩÏö©</button>
                            </div>
                        </div>
                        <div>
                            <div class="search-container">
                                <div style="position: relative; display: flex; align-items: center;">
                                    <span style="position: absolute; left: 12px; color: #7a7a7a; font-size: 14px;">?ÔøΩÔøΩ</span>
                                    <input type="text" class="search-box" id="usage-search" placeholder="Search name, email..." onkeyup="filterUsageMembers(this.value)" oninput="toggleSearchClearBtn('usage-search'); showAutocomplete('usage-search')" autocomplete="off" style="padding-left: 35px;">
                                    <button class="search-clear-btn" id="usage-search-clear" onclick="clearSearch('usage-search')" style="display: none;">√ó</button>
                                </div>
                                <div id="usage-autocomplete" class="autocomplete-dropdown" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <!-- ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÎ≥¥ -->
                    <div class="user-cumulative-info">
                        <div class="user-cumulative-header">?ÔøΩÔøΩ ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥</div>
                        <div class="user-cumulative-table">
                            <div>NAME</div>
                            <div>EMAIL</div>
                            <div>ROLE</div>
                            <div>REQUEST</div>
                            <div>SPEND</div>
                            <div>LAST ACT</div>
                        </div>
                        <div id="user-cumulative-container">
                            <!-- ?ÔøΩÏ†Å?ÔøΩÎ°ú ?ÔøΩÏÑ±???ÔøΩÏù¥Ôø??ÔøΩÏö© -->
                            <div style="padding: 20px; text-align: center; color: #7a7a7a; background-color: #1a1a1a;">
                                ?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂àÎü¨?ÔøΩÎäî Ôø?..
                            </div>
                        </div>
                        
                        <!-- ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥ ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥??(All Raw Events ?ÔøΩÔøΩ??? -->
                        <div id="user-cumulative-pagination" style="display: none; padding: 15px 20px; background-color: #2a2a2a; border-top: 1px solid #3a3a3a; text-align: center;">
                            <!-- ?ÔøΩÏûê ?ÔøΩÏù¥ÏßÄ Î≤ÑÌäº?ÔøΩÏù¥ ?ÔøΩÏ†Å?ÔøΩÎ°ú ?ÔøΩÏÑ±??-->
                        </div>
                    </div>

                    <!-- All Raw Events ?ÔøΩÏù¥Ôø?-->
                    <div class="user-cumulative-info">
                        <div class="user-cumulative-header">?ÔøΩÔøΩ All Raw Events</div>
                        <div class="user-cumulative-table">
                            <div>DATE</div>
                            <div>USER</div>
                            <div>KIND</div>
                            <div>MAX_MODEL</div>
                            <div>MODEL</div>
                            <div>COST</div>
                        </div>
                        <div style="padding: 20px; text-align: center; color: #7a7a7a; background-color: #1a1a1a;">
                            ?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂àÎü¨?ÔøΩÎäî Ôø?..
                        </div>
                        
                        <!-- ?ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÎ≤§???ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥??-->
                        <div class="filtered-events-pagination" style="display: none; padding: 15px 20px; background-color: #2a2a2a; border-top: 1px solid #3a3a3a; text-align: center;">
                            <!-- ?ÔøΩÏûê ?ÔøΩÏù¥ÏßÄ Î≤ÑÌäº?ÔøΩÏù¥ ?ÔøΩÏ†Å?ÔøΩÎ°ú ?ÔøΩÏÑ±??-->
                        </div>
                    </div>
                </div>

                <!-- Settings ?ÔøΩÏÖò -->
                <div id="settings" class="content-section">
                    <!-- ?ÔøΩÏÑ± Í∏∞Í∞Ñ ?ÔøΩÏ†ï -->
                    <div class="settings-section">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <div class="accordion-title">?ÔøΩÏÑ± Í∏∞Í∞Ñ ?ÔøΩÏ†ï</div>
                            <div class="accordion-arrow">??/div>
                        </div>
                        <div class="accordion-content">
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">?ÔøΩÏÑ± ?ÔøΩÌÉú ?ÔøΩÎèô ?ÔøΩÌôò</div>
                                    <div class="setting-description">ÏßÄ?ÔøΩÎêú Í∏∞Í∞Ñ ?ÔøΩÏïà ?ÔøΩÎèô???ÔøΩÏúºÔø??ÔøΩÎèô?ÔøΩÎ°ú ÎπÑÌôú???ÔøΩÌÉúÔø??ÔøΩÌôò?ÔøΩÎãà??/div>
                                </div>
                                <div class="toggle-switch" onclick="toggleSwitch(this)"></div>
                            </div>
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">ÎπÑÌôú???ÔøΩÌôò Í∏∞Í∞Ñ</div>
                                    <div class="setting-description">?ÔøΩÎèô???ÔøΩÏùÑ Í≤ΩÏö∞ ÎπÑÌôú?ÔøΩÏúºÔø??ÔøΩÌôò?ÔøΩÎäî Í∏∞Í∞Ñ</div>
                                </div>
                                <select class="setting-select">
                                    <option>7??/option>
                                    <option>14??/option>
                                    <option selected>30??/option>
                                    <option>60??/option>
                                    <option>90??/option>
                                </select>
                            </div>
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">?ÔøΩÏÑ± ?ÔøΩÌÉú ?ÔøΩÎ¶º</div>
                                    <div class="setting-description">ÎπÑÌôú???ÔøΩÌôò ???ÔøΩÏö©?ÔøΩÏóêÔø??ÔøΩÎ¶º??Î∞úÏÜ°?ÔøΩÎãà??/div>
                                </div>
                                <div class="toggle-switch" onclick="toggleSwitch(this)"></div>
                            </div>
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">?ÔøΩÎ¶º Î∞úÏÜ° ?ÔøΩÏ†ê</div>
                                    <div class="setting-description">ÎπÑÌôú???ÔøΩÌôò Ôø????ÔøΩÏóê ?ÔøΩÎ¶º??Î∞úÏÜ°?ÔøΩÔøΩ? ?ÔøΩÏ†ï</div>
                                </div>
                                <select class="setting-select">
                                    <option>1????/option>
                                    <option selected>3????/option>
                                    <option>7????/option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Email Report ?ÔøΩÏ†ï -->
                    <div class="settings-section">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <div class="accordion-title">Email Report ?ÔøΩÏ†ï</div>
                            <div class="accordion-arrow">??/div>
                        </div>
                        <div class="accordion-content">
                            <!-- ?ÔøΩÎèô Î¶¨Ìè¨???ÔøΩÏÑ±??-->
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">?ÔøΩÎèô Î¶¨Ìè¨???ÔøΩÏÑ±??/div>
                                    <div class="setting-description">?ÔøΩÍ∏∞?ÔøΩÏúºÔø??ÔøΩÎ©î??Î¶¨Ìè¨?ÔøΩÔøΩ? ?ÔøΩÎèô Î∞úÏÜ°?ÔøΩÎãà??/div>
                                </div>
                                <div class="toggle-switch" onclick="toggleSwitch(this)"></div>
                            </div>

                            <!-- Î∞úÏÜ° Ï£ºÍ∏∞ -->
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">Î∞úÏÜ° Ï£ºÍ∏∞</div>
                                    <div class="setting-description">Î¶¨Ìè¨?ÔøΩÔøΩ? Î∞úÏÜ°??Ï£ºÍ∏∞Ôø??ÔøΩÌÉù?ÔøΩÏÑ∏??/div>
                                </div>
                                <select class="setting-select" id="email-frequency-select" style="background-color: transparent;" onfocus="this.style.backgroundColor='#3a3a3a'" onblur="this.style.backgroundColor='transparent'">
                                    <option value="daily">Îß§Ïùº</option>
                                    <option value="weekly" selected>Îß§Ï£º</option>
                                    <option value="monthly">Îß§Ïõî</option>
                                </select>
                            </div>

                            <!-- Î∞úÏÜ° ?ÔøΩÍ∞Ñ ?ÔøΩÏ†ï -->
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">Î∞úÏÜ° ?ÔøΩÍ∞Ñ ?ÔøΩÏ†ï</div>
                                    <div class="setting-description">Î¶¨Ìè¨?ÔøΩÔøΩ? Î∞úÏÜ°??Íµ¨Ï≤¥?ÔøΩÏù∏ ?ÔøΩÍ∞Ñ???ÔøΩÏ†ï?ÔøΩÏÑ∏??/div>
                                </div>
                                <input type="time" id="email-time-input" value="09:00" style="
                                    background-color: transparent;
                                    border: 1px solid #3a3a3a;
                                    border-radius: 4px;
                                    padding: 8px 12px;
                                    color: #e1e1e1;
                                    font-size: 14px;
                                    font-family: inherit;
                                    transition: background-color 0.2s ease;
                                " onfocus="this.style.backgroundColor='#3a3a3a'" onblur="this.style.backgroundColor='transparent'">
                            </div>

                            <!-- Î∞úÏÜ° Î©îÏãúÏßÄ ?ÔøΩÎ†• -->
                            <div class="setting-item" style="flex-direction: column; align-items: flex-start;">
                                <div style="margin-bottom: 15px;">
                                    <div class="setting-label">Î∞úÏÜ° Î©îÏãúÏßÄ ?ÔøΩÎ†•</div>
                                    <div class="setting-description">?ÔøΩÎ©î??Î¶¨Ìè¨?ÔøΩÏóê ?ÔøΩÌï®??Î©îÏãúÏßÄÔø??ÔøΩÎ†•?ÔøΩÏÑ∏??/div>
                                </div>
                                <div style="
                                    position: relative;
                                    background-color: #1a1a1a;
                                    border: 1px solid #3a3a3a;
                                    border-radius: 4px;
                                    transition: all 0.2s ease;
                                    width: 100%;
                                    max-width: 800px;
                                ">
                                    <textarea 
                                        id="email-report-message" 
                                        placeholder="?ÔøΩÎ©î?ÔøΩÏóê ?ÔøΩÌï®??Î©îÏãúÏßÄÔø??ÔøΩÎ†•?ÔøΩÏÑ∏??.."
                                        style="
                                            width: 100%;
                                            height: 120px;
                                            padding: 12px;
                                            border: none;
                                            background: transparent;
                                            color: #ff9800;
                                            font-size: 14px;
                                            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                                            line-height: 1.5;
                                            outline: none;
                                            resize: vertical;
                                            min-height: 120px;
                                            max-height: 200px;
                                            box-sizing: border-box;
                                        "
                                        onfocus="this.parentElement.style.backgroundColor='#2a2a2a'; this.parentElement.style.borderColor='#4a9eff'"
                                        onblur="this.parentElement.style.backgroundColor='#1a1a1a'; this.parentElement.style.borderColor='#3a3a3a'"
                                        oninput="updateMessageCharCount()"
                                    ></textarea>
                                </div>
                                <div style="
                                    color: #7a7a7a;
                                    font-size: 12px;
                                    margin-top: 5px;
                                    text-align: right;
                                    width: 100%;
                                    max-width: 800px;
                                ">
                                    <span id="report-message-char-count">0</span>/1000 Í∏Ä??                                </div>
                            </div>

                            <!-- ?ÔøΩÏã†??Í∑∏Î£π -->
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">?ÔøΩÏã†??Í∑∏Î£π</div>
                                    <div class="setting-description">Î¶¨Ìè¨?ÔøΩÔøΩ? Î∞õÏùÑ ?Ôø?ÔøΩÏùÑ ?ÔøΩÏ†ï?ÔøΩÎãà??/div>
                                </div>
                                <div style="display: flex; gap: 10px;">
                                    <label style="display: flex; align-items: center; gap: 5px;">
                                        <input type="checkbox" id="admin-checkbox" checked style="width: 16px; height: 16px;" onchange="updateRecipientCount()">
                                        <span style="color: #e1e1e1; font-size: 14px;">Í¥ÄÎ¶¨Ïûê</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 5px;">
                                        <input type="checkbox" id="all-members-checkbox" style="width: 16px; height: 16px;" onchange="updateRecipientCount()">
                                        <span style="color: #e1e1e1; font-size: 14px;">?ÔøΩÏ≤¥ Î©§Î≤Ñ</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 5px;">
                                        <input type="checkbox" id="inactive-members-checkbox" style="width: 16px; height: 16px;" onchange="updateRecipientCount()">
                                        <span style="color: #e1e1e1; font-size: 14px;">ÎπÑÌôú??Î©§Î≤Ñ</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 5px;">
                                        <input type="checkbox" id="custom-email-checkbox" style="width: 16px; height: 16px;" onclick="toggleCustomEmailInput(this)" onchange="updateRecipientCount()">
                                        <span style="color: #e1e1e1; font-size: 14px;">ÏßÅÏ†ë ?ÔøΩÎ†•</span>
                                    </label>
                                </div>
                                <div style="margin-top: 10px; color: #7a7a7a; font-size: 12px;">
                                    ?ÔøΩÌÉù???ÔøΩÏã†?? <span id="recipient-count">0</span>Ôø?                                </div>
                            </div>
                            
                            <!-- ÏßÅÏ†ë ?ÔøΩÎ†• ?ÔøΩÏó≠ -->
                            <div id="custom-email-input" style="display: none; margin-top: 10px;">
                                <div style="margin-bottom: 8px;">
                                    <span style="color: #e1e1e1; font-size: 12px;">ÏßÅÏ†ë ?ÔøΩÎ†• ?ÔøΩÎ©î??Ï£ºÏÜå (?ÔøΩÌëúÔø?Íµ¨Î∂Ñ)</span>
                                </div>
                                <textarea
                                    id="custom-emails"
                                    placeholder="example1@samsung.com, example2@samsung.com"
                                    style="
                                        width: 100%;
                                        min-height: 60px;
                                        padding: 8px;
                                        border: 1px solid #3a3a3a;
                                        border-radius: 4px;
                                        background-color: transparent;
                                        color: #e1e1e1;
                                        font-size: 12px;
                                        resize: vertical;
                                        font-family: inherit;
                                        box-sizing: border-box;
                                    "
                                ></textarea>
                            </div>
                            
                            <!-- ?ÔøΩÎã® Î≤ÑÌäº -->
                            <div class="setting-item" style="margin-top: 20px;">
                                <div>
                                    <div class="setting-label">?ÔøΩÏ†ï Í¥ÄÔø?/div>
                                    <div class="setting-description">?ÔøΩÏû¨ ?ÔøΩÏ†ï???ÔøΩÏù∏?ÔøΩÍ≥† ?Ôø?ÔøΩÌï©?ÔøΩÎã§</div>
                                </div>
                                <div style="display: flex; gap: 10px;">
                                    <button class="analytics-btn" onclick="showEmailScheduleList()">?ÔøΩÏïΩ Î¶¨Ïä§??/button>
                                    <button class="analytics-btn" onclick="showEmailRecipients()">?ÔøΩÏã†??Î≥¥Í∏∞</button>
                                    <button class="analytics-btn" onclick="saveEmailSettings()">?ÔøΩÏ†ï ?Ôø??/button>
                                </div>
                            </div>


                        </div>
                    </div>

                    <!-- Export Documents ?ÔøΩÏ†ï -->
                    <div class="settings-section">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <div class="accordion-title">Export Documents ?ÔøΩÏ†ï</div>
                            <div class="accordion-arrow">??/div>
                        </div>
                        <div class="accordion-content">
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">?ÔøΩÎèô Î∞±ÏóÖ</div>
                                    <div class="setting-description">?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÍ∏∞?ÔøΩÏúºÔø??ÔøΩÎèô Î∞±ÏóÖ?ÔøΩÎãà??/div>
                                </div>
                                <div class="toggle-switch" onclick="toggleSwitch(this)"></div>
                            </div>
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">Export ?ÔøΩÏãù</div>
                                    <div class="setting-description">Î¨∏ÏÑúÔø??ÔøΩÎ≥¥???ÔøΩÏùº ?ÔøΩÏãù???ÔøΩÌÉù?ÔøΩÎãà??/div>
                                </div>
                                <select class="setting-select">
                                    <option>CSV</option>
                                    <option selected>Excel (XLSX)</option>
                                    <option>PDF</option>
                                    <option>JSON</option>
                                </select>
                            </div>
                            <div class="setting-item">
                                <div>
                                    <div class="setting-label">Export Î≤îÏúÑ</div>
                                    <div class="setting-description">?ÔøΩÎ≥¥???ÔøΩÏù¥?ÔøΩÏùò Í∏∞Í∞Ñ???ÔøΩÏ†ï?ÔøΩÎãà??/div>
                                </div>
                                <select class="setting-select">
                                    <option>ÏµúÍ∑º 7??/option>
                                    <option selected>ÏµúÍ∑º 30??/option>
                                    <option>ÏµúÍ∑º 90??/option>
                                    <option>?ÔøΩÏ≤¥ Í∏∞Í∞Ñ</option>
                                    <option>?ÔøΩÏö©??ÏßÄ??/option>
                                </select>
                            </div>
                            <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #3a3a3a;">
                                <button class="export-btn">?ÔøΩÔøΩ ÏßÄÔø?Export ?ÔøΩÍ∏∞</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Î©§Î≤Ñ ?ÔøΩÎèô ?ÔøΩÏù¥??        const memberData = {
            total: [
                { date: "25??7??25??(?ÔøΩÎäò)", email: "greenmold@samsung.com", type: "active", kind: "Chat Request", request: "3", spend: "$0.05" },
                { date: "25??7??25??(?ÔøΩÎäò)", email: "ck9104.lee@samsung.com", type: "active", kind: "Code Generation", request: "2", spend: "$0.03" },
                { date: "25??7??25??(?ÔøΩÎäò)", email: "by07.so@samsung.com", type: "active", kind: "Analysis", request: "5", spend: "$0.08" },
                { date: "25??7??24??(1?ÔøΩÏ†Ñ)", email: "dynamic.choi@samsung.com", type: "inactive", kind: "Chat Request", request: "1", spend: "$0.01" },
                { date: "25??7??24??(1?ÔøΩÏ†Ñ)", email: "darney.jeon@samsung.com", type: "inactive", kind: "Code Review", request: "2", spend: "$0.02" },
                { date: "25??7??24??(1?ÔøΩÏ†Ñ)", email: "j0117.lee@samsung.com", type: "active", kind: "Documentation", request: "4", spend: "$0.04" },
                { date: "25??7??24??(1?ÔøΩÏ†Ñ)", email: "kaeul.kim@samsung.com", type: "active", kind: "Chat Request", request: "6", spend: "$0.06" },
                { date: "25??7??24??(1?ÔøΩÏ†Ñ)", email: "nw.aioffice@samsung.com", type: "inactive", kind: "Analysis", request: "1", spend: "$0.01" },
                { date: "25??7??24??(1?ÔøΩÏ†Ñ)", email: "sh.ryan.park@samsung.com", type: "active", kind: "Code Generation", request: "7", spend: "$0.07" },
                { date: "25??7??24??(1?ÔøΩÏ†Ñ)", email: "sejin.seo@samsung.com", type: "active", kind: "Chat Request", request: "3", spend: "$0.03" },
                { date: "25??7??23??(2?ÔøΩÏ†Ñ)", email: "sol22.lee@samsung.com", type: "inactive", kind: "Documentation", request: "2", spend: "$0.02" },
                { date: "25??7??23??(2?ÔøΩÏ†Ñ)", email: "shee.lim@samsung.com", type: "inactive", kind: "Analysis", request: "1", spend: "$0.01" },
                { date: "25??7??23??(2?ÔøΩÏ†Ñ)", email: "joseph2.jeon@samsung.com", type: "active", kind: "Code Review", request: "5", spend: "$0.05" },
                { date: "25??7??23??(2?ÔøΩÏ†Ñ)", email: "taewoo.bang@samsung.com", type: "inactive", kind: "Chat Request", request: "1", spend: "$0.01" },
                { date: "25??7??23??(2?ÔøΩÏ†Ñ)", email: "baewj@samsung.com", type: "inactive", kind: "Code Generation", request: "3", spend: "$0.03" },
                { date: "25??7??22??(3?ÔøΩÏ†Ñ)", email: "yj7.park@samsung.com", type: "active", kind: "Analysis", request: "4", spend: "$0.04" },
                { date: "25??7??22??(3?ÔøΩÏ†Ñ)", email: "nemo.kim@samsung.com", type: "active", kind: "Chat Request", request: "6", spend: "$0.06" },
                { date: "25??7??22??(3?ÔøΩÏ†Ñ)", email: "ms0402.kim@samsung.com", type: "active", kind: "Documentation", request: "3", spend: "$0.03" },
                { date: "25??7??21??(4?ÔøΩÏ†Ñ)", email: "shx.kim@samsung.com", type: "active", kind: "Code Review", request: "5", spend: "$0.05" },
                { date: "25??7??21??(4?ÔøΩÏ†Ñ)", email: "greenmold@samsung.com", type: "active", kind: "Analysis", request: "8", spend: "$0.08" }
            ]
        };

        // ?ÔøΩÏÑ±/ÎπÑÌôú??Î©§Î≤Ñ ?ÔøΩÎèô Î∂ÑÎ•ò
        memberData.active = memberData.total.filter(activity => activity.type === "active");
        memberData.inactive = memberData.total.filter(activity => activity.type === "inactive");

        // Î©§Î≤Ñ Î¶¨Ïä§???ÔøΩÎçîÔø?        function renderMemberList(type) {
            const memberList = document.getElementById('member-list');
            const memberListTitle = document.getElementById('member-list-title');
           
            let activities = [];
            let title = "";
            let icon = "";
           
            switch(type) {
                case 'active':
                    activities = memberData.active;
                    title = "?ÔøΩÏÑ± Î©§Î≤Ñ ?ÔøΩÎèô Î¶¨Ïä§??;
                    icon = "?ÔøΩÔøΩ";
                    break;
                case 'inactive':
                    activities = memberData.inactive;
                    title = "ÎπÑÌôú??Î©§Î≤Ñ ?ÔøΩÎèô Î¶¨Ïä§??;
                    icon = "?ÔøΩÔøΩ";
                    break;
                default:
                    activities = memberData.total;
                    title = "?ÔøΩÏ≤¥ ?ÔøΩÎèô Î¶¨Ïä§??;
                    icon = "?ÔøΩÔøΩ";
            }
           
            memberListTitle.textContent = `${icon} ${title}`;
           
            memberList.innerHTML = `
                <div class="member-list-header">
                    <div>DATE</div>
                    <div>EMAIL</div>
                    <div>TYPE</div>
                    <div>KIND</div>
                    <div>REQUEST</div>
                    <div>SPEND</div>
                </div>
                ${activities.map(activity => `
                    <div class="member-item">
                        <div class="member-date">${activity.date}</div>
                        <div class="member-email">${activity.email}</div>
                        <div class="member-type ${activity.type}">${activity.type === 'active' ? '?ÔøΩÏÑ±' : 'ÎπÑÌôú??}</div>
                        <div class="member-kind">${activity.kind}</div>
                        <div class="member-request">${activity.request}</div>
                        <div class="member-spend">${activity.spend}</div>
                    </div>
                `).join('')}
            `;
        }

        // ?ÔøΩÍ≥Ñ Î∞ïÏä§ ?ÔøΩÎ¶≠ ?ÔøΩÎ≤§??        function initOverviewStats() {
            const statBoxes = document.querySelectorAll('.overview-stat-box');
           
            statBoxes.forEach(box => {
                box.addEventListener('click', function() {
                    // Î™®Îì† Î∞ïÏä§?ÔøΩÏÑú selected ?ÔøΩÎûò???ÔøΩÍ±∞
                    statBoxes.forEach(b => b.classList.remove('selected'));
                   
                    // ?ÔøΩÎ¶≠??Î∞ïÏä§??selected ?ÔøΩÎûò??Ï∂îÔøΩ?
                    this.classList.add('selected');
                   
                    // ?ÔøΩÎãπ ?Ôø?ÔøΩÏùò Î©§Î≤Ñ Î¶¨Ïä§???ÔøΩÏãú
                    const type = this.getAttribute('data-type');
                    renderMemberList(type);
                });
            });
           
            // Ï¥àÍ∏∞ Î°úÎìú ???ÔøΩÏ≤¥ Î©§Î≤Ñ Î¶¨Ïä§???ÔøΩÏãú
            renderMemberList('total');
        }

        // ?ÔøΩÏû¨ ?ÔøΩÌÑ∞ ?ÔøΩÌÉúÔø?Í∞Ä?ÔøΩÏò§???ÔøΩÏàò
        function getCurrentFilterState() {
            let dateRange;
            if (currentDateRange) {
                dateRange = currentDateRange;
            } else {
                const filterDays = getCurrentFilterDays();
                dateRange = getDateRange(filterDays);
            }
            
            return {
                dateRange: dateRange,
                filterType: currentFilterType,
                members: currentMembers,
                rawEventsData: currentRawEventsData
            };
        }
        
        // ?ÔøΩÌÑ∞ ?ÔøΩÌÉúÍ∞Ä ?ÔøΩÏùº?ÔøΩÔøΩ? ÎπÑÍµê?ÔøΩÎäî ?ÔøΩÏàò
        function isFilterStateEqual(filter1, filter2) {
            if (!filter1 || !filter2) return false;
            
            return filter1.dateRange.startDate.getTime() === filter2.dateRange.startDate.getTime() &&
                   filter1.dateRange.endDate.getTime() === filter2.dateRange.endDate.getTime() &&
                   filter1.filterType === filter2.filterType &&
                   filter1.members.length === filter2.members.length &&
                   filter1.rawEventsData.length === filter2.rawEventsData.length;
        }
        
        // Ï∫êÏãú??Ï∞®Ìä∏Ôø?Ï∫îÎ≤Ñ?ÔøΩÏóê Î≥µÏõê?ÔøΩÎäî ?ÔøΩÏàò
        function restoreCachedChart(chartType) {
            const cachedChart = chartCache[chartType];
            if (!cachedChart.data) return false;
            
            const canvas = getCanvasForChartType(chartType);
            if (!canvas) return false;
            
            const ctx = canvas.getContext('2d');
            
            // Ï∫îÎ≤Ñ???ÔøΩÍ∏∞ ?ÔøΩÏ†ï
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = 300;
            
            // Ï∫êÏãú???ÔøΩÔøΩ?ÏßÄ ?ÔøΩÏù¥??Î≥µÏõê
            ctx.putImageData(cachedChart.data, 0, 0);
            
            console.log(`?ÔøΩÔøΩ Ï∫êÏãú??Ï∞®Ìä∏ Î≥µÏõê ?ÔøΩÎ£å: ${chartType}`);
            return true;
        }
        
        // Ï∞®Ìä∏ ?Ôø?ÔøΩÏóê ?ÔøΩÎ•∏ Ï∫îÎ≤Ñ???ÔøΩÏÜå Î∞òÌôò
        function getCanvasForChartType(chartType) {
            const canvasIds = {
                'activity-trend': 'overviewChart',
                'model-distribution': 'modelDistributionChart',
                'cost-trend': 'costTrendChart',
                'activity-type': 'activityTypeChart',
                'user-heatmap': 'userHeatmapChart',
                'cost-efficiency': 'costEfficiencyChart',
                'model-preference': 'modelPreferenceChart',
                'user-performance': 'userPerformanceChart',
                'activity-type-detailed': 'activityTypeDetailedChart'
            };
            
            return document.getElementById(canvasIds[chartType]);
        }
        
        // Ï∞®Ìä∏ ?ÔøΩÏù¥?ÔøΩÔøΩ? Ï∫êÏãú???Ôø?ÔøΩÌïò???ÔøΩÏàò
        function cacheChartData(chartType) {
            const canvas = getCanvasForChartType(chartType);
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            
            chartCache[chartType].data = imageData;
            console.log(`?ÔøΩÔøΩ Ï∞®Ìä∏ ?ÔøΩÏù¥??Ï∫êÏãú ?Ôø?? ${chartType}`);
        }
        
        // Ï∞®Ìä∏???ÔøΩÏöî???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÎäîÏßÄ ?ÔøΩÏù∏?ÔøΩÎäî ?ÔøΩÏàò
        async function checkAndLoadDataForChart(chartType) {
            console.log(`?ÔøΩÔøΩ ${chartType} Ï∞®Ìä∏ ?ÔøΩÏù¥???ÔøΩÌÉú ?ÔøΩÏù∏ Ôø?..`);
            
            // ?ÔøΩÌï© ?ÔøΩÏù¥???Ôø?ÔøΩÏÜå ?ÔøΩÏÑ† ?ÔøΩÏù∏
            const currentFilter = getCurrentFilterState();
            if (chartDataStore.isDataValid(currentFilter)) {
                console.log(`???ÔøΩÌï© ?ÔøΩÏù¥???Ôø?ÔøΩÏÜå?ÔøΩÏÑú ${chartType} Ï∞®Ìä∏???ÔøΩÏöî???ÔøΩÏù¥?ÔøΩÔøΩ? Ï∞æÏïò?ÔøΩÎãà??`);
                return true;
            }
            
            // ?ÔøΩÌï© ?ÔøΩÏù¥???Ôø?ÔøΩÏÜå???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏúºÔø??ÔøΩÏû¨ ?ÔøΩÏó≠ Î≥Ä???ÔøΩÏù∏
            const members = currentMembersData || [];
            const rawEvents = currentRawEventsData || [];
            
            console.log(`?ÔøΩÔøΩ ?ÔøΩÏó≠ Î≥Ä???ÔøΩÏù¥???ÔøΩÌÉú - Î©§Î≤Ñ: ${members.length}Ôø? ?ÔøΩÎ≤§?? ${rawEvents.length}Ôø?);
            
            // Î™®Îç∏ Î∂ÑÌè¨ Ï∞®Ìä∏???ÔøΩÎ≤§???ÔøΩÏù¥?ÔøΩÎßå ?ÔøΩÏúºÔø???            if (chartType === 'model-distribution') {
                if (rawEvents.length === 0) {
                    console.log('??Î™®Îç∏ Î∂ÑÌè¨ Ï∞®Ìä∏: ?ÔøΩÏö© Í∞Ä?ÔøΩÌïú ?ÔøΩÎ≤§???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§. ?ÔøΩÏù¥??Î°úÎî©???ÔøΩÎèÑ?ÔøΩÎãà??');
                    // ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏúºÔø?Overview ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏãú Î°úÎìú
                    return false;
                }
                console.log('??Î™®Îç∏ Î∂ÑÌè¨ Ï∞®Ìä∏: ?ÔøΩÎ≤§???ÔøΩÏù¥???ÔøΩÏù∏ ?ÔøΩÎ£å');
                return true;
            }
            
            if (members.length === 0) {
                console.log('???ÔøΩÏö© Í∞Ä?ÔøΩÌïú Î©§Î≤Ñ ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                return false;
            }
            
            if (rawEvents.length === 0) {
                console.log('???ÔøΩÏö© Í∞Ä?ÔøΩÌïú ?ÔøΩÎ≤§???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                return false;
            }
            
            // ?ÔøΩÏ†ï Ï∞®Ìä∏Ôø?Ï∂îÔøΩ? ?ÔøΩÏù¥???ÔøΩÏù∏
            if (chartType === 'cost-trend' || chartType === 'cost-efficiency') {
                // ÎπÑÏö© Í¥Ä??Ï∞®Ìä∏??cost ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏöî
                const hasCostData = rawEvents.some(event => 
                    event.requestsCosts !== undefined && event.requestsCosts !== null
                );
                if (!hasCostData) {
                    console.log('??ÎπÑÏö© ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                    return false;
                }
            }
            
            console.log(`??${chartType} Ï∞®Ìä∏???ÔøΩÏöî???ÔøΩÏù¥?ÔøΩÔøΩ? Î™®Îëê ?ÔøΩÏäµ?ÔøΩÎã§.`);
            return true;
        }
        
        // Ï∞®Ìä∏Ôø??ÔøΩÌïú ?ÔøΩÏù¥???ÔøΩÎ°úÍ≥†Ïπ® ?ÔøΩÏàò
        async function refreshDataForChart(chartType) {
            console.log(`?ÔøΩÔøΩ ${chartType} Ï∞®Ìä∏Ôø??ÔøΩÌïú ?ÔøΩÏù¥???ÔøΩÎ°úÍ≥†Ïπ® ?ÔøΩÏûë...`);
            
            try {
                // Î°úÎî© ?ÔøΩÌÉú ?ÔøΩÏãú
                showLoadingStatus(true);
                
                // Í∏∞Î≥∏ ?ÔøΩÏù¥???ÔøΩÎ°úÍ≥†Ïπ®
                await Promise.all([
                    updateMembersWithRealData(),
                    updateOverviewWithRealData()
                ]);
                
                console.log(`??${chartType} Ï∞®Ìä∏ ?ÔøΩÏù¥???ÔøΩÎ°úÍ≥†Ïπ® ?ÔøΩÎ£å`);
                return true;
            } catch (error) {
                console.error(`??${chartType} Ï∞®Ìä∏ ?ÔøΩÏù¥???ÔøΩÎ°úÍ≥†Ïπ® ?ÔøΩÌå®:`, error);
                showErrorMessage(`Ï∞®Ìä∏ ?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂àÎü¨?ÔøΩÎäî Ôø??ÔøΩÎ•òÍ∞Ä Î∞úÏÉù?ÔøΩÏäµ?ÔøΩÎã§: ${error.message}`);
                return false;
            } finally {
                // Î°úÎî© ?ÔøΩÌÉú ?ÔøΩÏ†ú
                showLoadingStatus(false);
            }
        }
        
        // Ï∞®Ìä∏ Î≥ÄÔø??ÔøΩÎ≤§???ÔøΩÎì§??        function handleChartChange(chartType) {
            console.log(`?ÔøΩÔøΩ Ï∞®Ìä∏ Î≥ÄÔø??ÔøΩÏ≤≠: ${chartType}`);
            
            // Î™®Îì† Ï∞®Ìä∏?ÔøΩÏÑú Í≤Ä?ÔøΩÏ∞Ω ?ÔøΩÔøΩ?
            const searchContainer = document.getElementById('chart-search-container');
            if (searchContainer) {
                searchContainer.style.display = 'none';
                // Í≤Ä?ÔøΩÏ∞Ω Ï¥àÍ∏∞??                const searchInput = document.getElementById('chart-search-input');
                if (searchInput) {
                    searchInput.value = '';
                    clearChartSearch('chart-search-input');
                }
            }
            
            // ?ÔøΩÎ≥Ñ Ï≤òÎ¶¨Í∞Ä ?ÔøΩÏöî??Ï∞®Ìä∏??(activity-trend ?ÔøΩÏô∏)
            if (chartType !== 'activity-trend') {
                // ?ÔøΩÏö©???ÔøΩÎèô ?ÔøΩÌä∏ÎßµÍ≥º Î™®Îç∏ ?ÔøΩÌò∏?ÔøΩÏóê Í≤Ä?ÔøΩÏ∞Ω ?ÔøΩÏãú
                if (chartType === 'user-heatmap' || chartType === 'model-preference') {
                    const searchContainer = document.getElementById('chart-search-container');
                    if (searchContainer) {
                        searchContainer.style.display = 'block';
                        const searchInput = document.getElementById('chart-search-input');
                        if (searchInput) {
                            if (chartType === 'user-heatmap') {
                                searchInput.placeholder = '?ÔøΩÏö©??ID Í≤Ä??..';
                                // ?ÔøΩÌä∏ÎßµÏö© ?ÔøΩÎ©î???ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÏÑ±
                                populateHeatmapEmailDropdown();
                            } else if (chartType === 'model-preference') {
                                searchInput.placeholder = '?ÔøΩÏö©??ID Í≤Ä??..';
                                // Î™®Îç∏ ?ÔøΩÌò∏?ÔøΩÏö© ?ÔøΩÎ©î???ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÏÑ±
                                populateModelPreferenceDropdown();
                            }
                        }
                    }
                } else {
                    const searchContainer = document.getElementById('chart-search-container');
                    if (searchContainer) {
                        searchContainer.style.display = 'none';
                        const searchInput = document.getElementById('chart-search-input');
                        if (searchInput) {
                            searchInput.value = '';
                            clearChartSearch('chart-search-input');
                        }
                    }
                }
                console.log(`?ÔøΩÔøΩ ?ÔøΩÎ≥Ñ Ï≤òÎ¶¨ Ï∞®Ìä∏: ${chartType}`);
                
                // Î®ºÔøΩ? Ï∞®Ìä∏ Ïª®ÌÖå?ÔøΩÎÑà ?ÔøΩÏãú
                document.querySelectorAll('.chart-content').forEach(content => {
                    content.classList.remove('active');
                });
                
                const chartId = `${chartType}-chart`;
                const selectedChart = document.getElementById(chartId);
                if (selectedChart) {
                    selectedChart.classList.add('active');
                    console.log(`??${chartType} Ï∞®Ìä∏ Ïª®ÌÖå?ÔøΩÎÑà ?ÔøΩÏÑ±???ÔøΩÎ£å`);
                } else {
                    console.error(`??${chartId} ?ÔøΩÏÜåÔø?Ï∞æÏùÑ ???ÔøΩÏäµ?ÔøΩÎã§!`);
                    return;
                }
                
                // ?ÔøΩÏù¥???ÔøΩÏù∏ Ôø?Î°úÎî©
                const hasMembersData = currentMembersData && currentMembersData.length > 0;
                const hasEventsData = currentRawEventsData && currentRawEventsData.length > 0;
                
                console.log(`?ÔøΩÔøΩ ?ÔøΩÏù¥???ÔøΩÌÉú ?ÔøΩÏù∏: Î©§Î≤Ñ?ÔøΩÏù¥??${hasMembersData}, ?ÔøΩÎ≤§?ÔøΩÎç∞?ÔøΩÌÑ∞=${hasEventsData}`);
                
                // ?ÔøΩÏù¥???ÔøΩÍµ¨?ÔøΩÌï≠Ôø??ÔøΩÏù∏
                let needsData = false;
                if (chartType === 'model-distribution') {
                    needsData = !hasEventsData;
                } else if (chartType === 'user-performance') {
                    needsData = !hasMembersData || !hasEventsData;
                } else if (chartType === 'cost-trend' || chartType === 'cost-efficiency') {
                    needsData = !hasEventsData; // ÎπÑÏö© Í¥Ä??Ï∞®Ìä∏???ÔøΩÎ≤§???ÔøΩÏù¥?ÔøΩÎßå ?ÔøΩÏöî
                } else {
                    needsData = !hasMembersData || !hasEventsData; // Í∏∞ÔøΩ? Ï∞®Ìä∏???????ÔøΩÏöî
                }
                
                if (needsData) {
                    console.log(`?ÔøΩÔøΩ ${chartType} Ï∞®Ìä∏Ôø??ÔøΩÌïú ?ÔøΩÏù¥??Î°úÎî© ?ÔøΩÏûë...`);
                    
                    // Î°úÎî© Î©îÏãúÏßÄ ?ÔøΩÏãú - Ï∞®Ìä∏Ôø?Ï∫îÎ≤Ñ??ID Îß§Ìïë
                    const canvasIdMap = {
                        'user-performance': 'userPerformanceChart',
                        'model-distribution': 'modelDistributionChart',
                        'cost-trend': 'costTrendChart',
                        'activity-type': 'activityTypeChart',
                        'user-heatmap': 'userHeatmapChart',
                        'cost-efficiency': 'costEfficiencyChart',
                        'model-preference': 'modelPreferenceChart',
                        'activity-type-detailed': 'activityTypeDetailedChart'
                    };
                    const canvasId = canvasIdMap[chartType] || 'overviewChart';
                    const canvas = document.getElementById(canvasId);
                    if (canvas) {
                        const rect = canvas.getBoundingClientRect();
                        canvas.width = rect.width;
                        canvas.height = 300;
                        const ctx = canvas.getContext('2d');
                        ctx.fillStyle = '#1a1a1a';
                        ctx.fillRect(0, 0, canvas.width, canvas.height);
                        ctx.fillStyle = '#7a7a7a';
                        ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                        ctx.textAlign = 'center';
                        ctx.fillText('?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂àÎü¨?ÔøΩÎäî Ôø?..', canvas.width / 2, canvas.height / 2);
                    }
                    
                    updateOverviewWithCurrentFilter(30).then(() => {
                        console.log('???ÔøΩÏù¥??Î°úÎî© ?ÔøΩÎ£å, Ï∞®Ìä∏ ?ÔøΩÏÑ± ?ÔøΩÏûë');
                        // Ï∞®Ìä∏Ôø??ÔøΩÏÑ± ?ÔøΩÏàò ?ÔøΩÏ∂ú
                        if (chartType === 'user-performance') {
                            createUserPerformanceChart();
                        } else if (chartType === 'model-distribution') {
                            createModelDistributionChart();
                        } else if (chartType === 'cost-trend') {
                            createCostTrendChart();
                        } else if (chartType === 'activity-type') {
                            createActivityTypeChart();
                        } else if (chartType === 'user-heatmap') {
                            createUserHeatmapChart();
                        } else if (chartType === 'cost-efficiency') {
                            createCostEfficiencyChart();
                        } else if (chartType === 'model-preference') {
                            createModelPreferenceChart();
                        } else if (chartType === 'activity-type-detailed') {
                            createActivityTypeDetailedChart();
                        }
                    }).catch(error => {
                        console.error('?ÔøΩÏù¥??Î°úÎî© ?ÔøΩÌå®:', error);
                        const canvas = document.getElementById(canvasId);
                        if (canvas) {
                            const ctx = canvas.getContext('2d');
                            ctx.fillStyle = '#1a1a1a';
                            ctx.fillRect(0, 0, canvas.width, canvas.height);
                            ctx.fillStyle = '#f44336';
                            ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                            ctx.textAlign = 'center';
                            ctx.fillText('?ÔøΩÏù¥??Î°úÎî© ?ÔøΩÌå®', canvas.width / 2, canvas.height / 2);
                        }
                    });
                    return;
                } else {
                    // ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÔøΩ? ?ÔøΩÏúºÔø?Î∞îÎ°ú Ï∞®Ìä∏ ?ÔøΩÏÑ±
                    console.log('???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÔøΩ? Ï°¥Ïû¨?? Î∞îÎ°ú Ï∞®Ìä∏ ?ÔøΩÏÑ±');
                    if (chartType === 'user-performance') {
                        createUserPerformanceChart();
                    } else if (chartType === 'model-distribution') {
                        createModelDistributionChart();
                    } else if (chartType === 'cost-trend') {
                        createCostTrendChart();
                    } else if (chartType === 'activity-type') {
                        createActivityTypeChart();
                    } else if (chartType === 'user-heatmap') {
                        createUserHeatmapChart();
                    } else if (chartType === 'cost-efficiency') {
                        createCostEfficiencyChart();
                    } else if (chartType === 'model-preference') {
                        createModelPreferenceChart();
                    } else if (chartType === 'activity-type-detailed') {
                        createActivityTypeDetailedChart();
                    }
                    return;
                }
            }
            
            // ?ÔøΩÎ•∏ Ï∞®Ìä∏?ÔøΩÔøΩ? switchChart ?ÔøΩÏàò ?ÔøΩÏö©
            console.log(`?ÔøΩÔøΩ ?ÔøΩÎ•∏ Ï∞®Ìä∏ Ï≤òÎ¶¨: ${chartType}`);
            switchChart(chartType).catch(error => {
                console.error('Ï∞®Ìä∏ ?ÔøΩÌôò Ôø??ÔøΩÎ•òÍ∞Ä Î∞úÏÉù?ÔøΩÏäµ?ÔøΩÎã§:', error);
                showErrorMessage('Ï∞®Ìä∏Ôø?Î∂àÎü¨?ÔøΩÎäî Ôø??ÔøΩÎ•òÍ∞Ä Î∞úÏÉù?ÔøΩÏäµ?ÔøΩÎã§.');
            });
        }
        
        // Ï∞®Ìä∏ ?ÔøΩÌôò ?ÔøΩÏàò (?ÔøΩÏù¥??Î°úÎî© ?ÔøΩÌï®)
        async function switchChart(chartType) {
            console.log(`?ÔøΩÔøΩ switchChart ?ÔøΩÏ∂ú: ${chartType}`);
            
            // Î™®Îì† Ï∞®Ìä∏ ?ÔøΩÏö© ?ÔøΩÍ∏∞Ôø?            document.querySelectorAll('.chart-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // ?ÔøΩÌÉù??Ï∞®Ìä∏ ?ÔøΩÏö© ?ÔøΩÏãú
            const selectedChart = document.getElementById(`${chartType}-chart`);
            if (selectedChart) {
                selectedChart.classList.add('active');
                console.log(`??${chartType} Ï∞®Ìä∏ Ïª®ÌÖå?ÔøΩÎÑà ?ÔøΩÏÑ±???ÔøΩÎ£å`);
            } else {
                console.error(`??${chartType}-chart ?ÔøΩÏÜåÔø?Ï∞æÏùÑ ???ÔøΩÏäµ?ÔøΩÎã§!`);
                return;
            }
            
            // ?ÔøΩÏû¨ ?ÔøΩÌÑ∞ ?ÔøΩÌÉú Í∞Ä?ÔøΩÏò§Ôø?            const currentFilter = getCurrentFilterState();
            
            // Ï∫êÏãú??Ï∞®Ìä∏Í∞Ä ?ÔøΩÍ≥† ?ÔøΩÌÑ∞Í∞Ä ?ÔøΩÏùº?ÔøΩÔøΩ? ?ÔøΩÏù∏
            const cachedChart = chartCache[chartType];
            const shouldUseCache = cachedChart.rendered && cachedChart.data && isFilterStateEqual(cachedChart.filter, currentFilter);
            
            if (shouldUseCache) {
                console.log(`?ÔøΩÔøΩ Ï∫êÏãú??Ï∞®Ìä∏ ?ÔøΩÏö©: ${chartType}`);
                if (restoreCachedChart(chartType)) {
                    return;
                }
            }
            
            // ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÎäîÏßÄ ?ÔøΩÏù∏ (?ÔøΩÌï© ?ÔøΩÏù¥???Ôø?ÔøΩÏÜå ?ÔøΩÏÑ† ?ÔøΩÏö©)
            const hasRequiredData = await checkAndLoadDataForChart(chartType);
            if (!hasRequiredData) {
                console.log(`?ÔøΩÔ∏è ${chartType} Ï∞®Ìä∏???ÔøΩÏöî???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§. Overview Ï¥àÍ∏∞ Î°úÎî©??Î®ºÔøΩ? ?ÔøΩÎ£å?ÔøΩÏ£º?ÔøΩÏöî.`);
                // ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏúºÔø?Ï∞®Ìä∏??Î©îÏãúÏßÄÔø??ÔøΩÏãú?ÔøΩÍ≥† Î¶¨ÌÑ¥
                const canvas = getCanvasForChartType(chartType);
                if (canvas) {
                    const ctx = canvas.getContext('2d');
                    const rect = canvas.getBoundingClientRect();
                    canvas.width = rect.width;
                    canvas.height = 300;
                    
                    ctx.fillStyle = '#1a1a1a';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    ctx.fillStyle = '#7a7a7a';
                    ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                    ctx.textAlign = 'center';
                    ctx.fillText('?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂àÎü¨?ÔøΩÎäî Ôø?..', canvas.width / 2, canvas.height / 2);
                }
                return;
            }
            
            // ?ÔøΩÎ°ú??Ï∞®Ìä∏ ?ÔøΩÏÑ± ?ÔøΩÎäî ?ÔøΩÎç∞?ÔøΩÌä∏
            console.log(`?ÔøΩÔøΩ Ï∞®Ìä∏ ?ÔøΩÎ°ú ?ÔøΩÏÑ±/?ÔøΩÎç∞?ÔøΩÌä∏: ${chartType}`);
            
            // Ï∞®Ìä∏ ?Ôø?ÔøΩÏóê ?ÔøΩÎùº ?ÔøΩÏ†à??Ï∞®Ìä∏ ?ÔøΩÎçîÔø?            console.log(`?ÔøΩÔøΩ Ï∞®Ìä∏ ?Ôø??"${chartType}" ?ÔøΩÎçîÔø??ÔøΩÏûë...`);
            
            if (chartType === 'activity-trend') {
                console.log('?ÔøΩÔøΩ ?ÔøΩÎ≥Ñ ?ÔøΩÎèô Ï∂îÏù¥ Ï∞®Ìä∏ ?ÔøΩÏÑ±');
                createOverviewChart();
            } else if (chartType === 'model-distribution') {
                console.log('?ÔøΩÔøΩ Î™®Îç∏ ?ÔøΩÏö© Î∂ÑÌè¨ Ï∞®Ìä∏ ?ÔøΩÏÑ±');
                createModelDistributionChart();
            } else if (chartType === 'cost-trend') {
                console.log('?ÔøΩÔøΩ ÎπÑÏö© Ï∂îÏù¥ Ï∞®Ìä∏ ?ÔøΩÏÑ±');
                createCostTrendChart();
            } else if (chartType === 'activity-type') {
                console.log('?ÔøΩÔøΩ ?ÔøΩÎèô ?ÔøΩÌòï Î∂ÑÌè¨ Ï∞®Ìä∏ ?ÔøΩÏÑ±');
                createActivityTypeChart();
            } else if (chartType === 'user-heatmap') {
                console.log('?ÔøΩÔøΩ ?ÔøΩÏö©???ÔøΩÎèô ?ÔøΩÌä∏Ôø?Ï∞®Ìä∏ ?ÔøΩÏÑ±');
                createUserHeatmapChart();
            } else if (chartType === 'cost-efficiency') {
                console.log('?ÔøΩÔøΩ ÎπÑÏö© ?ÔøΩÏú®??Î∂ÑÏÑù Ï∞®Ìä∏ ?ÔøΩÏÑ±');
                createCostEfficiencyChart();
            } else if (chartType === 'model-preference') {
                console.log('?ÔøΩÔøΩ Î™®Îç∏ ?ÔøΩÌò∏??Ï∞®Ìä∏ ?ÔøΩÏÑ±');
                createModelPreferenceChart();
            } else if (chartType === 'user-performance') {
                console.log('?ÔøΩÔøΩ ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÍ≥º Ï∞®Ìä∏ ?ÔøΩÏÑ±');
                
                // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÍ≥º Ï∞®Ìä∏Ôø??ÔøΩÌïú ?ÔøΩÏù¥???ÔøΩÏù∏ Ôø?Î°úÎî©
                const hasMembersData = currentMembersData && currentMembersData.length > 0;
                const hasEventsData = currentRawEventsData && currentRawEventsData.length > 0;
                
                console.log(`?ÔøΩÔøΩ ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÍ≥º Ï∞®Ìä∏ ?ÔøΩÏù¥???ÔøΩÌÉú: Î©§Î≤Ñ ${hasMembersData ? currentMembersData.length : 0}Ôø? ?ÔøΩÎ≤§??${hasEventsData ? currentRawEventsData.length : 0}Ôø?);
                
                if (!hasMembersData || !hasEventsData) {
                    console.log('?ÔøΩÔ∏è ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÍ≥º Ï∞®Ìä∏???ÔøΩÏöî???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§. ?ÔøΩÏù¥?ÔøΩÔøΩ? Î®ºÔøΩ? Î°úÎìú?ÔøΩÏ£º?ÔøΩÏöî.');
                    // ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏúºÔø?Î©îÏãúÏßÄ ?ÔøΩÏãú
                    const canvas = document.getElementById('userPerformanceChart');
                    if (canvas) {
                        const ctx = canvas.getContext('2d');
                        const width = canvas.width;
                        const height = canvas.height;
                        
                        ctx.fillStyle = '#1a1a1a';
                        ctx.fillRect(0, 0, width, height);
                        
                        ctx.fillStyle = '#7a7a7a';
                        ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                        ctx.textAlign = 'center';
                        ctx.fillText('?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂àÎü¨?ÔøΩÎäî Ôø?..', width / 2, height / 2);
                    }
                    return;
                }
                
                createUserPerformanceChart();
            } else if (chartType === 'activity-type-detailed') {
                console.log('?ÔøΩÔøΩ ?ÔøΩÎèô ?ÔøΩÌòï ?ÔøΩÏÑ∏ Ï∞®Ìä∏ ?ÔøΩÏÑ±');
                createActivityTypeDetailedChart();
            } else {
                console.log('???????ÔøΩÎäî Ï∞®Ìä∏ ?Ôø??', chartType);
            }
            
            // Ï∞®Ìä∏ ?ÔøΩÎçîÔø??ÔøΩÎ£å ??Ï∫êÏãú???Ôø??            setTimeout(() => {
                cacheChartData(chartType);
                chartCache[chartType].filter = currentFilter;
                chartCache[chartType].rendered = true;
            }, 100);
            
            console.log(`?ÔøΩÔøΩ Ï∞®Ìä∏ ?ÔøΩÌôò ?ÔøΩÎ£å: ${chartType}`);
        }

        // Î™®Îç∏ ?ÔøΩÏö© Î∂ÑÌè¨ ÎßâÔøΩ? Ï∞®Ìä∏ ?ÔøΩÏÑ±
        function createModelDistributionChart() {
            console.log('?ÔøΩÔøΩ createModelDistributionChart ?ÔøΩÏûë...');
            console.log('?ÔøΩÔøΩ ?ÔøΩÏó≠ Î≥Ä???ÔøΩÌÉú ?ÔøΩÏù∏:');
            console.log('- currentRawEventsData:', currentRawEventsData);
            console.log('- currentRawEventsData Í∏∏Ïù¥:', currentRawEventsData ? currentRawEventsData.length : 'undefined');
            console.log('- chartDataStore.rawEvents Í∏∏Ïù¥:', chartDataStore.rawEvents ? chartDataStore.rawEvents.length : 'undefined');
            
            const canvas = document.getElementById('modelDistributionChart');
            if (!canvas) {
                console.error('??modelDistributionChart Ï∫îÎ≤Ñ?ÔøΩÔøΩ? Ï∞æÏùÑ ???ÔøΩÏäµ?ÔøΩÎã§.');
                return;
            }
            
            console.log('??Ï∫îÎ≤Ñ??Ï∞æÏùå:', canvas);
            
            // Canvas ?ÔøΩÍ∏∞ ?ÔøΩÏ†ï
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = 300;
            
            console.log('?ÔøΩÔøΩ Ï∫îÎ≤Ñ???ÔøΩÍ∏∞ ?ÔøΩÏ†ï:', canvas.width, 'x', canvas.height);
            
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            // Î∞∞Í≤Ω ?ÔøΩÏ†ï
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, width, height);
            console.log('??Î∞∞Í≤Ω ?ÔøΩÏ†ï ?ÔøΩÎ£å');
            
            // Î™®Îç∏ ?ÔøΩÏö© ?ÔøΩÏù¥???ÔøΩÏÑ±
            console.log('?ÔøΩÔøΩ Î™®Îç∏ ?ÔøΩÏù¥???ÔøΩÏÑ± ?ÔøΩÏûë...');
            const modelData = generateModelDistributionData();
            console.log('?ÔøΩÔøΩ ?ÔøΩÏÑ±??Î™®Îç∏ ?ÔøΩÏù¥??', modelData);
            
            if (modelData.length === 0) {
                console.log('?ÔøΩÔ∏è Î™®Îç∏ ?ÔøΩÏù¥?ÔøΩÔøΩ? ÎπÑÏñ¥?ÔøΩÏñ¥ Ôø?Ï∞®Ìä∏Ôø??ÔøΩÏãú?ÔøΩÎãà??');
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂àÎü¨?ÔøΩÎäî Ôø?..', width / 2, height / 2);
                return;
            }
            
            // ÎßâÔøΩ? Ï∞®Ìä∏ Í∑∏Î¶¨Ôø?            console.log('?ÔøΩÔøΩ ÎßâÔøΩ? Ï∞®Ìä∏ Í∑∏Î¶¨Ôø??ÔøΩÏûë...');
            drawModelDistributionBarChart(ctx, width, height, modelData);
            console.log('??Î™®Îç∏ Î∂ÑÌè¨ Ï∞®Ìä∏ ?ÔøΩÏÑ± ?ÔøΩÎ£å');
        }

        // Î™®Îç∏ ?ÔøΩÏö© Î∂ÑÌè¨ ?ÔøΩÏù¥???ÔøΩÏÑ±
        function generateModelDistributionData() {
            console.log('?ÔøΩÔøΩ generateModelDistributionData ?ÔøΩÏûë...');
            
            const modelUsage = new Map();
            
            // ?ÔøΩÏó≠ Î≥Ä?ÔøΩÏóê???ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø?(chartDataStore ?ÔøΩÏÑ†, ?ÔøΩÏúºÔø??ÔøΩÏó≠ Î≥Ä???ÔøΩÏö©)
            const rawEvents = (chartDataStore.rawEvents && chartDataStore.rawEvents.length > 0) ? 
                chartDataStore.rawEvents : (currentRawEventsData || []);
            
            console.log('?ÔøΩÔøΩ ?ÔøΩÏù¥???ÔøΩÏä§ ?ÔøΩÏù∏:');
            console.log('- chartDataStore.rawEvents:', chartDataStore.rawEvents ? chartDataStore.rawEvents.length : 0);
            console.log('- currentRawEventsData:', currentRawEventsData ? currentRawEventsData.length : 0);
            console.log('- ?ÔøΩÏö©??rawEvents.length:', rawEvents ? rawEvents.length : 0);
            
            if (rawEvents && rawEvents.length > 0) {
                console.log('?ÔøΩÔøΩ ?ÔøΩÎ≤§???ÔøΩÏù¥???ÔøΩÌîå (Ï≤òÏùå 3Ôø?:');
                rawEvents.slice(0, 3).forEach((event, index) => {
                    console.log(`?ÔøΩÎ≤§??${index}:`, {
                        model: event.model,
                        timestamp: event.timestamp,
                        userEmail: event.userEmail || event.email,
                        kind: event.kind,
                        ?ÔøΩÏ≤¥: event
                    });
                });
                
                // Î™®Îç∏Ôø??ÔøΩÏö© ?ÔøΩÏàò ÏßëÍ≥Ñ
                rawEvents.forEach((event, index) => {
                    const model = event.model || 'unknown';
                    modelUsage.set(model, (modelUsage.get(model) || 0) + 1);
                    
                    // Ï≤òÏùå 5Ôø??ÔøΩÎ≤§?ÔøΩÏùò Î™®Îç∏ ?ÔøΩÎ≥¥ Î°úÍ∑∏
                    if (index < 5) {
                        console.log(`- ?ÔøΩÎ≤§??${index}: model="${model}", ?ÔøΩÏ≤¥ ?ÔøΩÎ≤§??`, event);
                    }
                });
                
                console.log('?ÔøΩÔøΩ Î™®Îç∏Ôø??ÔøΩÏö© ?ÔøΩÏàò ÏßëÍ≥Ñ Í≤∞Í≥º:');
                modelUsage.forEach((count, model) => {
                    console.log(`- ${model}: ${count}??);
                });
                console.log('?ÔøΩÔøΩ modelUsage Map ?ÔøΩÍ∏∞:', modelUsage.size);
            } else {
                console.log('?ÔøΩÔ∏è generateModelDistributionData: ?ÔøΩÏö© Í∞Ä?ÔøΩÌïú ?ÔøΩÎ≤§???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                console.log('?ÔøΩÔ∏è rawEvents Ôø?', rawEvents);
                return [];
            }
            
            // ?ÔøΩÏù¥?ÔøΩÔøΩ? Î∞∞Ïó¥Ôø?Î≥Ä?ÔøΩÌïòÔø??ÔøΩÏÉÅ Ï∂îÔøΩ?
            const colors = ['#4a9eff', '#4caf50', '#ff9800', '#f44336', '#9c27b0', '#00bcd4'];
            const data = [];
            let colorIndex = 0;
            
            modelUsage.forEach((count, model) => {
                data.push({
                    label: model,
                    value: count,
                    color: colors[colorIndex % colors.length]
                });
                colorIndex++;
            });
            
            console.log(`?ÔøΩÔøΩ Î™®Îç∏ Î∂ÑÌè¨ ?ÔøΩÏù¥???ÔøΩÏÑ± ?ÔøΩÎ£å: ${data.length}Ôø?Î™®Îç∏ (?ÔøΩÏù¥???ÔøΩÏä§: ${rawEvents.length}Ôø??ÔøΩÎ≤§??`);
            console.log('?ÔøΩÔøΩ ÏµúÏ¢Ö ?ÔøΩÏù¥??', data);
            return data;
        }

        // ?ÔøΩÏù¥ Ï∞®Ìä∏ Í∑∏Î¶¨Ôø?        function drawPieChart(ctx, width, height, data) {
            const centerX = width / 2;
            const centerY = height / 2;
            const radius = Math.min(width, height) / 3;
            
            let total = data.reduce((sum, item) => sum + item.value, 0);
            let currentAngle = 0;
            
            data.forEach(item => {
                const sliceAngle = (item.value / total) * 2 * Math.PI;
                
                // ?ÔøΩÏù¥ ?ÔøΩÎùº?ÔøΩÏä§ Í∑∏Î¶¨Ôø?                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, currentAngle, currentAngle + sliceAngle);
                ctx.closePath();
                ctx.fillStyle = item.color;
                ctx.fill();
                
                // ?ÔøΩÎëêÔø?Í∑∏Î¶¨Ôø?                ctx.strokeStyle = '#1a1a1a';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                // ?ÔøΩÏù¥Ôø?Í∑∏Î¶¨Ôø?                const labelAngle = currentAngle + sliceAngle / 2;
                const labelX = centerX + (radius * 0.7) * Math.cos(labelAngle);
                const labelY = centerY + (radius * 0.7) * Math.sin(labelAngle);
                
                ctx.fillStyle = '#fff';
                ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(`${item.label} (${item.value})`, labelX, labelY);
                
                currentAngle += sliceAngle;
            });
            
            // Î≤îÔøΩ? Í∑∏Î¶¨Ôø?            drawPieChartLegend(ctx, width, height, data);
        }

        // Î™®Îç∏ ?ÔøΩÏö© Î∂ÑÌè¨ ÎßâÔøΩ? Ï∞®Ìä∏ Í∑∏Î¶¨Ôø?        function drawModelDistributionBarChart(ctx, width, height, data) {
            console.log('?ÔøΩÔøΩ drawModelDistributionBarChart ?ÔøΩÏûë...');
            console.log('?ÔøΩÔøΩ ?ÔøΩÎ†• ?ÔøΩÏù¥??', data);
            console.log('?ÔøΩÔøΩ Ï∫îÎ≤Ñ???ÔøΩÍ∏∞:', width, 'x', height);
            
            if (data.length === 0) {
                console.log('?ÔøΩÔ∏è ?ÔøΩÏù¥?ÔøΩÔøΩ? ÎπÑÏñ¥?ÔøΩÏñ¥ Î°úÎî© Î©îÏãúÏßÄÔø??ÔøΩÏãú?ÔøΩÎãà??');
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂àÎü¨?ÔøΩÎäî Ôø?..', width / 2, height / 2);
                return;
            }
            
            const padding = 60;
            const chartWidth = width - (padding * 2);
            const chartHeight = height - (padding * 2);
            const barWidth = chartWidth / data.length * 0.8;
            const barSpacing = chartWidth / data.length * 0.2;
            
            // ÏµúÔøΩ?Ôø?Í≥ÑÏÇ∞
            const maxValue = Math.max(...data.map(d => d.value));
            
            // YÔø?Í∑∏Î¶¨Ôø?            ctx.strokeStyle = '#3a3a3a';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, height - padding);
            ctx.stroke();
            
            // XÔø?Í∑∏Î¶¨Ôø?            ctx.beginPath();
            ctx.moveTo(padding, height - padding);
            ctx.lineTo(width - padding, height - padding);
            ctx.stroke();
            
            // YÔø??ÔøΩÏù¥Ôø?            ctx.fillStyle = '#7a7a7a';
            ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'right';
            ctx.textBaseline = 'middle';
            
            const ySteps = 5;
            for (let i = 0; i <= ySteps; i++) {
                const y = padding + (chartHeight / ySteps) * i;
                const value = Math.round((maxValue / ySteps) * (ySteps - i));
                ctx.fillText(value.toString(), padding - 10, y);
            }
            
            // ÎßâÔøΩ? Í∑∏Î¶¨Ôø?            const colors = ['#4a9eff', '#4caf50', '#ff9800', '#f44336', '#9c27b0', '#00bcd4'];
            
            data.forEach((item, index) => {
                const x = padding + (chartWidth / data.length) * index + barSpacing / 2;
                const barHeight = (item.value / maxValue) * chartHeight;
                const y = height - padding - barHeight;
                
                // ÎßâÔøΩ? Í∑∏Î¶¨Ôø?                ctx.fillStyle = colors[index % colors.length];
                ctx.fillRect(x, y, barWidth, barHeight);
                
                // ÎßâÔøΩ? ?ÔøΩÏóê Ôø??ÔøΩÏãú
                ctx.fillStyle = '#e1e1e1';
                ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(item.value.toString(), x + barWidth / 2, y - 10);
                
                // XÔø??ÔøΩÏù¥Ôø?(Î™®Îç∏Ôø?
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '11px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(item.label, x + barWidth / 2, height - padding + 20);
            });
            
            // ?ÔøΩÎ™©
            ctx.fillStyle = '#e1e1e1';
            ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('AI Î™®Îç∏Ôø??ÔøΩÏö© Î∂ÑÌè¨', width / 2, 25);
        }
        
        // ?ÔøΩÏù¥ Ï∞®Ìä∏ Î≤îÔøΩ? Í∑∏Î¶¨Ôø?        function drawPieChartLegend(ctx, width, height, data) {
            const legendX = 20;
            const legendY = height - 100;
            const itemHeight = 20;
            
            data.forEach((item, index) => {
                const y = legendY + index * itemHeight;
                
                // ?ÔøΩÏÉÅ Î∞ïÏä§
                ctx.fillStyle = item.color;
                ctx.fillRect(legendX, y, 15, 15);
                
                // ?ÔøΩÏä§??                ctx.fillStyle = '#fff';
                ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'left';
                ctx.fillText(`${item.label}: ${item.value}??, legendX + 20, y + 10);
            });
        }

        // ÎπÑÏö© Ï∂îÏù¥ ?ÔøΩÏù∏ Ï∞®Ìä∏ ?ÔøΩÏÑ±
        function createCostTrendChart() {
            console.log('?ÔøΩÔøΩ createCostTrendChart ?ÔøΩÏûë...');
            console.log('?ÔøΩÔøΩ ?ÔøΩÏó≠ Î≥Ä???ÔøΩÌÉú ?ÔøΩÏù∏:');
            console.log('- currentRawEventsData:', currentRawEventsData ? currentRawEventsData.length : 'undefined');
            console.log('- chartDataStore.rawEvents:', chartDataStore.rawEvents ? chartDataStore.rawEvents.length : 'undefined');
            
            const canvas = document.getElementById('costTrendChart');
            if (!canvas) {
                console.error('??costTrendChart Ï∫îÎ≤Ñ?ÔøΩÔøΩ? Ï∞æÏùÑ ???ÔøΩÏäµ?ÔøΩÎã§.');
                return;
            }
            console.log('??Ï∫îÎ≤Ñ??Ï∞æÏùå:', canvas);
            
            // Canvas ?ÔøΩÍ∏∞ ?ÔøΩÏ†ï
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = 300;
            
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            // Î∞∞Í≤Ω ?ÔøΩÏ†ï
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, width, height);
            
            // ÎπÑÏö© ?ÔøΩÏù¥???ÔøΩÏÑ±
            const costData = generateCostTrendData();
            console.log('?ÔøΩÔøΩ ?ÔøΩÏÑ±??ÎπÑÏö© ?ÔøΩÏù¥??', costData);
            
            if (costData.length === 0) {
                console.log('?ÔøΩÔ∏è ÎπÑÏö© ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§. Ôø?Ï∞®Ìä∏Ôø??ÔøΩÏãú?ÔøΩÎãà??');
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('ÎπÑÏö© ?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂àÎü¨?ÔøΩÎäî Ôø?..', width / 2, height / 2);
                return;
            }
            
            // ?ÔøΩÏù∏ Ï∞®Ìä∏ Í∑∏Î¶¨Ôø?            drawLineChart(ctx, width, height, costData);
            console.log('??ÎπÑÏö© Ï∂îÏù¥ Ï∞®Ìä∏ ?ÔøΩÏÑ± ?ÔøΩÎ£å');
        }

        // ÎπÑÏö© Ï∂îÏù¥ ?ÔøΩÏù¥???ÔøΩÏÑ±
        function generateCostTrendData() {
            console.log('?ÔøΩÔøΩ generateCostTrendData ?ÔøΩÏûë...');
            const dailyCosts = new Map();
            
            // ?ÔøΩÌï© ?ÔøΩÏù¥???Ôø?ÔøΩÏÜå?ÔøΩÏÑú ?ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø?            const rawEvents = (chartDataStore.rawEvents && chartDataStore.rawEvents.length > 0) ? 
                chartDataStore.rawEvents : (currentRawEventsData || []);
            
            console.log('?ÔøΩÔøΩ ?ÔøΩÏù¥???ÔøΩÏä§ ?ÔøΩÏù∏:');
            console.log('- chartDataStore.rawEvents:', chartDataStore.rawEvents ? chartDataStore.rawEvents.length : 0);
            console.log('- currentRawEventsData:', currentRawEventsData ? currentRawEventsData.length : 0);
            console.log('- ?ÔøΩÏö©??rawEvents.length:', rawEvents ? rawEvents.length : 0);
            
            if (rawEvents && rawEvents.length > 0) {
                rawEvents.forEach(event => {
                    const eventDate = new Date(parseInt(event.timestamp));
                    const dateKey = eventDate.toISOString().split('T')[0];
                    const cost = (event.requestsCosts || 0) / 100; // cents to dollars
                    
                    if (dailyCosts.has(dateKey)) {
                        dailyCosts.set(dateKey, dailyCosts.get(dateKey) + cost);
                    } else {
                        dailyCosts.set(dateKey, cost);
                    }
                });
            } else {
                console.log('?ÔøΩÔ∏è generateCostTrendData: ?ÔøΩÏö© Í∞Ä?ÔøΩÌïú ?ÔøΩÎ≤§???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                return [];
            }
            
            // ?ÔøΩÏßú?ÔøΩÏúºÔø??ÔøΩÎ†¨
            const sortedDates = Array.from(dailyCosts.keys()).sort();
            const data = sortedDates.map(date => ({
                date: date,
                cost: dailyCosts.get(date)
            }));
            
            console.log(`?ÔøΩÔøΩ ÎπÑÏö© Ï∂îÏù¥ ?ÔøΩÏù¥???ÔøΩÏÑ± ?ÔøΩÎ£å: ${data.length}?ÔøΩÍ∞Ñ???ÔøΩÏù¥??(?ÔøΩÏù¥???ÔøΩÏä§: ${rawEvents.length}Ôø??ÔøΩÎ≤§??`);
            return data;
        }

        // ?ÔøΩÏù∏ Ï∞®Ìä∏ Í∑∏Î¶¨Ôø?        function drawLineChart(ctx, width, height, data) {
            if (data.length === 0) {
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂àÎü¨?ÔøΩÎäî Ôø?..', width / 2, height / 2);
                return;
            }
            
            const padding = 40;
            const chartWidth = width - 2 * padding;
            const chartHeight = height - 2 * padding;
            
            // YÔø?ÏµúÔøΩ?Ôø?Í≥ÑÏÇ∞
            const maxCost = Math.max(...data.map(d => d.cost));
            const minCost = Math.min(...data.map(d => d.cost));
            const costRange = maxCost - minCost;
            
            // Í∑∏Î¶¨??Í∑∏Î¶¨Ôø?            ctx.strokeStyle = '#3a3a3a';
            ctx.lineWidth = 1;
            
            // Í∞ÄÔø?Í∑∏Î¶¨??            for (let i = 0; i <= 5; i++) {
                const y = padding + (chartHeight / 5) * i;
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(width - padding, y);
                ctx.stroke();
            }
            
            // ?ÔøΩÎ°ú Í∑∏Î¶¨??            for (let i = 0; i <= data.length - 1; i++) {
                const x = padding + (chartWidth / (data.length - 1)) * i;
                ctx.beginPath();
                ctx.moveTo(x, padding);
                ctx.lineTo(x, height - padding);
                ctx.stroke();
            }
            
            // ?ÔøΩÏù∏ Í∑∏Î¶¨Ôø?            ctx.strokeStyle = '#4a9eff';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            data.forEach((point, index) => {
                const x = padding + (chartWidth / (data.length - 1)) * index;
                const y = height - padding - ((point.cost - minCost) / costRange) * chartHeight;
                
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            
            ctx.stroke();
            
            // ?ÔøΩÏù¥???ÔøΩÏù∏??Í∑∏Î¶¨Ôø?            data.forEach((point, index) => {
                const x = padding + (chartWidth / (data.length - 1)) * index;
                const y = height - padding - ((point.cost - minCost) / costRange) * chartHeight;
                
                ctx.fillStyle = '#4a9eff';
                ctx.beginPath();
                ctx.arc(x, y, 4, 0, Math.PI * 2);
                ctx.fill();
            });
            
            // Ôø??ÔøΩÏù¥Ôø?Í∑∏Î¶¨Ôø?            ctx.fillStyle = '#7a7a7a';
            ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'center';
            
            // XÔø??ÔøΩÏù¥Ôø?(?ÔøΩÏßú)
            data.forEach((point, index) => {
                const x = padding + (chartWidth / (data.length - 1)) * index;
                const date = new Date(point.date);
                const dateStr = `${date.getMonth() + 1}/${date.getDate()}`;
                ctx.fillText(dateStr, x, height - 10);
            });
            
            // YÔø??ÔøΩÏù¥Ôø?(ÎπÑÏö©)
            for (let i = 0; i <= 5; i++) {
                const y = padding + (chartHeight / 5) * i;
                const cost = maxCost - (costRange / 5) * i;
                ctx.fillText(`$${cost.toFixed(2)}`, 10, y + 4);
            }
        }

        // ?ÔøΩÎèô ?ÔøΩÌòï Î∂ÑÌè¨ Ôø?Ï∞®Ìä∏ ?ÔøΩÏÑ±
        function createActivityTypeChart() {
            console.log('?ÔøΩÔøΩ createActivityTypeChart ?ÔøΩÏûë...');
            const canvas = document.getElementById('activityTypeChart');
            if (!canvas) {
                console.error('??activityTypeChart Ï∫îÎ≤Ñ?ÔøΩÔøΩ? Ï∞æÏùÑ ???ÔøΩÏäµ?ÔøΩÎã§.');
                return;
            }
            console.log('??Ï∫îÎ≤Ñ??Ï∞æÏùå:', canvas);
            
            // Canvas ?ÔøΩÍ∏∞ ?ÔøΩÏ†ï
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = 300;
            
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            // Î∞∞Í≤Ω ?ÔøΩÏ†ï
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, width, height);
            
            // ?ÔøΩÎèô ?ÔøΩÌòï ?ÔøΩÏù¥???ÔøΩÏÑ±
            const activityData = generateActivityTypeData();
            console.log('?ÔøΩÔøΩ ?ÔøΩÏÑ±???ÔøΩÎèô ?ÔøΩÌòï ?ÔøΩÏù¥??', activityData);
            
            if (activityData.length === 0) {
                console.log('?ÔøΩÔ∏è ?ÔøΩÎèô ?ÔøΩÌòï ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§. Ôø?Ï∞®Ìä∏Ôø??ÔøΩÏãú?ÔøΩÎãà??');
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('?ÔøΩÎèô ?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂àÎü¨?ÔøΩÎäî Ôø?..', width / 2, height / 2);
                return;
            }
            
            // Ôø?Ï∞®Ìä∏ Í∑∏Î¶¨Ôø?            drawBarChart(ctx, width, height, activityData);
            console.log('???ÔøΩÎèô ?ÔøΩÌòï Î∂ÑÌè¨ Ï∞®Ìä∏ ?ÔøΩÏÑ± ?ÔøΩÎ£å');
        }

        // ?ÔøΩÎèô ?ÔøΩÌòï ?ÔøΩÏù¥???ÔøΩÏÑ±
        function generateActivityTypeData() {
            console.log('?ÔøΩÔøΩ generateActivityTypeData ?ÔøΩÏûë...');
            const activityTypes = new Map();
            
            // ?ÔøΩÌï© ?ÔøΩÏù¥???Ôø?ÔøΩÏÜå?ÔøΩÏÑú ?ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø?            const rawEvents = (chartDataStore.rawEvents && chartDataStore.rawEvents.length > 0) ? 
                chartDataStore.rawEvents : (currentRawEventsData || []);
            
            console.log('?ÔøΩÔøΩ ?ÔøΩÏù¥???ÔøΩÏä§ ?ÔøΩÏù∏:');
            console.log('- chartDataStore.rawEvents:', chartDataStore.rawEvents ? chartDataStore.rawEvents.length : 0);
            console.log('- currentRawEventsData:', currentRawEventsData ? currentRawEventsData.length : 0);
            console.log('- ?ÔøΩÏö©??rawEvents.length:', rawEvents ? rawEvents.length : 0);
            
            if (rawEvents && rawEvents.length > 0) {
                rawEvents.forEach(event => {
                    const type = event.kind || 'unknown';
                    activityTypes.set(type, (activityTypes.get(type) || 0) + 1);
                });
            } else {
                console.log('?ÔøΩÔ∏è generateActivityTypeData: ?ÔøΩÏö© Í∞Ä?ÔøΩÌïú ?ÔøΩÎ≤§???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                return [];
            }
            
            // ?ÔøΩÏù¥?ÔøΩÔøΩ? Î∞∞Ïó¥Ôø?Î≥Ä?ÔøΩÌïòÔø??ÔøΩÏÉÅ Ï∂îÔøΩ?
            const colors = ['#4a9eff', '#4caf50', '#ff9800', '#f44336', '#9c27b0'];
            const data = [];
            let colorIndex = 0;
            
            activityTypes.forEach((count, type) => {
                data.push({
                    label: type,
                    value: count,
                    color: colors[colorIndex % colors.length]
                });
                colorIndex++;
            });
            
            console.log(`?ÔøΩÔøΩ ?ÔøΩÎèô ?ÔøΩÌòï ?ÔøΩÏù¥???ÔøΩÏÑ± ?ÔøΩÎ£â: ${data.length}Ôø??ÔøΩÌòï (?ÔøΩÏù¥???ÔøΩÏä§: ${rawEvents.length}Ôø??ÔøΩÎ≤§??`);
            return data;
        }

        // Ôø?Ï∞®Ìä∏ Í∑∏Î¶¨Ôø?        function drawBarChart(ctx, width, height, data) {
            if (data.length === 0) {
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂àÎü¨?ÔøΩÎäî Ôø?..', width / 2, height / 2);
                return;
            }
            
            const padding = 60;
            const chartWidth = width - 2 * padding;
            const chartHeight = height - 2 * padding;
            const barWidth = chartWidth / data.length;
            const maxValue = Math.max(...data.map(d => d.value));
            
            // Í∑∏Î¶¨??Í∑∏Î¶¨Ôø?            ctx.strokeStyle = '#3a3a3a';
            ctx.lineWidth = 1;
            
            // Í∞ÄÔø?Í∑∏Î¶¨??            for (let i = 0; i <= 5; i++) {
                const y = padding + (chartHeight / 5) * i;
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(width - padding, y);
                ctx.stroke();
            }
            
            // Ôø?Í∑∏Î¶¨Ôø?            data.forEach((item, index) => {
                const x = padding + barWidth * index + barWidth * 0.1;
                const barHeight = (item.value / maxValue) * chartHeight;
                const y = height - padding - barHeight;
                
                // Ôø?Í∑∏Î¶¨Ôø?                ctx.fillStyle = item.color;
                ctx.fillRect(x, y, barWidth * 0.8, barHeight);
                
                // Ôø??ÔøΩÏä§??                ctx.fillStyle = '#fff';
                ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(item.value.toString(), x + barWidth * 0.4, y - 10);
                
                // ?ÔøΩÏù¥Ôø?                ctx.fillStyle = '#7a7a7a';
                ctx.fillText(item.label, x + barWidth * 0.4, height - 10);
            });
            
            // YÔø??ÔøΩÏù¥Ôø?            ctx.fillStyle = '#7a7a7a';
            ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'right';
            
            for (let i = 0; i <= 5; i++) {
                const y = padding + (chartHeight / 5) * i;
                const value = maxValue - (maxValue / 5) * i;
                ctx.fillText(value.toString(), padding - 10, y + 4);
            }
        }

        // ?ÔøΩÏö©???ÔøΩÎèô ?ÔøΩÌä∏Ôø?Ï∞®Ìä∏ ?ÔøΩÏÑ± (ÎßâÔøΩ? Í∑∏Îûò??
        function createUserHeatmapChart() {
            console.log('?ÔøΩÔøΩ createUserHeatmapChart ?ÔøΩÏûë...');
            const canvas = document.getElementById('userHeatmapChart');
            if (!canvas) {
                console.error('??userHeatmapChart Ï∫îÎ≤Ñ?ÔøΩÔøΩ? Ï∞æÏùÑ ???ÔøΩÏäµ?ÔøΩÎã§.');
                return;
            }
            console.log('??Ï∫îÎ≤Ñ??Ï∞æÏùå:', canvas);
            
            // Canvas ?ÔøΩÍ∏∞ ?ÔøΩÏ†ï
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = 300;
            
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            // Î∞∞Í≤Ω ?ÔøΩÏ†ï
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, width, height);
            
            // ?ÔøΩÌä∏Ôø??ÔøΩÏù¥???ÔøΩÏÑ± (ÎßâÔøΩ? Í∑∏Îûò?ÔøΩÏö©)
            const heatmapData = generateHeatmapBarData();
            console.log('?ÔøΩÔøΩ ?ÔøΩÏÑ±???ÔøΩÌä∏Ôø??ÔøΩÏù¥??', heatmapData);
            
            if (heatmapData.length === 0) {
                console.log('?ÔøΩÔ∏è ?ÔøΩÌä∏Ôø??ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§. Ôø?Ï∞®Ìä∏Ôø??ÔøΩÏãú?ÔøΩÎãà??');
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('?ÔøΩÎèô ?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂àÎü¨?ÔøΩÎäî Ôø?..', width / 2, height / 2);
                return;
            }
            
            // ÎßâÔøΩ? Í∑∏Îûò??Í∑∏Î¶¨Ôø?            drawHeatmapBarChart(ctx, width, height, heatmapData);
            console.log('???ÔøΩÏö©???ÔøΩÎèô ?ÔøΩÌä∏Ôø?Ï∞®Ìä∏ ?ÔøΩÏÑ± ?ÔøΩÎ£å');
        }

        // ?ÔøΩÌä∏Ôø?ÎßâÔøΩ? Í∑∏Îûò?ÔøΩÏö© ?ÔøΩÏù¥???ÔøΩÏÑ±
        function generateHeatmapBarData() {
            console.log('?ÔøΩÔøΩ generateHeatmapBarData ?ÔøΩÏûë...');
            const userActivityMap = new Map();
            
            // ?ÔøΩÌï© ?ÔøΩÏù¥???Ôø?ÔøΩÏÜå?ÔøΩÏÑú ?ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø?            const members = (chartDataStore.members && chartDataStore.members.length > 0) ? 
                chartDataStore.members : (currentMembers || []);
            const rawEvents = (chartDataStore.rawEvents && chartDataStore.rawEvents.length > 0) ? 
                chartDataStore.rawEvents : (currentRawEventsData || []);
            
            console.log('?ÔøΩÔøΩ ?ÔøΩÏù¥???ÔøΩÏä§ ?ÔøΩÏù∏:');
            console.log('- chartDataStore.members:', chartDataStore.members ? chartDataStore.members.length : 0);
            console.log('- currentMembers:', currentMembers ? currentMembers.length : 0);
            console.log('- chartDataStore.rawEvents:', chartDataStore.rawEvents ? chartDataStore.rawEvents.length : 0);
            console.log('- currentRawEventsData:', currentRawEventsData ? currentRawEventsData.length : 0);
            
            if (!members || members.length === 0) {
                console.log('?ÔøΩÔ∏è generateHeatmapBarData: ?ÔøΩÏö© Í∞Ä?ÔøΩÌïú Î©§Î≤Ñ ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                return [];
            }
            
            if (!rawEvents || rawEvents.length === 0) {
                console.log('?ÔøΩÔ∏è generateHeatmapBarData: ?ÔøΩÏö© Í∞Ä?ÔøΩÌïú ?ÔøΩÎ≤§???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                return [];
            }
            
            // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÎèô ??Í≥ÑÏÇ∞
            members.forEach((member, userIndex) => {
                const userEmail = member.email;
                const userName = member.name;
                const userId = userEmail.split('@')[0]; // ID Ï∂îÏ∂ú
                
                const userEvents = rawEvents.filter(event => 
                    event.userEmail === userEmail || event.email === userEmail
                );
                
                const totalActivity = userEvents.length;
                
                userActivityMap.set(userIndex, {
                    name: userName,
                    email: userEmail,
                    id: userId,
                    totalActivity: totalActivity
                });
            });
            
            // ?ÔøΩÎèô ?ÔøΩÎ°ú ?ÔøΩÎ†¨?ÔøΩÏó¨ ?ÔøΩÏúÑ 20Ôø??ÔøΩÌÉù
            const sortedUsers = Array.from(userActivityMap.entries())
                .sort((a, b) => b[1].totalActivity - a[1].totalActivity)
                .slice(0, 20);
            
            const data = sortedUsers.map(([userIndex, userData]) => ({
                userId: userData.id,
                userName: userData.name,
                email: userData.email,
                activity: userData.totalActivity
            }));
            
            console.log(`?ÔøΩÔøΩ ?ÔøΩÌä∏Ôø?ÎßâÔøΩ? ?ÔøΩÏù¥???ÔøΩÏÑ± ?ÔøΩÎ£å: ${data.length}Î™ÖÏùò ?ÔøΩÏö©??(?ÔøΩÏù¥???ÔøΩÏä§: ${members.length}Ôø? ${rawEvents.length}Ôø??ÔøΩÎ≤§??`);
            console.log('?ÔøΩÔøΩ ÏµúÏ¢Ö ?ÔøΩÏù¥??', data);
            return data;
        }

        // Í∏∞Ï°¥ ?ÔøΩÌä∏Ôø??ÔøΩÏù¥???ÔøΩÏÑ± (Ï∞∏Í≥†??
        function generateHeatmapData() {
            const userActivityMap = new Map();
            
            // ?ÔøΩÌï© ?ÔøΩÏù¥???Ôø?ÔøΩÏÜå?ÔøΩÏÑú ?ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø?            const members = chartDataStore.members.length > 0 ? chartDataStore.members : currentMembers;
            const rawEvents = chartDataStore.rawEvents.length > 0 ? chartDataStore.rawEvents : currentRawEventsData;
            
            if (!members || members.length === 0) {
                console.log('?ÔøΩÔ∏è generateHeatmapData: ?ÔøΩÏö© Í∞Ä?ÔøΩÌïú Î©§Î≤Ñ ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                return [];
            }
            
            if (!rawEvents || rawEvents.length === 0) {
                console.log('?ÔøΩÔ∏è generateHeatmapData: ?ÔøΩÏö© Í∞Ä?ÔøΩÌïú ?ÔøΩÎ≤§???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                return [];
            }
            
            members.forEach((member, userIndex) => {
                const userEmail = member.email;
                const userName = member.name;
                
                const userEvents = rawEvents.filter(event => 
                    event.userEmail === userEmail
                );
                
                const dailyActivity = new Map();
                
                userEvents.forEach(event => {
                    const eventDate = new Date(parseInt(event.timestamp));
                    const dateKey = eventDate.toISOString().split('T')[0];
                    
                    if (dailyActivity.has(dateKey)) {
                        dailyActivity.set(dateKey, dailyActivity.get(dateKey) + 1);
                    } else {
                        dailyActivity.set(dateKey, 1);
                    }
                });
                
                userActivityMap.set(userIndex, {
                    name: userName,
                    email: userEmail,
                    dailyActivity: dailyActivity
                });
            });
            
            const data = [];
            const days = 7;
            
            for (let userIndex = 0; userIndex < Math.min(userActivityMap.size, 5); userIndex++) {
                const userData = userActivityMap.get(userIndex);
                if (!userData) continue;
                
                for (let dayIndex = 0; dayIndex < days; dayIndex++) {
                    const targetDate = new Date();
                    targetDate.setDate(targetDate.getDate() - (days - 1 - dayIndex));
                    const dateKey = targetDate.toISOString().split('T')[0];
                    
                    const activity = userData.dailyActivity.get(dateKey) || 0;
                    
                    data.push({
                        user: userIndex,
                        day: dayIndex,
                        activity: activity,
                        userName: userData.name
                    });
                }
            }
            
            console.log(`?ÔøΩÔøΩ ?ÔøΩÌä∏Ôø??ÔøΩÏù¥???ÔøΩÏÑ± ?ÔøΩÎ£å: ${data.length}Ôø??Ôø?(?ÔøΩÏù¥???ÔøΩÏä§: ${members.length}Ôø? ${rawEvents.length}Ôø??ÔøΩÎ≤§??`);
            return data;
        }

        // ?ÔøΩÌä∏Ôø?Í∑∏Î¶¨Ôø?        function drawHeatmap(ctx, width, height, data) {
            if (data.length === 0) {
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂àÎü¨?ÔøΩÎäî Ôø?..', width / 2, height / 2);
                return;
            }
            
            const cellWidth = (width - 100) / 7;
            const cellHeight = (height - 80) / 5;
            const startX = 80;
            const startY = 20;
            const cellSpacing = 8; // ?Ôø?Í∞ÑÍ≤© Ï∂îÔøΩ?
            
            const maxActivity = Math.max(...data.map(d => d.activity));
            
            data.forEach(item => {
                const x = startX + item.day * cellWidth;
                const y = startY + item.user * cellHeight;
                
                const intensity = item.activity / maxActivity;
                const color = getHeatmapColor(intensity);
                
                ctx.fillStyle = color;
                // ?Ôø?Í∞ÑÍ≤©??Í≥†Î†§?ÔøΩÏó¨ ?ÔøΩÍ∏∞ Ï°∞Ï†ï
                ctx.fillRect(x + cellSpacing/2, y + cellSpacing/2, cellWidth - cellSpacing, cellHeight - cellSpacing);
                
                if (item.activity > 0) {
                    ctx.fillStyle = intensity > 0.5 ? '#000' : '#fff';
                    ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(item.activity.toString(), x + cellWidth/2, y + cellHeight/2);
                }
            });
        }

        // ?ÔøΩÌä∏Ôø?ÎßâÔøΩ? Í∑∏Îûò??Í∑∏Î¶¨Ôø?        function drawHeatmapBarChart(ctx, width, height, data) {
            if (data.length === 0) {
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂àÎü¨?ÔøΩÎäî Ôø?..', width / 2, height / 2);
                return;
            }
            
            const padding = 80;
            const chartWidth = width - 2 * padding;
            const chartHeight = height - 2 * padding;
            const barWidth = chartWidth / data.length;
            const colors = ['#4a9eff', '#4caf50', '#ff9800', '#f44336', '#9c27b0'];
            
            // ÏµúÔøΩ? ?ÔøΩÎèô ??Ï∞æÍ∏∞
            const maxActivity = Math.max(...data.map(item => item.activity));
            
            // YÔø??ÔøΩÏù¥Ôø?Í∑∏Î¶¨Ôø?            ctx.fillStyle = '#7a7a7a';
            ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'right';
            ctx.textBaseline = 'middle';
            
            const ySteps = 5;
            for (let i = 0; i <= ySteps; i++) {
                const y = padding + (chartHeight / ySteps) * i;
                const value = Math.round((maxActivity / ySteps) * (ySteps - i));
                ctx.fillText(value.toString(), padding - 10, y);
            }
            
            // ÎßâÔøΩ? Í∑∏Î¶¨Ôø?            data.forEach((item, index) => {
                const x = padding + (chartWidth / data.length) * index + barWidth * 0.1;
                const barHeight = (item.activity / maxActivity) * chartHeight;
                const y = height - padding - barHeight;
                
                // ÎßâÔøΩ? Í∑∏Î¶¨Ôø?                ctx.fillStyle = colors[index % colors.length];
                ctx.fillRect(x, y, barWidth * 0.8, barHeight);
                
                // ÎßâÔøΩ? ?ÔøΩÏóê Ôø??ÔøΩÏãú
                ctx.fillStyle = '#e1e1e1';
                ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(item.activity.toString(), x + barWidth * 0.4, y - 10);
                
                // XÔø??ÔøΩÏù¥Ôø?(?ÔøΩÏö©??ID)
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '11px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(item.userId.substring(0, 15), x + barWidth * 0.4, height - padding + 20);
            });
            
            // ?ÔøΩÎ™©
            ctx.fillStyle = '#e1e1e1';
            ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÎèô ?ÔøΩÌä∏Ôø?(?ÔøΩÏúÑ 20Ôø?', width / 2, 25);
        }

        // ?ÔøΩÌä∏Ôø??ÔøΩÏÉÅ Í≥ÑÏÇ∞
        function getHeatmapColor(intensity) {
            const r = Math.floor(255 * intensity);
            const g = Math.floor(100 * (1 - intensity));
            const b = Math.floor(255 * (1 - intensity));
            return `rgb(${r}, ${g}, ${b})`;
        }

        // ?ÔøΩÌä∏Ôø??ÔøΩÏù¥Ôø?Í∑∏Î¶¨Ôø?        function drawHeatmapLabels(ctx, width, height) {
            const users = [];
            if (currentMembers && currentMembers.length > 0) {
                currentMembers.slice(0, 5).forEach(member => {
                    users.push(member.name);
                });
            }
            
            const days = [];
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                const dayName = date.toLocaleDateString('ko-KR', { weekday: 'short' });
                days.push(dayName);
            }
            
            ctx.fillStyle = '#7a7a7a';
            ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'center';
            
            const cellHeight = (height - 80) / 5;
            users.forEach((user, index) => {
                const y = 20 + index * cellHeight + cellHeight/2;
                const displayName = user.length > 8 ? user.substring(0, 8) + '...' : user;
                ctx.fillText(displayName, 40, y);
            });
            
            const cellWidth = (width - 100) / 7;
            days.forEach((day, index) => {
                const x = 80 + index * cellWidth + cellWidth/2;
                ctx.fillText(day, x, 10);
            });
        }

        // ÎπÑÏö© ?ÔøΩÏú®??Î∂ÑÏÑù Ï∞®Ìä∏ ?ÔøΩÏÑ±
        function createCostEfficiencyChart() {
            const canvas = document.getElementById('costEfficiencyChart');
            if (!canvas) return;
            
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = 300;
            
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, width, height);
            
            const efficiencyData = generateCostEfficiencyData();
            drawScatterPlot(ctx, width, height, efficiencyData);
        }

        // ÎπÑÏö© ?ÔøΩÏú®???ÔøΩÏù¥???ÔøΩÏÑ±
        function generateCostEfficiencyData() {
            const userEfficiency = new Map();
            
            // ?ÔøΩÌï© ?ÔøΩÏù¥???Ôø?ÔøΩÏÜå?ÔøΩÏÑú ?ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø?            const members = chartDataStore.members.length > 0 ? chartDataStore.members : currentMembers;
            const rawEvents = chartDataStore.rawEvents.length > 0 ? chartDataStore.rawEvents : currentRawEventsData;
            
            if (!members || members.length === 0) {
                console.log('?ÔøΩÔ∏è generateCostEfficiencyData: ?ÔøΩÏö© Í∞Ä?ÔøΩÌïú Î©§Î≤Ñ ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                return [];
            }
            
            if (!rawEvents || rawEvents.length === 0) {
                console.log('?ÔøΩÔ∏è generateCostEfficiencyData: ?ÔøΩÏö© Í∞Ä?ÔøΩÌïú ?ÔøΩÎ≤§???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                return [];
            }
            
            members.forEach(member => {
                const userEmail = member.email;
                const userName = member.name;
                
                const userEvents = rawEvents.filter(event => 
                    event.userEmail === userEmail
                );
                
                const totalRequests = userEvents.length;
                const totalCost = userEvents.reduce((sum, event) => 
                    sum + (event.requestsCosts || 0), 0) / 100;
                
                if (totalRequests > 0) {
                    userEfficiency.set(userName, {
                        requests: totalRequests,
                        cost: totalCost,
                        efficiency: totalCost / totalRequests
                    });
                }
            });
            
            const result = Array.from(userEfficiency.values());
            console.log(`?ÔøΩÔøΩ ÎπÑÏö© ?ÔøΩÏú®???ÔøΩÏù¥???ÔøΩÏÑ± ?ÔøΩÎ£â: ${result.length}Î™ÖÏùò ?ÔøΩÏö©??(?ÔøΩÏù¥???ÔøΩÏä§: ${members.length}Ôø? ${rawEvents.length}Ôø??ÔøΩÎ≤§??`);
            return result;
        }

        // ?ÔøΩÏ∫ê???ÔøΩÎ°Ø Í∑∏Î¶¨Ôø?        function drawScatterPlot(ctx, width, height, data) {
            if (data.length === 0) {
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂àÎü¨?ÔøΩÎäî Ôø?..', width / 2, height / 2);
                return;
            }
            
            const padding = 60;
            const chartWidth = width - 2 * padding;
            const chartHeight = height - 2 * padding;
            
            const maxRequests = Math.max(...data.map(d => d.requests));
            const maxCost = Math.max(...data.map(d => d.cost));
            
            // Í∑∏Î¶¨??Í∑∏Î¶¨Ôø?            ctx.strokeStyle = '#3a3a3a';
            ctx.lineWidth = 1;
            
            for (let i = 0; i <= 5; i++) {
                const x = padding + (chartWidth / 5) * i;
                const y = padding + (chartHeight / 5) * i;
                
                ctx.beginPath();
                ctx.moveTo(x, padding);
                ctx.lineTo(x, height - padding);
                ctx.stroke();
                
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(width - padding, y);
                ctx.stroke();
            }
            
            // ?ÔøΩÏù¥???ÔøΩÏù∏??Í∑∏Î¶¨Ôø?            data.forEach(item => {
                const x = padding + (item.requests / maxRequests) * chartWidth;
                const y = height - padding - (item.cost / maxCost) * chartHeight;
                
                ctx.fillStyle = '#4a9eff';
                ctx.beginPath();
                ctx.arc(x, y, 6, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.fillStyle = '#fff';
                ctx.font = '10px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(`${item.requests}`, x, y - 10);
            });
            
            // Ôø??ÔøΩÏù¥Ôø?            ctx.fillStyle = '#7a7a7a';
            ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('?ÔøΩÏ≤≠ ??, width / 2, height - 10);
            
            ctx.save();
            ctx.translate(10, height / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText('ÎπÑÏö© ($)', 0, 0);
            ctx.restore();
        }

        // Î™®Îç∏ ?ÔøΩÌò∏??Ï∞®Ìä∏ ?ÔøΩÏÑ±
        function createModelPreferenceChart() {
            const canvas = document.getElementById('modelPreferenceChart');
            if (!canvas) return;
            
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = 300;
            
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, width, height);
            
            const preferenceData = generateModelPreferenceData();
            drawStackedBarChart(ctx, width, height, preferenceData);
        }

        // Î™®Îç∏ ?ÔøΩÌò∏???ÔøΩÏù¥???ÔøΩÏÑ± (?ÔøΩÎèô Í∏∞ÔøΩ? ?ÔøΩÏúÑ 20Ôø? ?ÔøΩÎèô ?ÔøΩÎäî ?ÔøΩÏö©???ÔøΩÏô∏)
        function generateModelPreferenceData() {
            // ?ÔøΩÌï© ?ÔøΩÏù¥???Ôø?ÔøΩÏÜå?ÔøΩÏÑú ?ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø?            const members = chartDataStore.members.length > 0 ? chartDataStore.members : currentMembers;
            const rawEvents = chartDataStore.rawEvents.length > 0 ? chartDataStore.rawEvents : currentRawEventsData;
            
            if (!members || members.length === 0) {
                console.log('?ÔøΩÔ∏è generateModelPreferenceData: ?ÔøΩÏö© Í∞Ä?ÔøΩÌïú Î©§Î≤Ñ ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                return new Map();
            }
            
            if (!rawEvents || rawEvents.length === 0) {
                console.log('?ÔøΩÔ∏è generateModelPreferenceData: ?ÔøΩÏö© Í∞Ä?ÔøΩÌïú ?ÔøΩÎ≤§???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                return new Map();
            }
            
            // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÎèô Ôø?Î™®Îç∏ ?ÔøΩÏö©??Í≥ÑÏÇ∞
            const userActivityData = [];
            members.forEach(member => {
                const userEmail = member.email;
                const userName = member.name;
                const userId = userEmail.split('@')[0];
                
                const userEvents = rawEvents.filter(event => 
                    event.userEmail === userEmail || event.email === userEmail
                );
                
                // ?ÔøΩÎèô???ÔøΩÎäî ?ÔøΩÏö©?ÔøΩÎäî ?ÔøΩÏô∏
                if (userEvents.length === 0) {
                    return;
                }
                
                const modelUsage = new Map();
                userEvents.forEach(event => {
                    const model = event.model || 'unknown';
                    modelUsage.set(model, (modelUsage.get(model) || 0) + 1);
                });
                
                userActivityData.push({
                    userName: userName,
                    userId: userId,
                    email: userEmail,
                    totalActivity: userEvents.length,
                    modelUsage: modelUsage
                });
            });
            
            // ?ÔøΩÎèô ?ÔøΩÎ°ú ?ÔøΩÎ†¨?ÔøΩÏó¨ ?ÔøΩÏúÑ 20Ôø??ÔøΩÌÉù
            const sortedUsers = userActivityData
                .sort((a, b) => b.totalActivity - a.totalActivity)
                .slice(0, 20);
            
            // Map ?ÔøΩÌÉúÔø?Î≥Ä??(Í∏∞Ï°¥ ÏΩîÎìú?Ôø???ÔøΩÌôò?ÔøΩÏùÑ ?ÔøΩÌï¥)
            const userModelPreference = new Map();
            sortedUsers.forEach(user => {
                userModelPreference.set(user.userId, user.modelUsage); // userIdÔø???Î≥ÄÔø?            });
            
            console.log(`?ÔøΩÔøΩ Î™®Îç∏ ?ÔøΩÌò∏???ÔøΩÏù¥???ÔøΩÏÑ± ?ÔøΩÎ£å: ${userModelPreference.size}Î™ÖÏùò ?ÔøΩÏÑ± ?ÔøΩÏö©??(?ÔøΩÏ≤¥ ${members.length}Ôø?Ôø??ÔøΩÏúÑ 20Ôø? ${rawEvents.length}Ôø??ÔøΩÎ≤§??`);
            return userModelPreference;
        }

        // ?ÔøΩÌÉù Ôø?Ï∞®Ìä∏ Í∑∏Î¶¨Ôø?        function drawStackedBarChart(ctx, width, height, data) {
            if (data.size === 0) {
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂àÎü¨?ÔøΩÎäî Ôø?..', width / 2, height / 2);
                return;
            }
            
            const padding = 80;
            const chartWidth = width - 2 * padding;
            const chartHeight = height - 2 * padding;
            const barWidth = chartWidth / data.size;
            const colors = ['#4a9eff', '#4caf50', '#ff9800', '#f44336', '#9c27b0'];
            
            let userIndex = 0;
            data.forEach((modelUsage, userName) => {
                const x = padding + barWidth * userIndex + barWidth * 0.1;
                const totalUsage = Array.from(modelUsage.values()).reduce((sum, count) => sum + count, 0);
                
                // ?ÔøΩÏö©??ID (userName???ÔøΩÔøΩ? userIdÔø??ÔøΩÏ†ï??
                const userId = userName;
                
                let currentY = height - padding;
                let colorIndex = 0;
                
                modelUsage.forEach((count, model) => {
                    const barHeight = (count / totalUsage) * chartHeight;
                    currentY -= barHeight;
                    
                    ctx.fillStyle = colors[colorIndex % colors.length];
                    ctx.fillRect(x, currentY, barWidth * 0.8, barHeight);
                    
                    if (barHeight > 20) {
                        ctx.fillStyle = '#fff';
                        ctx.font = '10px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                        ctx.textAlign = 'center';
                        ctx.fillText(model, x + barWidth * 0.4, currentY + barHeight / 2);
                    }
                    
                    colorIndex++;
                });
                
                // ?ÔøΩÏö©??ID (XÔø? - ÏµúÔøΩ? 15?ÔøΩÎ°ú ?ÔøΩÌïú
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(userId.substring(0, 15), x + barWidth * 0.4, height - 10);
                
                userIndex++;
            });
        }

        // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÍ≥º Ï∞®Ìä∏ ?ÔøΩÏÑ±
        function createUserPerformanceChart() {
            console.log('?ÔøΩÔøΩ createUserPerformanceChart ?ÔøΩÏûë');
            
            const canvas = document.getElementById('userPerformanceChart');
            if (!canvas) {
                console.error('??userPerformanceChart Ï∫îÎ≤Ñ?ÔøΩÔøΩ? Ï∞æÏùÑ ???ÔøΩÏäµ?ÔøΩÎã§.');
                return;
            }
            
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = 300;
            
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            console.log(`?ÔøΩÔøΩ Ï∫îÎ≤Ñ???ÔøΩÍ∏∞: ${width}x${height}`);
            
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, width, height);
            
            const performanceData = generateUserPerformanceData();
            console.log(`?ÔøΩÔøΩ ?ÔøΩÍ≥º ?ÔøΩÏù¥???ÔøΩÏÑ± ?ÔøΩÎ£å: ${performanceData.length}Î™ÖÏùò ?ÔøΩÏö©??);
            
            if (performanceData.length === 0) {
                console.log('?ÔøΩÔ∏è ?ÔøΩÍ≥º ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§. Î°úÎî© Î©îÏãúÏßÄÔø??ÔøΩÏãú?ÔøΩÎãà??');
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂àÎü¨?ÔøΩÎäî Ôø?..', width / 2, height / 2);
                return;
            }
            
            console.log('?ÔøΩÔøΩ Ï∞®Ìä∏ Í∑∏Î¶¨Ôø??ÔøΩÏûë...', performanceData);
            drawPerformanceChart(ctx, width, height, performanceData);
            console.log('???ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÍ≥º Ï∞®Ìä∏ ?ÔøΩÏÑ± ?ÔøΩÎ£å');
        }

        // ?ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÏö©???ÔøΩÎèô ?ÔøΩÌä∏Ôø?Ï∞®Ìä∏ ?ÔøΩÏÑ± (?ÔøΩÏùºÔø?ÎßâÔøΩ? Í∑∏Îûò??
        function createFilteredUserHeatmapChart(searchTerm) {
            console.log('?ÔøΩÔøΩ createFilteredUserHeatmapChart ?ÔøΩÏûë:', searchTerm);
            const canvas = document.getElementById('userHeatmapChart');
            if (!canvas) {
                console.error('??userHeatmapChart Ï∫îÎ≤Ñ?ÔøΩÔøΩ? Ï∞æÏùÑ ???ÔøΩÏäµ?ÔøΩÎã§.');
                return;
            }
            
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = 300;
            
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, width, height);
            
            // Í≤Ä?ÔøΩÎêú ?ÔøΩÏö©?ÔøΩÏùò ?ÔøΩÏùºÔø??ÔøΩÎèô ?ÔøΩÏù¥???ÔøΩÏÑ±
            const weeklyData = generateWeeklyActivityData(searchTerm);
            console.log('?ÔøΩÔøΩ ?ÔøΩÏÑ±???ÔøΩÏùºÔø??ÔøΩÏù¥??', weeklyData);
            
            if (!weeklyData || !weeklyData.data || weeklyData.data.length === 0) {
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(`Í≤Ä??Í≤∞Í≥ºÍ∞Ä ?ÔøΩÏäµ?ÔøΩÎã§: "${searchTerm}"`, width / 2, height / 2);
                return;
            }
            
            // ?ÔøΩÏùºÔø?ÎßâÔøΩ? Í∑∏Îûò??Í∑∏Î¶¨Ôø?            drawWeeklyBarChart(ctx, width, height, weeklyData.data, weeklyData.userName);
            console.log('???ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÏö©???ÔøΩÎèô ?ÔøΩÌä∏Ôø?Ï∞®Ìä∏ ?ÔøΩÏÑ± ?ÔøΩÎ£å');
        }

        // ?ÔøΩÏùºÔø??ÔøΩÎèô ?ÔøΩÏù¥???ÔøΩÏÑ±
        function generateWeeklyActivityData(searchTerm) {
            console.log('?ÔøΩÔøΩ generateWeeklyActivityData ?ÔøΩÏûë:', searchTerm);
            
            const members = (chartDataStore.members && chartDataStore.members.length > 0) ? 
                chartDataStore.members : (currentMembers || []);
            const rawEvents = (chartDataStore.rawEvents && chartDataStore.rawEvents.length > 0) ? 
                chartDataStore.rawEvents : (currentRawEventsData || []);
            
            if (!members || members.length === 0 || !rawEvents || rawEvents.length === 0) {
                console.log('?ÔøΩÔ∏è ?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂ÄÏ°±Ìï©?ÔøΩÎã§.');
                return [];
            }
            
            // Í≤Ä?ÔøΩÏñ¥?Ôø??ÔøΩÏπò?ÔøΩÎäî ?ÔøΩÏö©??Ï∞æÍ∏∞ (ID Í∏∞Î∞ò)
            const matchedUser = members.find(member => {
                const emailId = member.email.split('@')[0];
                return emailId.toLowerCase() === searchTerm.toLowerCase();
            });
            
            if (!matchedUser) {
                console.log('?ÔøΩÔ∏è Í≤Ä?ÔøΩÎêú ?ÔøΩÏö©?ÔøΩÔøΩ? Ï∞æÏùÑ ???ÔøΩÏäµ?ÔøΩÎã§.');
                return null;
            }
            
            // ?ÔøΩÎãπ ?ÔøΩÏö©?ÔøΩÏùò ?ÔøΩÎ≤§???ÔøΩÌÑ∞Ôø?            const userEvents = rawEvents.filter(event => 
                event.userEmail === matchedUser.email || event.email === matchedUser.email
            );
            
            // ?ÔøΩÏùºÔø??ÔøΩÎèô ??Í≥ÑÏÇ∞
            const weeklyActivity = new Map();
            const dayNames = ['??, '??, '??, '??, 'Ôø?, 'Ôø?, '??];
            
            userEvents.forEach(event => {
                const eventDate = new Date(parseInt(event.timestamp));
                const dayOfWeek = eventDate.getDay();
                const dayName = dayNames[dayOfWeek];
                
                weeklyActivity.set(dayName, (weeklyActivity.get(dayName) || 0) + 1);
            });
            
            // Î™®Îì† ?ÔøΩÏùº???Ôø???ÔøΩÏù¥???ÔøΩÏÑ± (?ÔøΩÎèô???ÔøΩÎäî ?ÔøΩÏùº?Ôø?0)
            const data = dayNames.map(dayName => ({
                day: dayName,
                activity: weeklyActivity.get(dayName) || 0
            }));
            
            console.log(`?ÔøΩÔøΩ ?ÔøΩÏùºÔø??ÔøΩÎèô ?ÔøΩÏù¥???ÔøΩÏÑ± ?ÔøΩÎ£å: ${matchedUser.name} (${data.length}??`);
            console.log('?ÔøΩÔøΩ ÏµúÏ¢Ö ?ÔøΩÏù¥??', data);
            return {
                data: data,
                userName: matchedUser.name,
                userEmail: matchedUser.email
            };
        }

        // ?ÔøΩÏùºÔø?ÎßâÔøΩ? Í∑∏Îûò??Í∑∏Î¶¨Ôø?        function drawWeeklyBarChart(ctx, width, height, data, userName) {
            const padding = 80;
            const chartWidth = width - 2 * padding;
            const chartHeight = height - 2 * padding;
            const barWidth = chartWidth / data.length;
            const colors = ['#4a9eff', '#4caf50', '#ff9800', '#f44336', '#9c27b0', '#00bcd4', '#ff5722'];
            
            // ÏµúÔøΩ? ?ÔøΩÎèô ??Ï∞æÍ∏∞
            const maxActivity = Math.max(...data.map(item => item.activity));
            
            // YÔø??ÔøΩÏù¥Ôø?Í∑∏Î¶¨Ôø?(?ÔøΩÌä∏??
            ctx.fillStyle = '#7a7a7a';
            ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'right';
            ctx.textBaseline = 'middle';
            
            const ySteps = 5;
            for (let i = 0; i <= ySteps; i++) {
                const y = padding + (chartHeight / ySteps) * i;
                const value = Math.round((maxActivity / ySteps) * (ySteps - i));
                ctx.fillText(value.toString(), padding - 10, y);
            }
            
            // YÔø??ÔøΩÎ™© (?ÔøΩÌä∏??
            ctx.fillStyle = '#7a7a7a';
            ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'center';
            ctx.save();
            ctx.translate(20, height / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText('?ÔøΩÌä∏??, 0, 0);
            ctx.restore();
            
            // ÎßâÔøΩ? Í∑∏Î¶¨Ôø?            data.forEach((item, index) => {
                const x = padding + (chartWidth / data.length) * index + barWidth * 0.1;
                const barHeight = maxActivity > 0 ? (item.activity / maxActivity) * chartHeight : 0;
                const y = height - padding - barHeight;
                
                // ÎßâÔøΩ? Í∑∏Î¶¨Ôø?                ctx.fillStyle = colors[index % colors.length];
                ctx.fillRect(x, y, barWidth * 0.8, barHeight);
                
                // ÎßâÔøΩ? ?ÔøΩÏóê Ôø??ÔøΩÏãú
                ctx.fillStyle = '#e1e1e1';
                ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(item.activity.toString(), x + barWidth * 0.4, y - 10);
                
                // XÔø??ÔøΩÏù¥Ôø?(?ÔøΩÏùº)
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '11px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(item.day, x + barWidth * 0.4, height - padding + 20);
            });
            
            // ?ÔøΩÎ™©
            ctx.fillStyle = '#e1e1e1';
            ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText(`${userName}???ÔøΩÏùºÔø??ÔøΩÌä∏??, width / 2, 25);
        }

        // ?ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÍ≥º Ï∞®Ìä∏ ?ÔøΩÏÑ±
        function createFilteredUserPerformanceChart(searchTerm) {
            const canvas = document.getElementById('userPerformanceChart');
            if (!canvas) return;
            
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = 300;
            
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, width, height);
            
            // ?ÔøΩÏ≤¥ ?ÔøΩÍ≥º ?ÔøΩÏù¥?ÔøΩÏóê??Í≤Ä?ÔøΩÏñ¥?Ôø??ÔøΩÏπò?ÔøΩÎäî ?ÔøΩÏö©?ÔøΩÎßå ?ÔøΩÌÑ∞Ôø?            const allPerformanceData = generateUserPerformanceData();
            const filteredData = allPerformanceData.filter(user => 
                user.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                user.email.toLowerCase().includes(searchTerm.toLowerCase())
            );
            
            if (filteredData.length === 0) {
                // Í≤Ä??Í≤∞Í≥ºÍ∞Ä ?ÔøΩÏùÑ ??Î©îÏãúÏßÄ ?ÔøΩÏãú
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(`Í≤Ä??Í≤∞Í≥ºÍ∞Ä ?ÔøΩÏäµ?ÔøΩÎã§: "${searchTerm}"`, width / 2, height / 2);
                return;
            }
            
            // ?ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÏù¥?ÔøΩÎ°ú Ï∞®Ìä∏ Í∑∏Î¶¨Ôø?            drawPerformanceChart(ctx, width, height, filteredData);
            
            console.log(`???ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÍ≥º Ï∞®Ìä∏ ?ÔøΩÏÑ± ?ÔøΩÎ£å: "${searchTerm}" - ${filteredData.length}Î™ÖÏùò ?ÔøΩÏö©??);
        }

        // ?ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÏö©???ÔøΩÎèô ?ÔøΩÌä∏Ôø?Ï∞®Ìä∏ ?ÔøΩÏÑ± (?ÔøΩÏùºÔø??ÔøΩÌä∏??
        function createFilteredUserHeatmapChart(searchTerm) {
            console.log('?ÔøΩÔøΩ createFilteredUserHeatmapChart ?ÔøΩÏûë:', searchTerm);
            const canvas = document.getElementById('userHeatmapChart');
            if (!canvas) {
                console.error('??userHeatmapChart Ï∫îÎ≤Ñ?ÔøΩÔøΩ? Ï∞æÏùÑ ???ÔøΩÏäµ?ÔøΩÎã§.');
                return;
            }
            
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = 300;
            
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, width, height);
            
            // Í≤Ä?ÔøΩÎêú ?ÔøΩÏö©?ÔøΩÏùò ?ÔøΩÏùºÔø??ÔøΩÎèô ?ÔøΩÏù¥???ÔøΩÏÑ±
            const weeklyData = generateWeeklyActivityData(searchTerm);
            console.log('?ÔøΩÔøΩ ?ÔøΩÏÑ±???ÔøΩÏùºÔø??ÔøΩÏù¥??', weeklyData);
            
            if (!weeklyData || !weeklyData.data || weeklyData.data.length === 0) {
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(`Í≤Ä??Í≤∞Í≥ºÍ∞Ä ?ÔøΩÏäµ?ÔøΩÎã§: "${searchTerm}"`, width / 2, height / 2);
                return;
            }
            
            // ?ÔøΩÏùºÔø?ÎßâÔøΩ? Í∑∏Îûò??Í∑∏Î¶¨Ôø?            drawWeeklyBarChart(ctx, width, height, weeklyData.data, weeklyData.userName);
            console.log('???ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÏö©???ÔøΩÎèô ?ÔøΩÌä∏Ôø?Ï∞®Ìä∏ ?ÔøΩÏÑ± ?ÔøΩÎ£å');
        }

        // ?ÔøΩÌÑ∞ÎßÅÎêú Î™®Îç∏ ?ÔøΩÌò∏??Ï∞®Ìä∏ ?ÔøΩÏÑ±
        function createFilteredModelPreferenceChart(searchTerm) {
            const canvas = document.getElementById('modelPreferenceChart');
            if (!canvas) return;
            
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = 300;
            
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, width, height);
            
            // Í≤Ä??Í≤∞Í≥ºÍ∞Ä ?ÔøΩÏùÑ ??Î©îÏãúÏßÄ ?ÔøΩÏãú
            ctx.fillStyle = '#7a7a7a';
            ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText(`Î™®Îç∏ ?ÔøΩÌò∏??Í≤Ä??Í∏∞Îä• Ï§ÄÔø?Ôø?..`, width / 2, height / 2);
            
            console.log(`???ÔøΩÌÑ∞ÎßÅÎêú Î™®Îç∏ ?ÔøΩÌò∏??Ï∞®Ìä∏ ?ÔøΩÏÑ± ?ÔøΩÎ£å: "${searchTerm}"`);
        }

        // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÍ≥º ?ÔøΩÏù¥???ÔøΩÏÑ±
        function generateUserPerformanceData() {
            const userPerformance = [];
            
            // ?ÔøΩÏû¨ ?ÔøΩÏù¥?ÔøΩÏóê??Í∞Ä?ÔøΩÏò§Ôø?(chartDataStore ?ÔøΩÏÑ†, ?ÔøΩÏúºÔø??ÔøΩÏó≠ Î≥Ä???ÔøΩÏö©)
            const members = (chartDataStore.members && chartDataStore.members.length > 0) ? 
                chartDataStore.members : (currentMembersData || []);
            const rawEvents = (chartDataStore.rawEvents && chartDataStore.rawEvents.length > 0) ? 
                chartDataStore.rawEvents : (currentRawEventsData || []);
            
            console.log(`?ÔøΩÔøΩ ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÍ≥º ?ÔøΩÏù¥???ÔøΩÏÑ± ?ÔøΩÏûë: Î©§Î≤Ñ ${members.length}Ôø? ?ÔøΩÎ≤§??${rawEvents.length}Ôø?);
            
            if (!members || members.length === 0) {
                console.log('?ÔøΩÔ∏è generateUserPerformanceData: ?ÔøΩÏö© Í∞Ä?ÔøΩÌïú Î©§Î≤Ñ ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                return [];
            }
            
            if (!rawEvents || rawEvents.length === 0) {
                console.log('?ÔøΩÔ∏è generateUserPerformanceData: ?ÔøΩÏö© Í∞Ä?ÔøΩÌïú ?ÔøΩÎ≤§???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                return [];
            }
            
            members.forEach(member => {
                const userEmail = member.email;
                const userName = member.name;
                
                // ?ÔøΩÎ©î???ÔøΩÎìúÔø??ÔøΩÏù∏ (userEmail ?ÔøΩÎäî email)
                const userEvents = rawEvents.filter(event => {
                    const eventEmail = event.userEmail || event.email;
                    return eventEmail === userEmail;
                });
                
                const totalRequests = userEvents.length;
                const totalCost = userEvents.reduce((sum, event) => 
                    sum + (event.requestsCosts || 0), 0) / 100;
                const uniqueDays = new Set(userEvents.map(event => 
                    new Date(parseInt(event.timestamp)).toDateString())).size;
                
                if (totalRequests > 0) {
                    userPerformance.push({
                        name: userName,
                        email: userEmail,
                        requests: totalRequests,
                        cost: totalCost,
                        activeDays: uniqueDays,
                        efficiency: totalRequests / uniqueDays || 0
                    });
                }
            });
            
            const result = userPerformance.sort((a, b) => b.requests - a.requests).slice(0, 50);
            console.log(`?ÔøΩÔøΩ ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÍ≥º ?ÔøΩÏù¥???ÔøΩÏÑ± ?ÔøΩÎ£å: ${result.length}Î™ÖÏùò ?ÔøΩÏö©??(?ÔøΩÏúÑ 50Ôø? ?ÔøΩÏ≤¥: ${userPerformance.length}Ôø?`);
            return result;
        }

        // ?ÔøΩÍ≥º Ï∞®Ìä∏ Í∑∏Î¶¨Ôø?        function drawPerformanceChart(ctx, width, height, data) {
            console.log(`?ÔøΩÔøΩ Ï∞®Ìä∏ Í∑∏Î¶¨Ôø??ÔøΩÏûë: ?ÔøΩÏù¥??${data.length}Ôø? Ï∫îÎ≤Ñ???ÔøΩÍ∏∞ ${width}x${height}`);
            
            if (data.length === 0) {
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂àÎü¨?ÔøΩÎäî Ôø?..', width / 2, height / 2);
                return;
            }
            
            const padding = 80;
            const chartWidth = width - 2 * padding;
            const chartHeight = height - 2 * padding;
            const barWidth = Math.max(4, chartWidth / data.length); // ÏµúÏÜå 4px ?ÔøΩÎπÑ Î≥¥Ïû•
            const maxRequests = Math.max(...data.map(d => d.requests));
            
            console.log(`?ÔøΩÔøΩ Ï∞®Ìä∏ ?ÔøΩÏ†ï: ?ÔøΩÎî©=${padding}, Ï∞®Ìä∏?ÔøΩÍ∏∞=${chartWidth}x${chartHeight}, Î∞îÎÑàÔø?${barWidth}, ÏµúÔøΩ??ÔøΩÏ≤≠=${maxRequests}`);
            
            // Î∞∞Í≤Ω ÏßÄ?ÔøΩÍ∏∞
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, width, height);
            
            // Í∑∏Î¶¨??            ctx.strokeStyle = '#3a3a3a';
            ctx.lineWidth = 1;
            
            for (let i = 0; i <= 5; i++) {
                const y = padding + (chartHeight / 5) * i;
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(width - padding, y);
                ctx.stroke();
                
                // YÔø??ÔøΩÎ≤®
                const value = Math.round((maxRequests * (5 - i)) / 5);
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'right';
                ctx.fillText(value.toString(), padding - 10, y + 4);
            }
            
            // Ôø?Ï∞®Ìä∏
            data.forEach((user, index) => {
                const x = padding + barWidth * index + barWidth * 0.1;
                const barHeight = Math.max(1, (user.requests / maxRequests) * chartHeight);
                const y = height - padding - barHeight;
                
                // Ôø?Í∑∏Î¶¨Ôø?                ctx.fillStyle = '#4a9eff';
                ctx.fillRect(x, y, barWidth * 0.8, barHeight);
                
                // ?ÔøΩÏ≤≠ ??(Ôø??ÔøΩÏóê)
                if (barHeight > 20) {
                    ctx.fillStyle = '#fff';
                    ctx.font = '10px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                    ctx.textAlign = 'center';
                    ctx.fillText(user.requests.toString(), x + barWidth * 0.4, y - 5);
                }
                
                // ?ÔøΩÎ©î??ID (XÔø??ÔøΩÎûò) - @samsung.com ?ÔøΩÏô∏
                if (barWidth > 20) {
                    ctx.fillStyle = '#7a7a7a';
                    ctx.font = '10px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                    ctx.textAlign = 'center';
                    ctx.save();
                    ctx.translate(x + barWidth * 0.4, height - 15);
                    ctx.rotate(-Math.PI / 4);
                    const emailId = user.email.split('@')[0]; // @samsung.com ?ÔøΩÏô∏?ÔøΩÍ≥† IDÔø?Ï∂îÏ∂ú
                    ctx.fillText(emailId.substring(0, 8), 0, 0); // ÏµúÔøΩ? 8Í∏Ä?ÔøΩÍπåÏßÄ ?ÔøΩÏãú
                    ctx.restore();
                }
            });
            
            // Î≤îÔøΩ? Í∑∏Î¶¨Ôø?(?ÔøΩÎ•∏Ôø??ÔøΩÎã®)
            drawPerformanceLegend(ctx, width, height);
            
            console.log('??Ï∞®Ìä∏ Í∑∏Î¶¨Ôø??ÔøΩÎ£å');
        }

        // ?ÔøΩÍ≥º Ï∞®Ìä∏ Î≤îÔøΩ? Í∑∏Î¶¨Ôø?        function drawPerformanceLegend(ctx, width, height) {
            const legendX = width - 200;
            const legendY = 30;
            const itemHeight = 18;
            const itemSpacing = 5;
            
            // Î≤îÔøΩ? Î∞∞Í≤Ω
            ctx.fillStyle = 'rgba(26, 26, 26, 0.9)';
            ctx.fillRect(legendX - 10, legendY - 10, 190, 120);
            
            // Î≤îÔøΩ? ?ÔøΩÎëêÔø?            ctx.strokeStyle = '#3a3a3a';
            ctx.lineWidth = 1;
            ctx.strokeRect(legendX - 10, legendY - 10, 190, 120);
            
            // Î≤îÔøΩ? ?ÔøΩÎ™©
            ctx.fillStyle = '#e1e1e1';
            ctx.font = 'bold 12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'left';
            ctx.fillText('?ÔøΩÔøΩ Í≥ÑÏÇ∞ ÏßÄ??, legendX, legendY);
            
            // Î≤îÔøΩ? ??ÔøΩÔøΩ??            const legendItems = [
                { label: 'Ôø??ÔøΩÏ≤≠ ??, description: '?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÎ≤§??Í∞úÏàò' },
                { label: 'Ôø?ÎπÑÏö©', description: 'requestsCosts ?ÔøΩÍ≥Ñ √∑ 100' },
                { label: '?ÔøΩÎèô ?ÔøΩÏàò', description: 'Í≥†Ïú†???ÔøΩÎèô ?ÔøΩÏßú ?? },
                { label: '?ÔøΩÏú®??, description: 'Ôø??ÔøΩÏ≤≠ ??√∑ ?ÔøΩÎèô ?ÔøΩÏàò' },
                { label: '?ÔøΩÎ†¨ Í∏∞ÔøΩ?', description: '?ÔøΩÏ≤≠ ???ÔøΩÎ¶ºÏ∞®Ïàú' }
            ];
            
            legendItems.forEach((item, index) => {
                const y = legendY + 20 + (itemHeight + itemSpacing) * index;
                
                // ?ÔøΩÎ≤®
                ctx.fillStyle = '#4a9eff';
                ctx.font = '11px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'left';
                ctx.fillText(item.label, legendX, y);
                
                // ?ÔøΩÎ™Ö
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '10px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.fillText(item.description, legendX, y + 12);
            });
        }

        // ?ÔøΩÎèô ?ÔøΩÌòï ?ÔøΩÏÑ∏ Ï∞®Ìä∏ ?ÔøΩÏÑ±
        function createActivityTypeDetailedChart() {
            const canvas = document.getElementById('activityTypeDetailedChart');
            if (!canvas) return;
            
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = 300;
            
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, width, height);
            
            const detailedData = generateActivityTypeDetailedData();
            drawDetailedBarChart(ctx, width, height, detailedData);
        }

        // ?ÔøΩÎèô ?ÔøΩÌòï ?ÔøΩÏÑ∏ ?ÔøΩÏù¥???ÔøΩÏÑ±
        function generateActivityTypeDetailedData() {
            const activityDetails = new Map();
            
            // ?ÔøΩÌï© ?ÔøΩÏù¥???Ôø?ÔøΩÏÜå?ÔøΩÏÑú ?ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø?            const rawEvents = chartDataStore.rawEvents.length > 0 ? chartDataStore.rawEvents : currentRawEventsData;
            
            if (!rawEvents || rawEvents.length === 0) {
                console.log('?ÔøΩÔ∏è generateActivityTypeDetailedData: ?ÔøΩÏö© Í∞Ä?ÔøΩÌïú ?ÔøΩÎ≤§???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                return new Map();
            }
            
            rawEvents.forEach(event => {
                const type = event.kind || 'unknown';
                const model = event.model || 'unknown';
                const cost = (event.requestsCosts || 0) / 100;
                
                if (!activityDetails.has(type)) {
                    activityDetails.set(type, {
                        count: 0,
                        totalCost: 0,
                        models: new Map(),
                        users: new Set()
                    });
                }
                
                const details = activityDetails.get(type);
                details.count++;
                details.totalCost += cost;
                details.models.set(model, (details.models.get(model) || 0) + 1);
                details.users.add(event.userEmail);
            });
            
            console.log(`?ÔøΩÔøΩ ?ÔøΩÎèô ?ÔøΩÌòï ?ÔøΩÏÑ∏ ?ÔøΩÏù¥???ÔøΩÏÑ± ?ÔøΩÎ£â: ${activityDetails.size}Ôø??ÔøΩÌòï (?ÔøΩÏù¥???ÔøΩÏä§: ${rawEvents.length}Ôø??ÔøΩÎ≤§??`);
            return activityDetails;
        }

        // ?ÔøΩÏÑ∏ Ôø?Ï∞®Ìä∏ Í∑∏Î¶¨Ôø?        function drawDetailedBarChart(ctx, width, height, data) {
            if (data.size === 0) {
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂àÎü¨?ÔøΩÎäî Ôø?..', width / 2, height / 2);
                return;
            }
            
            const padding = 80;
            const chartWidth = width - 2 * padding;
            const chartHeight = height - 2 * padding;
            const barWidth = chartWidth / data.size;
            const maxCount = Math.max(...Array.from(data.values()).map(d => d.count));
            
            let index = 0;
            data.forEach((details, type) => {
                const x = padding + barWidth * index + barWidth * 0.1;
                const barHeight = (details.count / maxCount) * chartHeight;
                const y = height - padding - barHeight;
                
                // Î©îÏù∏ Ôø?                ctx.fillStyle = '#4a9eff';
                ctx.fillRect(x, y, barWidth * 0.8, barHeight);
                
                // ?ÔøΩÎ≥¥ ?ÔøΩÏä§??                ctx.fillStyle = '#fff';
                ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(details.count.toString(), x + barWidth * 0.4, y - 10);
                
                // ?ÔøΩÎèô ?ÔøΩÌòï
                ctx.fillStyle = '#7a7a7a';
                ctx.fillText(type, x + barWidth * 0.4, height - 10);
                
                // Ï∂îÔøΩ? ?ÔøΩÎ≥¥
                ctx.fillStyle = '#ff9800';
                ctx.fillText(`$${details.totalCost.toFixed(2)}`, x + barWidth * 0.4, height - 25);
                ctx.fillStyle = '#4caf50';
                ctx.fillText(`${details.users.size}Ôø?, x + barWidth * 0.4, height - 40);
                
                index++;
            });
        }

        // Ï∞®Ìä∏ ?ÔøΩÏÑ± (Overview??
        function createOverviewChart() {
            const canvas = document.getElementById('overviewChart');
            if (!canvas) return;
           
            // Canvas ?ÔøΩÍ∏∞ ?ÔøΩÏ†ï
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = 300;
           
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
           
            // Î∞∞Í≤Ω ?ÔøΩÏ†ï
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, width, height);
            
            // ?ÔøΩÏû¨ ?ÔøΩÌÑ∞ ?ÔøΩÌÉú ?ÔøΩÏù∏
            let dateRange;
            if (currentDateRange) {
                dateRange = currentDateRange;
            } else {
                const filterDays = getCurrentFilterDays();
                dateRange = getDateRange(filterDays);
            }
            
            // ?ÔøΩÎ≥Ñ ?ÔøΩÎèô ?ÔøΩÏù¥???ÔøΩÏÑ±
            const dailyData = generateDailyActivityData(dateRange);
            
            if (dailyData.length === 0) {
                // ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏùÑ ??Î©îÏãúÏßÄ ?ÔøΩÏãú
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂àÎü¨?ÔøΩÎäî Ôø?..', width / 2, height / 2);
                return;
            }
           
            // Í∑∏Î¶¨??Í∑∏Î¶¨Ôø?            ctx.strokeStyle = '#3a3a3a';
            ctx.lineWidth = 1;
           
            // ?ÔøΩÎ°ú Í∑∏Î¶¨??            for (let i = 0; i <= dailyData.length; i++) {
                const x = (width / dailyData.length) * i;
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, height);
                ctx.stroke();
            }
           
            // Í∞ÄÔø?Í∑∏Î¶¨??            for (let i = 0; i <= 5; i++) {
                const y = (height / 5) * i;
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(width, y);
                ctx.stroke();
            }
            
            // ÏµúÔøΩ?Ôø?Í≥ÑÏÇ∞
            const maxValue = Math.max(...dailyData.map(d => d.value));
            
            // ?ÔøΩÏù¥???ÔøΩÏù∏???ÔøΩÏÑ±
            const dataPoints = dailyData.map((data, index) => ({
                x: (width / dailyData.length) * index + (width / dailyData.length / 2),
                y: height - (height * (data.value / maxValue)) - 20
            }));
           
            // ??Í∑∏Îûò??Í∑∏Î¶¨Ôø?            ctx.strokeStyle = '#4a9eff';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(dataPoints[0].x, dataPoints[0].y);
           
            for (let i = 1; i < dataPoints.length; i++) {
                ctx.lineTo(dataPoints[i].x, dataPoints[i].y);
            }
            ctx.stroke();
           
            // ?ÔøΩÏù¥???ÔøΩÏù∏????Í∑∏Î¶¨Ôø?            dataPoints.forEach(point => {
                ctx.fillStyle = '#4a9eff';
                ctx.beginPath();
                ctx.arc(point.x, point.y, 4, 0, Math.PI * 2);
                ctx.fill();
            });
           
            // ?ÔøΩÏßú ?ÔøΩÏù¥Ôø?            ctx.fillStyle = '#7a7a7a';
            ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'center';
           
            dailyData.forEach((data, index) => {
                const x = (width / dailyData.length) * index + (width / dailyData.length / 2);
                ctx.fillText(data.date, x, height - 10);
            });
        }
        
        // ?ÔøΩÎ≥Ñ ?ÔøΩÎèô ?ÔøΩÏù¥???ÔøΩÏÑ± ?ÔøΩÏàò
        function generateDailyActivityData(dateRange) {
            const dailyData = [];
            
            // ?ÔøΩÌï© ?ÔøΩÏù¥???Ôø?ÔøΩÏÜå?ÔøΩÏÑú ?ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø?            const rawEvents = chartDataStore.rawEvents.length > 0 ? chartDataStore.rawEvents : currentRawEventsData;
            
            if (!rawEvents || rawEvents.length === 0) {
                console.log('?ÔøΩÔ∏è generateDailyActivityData: ?ÔøΩÏö© Í∞Ä?ÔøΩÌïú ?ÔøΩÎ≤§???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                return dailyData;
            }
            
            // ?ÔøΩÏßúÔø??ÔøΩÎèô ??ÏßëÍ≥Ñ
            const dailyActivity = new Map();
            
            rawEvents.forEach(event => {
                const eventDate = new Date(parseInt(event.timestamp));
                const dateKey = eventDate.toISOString().split('T')[0];
                
                if (eventDate >= dateRange.startDate && eventDate <= dateRange.endDate) {
                    dailyActivity.set(dateKey, (dailyActivity.get(dateKey) || 0) + 1);
                }
            });
            
            // ?ÔøΩÏßú Î≤îÏúÑ ??Î™®Îì† ?ÔøΩÏßú???Ôø???ÔøΩÏù¥???ÔøΩÏÑ±
            const startDate = new Date(dateRange.startDate);
            const endDate = new Date(dateRange.endDate);
            
            for (let d = new Date(startDate); d <= endDate; d.setDate(d.getDate() + 1)) {
                const dateKey = d.toISOString().split('T')[0];
                const dateStr = `${d.getMonth() + 1}/${d.getDate()}`;
                
                dailyData.push({
                    date: dateStr,
                    value: dailyActivity.get(dateKey) || 0
                });
            }
            
            return dailyData;
        }

        // ?ÔøΩÌÅ¨Ôø??ÔøΩÏπò Í¥ÄÔø?Í∞ùÏ≤¥
        const scrollPositions = {
            overview: 0,
            members: 0,
            usage: 0,
            settings: 0
        };
        
        // ?ÔøΩÏÖòÔø?ÏµúÏ¥à Î∞©Î¨∏ ?ÔøΩÔøΩ? Ï∂îÏ†Å
        const sectionVisited = {
            overview: false,
            members: false,
            usage: false,
            settings: false
        };

        // Î©îÎâ¥ ?ÔøΩÎ¶≠ ?ÔøΩÎ≤§??Ï≤òÎ¶¨
        document.querySelectorAll('.menu-item').forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
               
                // ?ÔøΩÏû¨ ?ÔøΩÏÑ± ?ÔøΩÏÖò???ÔøΩÌÅ¨Ôø??ÔøΩÏπò ?Ôø??                const currentActiveSection = document.querySelector('.content-section.active');
                if (currentActiveSection) {
                    const currentSectionName = currentActiveSection.id;
                    scrollPositions[currentSectionName] = currentActiveSection.scrollTop;
                }
               
                // Î™®Îì† Î©îÎâ¥ ?ÔøΩÏù¥?ÔøΩÏóê??active ?ÔøΩÎûò???ÔøΩÍ±∞
                document.querySelectorAll('.menu-item').forEach(menu => {
                    menu.classList.remove('active');
                });
               
                // ?ÔøΩÎ¶≠??Î©îÎâ¥??active ?ÔøΩÎûò??Ï∂îÔøΩ?
                this.classList.add('active');
               
                // Î™®Îì† ÏΩòÌÖêÔø??ÔøΩÏÖò ?ÔøΩÍ∏∞Ôø?                document.querySelectorAll('.content-section').forEach(section => {
                    section.classList.remove('active');
                });
               
                // ?ÔøΩÌÉù???ÔøΩÏÖò ?ÔøΩÏãú
                const sectionName = this.getAttribute('data-section');
                const targetSection = document.getElementById(sectionName);
                if (targetSection) {
                    targetSection.classList.add('active');
                    
                    // ?ÔøΩÌÅ¨Ôø??ÔøΩÏπò ?ÔøΩÏ†ï
                    setTimeout(() => {
                        if (!sectionVisited[sectionName]) {
                            // ÏµúÏ¥à Î∞©Î¨∏ ???ÔøΩÎã®?ÔøΩÎ°ú ?ÔøΩÌÅ¨Ôø?                            targetSection.scrollTop = 0;
                            sectionVisited[sectionName] = true;
                            console.log(`${sectionName} ?ÔøΩÏÖò ÏµúÏ¥à Î∞©Î¨∏ - ?ÔøΩÎã®?ÔøΩÎ°ú ?ÔøΩÌÅ¨Ôø?);
                        } else {
                            // ?ÔøΩÌõÑ Î∞©Î¨∏ ???ÔøΩÏ†Ñ ?ÔøΩÌÅ¨Ôø??ÔøΩÏπòÔø?Î≥µÏõê
                            targetSection.scrollTop = scrollPositions[sectionName];
                            console.log(`${sectionName} ?ÔøΩÏÖò ?ÔøΩÎ∞©Ôø?- ?ÔøΩÏ†Ñ ?ÔøΩÏπòÔø??ÔøΩÌÅ¨Ôø? ${scrollPositions[sectionName]}px`);
                        }
                    }, 50);
                }
               
                // ?ÔøΩÎçî ?ÔøΩÎ™© ?ÔøΩÎç∞?ÔøΩÌä∏
                const pageTitle = document.getElementById('page-title');
               
                switch(sectionName) {
                    case 'overview':
                        pageTitle.textContent = 'Dashboard Overview';
                        // Overview Î©îÎâ¥ ?ÔøΩÎ¶≠ ???ÔøΩÏû¨ ?ÔøΩÌÑ∞ ?ÔøΩÌÉú ?ÔøΩÔøΩ??ÔøΩÎ©¥???ÔøΩÏù¥?ÔøΩÎßå ?ÔøΩÎ°úÍ≥†Ïπ®
                        setTimeout(async () => {
                            console.log('=== Overview Î©îÎâ¥ ?ÔøΩÎ¶≠ ???ÔøΩÎèô ?ÔøΩÏ†ú API ?ÔøΩÏù¥???ÔøΩÎ°úÍ≥†Ïπ® ?ÔøΩÏûë ===');
                            await refreshAllRealData(); // ?ÔøΩÎèô ?ÔøΩÎ°úÍ≥†Ïπ® (?ÔøΩÏû¨ ?ÔøΩÌÑ∞ ?ÔøΩÌÉú ?ÔøΩÔøΩ?)
                        }, 100);
                        break;
                    case 'members':
                        pageTitle.textContent = 'Dashboard Members';
                        // Members Î©îÎâ¥ ?ÔøΩÎ¶≠ ???ÔøΩÎèô ?ÔøΩÎ°úÍ≥†Ïπ®
                        setTimeout(async () => {
                            console.log('=== Members Î©îÎâ¥ ?ÔøΩÎ¶≠ ???ÔøΩÎèô ?ÔøΩÏ†ú API ?ÔøΩÏù¥???ÔøΩÎ°úÍ≥†Ïπ® ?ÔøΩÏûë ===');
                            await updateMembersWithRealData();
                        }, 100);
                        break;
                    case 'usage':
                        pageTitle.textContent = 'Usage Analytics';
                        // Usage Î©îÎâ¥ ?ÔøΩÎ¶≠ ??Ï°∞Í±¥Î∂Ä ?ÔøΩÏù¥??Î°úÎî©
                        setTimeout(async () => {
                            if (!isUsageDataLoaded) {
                                console.log('=== Usage Î©îÎâ¥ Ôø?Î≤àÏß∏ ?ÔøΩÎ¶≠ - ?ÔøΩÏù¥??Î°úÎî© ?ÔøΩÏûë ===');
                                // Ï¥àÍ∏∞ ?ÔøΩÌÑ∞ Í∏∞Í∞Ñ ?ÔøΩÏãú ?ÔøΩÏ†ï (30??
                                const initialDateRange = getDateRange(30);
                                updateUsageFilterPeriodDisplay(initialDateRange.startDate, initialDateRange.endDate);
                                await updateUsageWithCurrentFilter(30, true); // Ôø?Î≤àÏß∏ Î°úÎî©
                            } else {
                                console.log('=== Usage Î©îÎâ¥ ?ÔøΩÌÅ¥Ôø?- Î∞±Í∑∏?ÔøΩÏö¥???ÔøΩÏù¥??Í∞±Ïã† ===');
                                updateUsageWithCurrentFilter(30, false); // Î∞±Í∑∏?ÔøΩÏö¥??Î°úÎî©
                            }
                        }, 100);
                        break;
                    case 'settings':
                        pageTitle.textContent = 'Settings';
                        break;
                    default:
                        pageTitle.textContent = sectionName.charAt(0).toUpperCase() + sectionName.slice(1);
                }
            });
        });

        // ?ÔøΩÏΩî?ÔøΩÏñ∏ ?ÔøΩÔøΩ? ?ÔøΩÏàò
        function toggleAccordion(header) {
            const content = header.nextElementSibling;
            const arrow = header.querySelector('.accordion-arrow');
           
            // ?ÔøΩÎ•∏ Î™®Îì† ?ÔøΩÏΩî?ÔøΩÏñ∏ ?ÔøΩÍ∏∞
            document.querySelectorAll('.accordion-content').forEach(otherContent => {
                if (otherContent !== content) {
                    otherContent.classList.remove('active');
                    otherContent.previousElementSibling.querySelector('.accordion-arrow').textContent = '??;
                }
            });
           
            // ?ÔøΩÏû¨ ?ÔøΩÏΩî?ÔøΩÏñ∏ ?ÔøΩÔøΩ?
            if (content.classList.contains('active')) {
                content.classList.remove('active');
                arrow.textContent = '??;
            } else {
                content.classList.add('active');
                arrow.textContent = '??;
            }
        }

        // ?ÔøΩÔøΩ? ?ÔøΩÏúÑÔø??ÔøΩÏàò
        function toggleSwitch(toggle) {
            toggle.classList.toggle('off');
        }

        // Overview ?ÔøΩÍ≥Ñ Ïπ¥Îìú ?ÔøΩÎ¶≠ ??Î©§Î≤Ñ ?Ôø?ÔøΩÎ≥Ñ ?ÔøΩÌÑ∞Ôø?        function filterOverviewMembersByType(type) {
            console.log(`=== Overview ?ÔøΩÍ≥Ñ Ïπ¥Îìú ?ÔøΩÎ¶≠: ${type} ===`);
            
            // ?ÔøΩÌÉù ?ÔøΩÌÉú ?ÔøΩÎç∞?ÔøΩÌä∏
            updateOverviewSelection(type);
            currentFilterType = type;
            
            // Î©§Î≤Ñ ?ÔøΩÏù¥???ÔøΩÌÑ∞Ôø?Ôø??ÔøΩÏãú
            filterAndDisplayMembers(type);
            
            console.log(`?ÔøΩÍ≥Ñ Ïπ¥Îìú ?ÔøΩÌÉù ?ÔøΩÎ£å: ${type} - ?ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÏù¥???ÔøΩÏãú`);
        }

        // Î©§Î≤Ñ ?ÔøΩÏù¥?ÔøΩÔøΩ? ?Ôø?ÔøΩÎ≥ÑÔø??ÔøΩÌÑ∞ÎßÅÌïòÔø??ÔøΩÏãú
        function filterAndDisplayMembers(type) {
            console.log(`=== Î©§Î≤Ñ ?ÔøΩÏù¥???ÔøΩÌÑ∞Ôø??ÔøΩÏûë: ${type} ===`);
            
            if (!originalMembersData || originalMembersData.length === 0) {
                console.log('?ÔøΩÌÑ∞ÎßÅÌï† Î©§Î≤Ñ ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                return;
            }
            
            let filteredMembers = [];
            
            if (type === 'total') {
                // ?ÔøΩÏ≤¥ Î©§Î≤Ñ ?ÔøΩÏãú
                filteredMembers = [...originalMembersData];
                console.log(`?ÔøΩÏ≤¥ Î©§Î≤Ñ ?ÔøΩÏãú: ${filteredMembers.length}Ôø?);
            } else if (type === 'active') {
                // ?ÔøΩÏÑ± Î©§Î≤ÑÔø??ÔøΩÌÑ∞Ôø?(Premium RequestsÍ∞Ä ?ÔøΩÎäî Î©§Î≤Ñ)
                filteredMembers = originalMembersData.filter(member => 
                    member.spendData.premiumRequests > 0
                );
                console.log(`?ÔøΩÏÑ± Î©§Î≤Ñ ?ÔøΩÌÑ∞Ôø? ${filteredMembers.length}Ôø?);
            } else if (type === 'inactive') {
                // ÎπÑÌôú??Î©§Î≤ÑÔø??ÔøΩÌÑ∞Ôø?(Premium RequestsÍ∞Ä ?ÔøΩÎäî Î©§Î≤Ñ)
                filteredMembers = originalMembersData.filter(member => 
                    member.spendData.premiumRequests === 0
                );
                console.log(`ÎπÑÌôú??Î©§Î≤Ñ ?ÔøΩÌÑ∞Ôø? ${filteredMembers.length}Ôø?);
            }
            
            // ?ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÏù¥?ÔøΩÎ°ú ?ÔøΩÏù¥Ôø??ÔøΩÎç∞?ÔøΩÌä∏
            if (filteredMembers.length > 0) {
                currentMembersData = filteredMembers;
                currentMembersPage = 1; // ?ÔøΩÏù¥ÏßÄ Î¶¨ÏÖã
                renderMembersTableWithPagination(filteredMembers);
            } else {
                // ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏùÑ Í≤ΩÏö∞ Ôø??ÔøΩÏù¥Ôø??ÔøΩÏãú
                const container = document.getElementById('members-table-container');
                if (container) {
                    container.innerHTML = `
                        <div style="padding: 20px; text-align: center; color: #7a7a7a; background-color: #1a1a1a;">
                            ${type === 'active' ? '?ÔøΩÏÑ± Î©§Î≤ÑÍ∞Ä ?ÔøΩÏäµ?ÔøΩÎã§.' : 
                              type === 'inactive' ? 'ÎπÑÌôú??Î©§Î≤ÑÍ∞Ä ?ÔøΩÏäµ?ÔøΩÎã§.' : 
                              'Î©§Î≤Ñ ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.'}
                        </div>
                    `;
                }
            }
            
            // ?ÔøΩÎèô Î¶¨Ïä§?ÔøΩÎèÑ ?ÔøΩÍªò ?ÔøΩÎç∞?ÔøΩÌä∏
            updateActivityListByType(type);
            
            console.log(`=== Î©§Î≤Ñ ?ÔøΩÏù¥???ÔøΩÌÑ∞Ôø??ÔøΩÎ£å: ${type} ===`);
        }

        // ?ÔøΩÎèô Î¶¨Ïä§?ÔøΩÔøΩ? ?Ôø?ÔøΩÎ≥ÑÔø??ÔøΩÌÑ∞ÎßÅÌïòÔø??ÔøΩÎç∞?ÔøΩÌä∏
        function updateActivityListByType(type) {
            console.log(`=== ?ÔøΩÎèô Î¶¨Ïä§???ÔøΩÌÑ∞Ôø??ÔøΩÏûë: ${type} ===`);
            
            if (!currentActivities || currentActivities.length === 0) {
                console.log('?ÔøΩÌÑ∞ÎßÅÌï† ?ÔøΩÎèô ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                updateActivityList([]);
                return;
            }
            
            let filteredActivities = [];
            
            if (type === 'total') {
                // ?ÔøΩÏ≤¥ ?ÔøΩÎèô ?ÔøΩÏãú
                filteredActivities = [...currentActivities];
                console.log(`?ÔøΩÏ≤¥ ?ÔøΩÎèô ?ÔøΩÏãú: ${filteredActivities.length}Ôø?);
            } else if (type === 'active') {
                // ?ÔøΩÏÑ± ?ÔøΩÎèôÔø??ÔøΩÌÑ∞Ôø?                filteredActivities = currentActivities.filter(activity => 
                    activity.type === 'active'
                );
                console.log(`?ÔøΩÏÑ± ?ÔøΩÎèô ?ÔøΩÌÑ∞Ôø? ${filteredActivities.length}Ôø?);
            } else if (type === 'inactive') {
                // ÎπÑÌôú???ÔøΩÎèôÔø??ÔøΩÌÑ∞Ôø?                filteredActivities = currentActivities.filter(activity => 
                    activity.type === 'inactive'
                );
                console.log(`ÎπÑÌôú???ÔøΩÎèô ?ÔøΩÌÑ∞Ôø? ${filteredActivities.length}Ôø?);
            }
            
            // ?ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÎèô ?ÔøΩÏù¥?ÔøΩÎ°ú Î¶¨Ïä§???ÔøΩÎç∞?ÔøΩÌä∏
            updateActivityList(filteredActivities);
            
            console.log(`=== ?ÔøΩÎèô Î¶¨Ïä§???ÔøΩÌÑ∞Ôø??ÔøΩÎ£å: ${type} ===`);
        }

        // Overview ?ÔøΩÍ≥Ñ Ïπ¥Îìú ?ÔøΩÌÉù ?ÔøΩÌÉú ?ÔøΩÎç∞?ÔøΩÌä∏
        function updateOverviewSelection(type) {
            // Î™®Îì† ?ÔøΩÍ≥Ñ Ïπ¥Îìú?ÔøΩÏÑú selected ?ÔøΩÎûò???ÔøΩÍ±∞
            document.querySelectorAll('.overview-stat-box').forEach(box => {
                box.classList.remove('selected');
            });
            
            // ?ÔøΩÎ¶≠??Ïπ¥Îìú??selected ?ÔøΩÎûò??Ï∂îÔøΩ?
            const targetBox = document.querySelector(`.overview-stat-box[data-type="${type}"]`);
            if (targetBox) {
                targetBox.classList.add('selected');
            }
            
            console.log(`?ÔøΩÍ≥Ñ Ïπ¥Îìú ?ÔøΩÌÉù ?ÔøΩÌÉú ?ÔøΩÎç∞?ÔøΩÌä∏: ${type}`);
        }

        // ?Ôø?ÔøΩÎ≥Ñ Î©§Î≤Ñ ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏ†ú API?ÔøΩÏÑú Í∞Ä?ÔøΩÔøΩ????ÔøΩÏãú
        async function updateMembersByTypeWithRealData(type) {
            console.log(`=== ${type} Î©§Î≤Ñ ?ÔøΩÏ†ú API ?ÔøΩÏù¥??Î°úÎìú ?ÔøΩÏûë ===`);
            console.log(`?ÔøΩÏ≤≠???Ôø?? ${type}, ?ÔøΩÏû¨ ?ÔøΩÌÑ∞ ?Ôø?? ${currentFilterType}`);
           
            // ?ÔøΩÏû¨ ?ÔøΩÌÑ∞ Í∏∞Í∞Ñ Í≤∞Ï†ï
            let dateRange;
            if (currentDateRange) {
                dateRange = currentDateRange;
            } else {
                const filterDays = getCurrentFilterDays();
                dateRange = getDateRange(filterDays);
            }
           
            console.log(`?ÔøΩÌÑ∞ Í∏∞Í∞Ñ: ${new Date(dateRange.startDate).toLocaleDateString()} ~ ${new Date(dateRange.endDate).toLocaleDateString()}`);
           
            // ?ÔøΩÏ†ú API ?ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø?            const [membersData, eventsData] = await Promise.all([
                getTeamMembers(),
                getFilteredEvents(dateRange.startDate, dateRange.endDate)
            ]);
           
            if (!membersData || !membersData.teamMembers) {
                throw new Error('Î©§Î≤Ñ ?ÔøΩÏù¥?ÔøΩÔøΩ? Í∞Ä?ÔøΩÏò¨ ???ÔøΩÏäµ?ÔøΩÎã§.');
            }
           
            console.log(`API ?ÔøΩÎãµ: Î©§Î≤Ñ ${membersData.teamMembers.length}Ôø? ?ÔøΩÎ≤§??${eventsData?.usageEvents?.length || 0}Ôø?);
           
            if (type === 'inactive') {
                // ÎπÑÌôú??Î©§Î≤Ñ Ï≤òÎ¶¨
                await showInactiveMembersWithData(membersData, eventsData);
            } else if (type === 'active') {
                // ?ÔøΩÏÑ± Î©§Î≤Ñ Ï≤òÎ¶¨
                await showActiveMembersWithData(membersData, eventsData, 'active');
            } else if (type === 'total') {
                // ?ÔøΩÏ≤¥ Î©§Î≤Ñ Ï≤òÎ¶¨
                await showActiveMembersWithData(membersData, eventsData, 'total');
            } else {
                console.error(`?????ÔøΩÎäî ?Ôø?? ${type}`);
                currentActivityPage = 1; // ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥??Ï¥àÍ∏∞??                updateActivityList([]);
                // ?ÔøΩÎ™©?Ôø??ÔøΩÏ†Å?ÔøΩÎ°ú ?ÔøΩÏÑ±??            }
           
            console.log(`=== ${type} Î©§Î≤Ñ ?ÔøΩÏ†ú API ?ÔøΩÏù¥??Î°úÎìú ?ÔøΩÎ£å ===`);
        }

        // ?ÔøΩÏÑ± Î©§Î≤Ñ ?ÔøΩÎäî ?ÔøΩÏ≤¥ Î©§Î≤Ñ ?ÔøΩÏãú
        async function showActiveMembersWithData(membersData, eventsData, type) {
            console.log(`=== ${type} Î©§Î≤Ñ ?ÔøΩÏù¥???ÔøΩÏãú ?ÔøΩÏûë ===`);
           
            if (!eventsData || !eventsData.usageEvents) {
                console.log('?ÔøΩÎèô ?ÔøΩÎ≤§???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                currentActivityPage = 1; // ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥??Ï¥àÍ∏∞??                updateActivityList([]);
                // ?ÔøΩÎ™©?Ôø??ÔøΩÏ†Å?ÔøΩÎ°ú ?ÔøΩÏÑ±??                return;
            }
           
            // ÏßÄÔø??ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø?            const spendingData = await getTeamSpendingData();
            const memberSpendMap = {};
            if (spendingData && spendingData.teamMemberSpend) {
                spendingData.teamMemberSpend.forEach(spendInfo => {
                    memberSpendMap[spendInfo.email] = {
                        premiumRequests: spendInfo.fastPremiumRequests || 0,
                        spend: (spendInfo.spendCents || 0) / 100,
                        hardLimitOverride: spendInfo.hardLimitOverrideDollars || 0
                    };
                });
            }
           
            // ?ÔøΩÏ†ú ?ÔøΩÎèô Î¶¨Ïä§???ÔøΩÏÑ±
            const activities = createActivityListWithLastActivity(eventsData.usageEvents, membersData.teamMembers, memberSpendMap);
            console.log(`?ÔøΩÏÑ±???ÔøΩÎèô Î¶¨Ïä§?? ${activities.length}Ôø?);
           
            let filteredActivities;
            if (type === 'active') {
                // ?ÔøΩÏÑ± Î©§Î≤Ñ: request > 0??Î©§Î≤ÑÔø?                filteredActivities = activities.filter(activity => activity.request > 0);
            } else if (type === 'total') {
                // ?ÔøΩÏ≤¥ Î©§Î≤Ñ: ?ÔøΩÏ†ú ?ÔøΩÎèô???ÔøΩÎäî Î™®Îì† Î©§Î≤Ñ
                filteredActivities = activities;
            } else {
                // Í∏∞Î≥∏Ôø? ?ÔøΩÏ≤¥ Î©§Î≤Ñ
                filteredActivities = activities;
                console.log(`Í∏∞Î≥∏ ?ÔøΩÏ≤¥ Î©§Î≤Ñ ?ÔøΩÏãú: ${filteredActivities.length}Ôø?);
            }
           
            console.log(`${type} Î©§Î≤Ñ ÏµúÏ¢Ö ?ÔøΩÏù¥?? ${filteredActivities.length}Ôø?);
            console.log('?ÔøΩÏãú??Î©§Î≤Ñ Î™©Î°ù:', filteredActivities.map(a => `${a.email} (${a.request} requests)`));
           
            updateActivityList(filteredActivities);
            // ?ÔøΩÎ™©?Ôø??ÔøΩÏ†Å?ÔøΩÎ°ú ?ÔøΩÏÑ±??           
            console.log(`=== ${type} Î©§Î≤Ñ ?ÔøΩÏù¥???ÔøΩÏãú ?ÔøΩÎ£å ===`);
        }

        // ÎπÑÌôú??Î©§Î≤Ñ ?ÔøΩÏãú ?ÔøΩÏàò (?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÍªò)
        async function showInactiveMembersWithData(membersData, eventsData) {
            console.log('=== ÎπÑÌôú??Î©§Î≤Ñ ?ÔøΩÏãú ?ÔøΩÏûë ===');
           
            // ÏßÄÔø??ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø?            const spendingData = await getTeamSpendingData();
            const memberSpendMap = {};
            if (spendingData && spendingData.teamMemberSpend) {
                spendingData.teamMemberSpend.forEach(spendInfo => {
                    memberSpendMap[spendInfo.email] = {
                        premiumRequests: spendInfo.fastPremiumRequests || 0,
                        spend: (spendInfo.spendCents || 0) / 100,
                        hardLimitOverride: spendInfo.hardLimitOverrideDollars || 0
                    };
                });
            }
           
            // ?ÔøΩÎèô???ÔøΩÎäî ?ÔøΩÏö©??Î™©Î°ù ?ÔøΩÏÑ±
            const activeUserEmails = new Set();
            if (eventsData && eventsData.usageEvents) {
                eventsData.usageEvents.forEach(event => {
                    if (event.userEmail && event.requestsCosts > 0) {
                        activeUserEmails.add(event.userEmail);
                    }
                });
            }
           
            // ÎπÑÌôú??Î©§Î≤Ñ ?ÔøΩÌÑ∞Ôø?            const inactiveMembers = membersData.teamMembers.filter(member =>
                !activeUserEmails.has(member.email)
            );
           
            console.log(`ÎπÑÌôú??Î©§Î≤Ñ: ${inactiveMembers.length}Ôø?);
            console.log('ÎπÑÌôú??Î©§Î≤Ñ Î™©Î°ù:', inactiveMembers.map(m => m.email));
           
            // ÎπÑÌôú??Î©§Î≤ÑÔø??ÔøΩÎèô Î¶¨Ïä§???ÔøΩÌÉúÔø?Î≥Ä??            const inactiveActivities = inactiveMembers.map(member => {
                const spendData = memberSpendMap[member.email] || {};
                const actualSpend = spendData.spend || 0; // ?ÔøΩÏ†ú ÏßÄÔø??ÔøΩÏù¥???ÔøΩÏö©
                const premiumRequests = spendData.premiumRequests || 0;
                const hardLimit = spendData.hardLimitOverride || 0;
                const limitDisplay = hardLimit > 0 ? `$${hardLimit}` : '$0';
               
                return {
                    date: 'No Activity',
                    timestamp: 0,
                    email: member.email,
                    name: member.name || 'Unnamed',
                    type: 'inactive',
                    kind: 'No Activity',
                    request: premiumRequests, // Premium Requests ?ÔøΩÏö©
                    spend: `$${actualSpend.toFixed(2)}`, // ?ÔøΩÏ†ú ÏßÄÔø??ÔøΩÏù¥???ÔøΩÏö©
                    limit: limitDisplay
                };
            });
           
            currentActivityPage = 1; // ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥??Ï¥àÍ∏∞??            updateActivityList(inactiveActivities);
            // ?ÔøΩÎ™©?Ôø??ÔøΩÏ†Å?ÔøΩÎ°ú ?ÔøΩÏÑ±??        }

        // ÎπÑÌôú??Î©§Î≤Ñ ?ÔøΩÏãú ?ÔøΩÏàò (Í∏∞Ï°¥ ?ÔøΩÌôò???ÔøΩÔøΩ?)
        async function showInactiveMembers() {
            try {
                console.log('=== ÎπÑÌôú??Î©§Î≤Ñ ?ÔøΩÏãú ?ÔøΩÏûë (Í∏∞Ï°¥ ?ÔøΩÏàò) ===');
               
                // ?ÔøΩÏû¨ ?ÔøΩÌÑ∞ Í∏∞Í∞Ñ???ÔøΩÎ≤§???ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø?                let dateRange;
                if (currentDateRange) {
                    dateRange = currentDateRange;
                } else {
                    const filterDays = getCurrentFilterDays();
                    dateRange = getDateRange(filterDays);
                }
               
                const [membersData, eventsData] = await Promise.all([
                    getTeamMembers(),
                    getFilteredEvents(dateRange.startDate, dateRange.endDate)
                ]);
               
                if (!membersData || !membersData.teamMembers) {
                    console.error('Î©§Î≤Ñ ?ÔøΩÏù¥?ÔøΩÔøΩ? Í∞Ä?ÔøΩÏò¨ ???ÔøΩÏäµ?ÔøΩÎã§.');
                    return;
                }
               
                await showInactiveMembersWithData(membersData, eventsData);
               
            } catch (error) {
                console.error('??ÎπÑÌôú??Î©§Î≤Ñ ?ÔøΩÏãú ?ÔøΩÌå®:', error);
            }
        }

        // ?ÔøΩÎèô ?ÔøΩÏù¥?ÔøΩÔøΩ? ?Ôø?ÔøΩÎ≥ÑÔø??ÔøΩÌÑ∞Ôø?(?ÔøΩÏ†ú ?ÔøΩÎèô Í∏∞ÔøΩ?) - ?ÔøΩÏö© Ï§ëÎã®??        // ?ÔøΩÏ†ú Ôø??ÔøΩÍ≥Ñ Ïπ¥Îìú ?ÔøΩÎ¶≠ ???ÔøΩÏ†ú API ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÎ°ú Í∞Ä?ÔøΩÔøΩ????ÔøΩÏãú??        function filterActivitiesByType(activities, type) {
            console.log(`?ÔøΩÔ∏è filterActivitiesByType ?ÔøΩÏö© Ï§ëÎã®?? ?Ôø??updateMembersByTypeWithRealData ?ÔøΩÏö©`);
            console.log(`?ÔøΩÌÑ∞Ôø??ÔøΩÏ≤≠: ${type}, ?ÔøΩÏ≤¥ ?ÔøΩÎèô ?? ${activities.length}`);
           
            let filteredActivities;
            switch (type) {
                case 'active':
                    filteredActivities = activities.filter(activity => activity.type === 'active' && activity.request > 0);
                    break;
                case 'inactive':
                    // ÎπÑÌôú??Î©§Î≤Ñ???ÔøΩÏãú?ÔøΩÎèÑÔø??ÔøΩÏ†ï
                    filteredActivities = activities.filter(activity => activity.type === 'inactive');
                    break;
                case 'total':
                default:
                    filteredActivities = activities;
                    break;
            }
           
            console.log(`?ÔøΩÌÑ∞Ôø?Í≤∞Í≥º: ${filteredActivities.length}Ôø?);
            return filteredActivities;
        }

        // Overview ?ÔøΩÎèôÎ¶¨Ïä§???ÔøΩÎ™© ?ÔøΩÎç∞?ÔøΩÌä∏ (?ÔøΩÏ†Å?ÔøΩÎ°ú ?ÔøΩÎçî???ÔøΩÌï®??
        function updateOverviewActivityTitle(type, count, totalCount) {
            // ?ÔøΩÎ™©?Ôø?renderOverviewActivityTableWithPagination?ÔøΩÏÑú ?ÔøΩÏ†Å?ÔøΩÎ°ú ?ÔøΩÏÑ±??            let title, emoji;
            switch (type) {
                case 'active':
                    title = '?ÔøΩÏÑ± Î©§Î≤Ñ ?ÔøΩÎèô Î¶¨Ïä§??;
                    emoji = '??;
                    break;
                case 'inactive':
                    title = 'ÎπÑÌôú??Î©§Î≤Ñ ?ÔøΩÎèô Î¶¨Ïä§??;
                    emoji = '?ÔøΩÔøΩ';
                    break;
                case 'total':
                default:
                    title = '?ÔøΩÏ≤¥ ?ÔøΩÎèô Î¶¨Ïä§??;
                    emoji = '?ÔøΩÔøΩ';
                    break;
            }
           
            // ?ÔøΩÏ†Å?ÔøΩÎ°ú ?ÔøΩÏÑ±?ÔøΩÎäî ?ÔøΩÎ™©???ÔøΩÏö©??Í∏∞Î≥∏ ?ÔøΩÎ≥¥ Î∞òÌôò
            return { title, emoji };
        }

        // ?ÔøΩÏû¨ Overview ?ÔøΩÌÑ∞ Í∏∞Í∞Ñ???ÔøΩÏä§?ÔøΩÎ°ú Î∞òÌôò
        function getCurrentOverviewPeriodText() {
            let dateRange;
            if (currentDateRange) {
                dateRange = currentDateRange;
            } else {
                const filterDays = getCurrentFilterDays();
                dateRange = getDateRange(filterDays);
            }
            
            const startDate = new Date(dateRange.startDate).toLocaleDateString('ko-KR');
            const endDate = new Date(dateRange.endDate).toLocaleDateString('ko-KR');
            
            // ?ÔøΩÏßú ?ÔøΩÏùò "." ?ÔøΩÍ±∞
            const cleanStartDate = startDate.replace(/\.$/, '');
            const cleanEndDate = endDate.replace(/\.$/, '');
            
            return `${cleanStartDate} ~ ${cleanEndDate}`;
        }

        // Ï∞®Ìä∏ Î≤ÑÌäº ?ÔøΩÎ¶≠ ?ÔøΩÎ≤§??(Ï¶âÏãú Î∞òÏùë)
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('chart-btn')) {
                // Ï¶âÏãú ?ÔøΩÍ∞Å???ÔøΩÎìúÔø?                e.target.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    e.target.style.transform = '';
                }, 150);
                
                // ?ÔøΩÏû¨ ?ÔøΩÏÖò??Ï∞®Ìä∏ Î≤ÑÌäº?ÔøΩÎßå Ï≤òÎ¶¨
                const parentSection = e.target.closest('.content-section');
                if (parentSection) {
                    // Ï¶âÏãú Î≤ÑÌäº ?ÔøΩÌÉú Î≥ÄÔø?                    parentSection.querySelectorAll('.chart-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    e.target.classList.add('active');
                   
                    // Overview ?ÔøΩÏÖò???ÔøΩÌÑ∞ Î≤ÑÌäº??Í≤ΩÏö∞
                    if (parentSection.id === 'overview') {
                        const days = e.target.getAttribute('data-days') || 1;
                        console.log(`Overview ?ÔøΩÌÑ∞ Î≤ÑÌäº ?ÔøΩÎ¶≠: ${days}??);
                        
                        // Ï∞®Ìä∏ Ï∫êÏãú Ï¥àÍ∏∞??(?ÔøΩÌÑ∞Í∞Ä Î≥ÄÍ≤ΩÎêò?ÔøΩÏúºÎØÄÔø?
                        clearChartCache();
                        
                        // Ï¶âÏãú ?ÔøΩÌÑ∞ Í∏∞Í∞Ñ ?ÔøΩÏãú ?ÔøΩÎç∞?ÔøΩÌä∏ (?ÔøΩÏù¥??Î°úÎî© ??
                        const dateRange = getDateRange(parseInt(days));
                        updateFilterPeriodDisplay(dateRange.startDate, dateRange.endDate);
                        
                        // ÎπÑÎèôÍ∏∞Î°ú ?ÔøΩÏù¥???ÔøΩÎç∞?ÔøΩÌä∏
                        setTimeout(() => {
                            updateOverviewWithCurrentFilter();
                        }, 10);
                    }
                    // Usage ?ÔøΩÏÖò???ÔøΩÌÑ∞ Î≤ÑÌäº??Í≤ΩÏö∞
                    else if (parentSection.id === 'usage') {
                        const days = e.target.getAttribute('data-days') || 30;
                        console.log(`Usage ?ÔøΩÌÑ∞ Î≤ÑÌäº ?ÔøΩÎ¶≠: ${days}??);
                        
                        // Ï¶âÏãú ?ÔøΩÌÑ∞ Í∏∞Í∞Ñ ?ÔøΩÏãú ?ÔøΩÎç∞?ÔøΩÌä∏ (?ÔøΩÏù¥??Î°úÎî© ??
                        const dateRange = getDateRange(parseInt(days));
                        updateUsageFilterPeriodDisplay(dateRange.startDate, dateRange.endDate);
                        
                        // ÎπÑÎèôÍ∏∞Î°ú ?ÔøΩÏù¥???ÔøΩÎç∞?ÔøΩÌä∏
                        setTimeout(() => {
                            updateUsageWithCurrentFilter(days);
                        }, 10);
                    }
                }
            }
        });

        // ?ÔøΩÏßú ?ÔøΩÌÑ∞ ?ÔøΩÏö© ?ÔøΩÏàò
        async function applyDateFilter() {
            const startDateInput = document.getElementById('start-date');
            const endDateInput = document.getElementById('end-date');
           
            if (!startDateInput.value || !endDateInput.value) {
                alert('?ÔøΩÏûë ?ÔøΩÏßú?Ôø?Ï¢ÖÎ£å ?ÔøΩÏßúÔø?Î™®Îëê ?ÔøΩÌÉù?ÔøΩÏ£º?ÔøΩÏöî.');
                return;
            }
           
            const startDate = new Date(startDateInput.value).getTime();
            const endDate = new Date(endDateInput.value).getTime() + (24 * 60 * 60 * 1000 - 1); // ?ÔøΩÎ£® ?ÔøΩÍπåÏßÄ
           
            if (startDate > endDate) {
                alert('?ÔøΩÏûë ?ÔøΩÏßú??Ï¢ÖÎ£å ?ÔøΩÏßúÎ≥¥Îã§ Îπ†ÔøΩ? ???ÔøΩÏäµ?ÔøΩÎã§.');
                return;
            }
           
            console.log(`Overview ?ÔøΩÏö©???ÔøΩÏùò ?ÔøΩÏßú Î≤îÏúÑ ?ÔøΩÏö©: ${new Date(startDate).toLocaleDateString()} ~ ${new Date(endDate).toLocaleDateString()}`);
           
            // ?ÔøΩÏû¨ ?ÔøΩÏßú Î≤îÏúÑ ?Ôø??            currentDateRange = { startDate, endDate };
           
            // Ï∞®Ìä∏ Ï∫êÏãú Ï¥àÍ∏∞??(?ÔøΩÌÑ∞Í∞Ä Î≥ÄÍ≤ΩÎêò?ÔøΩÏúºÎØÄÔø?
            clearChartCache();
           
            // Ï¶âÏãú ?ÔøΩÌÑ∞ Í∏∞Í∞Ñ ?ÔøΩÏãú ?ÔøΩÎç∞?ÔøΩÌä∏
            updateFilterPeriodDisplay(startDate, endDate);
           
            // Î≤ÑÌäº active ?ÔøΩÌÉú ?ÔøΩÍ±∞
            document.querySelectorAll('#overview .chart-btn').forEach(btn => {
                btn.classList.remove('active');
            });
           
            // ÎπÑÎèôÍ∏∞Î°ú Overview ?ÔøΩÎç∞?ÔøΩÌä∏
            setTimeout(async () => {
                await updateOverviewWithCurrentFilter();
            }, 10);
        }

        // Usage ?ÔøΩÏßú ?ÔøΩÌÑ∞ ?ÔøΩÏö© ?ÔøΩÏàò
        async function applyUsageDateFilter() {
            const startDateInput = document.getElementById('usage-start-date');
            const endDateInput = document.getElementById('usage-end-date');
           
            if (!startDateInput.value || !endDateInput.value) {
                alert('?ÔøΩÏûë ?ÔøΩÏßú?Ôø?Ï¢ÖÎ£å ?ÔøΩÏßúÔø?Î™®Îëê ?ÔøΩÌÉù?ÔøΩÏ£º?ÔøΩÏöî.');
                return;
            }
           
            const startDate = new Date(startDateInput.value).getTime();
            const endDate = new Date(endDateInput.value).getTime() + (24 * 60 * 60 * 1000 - 1); // ?ÔøΩÎ£® ?ÔøΩÍπåÏßÄ
           
            if (startDate > endDate) {
                alert('?ÔøΩÏûë ?ÔøΩÏßú??Ï¢ÖÎ£å ?ÔøΩÏßúÎ≥¥Îã§ Îπ†ÔøΩ? ???ÔøΩÏäµ?ÔøΩÎã§.');
                return;
            }
           
            console.log(`Usage ?ÔøΩÏö©???ÔøΩÏùò ?ÔøΩÏßú Î≤îÏúÑ ?ÔøΩÏö©: ${new Date(startDate).toLocaleDateString()} ~ ${new Date(endDate).toLocaleDateString()}`);
           
            // ?ÔøΩÏû¨ ?ÔøΩÏßú Î≤îÏúÑ ?Ôø??            currentUsageDateRange = { startDate, endDate };
           
            // Ï¶âÏãú ?ÔøΩÌÑ∞ Í∏∞Í∞Ñ ?ÔøΩÏãú ?ÔøΩÎç∞?ÔøΩÌä∏
            updateUsageFilterPeriodDisplay(startDate, endDate);
           
            // Î≤ÑÌäº active ?ÔøΩÌÉú ?ÔøΩÍ±∞
            document.querySelectorAll('#usage .chart-btn').forEach(btn => {
                btn.classList.remove('active');
            });
           
            // ÎπÑÎèôÍ∏∞Î°ú Usage ?ÔøΩÎç∞?ÔøΩÌä∏
            setTimeout(async () => {
                await updateUsageWithDateRange(startDate, endDate);
            }, 10);
        }

        // ?ÔøΩÏû¨ ?ÔøΩÌÑ∞ ?ÔøΩÏ†ï?ÔøΩÎ°ú Overview ?ÔøΩÎç∞?ÔøΩÌä∏
        async function updateOverviewWithCurrentFilter() {
            try {
                console.log('=== ?ÔøΩÏû¨ ?ÔøΩÌÑ∞Ôø?Overview ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÏûë ===');
               
                // Ï∞®Ìä∏Í∞Ä Ï¥àÍ∏∞?ÔøΩÎêòÏßÄ ?ÔøΩÔøΩ? Í≤ΩÏö∞?ÔøΩÎßå Í∏∞Î≥∏ Ï∞®Ìä∏ ?ÔøΩÏÑ±
                if (!window.overviewChartInitialized) {
                    console.log('Ï∞®Ìä∏Í∞Ä Ï¥àÍ∏∞?ÔøΩÎêòÏßÄ ?ÔøΩÏïÑ Í∏∞Î≥∏ Ï∞®Ìä∏ ?ÔøΩÏÑ±');
                    createOverviewChart();
                    window.overviewChartInitialized = true;
                }
               
                // ?ÔøΩÏßú Î≤îÏúÑ Í≤∞Ï†ï
                let dateRange;
                if (currentDateRange) {
                    dateRange = currentDateRange;
                    console.log('?ÔøΩÏö©???ÔøΩÏùò ?ÔøΩÏßú Î≤îÏúÑ ?ÔøΩÏö©');
                } else {
                    const filterDays = getCurrentFilterDays();
                    dateRange = getDateRange(filterDays);
                    console.log(`Í∏∞Î≥∏ ?ÔøΩÌÑ∞ Í∏∞Í∞Ñ ?ÔøΩÏö©: ${filterDays}??);
                }
                
                // ?ÔøΩÌÑ∞ Í∏∞Í∞Ñ ?ÔøΩÏãú ?ÔøΩÎç∞?ÔøΩÌä∏
                updateFilterPeriodDisplay(dateRange.startDate, dateRange.endDate);
               
                // ?Ôø???ÔøΩÎ≥¥ Í∞Ä?ÔøΩÏò§Ôø?                const membersData = await getTeamMembers();
                if (!membersData || !membersData.teamMembers) {
                    console.error('?Ôø???ÔøΩÏù¥?ÔøΩÔøΩ? Í∞Ä?ÔøΩÏò¨ ???ÔøΩÏäµ?ÔøΩÎã§.');
                    return;
                }
                currentMembers = membersData.teamMembers;
               
                // ?ÔøΩÎèô ?ÔøΩÎ≤§??Í∞Ä?ÔøΩÏò§Ôø?                const eventsData = await getFilteredEvents(dateRange.startDate, dateRange.endDate);
               
                // ÏßÄÔø??ÔøΩÏù¥?ÔøΩÎ°ú ?ÔøΩÍ≥Ñ Í≥ÑÏÇ∞ (?ÔøΩÌÉù??Í∏∞Í∞Ñ)
                const spendingData = await getTeamSpendingData();
               
                // ÏßÄÔø??ÔøΩÏù¥??Îß§Ìïë
                const memberSpendMap = {};
                if (spendingData && spendingData.teamMemberSpend) {
                    console.log('?ÔøΩÔøΩ ?ÔøΩÎ≥∏ ÏßÄÔø??ÔøΩÏù¥??', spendingData.teamMemberSpend);
                    spendingData.teamMemberSpend.forEach(spendInfo => {
                        memberSpendMap[spendInfo.email] = {
                            premiumRequests: spendInfo.fastPremiumRequests || 0,
                            spend: (spendInfo.spendCents || 0) / 100,
                            hardLimitOverride: spendInfo.hardLimitOverrideDollars || 0
                        };
                        console.log(`?ÔøΩÔøΩ ${spendInfo.email}: requests=${spendInfo.fastPremiumRequests}, spend=$${((spendInfo.spendCents || 0) / 100).toFixed(2)}, limit=$${spendInfo.hardLimitOverrideDollars || 0}`);
                    });
                    console.log('?ÔøΩÔøΩ ÏµúÏ¢Ö ÏßÄÔø??ÔøΩÏù¥??Ôø?', memberSpendMap);
                }
               
                if (eventsData && eventsData.usageEvents) {
                    console.log(`??${eventsData.usageEvents.length}Í±¥Ïùò ?ÔøΩÎèô ?ÔøΩÎ≤§?ÔøΩÔøΩ? Í∞Ä?ÔøΩÏôî?ÔøΩÎãà??`);
                    currentActivities = createActivityListWithLastActivity(eventsData.usageEvents, membersData.teamMembers, memberSpendMap);
                    
                    // ?ÔøΩÏû¨ Raw Events ?ÔøΩÏù¥???ÔøΩÎç∞?ÔøΩÌä∏
                    currentRawEventsData = eventsData.usageEvents;
                    console.log('?ÔøΩÔøΩ currentRawEventsData ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÎ£å:', currentRawEventsData.length, 'Ôø??ÔøΩÎ≤§??);
                    
                    // ?ÔøΩÌï© Ï∞®Ìä∏ ?ÔøΩÏù¥???Ôø?ÔøΩÏÜå ?ÔøΩÎç∞?ÔøΩÌä∏
                    const currentFilter = getCurrentFilterState();
                    chartDataStore.updateData(
                        membersData.teamMembers,
                        eventsData.usageEvents,
                        spendingData,
                        null, // usageData??Î≥ÑÎèÑ ?ÔøΩÏ∂ú??                        currentFilter
                    );
                   
                    // ?ÔøΩÌÉù??Í∏∞Í∞Ñ ???ÔøΩÏ†ú ?ÔøΩÏÑ± Î©§Î≤Ñ Í≥ÑÏÇ∞
                    const periodActiveMembers = calculatePeriodActiveMembers(eventsData.usageEvents);
                    const totalMembers = membersData.teamMembers.length;
                    const inactiveMembers = totalMembers - periodActiveMembers;
                   
                    console.log(`?ÔøΩÍ≥Ñ Í≥ÑÏÇ∞ Í≤∞Í≥º: ?ÔøΩÏ≤¥ ${totalMembers}Ôø? ?ÔøΩÏÑ± ${periodActiveMembers}Ôø? ÎπÑÌôú??${inactiveMembers}Ôø?);
                    console.log(`?ÔøΩÎèô Î¶¨Ïä§?ÔøΩÏóê ?ÔøΩÏ†ú ?ÔøΩÏãú??Î©§Î≤Ñ ?? ${currentActivities.length}Ôø?);
                   
                    // ?ÔøΩÍ≥Ñ Ïπ¥Îìú ?ÔøΩÎç∞?ÔøΩÌä∏
                    updateStatsCards(totalMembers, periodActiveMembers, inactiveMembers);
                   
                    // ?ÔøΩÏû¨ ?ÔøΩÌÉù???Ôø?ÔøΩÏóê ?ÔøΩÎùº ?ÔøΩÌÑ∞Ôø?                    const filteredActivities = filterActivitiesByType(currentActivities, currentFilterType);
                    currentActivityPage = 1; // ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥??Ï¥àÍ∏∞??                    updateActivityList(filteredActivities);
                    // ?ÔøΩÎ™©?Ôø??ÔøΩÏ†Å?ÔøΩÎ°ú ?ÔøΩÏÑ±??                    
                    // Overview ?ÔøΩÏÖò???ÔøΩÏö©??Ïπ¥Îìú ?ÔøΩÎç∞?ÔøΩÌä∏ (?ÔøΩÏû¨ ?ÔøΩÌÑ∞ Í∏∞Í∞Ñ ?ÔøΩÏö©)
                    console.log('Overview ?ÔøΩÏÖò ?ÔøΩÏö©??Ïπ¥Îìú ?ÔøΩÎç∞?ÔøΩÌä∏ Ôø?..');
                    const overviewUsageData = await getUsageData(dateRange.startDate, dateRange.endDate);
                    updateUsageCards(overviewUsageData, eventsData);
                    console.log('??Overview ?ÔøΩÏÖò ?ÔøΩÏö©??Ïπ¥Îìú ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÎ£å');
                    
                    // Ï∞®Ìä∏ ?ÔøΩÎç∞?ÔøΩÌä∏ (?ÔøΩÌÉù???ÔøΩÌÑ∞ Í∏∞Í∞Ñ Í∏∞ÔøΩ?)
                    console.log('Overview Ï∞®Ìä∏ ?ÔøΩÎç∞?ÔøΩÌä∏ Ôø?..');
                    if (overviewUsageData && overviewUsageData.data) {
                        const chartData = createChartData(overviewUsageData.data);
                        updateChart(chartData);
                        console.log(`??${overviewUsageData.data.length}Í±¥Ïùò Ï∞®Ìä∏ ?ÔøΩÏù¥?ÔøΩÔøΩ? Ï≤òÎ¶¨?ÔøΩÏäµ?ÔøΩÎã§.`);
                    }
                    console.log('??Overview Ï∞®Ìä∏ ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÎ£å');
                } else {
                    console.log('?ÔøΩÎèô ?ÔøΩÎ≤§???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                    currentActivities = [];
                    const totalMembers = membersData ? membersData.teamMembers.length : 0;
                    updateStatsCards(totalMembers, 0, totalMembers);
                    currentActivityPage = 1; // ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥??Ï¥àÍ∏∞??                    updateActivityList([]);
                    
                    // Overview ?ÔøΩÏÖò???ÔøΩÏö©??Ïπ¥Îìú ?ÔøΩÎç∞?ÔøΩÌä∏ (?ÔøΩÏû¨ ?ÔøΩÌÑ∞ Í∏∞Í∞Ñ ?ÔøΩÏö©)
                    console.log('Overview ?ÔøΩÏÖò ?ÔøΩÏö©??Ïπ¥Îìú ?ÔøΩÎç∞?ÔøΩÌä∏ Ôø?..');
                    const overviewUsageData = await getUsageData(dateRange.startDate, dateRange.endDate);
                    updateUsageCards(overviewUsageData, eventsData);
                    console.log('??Overview ?ÔøΩÏÖò ?ÔøΩÏö©??Ïπ¥Îìú ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÎ£å');
                    
                    // ?ÔøΩÏû¨ ?ÔøΩÏÑ±?ÔøΩÎêú Ï∞®Ìä∏ ?ÔøΩÎç∞?ÔøΩÌä∏
                    console.log('?ÔøΩÏû¨ ?ÔøΩÏÑ±?ÔøΩÎêú Ï∞®Ìä∏ ?ÔøΩÎç∞?ÔøΩÌä∏ Ôø?..');
                    const activeChart = document.querySelector('.chart-content.active');
                    if (activeChart) {
                        const chartSelect = document.getElementById('chartSelect');
                        const currentChartType = chartSelect ? chartSelect.value : 'activity-trend';
                        
                        console.log(`?ÔøΩÏû¨ ?ÔøΩÏÑ±?ÔøΩÎêú Ï∞®Ìä∏: ${currentChartType}`);
                        
                        // Ï∫êÏãúÔø?Î¨¥Ïãú?ÔøΩÍ≥† Ï∞®Ìä∏Ôø??ÔøΩÎ°ú ?ÔøΩÏÑ±
                        chartCache[currentChartType] = { data: null, filter: null, rendered: false };
                        
                        // Ï∞®Ìä∏ ?Ôø?ÔøΩÏóê ?ÔøΩÎùº ?ÔøΩÏ†à??Ï∞®Ìä∏ ?ÔøΩÎçîÔø?                        if (currentChartType === 'activity-trend') {
                            createOverviewChart();
                        } else if (currentChartType === 'model-distribution') {
                            createModelDistributionChart();
                        } else if (currentChartType === 'cost-trend') {
                            createCostTrendChart();
                        } else if (currentChartType === 'activity-type') {
                            createActivityTypeChart();
                        } else if (currentChartType === 'user-heatmap') {
                            createUserHeatmapChart();
                        } else if (currentChartType === 'cost-efficiency') {
                            createCostEfficiencyChart();
                        } else if (currentChartType === 'model-preference') {
                            createModelPreferenceChart();
                        } else if (currentChartType === 'user-performance') {
                            createUserPerformanceChart();
                        } else if (currentChartType === 'activity-type-detailed') {
                            createActivityTypeDetailedChart();
                        }
                        
                        // Ï∞®Ìä∏ ?ÔøΩÎçîÔø??ÔøΩÎ£å ??Ï∫êÏãú???Ôø??                        setTimeout(() => {
                            cacheChartData(currentChartType);
                            chartCache[currentChartType].filter = getCurrentFilterState();
                            chartCache[currentChartType].rendered = true;
                        }, 100);
                        
                        console.log(`??${currentChartType} Ï∞®Ìä∏ ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÎ£å`);
                    } else {
                        console.log('?ÔøΩÏÑ±?ÔøΩÎêú Ï∞®Ìä∏Í∞Ä ?ÔøΩÏùå');
                    }
                }
               
                console.log('=== ?ÔøΩÏû¨ ?ÔøΩÌÑ∞Ôø?Overview ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÎ£å ===');
            } catch (error) {
                console.error('??Overview ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÌå®:', error);
            }
        }

        // ?ÔøΩÌÉù??Í∏∞Í∞Ñ ???ÔøΩÏÑ± Î©§Î≤Ñ ??Í≥ÑÏÇ∞ (?ÔøΩÏ†ú ?ÔøΩÎèô Í∏∞ÔøΩ?)
        function calculatePeriodActiveMembers(events) {
            const activeUsers = new Set();
            events.forEach(event => {
                // ?ÔøΩÏ†ú ?ÔøΩÎèô???ÔøΩÎäî ?ÔøΩÏö©?ÔøΩÎßå Ïπ¥Ïö¥??(?ÔøΩÏ≤≠ ÎπÑÏö©??0Î≥¥Îã§ ?ÔøΩÍ±∞???ÔøΩÌÅ∞ Í∏∞Î∞ò ?ÔøΩÏ∂ú)
                if (event.userEmail && event.requestsCosts > 0) {
                    activeUsers.add(event.userEmail);
                }
            });
            console.log(`?ÔøΩÌÉù??Í∏∞Í∞Ñ ???ÔøΩÏÑ± Î©§Î≤Ñ: ${activeUsers.size}Ôø?, Array.from(activeUsers));
            return activeUsers.size;
        }

        // Overview ?ÔøΩÎèô Î¶¨Ïä§?ÔøΩÎßå ?ÔøΩÎç∞?ÔøΩÌä∏ (Í∏∞Ï°¥ ?ÔøΩÏàò ?ÔøΩÌôò???ÔøΩÔøΩ?)
        async function updateOverviewActivityList() {
            await updateOverviewWithCurrentFilter();
        }

        // ?ÔøΩÏ≤¥ ?ÔøΩÏ†ú API ?ÔøΩÏù¥???ÔøΩÎ°úÍ≥†Ïπ®
        async function refreshAllRealData() {
            // Î°úÎî© ?ÔøΩÌÉú ?ÔøΩÏãú
            showLoadingStatus(true);
            
            // ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÎ°ú Î°úÎìú?ÔøΩÔøΩ?Ôø?Ï∞®Ìä∏ Ï∫êÏãú Ï¥àÍ∏∞??            clearChartCache();
           
            // Overview?Ôø?MembersÔø??ÔøΩÏãú??Î°úÎìú?ÔøΩÏó¨ ?ÔøΩÍ∞Ñ ?ÔøΩÏ∂ï
            await Promise.all([
                updateOverviewWithRealData(),
                updateMembersWithRealData()
            ]);
           
            // Î°úÎî© ?ÔøΩÌÉú ?ÔøΩÏ†ú
            showLoadingStatus(false);
        }

        // ÏµúÏ†Å?ÔøΩÎêú Î°úÎî© ?ÔøΩÌÉú ?ÔøΩÏãú/?ÔøΩÏ†ú
        function showLoadingStatus(isLoading) {
            const pageTitle = document.getElementById('page-title');
           
            if (isLoading) {
                // Overview ?ÔøΩÏÖò?ÔøΩÏÑú??Î°úÎî© Î©îÏãúÏßÄÔø??ÔøΩÏãú?ÔøΩÔøΩ? ?ÔøΩÏùå
                if (pageTitle.textContent === 'Overview' || pageTitle.textContent === 'Dashboard Overview') {
                    return;
                }
                pageTitle.innerHTML = '?ÔøΩÔøΩ Loading Real API Data...';
            } else {
                // ?ÔøΩÎûò ?ÔøΩÎ™©?ÔøΩÎ°ú Î≥µÏõê
                if (pageTitle.textContent === '?ÔøΩÔøΩ Loading Real API Data...') {
                    pageTitle.textContent = 'Dashboard Overview';
                }
            }
        }

        // ?ÔøΩÏó≠ Î≥Ä??        let currentFilterType = 'total'; // ?ÔøΩÏû¨ ?ÔøΩÌÉù???ÔøΩÌÑ∞ ?Ôø??        let currentActivities = []; // ?ÔøΩÏû¨ ?ÔøΩÎèô ?ÔøΩÏù¥??        let currentMembers = []; // ?ÔøΩÏû¨ Î©§Î≤Ñ ?ÔøΩÏù¥??        let currentDateRange = null; // ?ÔøΩÏû¨ ?ÔøΩÌÉù???ÔøΩÏßú Î≤îÏúÑ (Overview??
        let currentUsageDateRange = null; // ?ÔøΩÏû¨ ?ÔøΩÌÉù???ÔøΩÏßú Î≤îÏúÑ (Usage??
        let currentRawEventsData = []; // ?ÔøΩÏû¨ Raw Events ?ÔøΩÏ≤¥ ?ÔøΩÏù¥??        let currentRawEventsPage = 1; // ?ÔøΩÏû¨ Raw Events ?ÔøΩÏù¥ÏßÄ
        let currentRawEventsPageSize = 10; // ?ÔøΩÏû¨ Raw Events ?ÔøΩÏù¥ÏßÄ ?ÔøΩÍ∏∞
        
        // ?ÔøΩÌï© Ï∞®Ìä∏ ?ÔøΩÏù¥???Ôø?ÔøΩÏÜå
        let chartDataStore = {
            members: [], // ?Ôø?Î©§Î≤Ñ ?ÔøΩÏù¥??            rawEvents: [], // ?ÔøΩÏãú ?ÔøΩÎ≤§???ÔøΩÏù¥??            spendingData: null, // ÏßÄÔø??ÔøΩÏù¥??            usageData: null, // ?ÔøΩÏö©???ÔøΩÏù¥??            lastUpdated: null, // ÎßàÔøΩ?Ôø??ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÍ∞Ñ
            currentFilter: null, // ?ÔøΩÏû¨ ?ÔøΩÏö©???ÔøΩÌÑ∞ ?ÔøΩÌÉú
            
            // ?ÔøΩÏù¥???ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÏàò
            updateData: function(members, rawEvents, spendingData, usageData, filterState) {
                this.members = members || [];
                this.rawEvents = rawEvents || [];
                this.spendingData = spendingData;
                this.usageData = usageData;
                this.currentFilter = filterState;
                this.lastUpdated = new Date();
                console.log(`?ÔøΩÔøΩ ?ÔøΩÌï© Ï∞®Ìä∏ ?ÔøΩÏù¥???Ôø?ÔøΩÏÜå ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÎ£å: ${this.members.length}Ôø? ${this.rawEvents.length}Ôø??ÔøΩÎ≤§??);
            },
            
            // ?ÔøΩÏù¥???ÔøΩÌö®???ÔøΩÏù∏
            isDataValid: function(filterState) {
                if (!this.members.length || !this.rawEvents.length || !this.lastUpdated) {
                    return false;
                }
                
                // ?ÔøΩÌÑ∞ ?ÔøΩÌÉúÍ∞Ä ?ÔøΩÏùº?ÔøΩÔøΩ? ?ÔøΩÏù∏
                if (filterState && this.currentFilter) {
                    return isFilterStateEqual(this.currentFilter, filterState);
                }
                
                return true;
            },
            
            // ?ÔøΩÏù¥??Ï¥àÍ∏∞??            clearData: function() {
                this.members = [];
                this.rawEvents = [];
                this.spendingData = null;
                this.usageData = null;
                this.lastUpdated = null;
                this.currentFilter = null;
                console.log('?ÔøΩÔøΩ ?ÔøΩÌï© Ï∞®Ìä∏ ?ÔøΩÏù¥???Ôø?ÔøΩÏÜå Ï¥àÍ∏∞??);
            }
        };
        
        // Usage ?ÔøΩÏù¥??Î°úÎî© ?ÔøΩÌÉú Ï∂îÏ†Å
        let isUsageDataLoaded = false; // Usage ?ÔøΩÏù¥?ÔøΩÔøΩ? ??Î≤àÏù¥?ÔøΩÎèÑ Î°úÎìú?ÔøΩÏóà?ÔøΩÔøΩ? ?ÔøΩÏù∏
        let isUsageLoading = false; // Usage ?ÔøΩÏù¥??Î°úÎî© Ï§ëÏù∏ÏßÄ ?ÔøΩÏù∏
        
        // ?ÔøΩÎèôÎ¶¨Ïä§???ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥??Î≥Ä??        let currentActivityPage = 1; // ?ÔøΩÏû¨ ?ÔøΩÎèôÎ¶¨Ïä§???ÔøΩÏù¥ÏßÄ
        let currentActivityPageSize = 20; // ?ÔøΩÏû¨ ?ÔøΩÎèôÎ¶¨Ïä§???ÔøΩÏù¥ÏßÄ ?ÔøΩÍ∏∞
        
        // Ï∞®Ìä∏ Ï∫êÏã± ?ÔøΩÏä§??        let chartCache = {
            'activity-trend': { data: null, filter: null, rendered: false },
            'model-distribution': { data: null, filter: null, rendered: false },
            'cost-trend': { data: null, filter: null, rendered: false },
            'activity-type': { data: null, filter: null, rendered: false },
            'user-heatmap': { data: null, filter: null, rendered: false },
            'cost-efficiency': { data: null, filter: null, rendered: false },
            'model-preference': { data: null, filter: null, rendered: false },
            'user-performance': { data: null, filter: null, rendered: false },
            'activity-type-detailed': { data: null, filter: null, rendered: false }
        };
        
        // Ï∞®Ìä∏ Ï∫êÏãú Ï¥àÍ∏∞???ÔøΩÏàò
        function clearChartCache() {
            Object.keys(chartCache).forEach(key => {
                chartCache[key] = { data: null, filter: null, rendered: false };
            });
            console.log('?ÔøΩÔøΩ Î™®Îì† Ï∞®Ìä∏ Ï∫êÏãú Ï¥àÍ∏∞??);
        }
        let currentActivityData = []; // ?ÔøΩÏû¨ ?ÔøΩÎèôÎ¶¨Ïä§???ÔøΩÏù¥??        
        // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥ ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥??Î≥Ä??        let currentUserCumulativePage = 1; // ?ÔøΩÏû¨ ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥ ?ÔøΩÏù¥ÏßÄ
        let currentUserCumulativePageSize = 20; // ?ÔøΩÏû¨ ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥ ?ÔøΩÏù¥ÏßÄ ?ÔøΩÍ∏∞
        let currentUserCumulativeData = []; // ?ÔøΩÏû¨ ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥ ?ÔøΩÏù¥??        let currentUserCumulativeStartDate = null; // ?ÔøΩÏû¨ ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥ ?ÔøΩÏûë ?ÔøΩÏßú
        let currentUserCumulativeEndDate = null; // ?ÔøΩÏû¨ ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥ Ï¢ÖÎ£å ?ÔøΩÏßú
        
        // Members ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥??Î≥Ä??        let currentMembersPage = 1; // ?ÔøΩÏû¨ Members ?ÔøΩÏù¥ÏßÄ
        let currentMembersPageSize = 20; // ?ÔøΩÏû¨ Members ?ÔøΩÏù¥ÏßÄ ?ÔøΩÍ∏∞
        let currentMembersData = []; // ?ÔøΩÏû¨ Members ?ÔøΩÏù¥??        let originalMembersData = []; // ?ÔøΩÎ≥∏ Î©§Î≤Ñ ?ÔøΩÏù¥??(?ÔøΩÌÑ∞ÎßÅÏö©)

        // ============================================================================
        // ?ÔøΩÎä• ÏµúÏ†Å???ÔøΩÏä§??(2025.07.29 Ï∂îÔøΩ?)
        // ============================================================================









        // API ?ÔøΩÏ∂ú???ÔøΩÌïú ?ÔøΩÏ†ï
        const API_CONFIG = {
            baseUrl: 'http://localhost:8001', // Î°úÏª¨ ?ÔøΩÎ°ù???ÔøΩÎ≤Ñ
            apiKey: 'key_e46368ce482125bbd568b7d55090c657e30e4b73c824f522cbc9ef9b1bf3f0d3',
            headers: {
                'Content-Type': 'application/json'
            }
        };

        // API ?ÔøΩÏ∂ú ?ÔøΩÏàò (?ÔøΩÏ†ú API ?ÔøΩÏ∂ú)
        async function callAPI(endpoint, method = 'GET', data = null) {
            try {
                // Basic Auth ?ÔøΩÏ†ï
                const credentials = `${API_CONFIG.apiKey}:`;
                const encodedCredentials = btoa(credentials);
                
                const options = {
                    method: method,
                    headers: {
                        ...API_CONFIG.headers,
                        'Authorization': `Basic ${encodedCredentials}`
                    }
                };

                if (data && method === 'POST') {
                    options.body = JSON.stringify(data);
                }

                console.log(`?ÔøΩÏ†ú Cursor Admin API ?ÔøΩÏ∂ú: ${method} ${API_CONFIG.baseUrl}${endpoint}`, data);
               
                const response = await fetch(API_CONFIG.baseUrl + endpoint, options);
               
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`API ?ÔøΩÏ∂ú ?ÔøΩÌå®: ${response.status} - ${response.statusText}\n${errorText}`);
                }

                const result = await response.json();
                console.log('?ÔøΩÏ†ú API ?ÔøΩÎãµ ?ÔøΩÏù¥??', result);
               
                // API ?ÔøΩÎãµ???ÔøΩÎ•òÍ∞Ä ?ÔøΩÎäîÏßÄ ?ÔøΩÏù∏
                if (result.error) {
                    throw new Error(`API ?ÔøΩÎ•ò: ${result.error} - ${result.message}`);
                }
               
                return result;
               
            } catch (error) {
                console.error('API ?ÔøΩÏ∂ú ?ÔøΩÎ•ò:', error);
                throw error; // ?ÔøΩÎ•òÔø??ÔøΩÏãú ?ÔøΩÏ†∏???ÔøΩÏ∂ú?ÔøΩÔøΩ? Ï≤òÎ¶¨?ÔøΩÎèÑÔø???            }
        }



        // API ?ÔøΩÍ≤∞ ?ÔøΩÌÉú ?ÔøΩÏù∏
        async function checkAPIConnection() {
            try {
                const response = await fetch(API_CONFIG.baseUrl + '/teams/members', {
                    method: 'GET',
                    headers: API_CONFIG.headers
                });
                return response.ok;
            } catch (error) {
                return false;
            }
        }

        // ?Ôø???ÔøΩÎ≥¥ Í∞Ä?ÔøΩÏò§Ôø?        async function getTeamMembers() {
            return await callAPI('/teams/members');
        }

        // ?ÔøΩÏö©???ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø?        async function getUsageData(startDate, endDate) {
            return await callAPI('/teams/daily-usage-data', 'POST', {
                startDate: startDate,
                endDate: endDate
            });
        }

        // ?Ôø?ÏßÄÔø??ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø?(?ÔøΩÏ≤¥ Î©§Î≤Ñ)
        async function getTeamSpendingData() {
            try {
                console.log('?ÔøΩÔøΩ ?ÔøΩÏ≤¥ Î©§Î≤Ñ ÏßÄÔø??ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø??ÔøΩÏûë...');
                
                // ÏßÅÏ†ë ??pageSizeÔø?Î™®Îì† Î©§Î≤Ñ ?ÔøΩÏù¥???ÔøΩÏ≤≠
                console.log('?ÔøΩÔøΩ API ?ÔøΩÏ∂ú: /teams/spend (pageSize: 1000)');
                const spendingData = await callAPI('/teams/spend', 'POST', {
                    page: 1,
                    pageSize: 1000
                });
                
                if (!spendingData || !spendingData.teamMemberSpend) {
                    throw new Error('ÏßÄÔø??ÔøΩÏù¥?ÔøΩÔøΩ? Í∞Ä?ÔøΩÏò¨ ???ÔøΩÏäµ?ÔøΩÎã§.');
                }
                
                const retrievedCount = spendingData.teamMemberSpend.length;
                const totalMembers = spendingData.totalMembers || retrievedCount;
                const totalPages = spendingData.totalPages || 1;
                
                console.log(`??ÏßÄÔø??ÔøΩÏù¥??Ï°∞Ìöå ?ÔøΩÎ£å:`);
                console.log(`   - Ï°∞Ìöå??Î©§Î≤Ñ: ${retrievedCount}Ôø?);
                console.log(`   - ?ÔøΩÏ≤¥ Î©§Î≤Ñ: ${totalMembers}Ôø?);
                console.log(`   - ?ÔøΩÏ≤¥ ?ÔøΩÏù¥ÏßÄ: ${totalPages}?ÔøΩÏù¥ÏßÄ`);
                
                // Î™®Îì† ?ÔøΩÏù¥?ÔøΩÔøΩ? Í∞Ä?ÔøΩÏôî?ÔøΩÔøΩ? ?ÔøΩÏù∏
                if (retrievedCount < totalMembers && totalPages > 1) {
                    console.log('?ÔøΩÔ∏è Ï∂îÔøΩ? ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§. ????pageSizeÔø??ÔøΩÏöîÔø?..');
                    
                    const largerData = await callAPI('/teams/spend', 'POST', {
                        page: 1,
                        pageSize: Math.max(totalMembers + 100, 2000) // ?ÔøΩÏú†?ÔøΩÍ≤å ?ÔøΩÏ†ï
                    });
                    
                    if (largerData && largerData.teamMemberSpend && largerData.teamMemberSpend.length > retrievedCount) {
                        console.log(`???ÔøΩÏöîÔø??ÔøΩÍ≥µ: ${largerData.teamMemberSpend.length}Î™ÖÏùò ?ÔøΩÏù¥???ÔøΩÎ≥¥`);
                        return largerData;
                    }
                }
                
                console.log(`?ÔøΩÔøΩ ÏµúÏ¢Ö Í≤∞Í≥º: ${retrievedCount}Î™ÖÏùò Î©§Î≤Ñ ?ÔøΩÏù¥??Î∞òÌôò`);
                return spendingData;
                
            } catch (error) {
                console.error('??ÏßÄÔø??ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø??ÔøΩÌå®:', error);
                throw error;
            }
        }

        // ?ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÎ≤§??Í∞Ä?ÔøΩÏò§Ôø?(Î™®Îì† ?ÔøΩÏù¥ÏßÄ ?ÔøΩÏù¥???ÔøΩÏßë)
        async function getFilteredEvents(startDate, endDate) {
            try {
                console.log('=== ?ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÎ≤§???ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø??ÔøΩÏûë ===');
                
                // Ôø?Î≤àÏß∏ ?ÔøΩÏù¥ÏßÄ ?ÔøΩÏ≤≠
                let allEvents = [];
                let currentPage = 1;
                let hasMorePages = true;
                
                while (hasMorePages) {
                    console.log(`?ÔøΩÔøΩ ?ÔøΩÏù¥ÏßÄ ${currentPage} ?ÔøΩÏ≤≠ Ôø?..`);
                    
                    const pageData = await callAPI('/teams/filtered-usage-events', 'POST', {
                        startDate: startDate,
                        endDate: endDate,
                        page: currentPage,
                        pageSize: 1000
                    });
                    
                    if (pageData && pageData.usageEvents) {
                        allEvents = allEvents.concat(pageData.usageEvents);
                        console.log(`???ÔøΩÏù¥ÏßÄ ${currentPage}: ${pageData.usageEvents.length}Ôø??ÔøΩÎ≤§???ÔøΩÏßë (?ÔøΩÏ†Å: ${allEvents.length}Ôø?`);
                        
                        // ??ÎßéÔøΩ? ?ÔøΩÏù¥ÏßÄÍ∞Ä ?ÔøΩÎäîÏßÄ ?ÔøΩÏù∏
                        hasMorePages = pageData.pagination && pageData.pagination.hasNextPage;
                        currentPage++;
                        
                        // Î¨¥Ìïú Î£®ÌîÑ Î∞©ÔøΩ? (ÏµúÔøΩ? 10?ÔøΩÏù¥ÏßÄ)
                        if (currentPage > 10) {
                            console.log('?ÔøΩÔ∏è ÏµúÔøΩ? ?ÔøΩÏù¥ÏßÄ ???ÔøΩÎã¨ - Î¨¥Ìïú Î£®ÌîÑ Î∞©ÔøΩ?');
                            break;
                        }
                    } else {
                        console.log(`???ÔøΩÏù¥ÏßÄ ${currentPage} ?ÔøΩÏù¥???ÔøΩÏùå`);
                        hasMorePages = false;
                    }
                }
                
                console.log(`=== ?ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÎ≤§???ÔøΩÏù¥???ÔøΩÏßë ?ÔøΩÎ£å: Ôø?${allEvents.length}Ôø??ÔøΩÎ≤§??===`);
                
                // Í∏∞Ï°¥ ?ÔøΩÏãù?ÔøΩÎ°ú Î∞òÌôò
                return {
                    totalUsageEventsCount: allEvents.length,
                    usageEvents: allEvents,
                    period: {
                        startDate: startDate,
                        endDate: endDate
                    }
                };
                
            } catch (error) {
                console.error('???ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÎ≤§??Í∞Ä?ÔøΩÏò§Ôø??ÔøΩÌå®:', error);
                throw error;
            }
        }

        // ?ÔøΩÏû¨ ?ÔøΩÌÉù???ÔøΩÌÑ∞ Í∏∞Í∞Ñ Í∞Ä?ÔøΩÏò§Ôø?        function getCurrentFilterDays() {
            const activeBtn = document.querySelector('#overview .chart-btn.active');
            if (!activeBtn) return 30; // Í∏∞Î≥∏Ôø?30??           
            const days = activeBtn.getAttribute('data-days');
            return days ? parseInt(days) : 30;
        }

        // ?ÔøΩÏßúÔø?epoch millisecondsÔø?Î≥Ä??(?ÔøΩÍµ≠ ?ÔøΩÍ∞Ñ Í∏∞ÔøΩ?)
        function getDateRange(days = 7) {
            // ?ÔøΩÍµ≠ ?ÔøΩÍ∞Ñ?Ôø?Í∏∞ÔøΩ??ÔøΩÎ°ú ?ÔøΩÏû¨ ?ÔøΩÏßú Í≥ÑÏÇ∞
            const now = new Date();
            const koreaTime = new Date(now.getTime() + (9 * 60 * 60 * 1000)); // UTC+9
            
            const endDate = new Date(koreaTime);
            const startDate = new Date(koreaTime);
            startDate.setDate(startDate.getDate() - days);
           
            return {
                startDate: startDate.getTime(),
                endDate: endDate.getTime()
            };
        }

        // ?ÔøΩÌÑ∞ Í∏∞Í∞Ñ ?ÔøΩÏãú ?ÔøΩÎç∞?ÔøΩÌä∏ (?ÔøΩÍµ≠ ?ÔøΩÍ∞Ñ Í∏∞ÔøΩ?)
        function updateFilterPeriodDisplay(startDate, endDate) {
            const filterPeriodText = document.getElementById('filter-period-text');
            if (!filterPeriodText) return;

            // ?ÔøΩÍµ≠ ?ÔøΩÍ∞Ñ?Ôø?Í∏∞ÔøΩ??ÔøΩÎ°ú ?ÔøΩÏßú Î≥Ä??            const startDateKorea = new Date(startDate + (9 * 60 * 60 * 1000));
            const endDateKorea = new Date(endDate + (9 * 60 * 60 * 1000));
            
            const startDateStr = startDateKorea.toISOString().split('T')[0];
            const endDateStr = endDateKorea.toISOString().split('T')[0];
            
            filterPeriodText.textContent = `${startDateStr} ~ ${endDateStr}`;
            console.log(`???ÔøΩÌÑ∞ Í∏∞Í∞Ñ ?ÔøΩÏãú ?ÔøΩÎç∞?ÔøΩÌä∏: ${startDateStr} ~ ${endDateStr}`);
        }

        // Usage ?ÔøΩÏÖò ?ÔøΩÌÑ∞ Í∏∞Í∞Ñ ?ÔøΩÏãú ?ÔøΩÎç∞?ÔøΩÌä∏ (?ÔøΩÍµ≠ ?ÔøΩÍ∞Ñ Í∏∞ÔøΩ?)
        function updateUsageFilterPeriodDisplay(startDate, endDate) {
            const filterPeriodText = document.getElementById('usage-filter-period-text');
            if (!filterPeriodText) return;

            // ?ÔøΩÍµ≠ ?ÔøΩÍ∞Ñ?Ôø?Í∏∞ÔøΩ??ÔøΩÎ°ú ?ÔøΩÏßú Î≥Ä??            const startDateKorea = new Date(startDate + (9 * 60 * 60 * 1000));
            const endDateKorea = new Date(endDate + (9 * 60 * 60 * 1000));
            
            const startDateStr = startDateKorea.toISOString().split('T')[0];
            const endDateStr = endDateKorea.toISOString().split('T')[0];
            
            filterPeriodText.textContent = `${startDateStr} ~ ${endDateStr}`;
            console.log(`??Usage ?ÔøΩÌÑ∞ Í∏∞Í∞Ñ ?ÔøΩÏãú ?ÔøΩÎç∞?ÔøΩÌä∏: ${startDateStr} ~ ${endDateStr}`);
        }

        // Overview ?ÔøΩÏù¥???ÔøΩÎç∞?ÔøΩÌä∏ (Ï¥àÍ∏∞ Î°úÎìú??
        async function updateOverviewWithRealData() {
            try {
                console.log('=== ?ÔøΩÏ†ú Cursor Admin API ?ÔøΩÏù¥?ÔøΩÎ°ú Overview Ï¥àÍ∏∞ Î°úÎìú ?ÔøΩÏûë ===');
               
                // Ï¥àÍ∏∞??                currentFilterType = 'total';
                currentDateRange = null;
               
                // ?ÔøΩÏû¨ ?ÔøΩÌÑ∞Ôø??ÔøΩÎç∞?ÔøΩÌä∏
                await updateOverviewWithCurrentFilter();

                // Ï∞®Ìä∏??updateOverviewWithCurrentFilter?ÔøΩÏÑú Ï≤òÎ¶¨??(Í∏∞Î≥∏ 30???ÔøΩÌÑ∞)
                console.log('Ï∞®Ìä∏??Í∏∞Î≥∏ ?ÔøΩÌÑ∞ ?ÔøΩÎç∞?ÔøΩÌä∏?ÔøΩÏÑú Ï≤òÎ¶¨?ÔøΩÎãà??');

                // Ï¥àÍ∏∞ Î°úÎìú ??Í∏∞Î≥∏ ?ÔøΩÌÉù??'total' Ïπ¥Îìú??ÎßûÎäî ?ÔøΩÏ†ú ?ÔøΩÏù¥???ÔøΩÏãú
                console.log('Ï¥àÍ∏∞ Î°úÎìú ???ÔøΩÏ≤¥ Î©§Î≤Ñ ?ÔøΩÏù¥???ÔøΩÏãú');
                await updateMembersByTypeWithRealData('total');
               
                // ?ÔøΩÌÉù ?ÔøΩÌÉú?Ôø??ÔøΩÏù¥???ÔøΩÏπò ?ÔøΩÏù∏
                console.log(`?ÔøΩÏû¨ ?ÔøΩÌÉù???Ôø?? ${currentFilterType}`);
                console.log('?ÔøΩÏ≤¥ Î©§Î≤Ñ Ïπ¥Îìú ?ÔøΩÌÉù ?ÔøΩÌÉú ?ÔøΩÏù∏ ?ÔøΩÎ£å');

                console.log('=== ?ÔøΩÏ†ú API ?ÔøΩÏù¥?ÔøΩÎ°ú Overview Ï¥àÍ∏∞ Î°úÎìú ?ÔøΩÎ£å! ===');
            } catch (error) {
                console.error('??Overview Ï¥àÍ∏∞ Î°úÎìú ?ÔøΩÌå®:', error);
                alert('Overview ?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂àÎü¨?ÔøΩÎäî???ÔøΩÌå®?ÔøΩÏäµ?ÔøΩÎã§. ?ÔøΩÌä∏?ÔøΩÌÅ¨ ?ÔøΩÍ≤∞Ôø?API ?ÔøΩÎ≤Ñ ?ÔøΩÌÉúÔø??ÔøΩÏù∏?ÔøΩÏ£º?ÔøΩÏöî.');
            }
        }

        // ?ÔøΩÍ≥Ñ Ïπ¥Îìú ?ÔøΩÎç∞?ÔøΩÌä∏ (?ÔøΩÏ†ú API ?ÔøΩÏù¥???ÔøΩÏö©)
        function updateStatsCards(total, active, inactive) {
            const totalBox = document.querySelector('.overview-stat-box[data-type="total"] .stat-number');
            const activeBox = document.querySelector('.overview-stat-box[data-type="active"] .stat-number');
            const inactiveBox = document.querySelector('.overview-stat-box[data-type="inactive"] .stat-number');

            if (totalBox) {
                totalBox.textContent = total;
                console.log(`??Ôø?Î©§Î≤Ñ ???ÔøΩÎç∞?ÔøΩÌä∏: ${total}Ôø?);
            }
            if (activeBox) {
                activeBox.textContent = active;
                console.log(`???ÔøΩÏÑ± Î©§Î≤Ñ ???ÔøΩÎç∞?ÔøΩÌä∏: ${active}Ôø?);
            }
            if (inactiveBox) {
                inactiveBox.textContent = inactive;
                console.log(`??ÎπÑÌôú??Î©§Î≤Ñ ???ÔøΩÎç∞?ÔøΩÌä∏: ${inactive}Ôø?);
            }

            // Î©§Î≤Ñ ??Ïπ¥Ïö¥???ÔøΩÎç∞?ÔøΩÌä∏
            const memberCount = document.getElementById('member-count');
            if (memberCount) {
                memberCount.textContent = `(${total}Ôø?`;
            }
        }

        // Ï∞®Ìä∏ ?ÔøΩÏù¥???ÔøΩÏÑ± (?ÔøΩÎ≥Ñ ÏßëÍ≥Ñ)
        function createChartData(usageData) {
            const dailyTotals = {};
           
            // ?ÔøΩÎ≥ÑÔø?Î™®Îì† ?ÔøΩÏö©?ÔøΩÏùò ?ÔøΩÎèô ÏßëÍ≥Ñ
            usageData.forEach(dayData => {
                const dateKey = new Date(dayData.date).toDateString();
               
                if (!dailyTotals[dateKey]) {
                    dailyTotals[dateKey] = {
                        date: dayData.date,
                        totalApplies: 0,
                        totalAccepts: 0,
                        chatRequests: 0,
                        agentRequests: 0
                    };
                }
               
                dailyTotals[dateKey].totalApplies += (dayData.totalApplies || 0);
                dailyTotals[dateKey].totalAccepts += (dayData.totalAccepts || 0);
                dailyTotals[dateKey].chatRequests += (dayData.chatRequests || 0);
                dailyTotals[dateKey].agentRequests += (dayData.agentRequests || 0);
            });
           
            // Ï∞®Ìä∏ ?ÔøΩÏù¥???ÔøΩÏÑ±
            const chartData = Object.values(dailyTotals)
                .sort((a, b) => a.date - b.date)
                .map(dayTotal => {
                    const date = new Date(dayTotal.date);
                    const activityScore = dayTotal.totalApplies + dayTotal.totalAccepts +
                                        dayTotal.chatRequests + dayTotal.agentRequests;
                   
                    // ?ÔøΩÍµ≠ ?ÔøΩÍ∞Ñ Í∏∞ÔøΩ??ÔøΩÎ°ú ?ÔøΩÏßú ?ÔøΩÏãú
                    const koreaDate = new Date(date.getTime() + (9 * 60 * 60 * 1000));
                    const formatDate = koreaDate.toLocaleDateString('ko-KR', { 
                        month: 'numeric', 
                        day: 'numeric' 
                    }).replace(/\.$/, ''); // ?ÔøΩÏùò ???ÔøΩÍ±∞
                    
                    return {
                        date: formatDate,
                        activity: activityScore,
                        applies: dayTotal.totalApplies,
                        accepts: dayTotal.totalAccepts,
                        chats: dayTotal.chatRequests,
                        agents: dayTotal.agentRequests
                    };
                });

            console.log('Ï∞®Ìä∏ ?ÔøΩÏù¥???ÔøΩÏÑ±:', chartData);
            return chartData;
        }

        // Ï∞®Ìä∏ ?ÔøΩÎç∞?ÔøΩÌä∏
        function updateChart(chartData) {
            const canvas = document.getElementById('overviewChart');
            if (!canvas || !chartData.length) return;

            // Ï∫îÎ≤Ñ???ÔøΩÍ∏∞Í∞Ä ?ÔøΩÏ†ï?ÔøΩÔøΩ? ?ÔøΩÔøΩ? Í≤ΩÏö∞ ?ÔøΩÏãú ?ÔøΩÏ†ï
            if (canvas.width === 0 || canvas.height === 0) {
                const rect = canvas.getBoundingClientRect();
                canvas.width = rect.width;
                canvas.height = 300;
            }

            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;

            // Í∏∞Ï°¥ Ï∞®Ìä∏ ÏßÄ?ÔøΩÍ∏∞
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, width, height);

            // Í∑∏Î¶¨??Í∑∏Î¶¨Ôø?            ctx.strokeStyle = '#3a3a3a';
            ctx.lineWidth = 1;
           
            // ?ÔøΩÎ°ú Í∑∏Î¶¨??            for (let i = 0; i <= chartData.length; i++) {
                const x = (width / chartData.length) * i;
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, height);
                ctx.stroke();
            }

            // Í∞ÄÔø?Í∑∏Î¶¨??            for (let i = 0; i <= 5; i++) {
                const y = (height / 5) * i;
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(width, y);
                ctx.stroke();
            }

            // ?ÔøΩÏù¥???ÔøΩÏù∏??Í≥ÑÏÇ∞
            const maxActivity = Math.max(...chartData.map(d => d.activity));
            const dataPoints = chartData.map((data, index) => ({
                x: (width / (chartData.length - 1)) * index,
                y: height - (height * (data.activity / maxActivity))
            }));

            // ??Í∑∏Îûò??Í∑∏Î¶¨Ôø?            if (dataPoints.length > 1) {
                ctx.strokeStyle = '#4a9eff';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.moveTo(dataPoints[0].x, dataPoints[0].y);
               
                for (let i = 1; i < dataPoints.length; i++) {
                    ctx.lineTo(dataPoints[i].x, dataPoints[i].y);
                }
                ctx.stroke();
            }

            // ?ÔøΩÏù¥???ÔøΩÏù∏????Í∑∏Î¶¨Ôø?            dataPoints.forEach(point => {
                ctx.fillStyle = '#4a9eff';
                ctx.beginPath();
                ctx.arc(point.x, point.y, 4, 0, Math.PI * 2);
                ctx.fill();
            });

            // ?ÔøΩÏßú ?ÔøΩÏù¥Ôø?            ctx.fillStyle = '#7a7a7a';
            ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'center';
           
            chartData.forEach((data, index) => {
                const x = (width / (chartData.length - 1)) * index;
                ctx.fillText(data.date, x, height - 10);
            });
        }

        // ?ÔøΩÎèô Î¶¨Ïä§???ÔøΩÏÑ± (?ÔøΩÏ†ú ?ÔøΩÎèô???ÔøΩÎäî Î©§Î≤ÑÔø? ?ÔøΩÌôï???ÔøΩÍ≥Ñ Î∞òÏòÅ)
        function createActivityListWithLastActivity(events, members, memberSpendMap = {}) {
            console.log('=== ?ÔøΩÎèô Î¶¨Ïä§???ÔøΩÏÑ± ?ÔøΩÏûë ===');
            console.log(`?ÔøΩÏ≤¥ ?ÔøΩÎ≤§???? ${events.length}Ôø?);
            console.log(`?ÔøΩÏ≤¥ Î©§Î≤Ñ ?? ${members.length}Ôø?);
            console.log('ÏßÄÔø??ÔøΩÏù¥??Ôø?', memberSpendMap);
           
            // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ÎßàÔøΩ?Ôø??ÔøΩÎèô ?ÔøΩÏßú Ôø??ÔøΩÍ≥Ñ Í≥ÑÏÇ∞
            const userActivity = {};
           
            events.forEach(event => {
                const userEmail = event.userEmail;
                const timestamp = parseInt(event.timestamp);
                const requestCost = event.requestsCosts || 0;
               
                if (!userActivity[userEmail]) {
                    userActivity[userEmail] = {
                        lastTimestamp: timestamp,
                        totalRequests: 0,
                        events: []
                    };
                }
               
                // ÎßàÔøΩ?Ôø??ÔøΩÎèô ?ÔøΩÍ∞Ñ ?ÔøΩÎç∞?ÔøΩÌä∏
                if (timestamp > userActivity[userEmail].lastTimestamp) {
                    userActivity[userEmail].lastTimestamp = timestamp;
                }
               
                // ?ÔøΩÏ≤≠ ?ÔøΩÎßå ?ÔøΩÏ†Å (?ÔøΩÏ†ú ÏßÄÏ∂úÔøΩ? /teams/spend API?ÔøΩÏÑú Í∞Ä?ÔøΩÏò¥)
                userActivity[userEmail].totalRequests += requestCost;
                userActivity[userEmail].events.push(event);
            });
           
            console.log('?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÎèô ?ÔøΩÍ≥Ñ:', userActivity);
           
            // Î™®Îì† Î©§Î≤ÑÔø??ÔøΩÌï®?ÔøΩÏó¨ ?ÔøΩÎèô ?ÔøΩÎ≥¥ ?ÔøΩÏÑ± (?ÔøΩÏÑ± + ÎπÑÌôú??
            const activities = [];
            let activeCount = 0;
            let inactiveCount = 0;
           
            members.forEach(member => {
                const userStats = userActivity[member.email];
                const spendData = memberSpendMap[member.email] || {};
                
                // ?ÔøΩÏ†ú ÏßÄÔø??ÔøΩÏù¥???ÔøΩÏö© (/teams/spend API?ÔøΩÏÑú)
                const actualSpend = spendData.spend || 0;
                const premiumRequests = spendData.premiumRequests || 0;
                const hardLimit = spendData.hardLimitOverride || 0;
                const limitDisplay = hardLimit > 0 ? `$${hardLimit}` : '$0';
               
                if (userStats && userStats.totalRequests > 0) {
                    // ?ÔøΩÎèô???ÔøΩÎäî Î©§Î≤Ñ
                    const lastActivityDate = new Date(userStats.lastTimestamp);
                   
                    // ?ÔøΩÎäò ?ÔøΩÏßú Í∏∞ÔøΩ??ÔøΩÎ°ú ?ÔøΩÌôï???ÔøΩÏàò Ï∞®Ïù¥ Í≥ÑÏÇ∞
                    const today = new Date();
                    today.setHours(0, 0, 0, 0);
                   
                    const activityDate = new Date(userStats.lastTimestamp);
                    activityDate.setHours(0, 0, 0, 0);
                   
                    const daysDiff = Math.floor((today - activityDate) / (1000 * 60 * 60 * 24));
                   
                    activeCount++;
                   
                    activities.push({
                        date: lastActivityDate.toLocaleDateString('ko-KR', {
                            month: '2-digit',
                            day: '2-digit'
                        }) + ` (${daysDiff === 0 ? '?ÔøΩÎäò' : daysDiff + '????})`,
                        timestamp: userStats.lastTimestamp,
                        email: member.email,
                        name: member.name || 'Unnamed',
                        type: 'active',
                        kind: userStats.events.length > 0 ? userStats.events[0].kindLabel || 'Unknown' : 'Unknown',
                        request: premiumRequests, // Premium Requests ?ÔøΩÏö©
                        spend: `$${actualSpend.toFixed(2)}`, // ?ÔøΩÏ†ú ÏßÄÔø??ÔøΩÏù¥???ÔøΩÏö©
                        limit: limitDisplay
                    });
                } else {
                    // ?ÔøΩÎèô???ÔøΩÎäî Î©§Î≤Ñ (ÎπÑÌôú??
                    inactiveCount++;
                   
                    activities.push({
                        date: 'No Activity',
                        timestamp: 0,
                        email: member.email,
                        name: member.name || 'Unnamed',
                        type: 'inactive',
                        kind: 'No Activity',
                        request: 0,
                        spend: `$${actualSpend.toFixed(2)}`, // ?ÔøΩÏ†ú ÏßÄÔø??ÔøΩÏù¥???ÔøΩÏö©
                        limit: limitDisplay
                    });
                }
            });
           
            console.log(`?ÔøΩÎèô Î¶¨Ïä§??Í≤∞Í≥º: Ôø?${activities.length}Ôø?(?ÔøΩÏÑ±: ${activeCount}Ôø? ÎπÑÌôú?? ${inactiveCount}Ôø?`);
           
            // ÎßàÔøΩ?Ôø??ÔøΩÎèô ?ÔøΩÏßú Í∏∞ÔøΩ??ÔøΩÎ°ú ?ÔøΩÎ†¨ (ÏµúÏã†??- ?ÔøΩÎ¶ºÏ∞®Ïàú)
            return activities.sort((a, b) => {
                return b.timestamp - a.timestamp;
            });
        }

        // Í∏∞Ï°¥ ?ÔøΩÎèô Î¶¨Ïä§???ÔøΩÏÑ± (?ÔøΩÌôò???ÔøΩÔøΩ?)
        function createActivityList(events) {
            return events.slice(0, 20).map(event => {
                const timestamp = new Date(parseInt(event.timestamp));
                return {
                    date: timestamp.toLocaleDateString('ko-KR', {
                        month: '2-digit',
                        day: '2-digit',
                        hour: '2-digit',
                        minute: '2-digit'
                    }),
                    email: event.userEmail || 'Unknown',
                    type: event.isTokenBasedCall ? 'active' : 'inactive',
                    kind: event.kindLabel || 'Unknown',
                    request: event.requestsCosts || 0,
                    spend: event.isTokenBasedCall ?
                        `$${(event.tokenUsage?.totalCents || 0) / 100}` :
                        '$0.00'
                };
            });
        }



        // ?ÔøΩÎ©î???ÔøΩÎ¶≠ ??Usage ?ÔøΩÏÖò?ÔøΩÎ°ú ?ÔøΩÎèô Ôø?Í≤Ä??        function navigateToUsageWithEmail(email) {
            console.log(`?ÔøΩÎ©î???ÔøΩÎ¶≠: ${email} - Usage ?ÔøΩÏÖò?ÔøΩÎ°ú ?ÔøΩÎèô ?ÔøΩÏûë`);
            
            // Í≤Ä???ÔøΩÏ†ï ?ÔøΩÎûòÔø??ÔøΩÏ†ï (?ÔøΩÎèô ?ÔøΩÎ°úÍ≥†Ïπ® Î∞©ÔøΩ???
            window.pendingEmailSearch = email;
            
            // ?ÔøΩÎèô?ÔøΩÎ°ú ?ÔøΩÏÖò ?ÔøΩÌôò (?ÔøΩÎèô ?ÔøΩÏù¥??Î°úÎìú Î∞©ÔøΩ?)
            const usageMenuItem = document.querySelector('.menu-item[data-section="usage"]');
            const allMenuItems = document.querySelectorAll('.menu-item');
            const allSections = document.querySelectorAll('.content-section');
            
            // Î©îÎâ¥ ?ÔøΩÌÉú ?ÔøΩÎç∞?ÔøΩÌä∏
            allMenuItems.forEach(menu => menu.classList.remove('active'));
            if (usageMenuItem) {
                usageMenuItem.classList.add('active');
            }
            
            // ?ÔøΩÏÖò ?ÔøΩÌôò
            allSections.forEach(section => section.classList.remove('active'));
            const usageSection = document.getElementById('usage');
            if (usageSection) {
                usageSection.classList.add('active');
            }
            
            // ?ÔøΩÏù¥ÏßÄ ?ÔøΩÎ™© ?ÔøΩÎç∞?ÔøΩÌä∏
            const pageTitle = document.getElementById('page-title');
            if (pageTitle) {
                pageTitle.textContent = 'Usage Analytics';
            }
            
            // Usage ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÔøΩ? Î°úÎìú?ÔøΩÏñ¥ ?ÔøΩÎäîÏßÄ ?ÔøΩÏù∏
            const hasData = currentRawEventsData && currentRawEventsData.length > 0;
            
            if (hasData) {
                // ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÔøΩ? ?ÔøΩÏúºÔø?Ï¶âÏãú Í≤Ä???ÔøΩÌñâ
                executeEmailSearch(email);
            } else {
                // ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏúºÔø?Î®ºÔøΩ? Î°úÎìú????Í≤Ä??                console.log('Usage ?ÔøΩÏù¥?ÔøΩÔøΩ? Î®ºÔøΩ? Î°úÎìú?ÔøΩÎãà??..');
                updateUsageWithCurrentFilter(30).then(() => {
                    // ?ÔøΩÏù¥??Î°úÎìú ?ÔøΩÎ£å ??Í≤Ä???ÔøΩÌñâ
                    setTimeout(() => {
                        executeEmailSearch(email);
                    }, 500);
                }).catch(error => {
                    console.error('Usage ?ÔøΩÏù¥??Î°úÎìú ?ÔøΩÌå®:', error);
                    // Î°úÎìú ?ÔøΩÌå®?ÔøΩÎèÑ Í≤Ä?ÔøΩÔøΩ? ?ÔøΩÎèÑ
                    executeEmailSearch(email);
                });
            }
            
            console.log(`?ÔøΩÔøΩ ?ÔøΩÎ©î???ÔøΩÎ¶≠ Ï≤òÎ¶¨ ?ÔøΩÎ£å: ${email}`);
        }
        
        // ?ÔøΩÎ©î??Í≤Ä???ÔøΩÌñâ ?ÔøΩÏàò
        function executeEmailSearch(email) {
            const searchBox = document.querySelector('#usage .search-box');
            if (searchBox) {
                searchBox.value = email;
                // X Î≤ÑÌäº ?ÔøΩÏãú
                toggleSearchClearBtn('usage-search');
                filterUsageMembers(email);
                console.log(`???ÔøΩÎ©î??Í≤Ä???ÔøΩÎ£å: ${email}`);
                
                // Í≤Ä???ÔøΩÎ£å ???ÔøΩÎûòÔø??ÔøΩÍ±∞
                delete window.pendingEmailSearch;
            } else {
                console.error('??Usage ?ÔøΩÏÖò??Í≤Ä?ÔøΩÏ∞Ω??Ï∞æÏùÑ ???ÔøΩÏäµ?ÔøΩÎã§.');
            }
        }

        // ?ÔøΩÎèô Î¶¨Ïä§???ÔøΩÎç∞?ÔøΩÌä∏ (Members ?ÔøΩÔøΩ????ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥??
        function updateActivityList(activities) {
            currentActivityData = activities; // ?ÔøΩÏù¥???Ôø??            renderOverviewActivityTableWithPagination(activities);
        }

        // Overview ?ÔøΩÎèôÎ¶¨Ïä§???ÔøΩÏù¥Ôø??ÔøΩÎçîÔø?(Members ?ÔøΩÔøΩ???
        function renderOverviewActivityTableWithPagination(activities) {
            // ?ÔøΩÎçî ?ÔøΩÎç∞?ÔøΩÌä∏
            const headerElement = document.querySelector('.overview-activity-header');
            if (headerElement) {
                if (!activities || activities.length === 0) {
                    headerElement.innerHTML = '?ÔøΩÔøΩ ?ÔøΩÎèô Î¶¨Ïä§??;
                } else {
                    const totalActivities = activities.length;
                    const totalPages = Math.ceil(totalActivities / currentActivityPageSize);
                    const startIndex = (currentActivityPage - 1) * currentActivityPageSize;
                    const endIndex = Math.min(startIndex + currentActivityPageSize, totalActivities);
                    
                    // ?ÔøΩÏû¨ ?ÔøΩÌÑ∞ ?Ôø?ÔøΩÏóê ?ÔøΩÎ•∏ ?ÔøΩÎ™© Í≤∞Ï†ï
                    const titleInfo = updateOverviewActivityTitle(currentFilterType, totalActivities, totalActivities);
                    const periodText = getCurrentOverviewPeriodText();
                    
                    headerElement.innerHTML = `
                        <span>${titleInfo.emoji} ${titleInfo.title} (${periodText})(${startIndex + 1}-${endIndex} of ${totalActivities})</span>
                        <select id="overviewActivityPageSize" onchange="changeOverviewActivityPageSize(this.value)" style="background: #3a3a3a; color: #fff; border: 1px solid #4a4a4a; padding: 5px 10px; border-radius: 4px; font-size: 12px;">
                            <option value="10" ${currentActivityPageSize === 10 ? 'selected' : ''}>10Ôø?Î≥¥Í∏∞</option>
                            <option value="20" ${currentActivityPageSize === 20 ? 'selected' : ''}>20Ôø?Î≥¥Í∏∞</option>
                            <option value="30" ${currentActivityPageSize === 30 ? 'selected' : ''}>30Ôø?Î≥¥Í∏∞</option>
                            <option value="50" ${currentActivityPageSize === 50 ? 'selected' : ''}>50Ôø?Î≥¥Í∏∞</option>
                            <option value="100" ${currentActivityPageSize === 100 ? 'selected' : ''}>100Ôø?Î≥¥Í∏∞</option>
                        </select>
                    `;
                }
            }
            
            if (!activities || activities.length === 0) {
                const container = document.getElementById('overview-activity-container');
                if (container) {
                    container.innerHTML = `
                        <div style="padding: 20px; text-align: center; color: #7a7a7a; background-color: #1a1a1a;">
                            ?ÔøΩÎèô ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.
                        </div>
                    `;
                }
                // ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥???ÔøΩÍ∏∞Ôø?                const pagination = document.getElementById('overview-activity-pagination');
                if (pagination) pagination.style.display = 'none';
                return;
            }

            // ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥??Í≥ÑÏÇ∞
            const totalActivities = activities.length;
            const totalPages = Math.ceil(totalActivities / currentActivityPageSize);
            const startIndex = (currentActivityPage - 1) * currentActivityPageSize;
            const endIndex = Math.min(startIndex + currentActivityPageSize, totalActivities);
            const pageActivities = activities.slice(startIndex, endIndex);

            console.log(`?ÔøΩÔøΩ Overview ?ÔøΩÎèôÎ¶¨Ïä§???ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥?? ${startIndex + 1}-${endIndex} of ${totalActivities} (?ÔøΩÏù¥ÏßÄ ${currentActivityPage}/${totalPages})`);

            // ?ÔøΩÏù¥Ôø??ÔøΩÏö©Ôø??ÔøΩÎç∞?ÔøΩÌä∏
            const tableContent = pageActivities.map(activity => `
                <div class="member-item">
                    <div class="member-date">${activity.date}</div>
                    <div class="member-email clickable-email" title="View usage for ${activity.email}" onclick="navigateToUsageWithEmail('${activity.email}')">${activity.email}</div>
                    <div class="member-type ${activity.type}">${activity.type === 'active' ? '?ÔøΩÏÑ±' : 'ÎπÑÌôú??}</div>
                    <div class="member-kind">${activity.kind}</div>
                    <div class="member-request">${activity.request}</div>
                    <div class="member-spend">${activity.spend}</div>
                    <div class="member-limit">${activity.limit || '$0'}</div>
                </div>
            `).join('');

            // Ïª®ÌÖå?ÔøΩÎÑà???ÔøΩÏù¥Ôø??ÔøΩÏö©Ôø??ÔøΩÏûÖ
            const container = document.getElementById('overview-activity-container');
            if (container) {
                container.innerHTML = tableContent;
            }

            // ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥???ÔøΩÎç∞?ÔøΩÌä∏
            const paginationContainer = document.getElementById('overview-activity-pagination');
            if (paginationContainer && totalPages > 1) {
                paginationContainer.innerHTML = generateOverviewActivityPagination(totalPages);
                paginationContainer.style.display = 'block';
            } else if (paginationContainer) {
                paginationContainer.style.display = 'none';
            }
           
            // ?ÔøΩÍ≥Ñ ?ÔøΩÎç∞?ÔøΩÌä∏
            const activeCount = activities.filter(a => a.type === 'active').length;
            const totalRequests = activities.reduce((sum, a) => sum + (typeof a.request === 'number' ? a.request : 0), 0);
           
            console.log(`?ÔøΩÔøΩ Overview ?ÔøΩÎèô Î¶¨Ïä§???ÔøΩÎç∞?ÔøΩÌä∏: Ôø?${activities.length}Ôø? ?ÔøΩÏÑ± ${activeCount}Ôø? Ôø??ÔøΩÏ≤≠ ${totalRequests}Ôø?(?ÔøΩÏù¥ÏßÄ ${currentActivityPage}/${totalPages})`);
        }



        // ?ÔøΩÌÑ∞ Í∏∞Í∞Ñ ?ÔøΩÎç∞?ÔøΩÌä∏
        function updateFilterPeriod(startDate, endDate) {
            const start = new Date(startDate).toLocaleDateString('en-US', {
                month: 'short',
                day: 'numeric'
            });
            const end = new Date(endDate).toLocaleDateString('en-US', {
                month: 'short',
                day: 'numeric'
            });
           
            const dateFilterBtn = document.querySelector('.date-filter-btn');
            if (dateFilterBtn) {
                dateFilterBtn.textContent = `${start} - ${end}`;
            }
        }



        // Î©§Î≤Ñ ?ÔøΩÏù¥Î∏îÏùÑ ?ÔøΩÏ†ú API ?ÔøΩÏù¥?ÔøΩÎ°ú ?ÔøΩÎç∞?ÔøΩÌä∏
        async function updateMembersWithRealData() {
            try {
                console.log('=== ?ÔøΩÏ†ú Cursor Admin API ?ÔøΩÏù¥?ÔøΩÎ°ú Î©§Î≤Ñ ?ÔøΩÏù¥Ôø??ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÏûë ===');
               
                // 1. ?ÔøΩÏ†ú ?Ôø???ÔøΩÎ≥¥ Í∞Ä?ÔøΩÏò§Ôø?                console.log('1. ?Ôø???ÔøΩÎ≥¥ API ?ÔøΩÏ∂ú Ôø?..');
                const membersData = await getTeamMembers();
                console.log('?Ôø???ÔøΩÏù¥???ÔøΩÎãµ:', membersData);
               
                if (!membersData || !membersData.teamMembers) {
                    throw new Error('?Ôø???ÔøΩÏù¥?ÔøΩÔøΩ? Í∞Ä?ÔøΩÏò¨ ???ÔøΩÏäµ?ÔøΩÎã§.');
                }

                console.log(`??Ôø?${membersData.teamMembers.length}Î™ÖÏùò ?Ôø???ÔøΩÎ≥¥Ôø?Í∞Ä?ÔøΩÏôî?ÔøΩÎãà??`);

                // 2. ?ÔøΩÏ†ú ÏßÄÔø??ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø?(?ÔøΩÎ∞îÔø?API ?ÔøΩÏö©)
                console.log('2. ?Ôø?ÏßÄÔø??ÔøΩÏù¥??API ?ÔøΩÏ∂ú Ôø?.. (/teams/spend)');
                const spendingData = await getTeamSpendingData();
                console.log('ÏßÄÔø??ÔøΩÏù¥???ÔøΩÎãµ:', spendingData);
               
                if (!spendingData || !spendingData.teamMemberSpend) {
                    throw new Error('ÏßÄÔø??ÔøΩÏù¥?ÔøΩÔøΩ? Í∞Ä?ÔøΩÏò¨ ???ÔøΩÏäµ?ÔøΩÎã§.');
                }

                console.log(`??${spendingData.teamMemberSpend.length}Î™ÖÏùò ÏßÄÔø??ÔøΩÏù¥?ÔøΩÔøΩ? Í∞Ä?ÔøΩÏôî?ÔøΩÎãà??`);
                console.log(`?ÔøΩÔøΩ API ?ÔøΩÎãµ ?ÔøΩÎ≥¥: Ôø?Î©§Î≤Ñ ${spendingData.totalMembers || '?ÔøΩÎ≥¥?ÔøΩÏùå'}Ôø? Ôø??ÔøΩÏù¥ÏßÄ ${spendingData.totalPages || '?ÔøΩÎ≥¥?ÔøΩÏùå'}Ôø?);
                
                // ?ÔøΩÏ†úÔø?Í∞Ä?ÔøΩÏò® Î©§Î≤Ñ ?ÔøΩÔøΩ? API Î©§Î≤Ñ ??ÎπÑÍµê Î°úÍπÖ
                if (membersData.teamMembers.length !== spendingData.teamMemberSpend.length) {
                    console.log(`?ÔøΩÔ∏è Î©§Î≤Ñ ??Î∂àÏùºÔø? Î©§Î≤Ñ API ${membersData.teamMembers.length}Ôø?vs ÏßÄÔø?API ${spendingData.teamMemberSpend.length}Ôø?);
                }

                // 3. ?ÔøΩÎ©î??Í∏∞ÔøΩ??ÔøΩÎ°ú Î©§Î≤Ñ?Ôø?ÏßÄÔø??ÔøΩÏù¥??Îß§Ìïë
                console.log('3. Î©§Î≤Ñ?Ôø?ÏßÄÔø??ÔøΩÏù¥??Îß§Ìïë Ôø?..');
                const memberSpendMap = {};
               
                spendingData.teamMemberSpend.forEach(spendInfo => {
                    memberSpendMap[spendInfo.email] = {
                        premiumRequests: spendInfo.fastPremiumRequests || 0,
                        spend: (spendInfo.spendCents || 0) / 100, // centsÔø?dollarsÔø?Î≥Ä??                        hardLimitOverride: spendInfo.hardLimitOverrideDollars || 0
                    };
                });

                console.log('ÏßÄÔø??ÔøΩÏù¥??Îß§Ìïë Í≤∞Í≥º:', memberSpendMap);

                // 4. Fast Requests Î¶¨ÏÖã ?ÔøΩÏßú ?ÔøΩÏãú
                console.log('4. Fast Requests Î¶¨ÏÖã ?ÔøΩÏßú ?ÔøΩÏãú Ôø?..');
                updateFastRequestsResetDate(spendingData.teamMemberSpend);
                
                // 5. Î©§Î≤Ñ ?ÔøΩÏù¥Ôø??ÔøΩÎç∞?ÔøΩÌä∏
                console.log('5. Î©§Î≤Ñ ?ÔøΩÏù¥Ôø?UI ?ÔøΩÎç∞?ÔøΩÌä∏ Ôø?..');
                updateMembersTable(membersData.teamMembers, memberSpendMap);
               
                console.log('=== ?ÔøΩÏ†ú API ?ÔøΩÏù¥?ÔøΩÎ°ú Î©§Î≤Ñ ?ÔøΩÏù¥Ôø??ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÎ£å! ===');
               
            } catch (error) {
                console.error('???ÔøΩÏ†ú API ?ÔøΩÏù¥??Î°úÎìú ?ÔøΩÌå®:', error);
                
                // ?ÔøΩÏö©?ÔøΩÏóêÔø??ÔøΩÎ¶º
                alert(`?ÔøΩÏ†ú API ?ÔøΩÏù¥??Î°úÎìú???ÔøΩÌå®?ÔøΩÏäµ?ÔøΩÎã§:\n${error.message}\n\n?ÔøΩÎ°ù???ÔøΩÎ≤ÑÍ∞Ä ?ÔøΩÌñâ Ï§ëÏù∏ÏßÄ ?ÔøΩÏù∏?ÔøΩÏÑ∏??`);
            }
        }

        // Fast Requests Î¶¨ÏÖã ?ÔøΩÏßú ?ÔøΩÏãú
        function updateFastRequestsResetDate(teamMemberSpend) {
            try {
                // Premium RequestsÍ∞Ä 0??Î©§Î≤Ñ?ÔøΩÏùÑ Ï∞æÏïÑ??Î¶¨ÏÖã ?ÔøΩÏßú Í≥ÑÏÇ∞
                const zeroRequestMembers = teamMemberSpend.filter(member => 
                    member.fastPremiumRequests === 0
                );
                
                // ?ÔøΩÏ†úÎ°úÎäî API?ÔøΩÏÑú ?ÔøΩÍ≥µ?ÔøΩÎäî Î¶¨ÏÖã ?ÔøΩÏßú ?ÔøΩÎ≥¥Í∞Ä ?ÔøΩÏöî?ÔøΩÔøΩ?Ôø?
                // ?ÔøΩÏû¨Î°úÏÑú??Í≥†Ï†ï???ÔøΩÏßúÔø??ÔøΩÏö©
                const resetDate = '2025??7??22??;
                
                const resetDateElement = document.getElementById('fast-requests-reset-date');
                if (resetDateElement) {
                    resetDateElement.textContent = resetDate;
                }
                
                // ?ÔøΩÍµ≠ ?ÔøΩÍ∞Ñ Í∏∞ÔøΩ? ?ÔøΩÎäò ?ÔøΩÏßú ?ÔøΩÎç∞?ÔøΩÌä∏
                updateTodayDate();
                
                console.log(`?ÔøΩÔøΩ Fast Requests Î¶¨ÏÖã ?ÔøΩÏßú: ${resetDate} (Premium Requests 0??Î©§Î≤Ñ: ${zeroRequestMembers.length}Ôø?`);
            } catch (error) {
                console.error('??Fast Requests Î¶¨ÏÖã ?ÔøΩÏßú Í≥ÑÏÇ∞ ?ÔøΩÎ•ò:', error);
                const resetDateElement = document.getElementById('fast-requests-reset-date');
                if (resetDateElement) {
                    resetDateElement.textContent = '2025??7??22??;
                }
                // ?ÔøΩÎ•ò Î∞úÏÉù ?ÔøΩÏóê???ÔøΩÎäò ?ÔøΩÏßú???ÔøΩÎç∞?ÔøΩÌä∏
                updateTodayDate();
            }
        }

        // ?ÔøΩÍµ≠ ?ÔøΩÍ∞Ñ Í∏∞ÔøΩ? ?ÔøΩÎäò ?ÔøΩÏßú ?ÔøΩÎç∞?ÔøΩÌä∏
        function updateTodayDate() {
            try {
                // ?ÔøΩÍµ≠ ?ÔøΩÍ∞Ñ Í∏∞ÔøΩ? (UTC+9)
                const now = new Date();
                const koreaTime = new Date(now.getTime() + (9 * 60 * 60 * 1000)); // UTC+9
                const todayDate = koreaTime.toISOString().split('T')[0]; // YYYY-MM-DD ?ÔøΩÏãù
                
                const todayDateElement = document.getElementById('today-date');
                if (todayDateElement) {
                    todayDateElement.textContent = todayDate;
                    todayDateElement.style.color = '#ff9800'; // ?ÔøΩÎ†åÏßÄ??                }
                
                console.log(`?ÔøΩÔøΩ ?ÔøΩÎäò ?ÔøΩÏßú (?ÔøΩÍµ≠ ?ÔøΩÍ∞Ñ): ${todayDate}`);
            } catch (error) {
                console.error('???ÔøΩÎäò ?ÔøΩÏßú Í≥ÑÏÇ∞ ?ÔøΩÎ•ò:', error);
                const todayDateElement = document.getElementById('today-date');
                if (todayDateElement) {
                    todayDateElement.textContent = '2025-08-03';
                    todayDateElement.style.color = '#ff9800'; // ?ÔøΩÎ†åÏßÄ??                }
            }
        }

        // Export CSV Í∏∞Îä•
        function exportMembersToCSV() {
            try {
                if (!currentMembersData || currentMembersData.length === 0) {
                    alert('?ÔøΩÎ≥¥??Î©§Î≤Ñ ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                    return;
                }
                
                // CSV ?ÔøΩÎçî
                const headers = ['Name', 'Email', 'Role', 'Premium Requests', 'Spend ($)', 'Hard Limit Override ($)'];
                
                // CSV ?ÔøΩÏù¥???ÔøΩÏÑ±
                const csvData = currentMembersData.map(member => [
                    member.name || '',
                    member.email || '',
                    member.role || '',
                    member.spendData?.premiumRequests || 0,
                    (member.spendData?.spend || 0).toFixed(2),
                    (member.spendData?.hardLimitOverride || 0).toFixed(2)
                ]);
                
                // CSV Î¨∏Ïûê???ÔøΩÏÑ±
                const csvContent = [
                    headers.join(','),
                    ...csvData.map(row => row.join(','))
                ].join('\n');
                
                // ?ÔøΩÏùº ?ÔøΩÏö¥Î°úÎìú
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', `members_export_${new Date().toISOString().split('T')[0]}.csv`);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                console.log(`?ÔøΩÔøΩ CSV ?ÔøΩÎ≥¥?ÔøΩÍ∏∞ ?ÔøΩÎ£å: ${currentMembersData.length}Î™ÖÏùò Î©§Î≤Ñ ?ÔøΩÏù¥??);
            } catch (error) {
                console.error('??CSV ?ÔøΩÎ≥¥?ÔøΩÍ∏∞ ?ÔøΩÎ•ò:', error);
                alert('CSV ?ÔøΩÎ≥¥?ÔøΩÍ∏∞???ÔøΩÌå®?ÔøΩÏäµ?ÔøΩÎã§.');
            }
        }

        // Î©§Î≤Ñ ?ÔøΩÏù¥Ôø??ÔøΩÎç∞?ÔøΩÌä∏ (?ÔøΩÏ†ú ÏßÄÔø??ÔøΩÏù¥???ÔøΩÏö©)
        function updateMembersTable(members, memberSpendMap) {
            console.log(`?ÔøΩÔøΩ Î©§Î≤Ñ ?ÔøΩÏù¥Ôø??ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÏûë: ${members.length}Î™ÖÏùò Î©§Î≤Ñ ?ÔøΩÏù¥??);
            console.log('?ÔøΩÔøΩ ÏßÄÔø??ÔøΩÏù¥??Îß§Ìïë ?ÔøΩÎ≥¥:', Object.keys(memberSpendMap));
           
            // Î©§Î≤Ñ ?ÔøΩÎ≥¥?Ôø??ÔøΩÏ†ú ÏßÄÔø??ÔøΩÏù¥??Í≤∞Ìï©
            const membersWithSpending = members.map(member => {
                const spendData = memberSpendMap[member.email] || {
                    premiumRequests: 0,
                    spend: 0,
                    hardLimitOverride: 0
                };
               
                return {
                    ...member,
                    spendData: spendData
                };
            });
           
            console.log(`?ÔøΩÔøΩ Ï≤òÎ¶¨??Î©§Î≤Ñ ?ÔøΩÏù¥?? ${membersWithSpending.length}Ôø?);
           
            // Premium Requests Í∏∞ÔøΩ??ÔøΩÎ°ú ?ÔøΩÎ†¨ (?ÔøΩÔøΩ? ??
            membersWithSpending.sort((a, b) => b.spendData.premiumRequests - a.spendData.premiumRequests);
           
            // ?ÔøΩÏó≠ ?ÔøΩÏù¥???Ôø??            currentMembersData = membersWithSpending;
            originalMembersData = [...membersWithSpending]; // ?ÔøΩÎ≥∏ ?ÔøΩÏù¥??Î≥¥Ï°¥
            currentMembersPage = 1; // ?ÔøΩÏù¥ÏßÄ Î¶¨ÏÖã
            
            // ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥?ÔøΩÍ≥º ?ÔøΩÍªò ?ÔøΩÎçîÔø?            renderMembersTableWithPagination(membersWithSpending);
        }
        
        // Members ?ÔøΩÏù¥Ôø??ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥?ÔøΩÍ≥º ?ÔøΩÍªò ?ÔøΩÎçîÔø?(All Raw Events ?ÔøΩÔøΩ???
        function renderMembersTableWithPagination(membersWithSpending) {
            const tableContainer = document.querySelector('#members-table-container');
            if (!tableContainer) {
                console.error('??Î©§Î≤Ñ ?ÔøΩÏù¥Ôø?Ïª®ÌÖå?ÔøΩÎÑàÔø?Ï∞æÏùÑ ???ÔøΩÏäµ?ÔøΩÎã§.');
                return;
            }
            
            // ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥???ÔøΩÏö©
            const totalMembers = membersWithSpending.length;
            const totalPages = Math.ceil(totalMembers / currentMembersPageSize);
            const startIndex = (currentMembersPage - 1) * currentMembersPageSize;
            const endIndex = Math.min(startIndex + currentMembersPageSize, totalMembers);
            const pageMembers = membersWithSpending.slice(startIndex, endIndex);
            
            console.log(`?ÔøΩÔøΩ ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥?? ${startIndex + 1}-${endIndex} of ${totalMembers} (?ÔøΩÏù¥ÏßÄ ${currentMembersPage}/${totalPages})`);
           
            // ?ÔøΩÏù¥Ôø??ÔøΩÎ™© ?ÔøΩÏ†Å ?ÔøΩÏÑ±
            const getTableTitle = () => {
                if (currentFilterType === 'active') {
                    return `?ÔøΩÔøΩ ?ÔøΩÏÑ± Î©§Î≤Ñ Î≥¥Í∏∞ (${startIndex + 1}-${endIndex} of ${totalMembers})`;
                } else if (currentFilterType === 'inactive') {
                    return `?ÔøΩÔøΩ ÎπÑÌôú??Î©§Î≤Ñ Î≥¥Í∏∞ (${startIndex + 1}-${endIndex} of ${totalMembers})`;
                } else {
                    return `?ÔøΩÔøΩ ?ÔøΩÏ≤¥ Î©§Î≤Ñ Î≥¥Í∏∞ (${startIndex + 1}-${endIndex} of ${totalMembers})`;
                }
            };

            // ?ÔøΩÏù¥Ôø?HTML ?ÔøΩÏÑ± (All Raw Events ?ÔøΩÔøΩ???
            const tableHtml = `
                <div class="user-cumulative-header" style="display: flex; justify-content: space-between; align-items: center;">
                    <span>${getTableTitle()}</span>
                    <select id="membersPageSize" onchange="changeMembersPageSize(this.value)" style="background: #3a3a3a; color: #fff; border: 1px solid #4a4a4a; padding: 5px 10px; border-radius: 4px; font-size: 12px;">
                        <option value="10" ${currentMembersPageSize === 10 ? 'selected' : ''}>10Ôø?Î≥¥Í∏∞</option>
                        <option value="20" ${currentMembersPageSize === 20 ? 'selected' : ''}>20Ôø?Î≥¥Í∏∞</option>
                        <option value="30" ${currentMembersPageSize === 30 ? 'selected' : ''}>30Ôø?Î≥¥Í∏∞</option>
                        <option value="50" ${currentMembersPageSize === 50 ? 'selected' : ''}>50Ôø?Î≥¥Í∏∞</option>
                        <option value="100" ${currentMembersPageSize === 100 ? 'selected' : ''}>100Ôø?Î≥¥Í∏∞</option>
                    </select>
                </div>
                <div class="table-header">
                    <div onclick="sortMembers('name')" style="cursor: pointer;">NAME ??/div>
                    <div onclick="sortMembers('email')" style="cursor: pointer;">EMAIL ??/div>
                    <div onclick="sortMembers('requests')" style="cursor: pointer;">PREMIUM REQUESTS ??/div>
                    <div onclick="sortMembers('spend')" style="cursor: pointer;">SPEND ??/div>
                    <div onclick="sortMembers('role')" style="cursor: pointer;">ROLE ??/div>
                    <div></div>
                </div>
                ${pageMembers.length > 0 ? pageMembers.map(member => {
                const roleBadgeClass = member.role === 'owner' ? 'admin' : '';
                const roleText = member.role === 'owner' ? 'Admin' : 'Member';
                const requestColor = member.spendData.premiumRequests > 100 ? '#4caf50' :
                                   member.spendData.premiumRequests > 20 ? '#ff9800' :
                                   member.spendData.premiumRequests > 0 ? '#2196f3' : '#f44336';
               
                    return `
                        <div class="table-row">
                    <div>${member.name || 'Unnamed'}</div>
                    <div class="clickable-email" title="View usage for ${member.email}" onclick="navigateToUsageWithEmail('${member.email}')">${member.email}</div>
                    <div style="color: ${requestColor}; font-weight: 600;">${member.spendData.premiumRequests}</div>
                    <div>$${member.spendData.spend.toFixed(2)}</div>
                    <div><span class="role-badge ${roleBadgeClass}">${roleText}</span></div>
                    <div>??/div>
                        </div>
                    `;
                }).join('') : '<div style="padding: 20px; text-align: center; color: #7a7a7a; background-color: #1a1a1a; grid-column: 1 / -1;">Î©§Î≤Ñ ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.</div>'}
            `;
            
            tableContainer.innerHTML = tableHtml;
            
            // ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥???ÔøΩÏãú/?ÔøΩÔøΩ?
            const paginationContainer = document.getElementById('members-pagination');
            if (paginationContainer) {
                if (totalMembers > currentMembersPageSize) {
                    paginationContainer.style.display = 'block';
                    paginationContainer.innerHTML = generateMembersPagination(totalPages);
                } else {
                    paginationContainer.style.display = 'none';
                }
            }
            
            console.log(`??Members ?ÔøΩÏù¥Ôø??ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÎ£å: ?ÔøΩÏù¥ÏßÄ ${currentMembersPage}/${totalPages}, ${pageMembers.length}Ôø?Î©§Î≤Ñ ?ÔøΩÏãú`);
           
            // ?ÔøΩÍ≥Ñ ?ÔøΩÎ≥¥ ?ÔøΩÏãú
            const totalRequests = membersWithSpending.reduce((sum, member) => sum + member.spendData.premiumRequests, 0);
            const totalSpend = membersWithSpending.reduce((sum, member) => sum + member.spendData.spend, 0);
            const activeMembers = membersWithSpending.filter(member => member.spendData.premiumRequests > 0).length;
           
            console.log(`?ÔøΩÔøΩ Î©§Î≤Ñ ?ÔøΩÍ≥Ñ (?ÔøΩÏ†ú API ?ÔøΩÏù¥??:`);
            console.log(`   - Ôø?Î©§Î≤Ñ: ${membersWithSpending.length}Ôø?);
            console.log(`   - ?ÔøΩÏÑ± Î©§Î≤Ñ: ${activeMembers}Ôø?(Premium Requests > 0)`);
            console.log(`   - Ôø?Premium Requests: ${totalRequests}Ôø?);
            console.log(`   - Ôø?ÏßÄÔø? $${totalSpend.toFixed(2)}`);
        }
        
        // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥ ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥???ÔøΩÏÑ± (All Raw Events ?ÔøΩÔøΩ???
        function generateUserCumulativePagination(totalPages) {
            let pagination = '';
            
            // ?ÔøΩÏ†Ñ Î≤ÑÌäº
            if (currentUserCumulativePage > 1) {
                pagination += `<button onclick="changeUserCumulativePage(${currentUserCumulativePage - 1})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin: 0 2px;">??/button>`;
            }
            
            // ?ÔøΩÏù¥ÏßÄ Î≤àÌò∏??            let startPage = Math.max(1, currentUserCumulativePage - 2);
            let endPage = Math.min(totalPages, currentUserCumulativePage + 2);
            
            // Ôø??ÔøΩÏù¥ÏßÄÍ∞Ä Î≤îÏúÑ???ÔøΩÏúºÔø?Ï∂îÔøΩ?
            if (startPage > 1) {
                pagination += `<button onclick="changeUserCumulativePage(1)" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin: 0 2px;">1</button>`;
                if (startPage > 2) {
                    pagination += `<span style="color: #7a7a7a; padding: 0 5px;">...</span>`;
                }
            }
            
            // ?ÔøΩÏû¨ Î≤îÏúÑ???ÔøΩÏù¥ÏßÄ??            for (let i = startPage; i <= endPage; i++) {
                const isActive = i === currentUserCumulativePage;
                pagination += `<button onclick="changeUserCumulativePage(${i})" style="background: ${isActive ? '#4a9eff' : '#3a3a3a'}; border: 1px solid ${isActive ? '#4a9eff' : '#4a4a4a'}; color: ${isActive ? 'white' : '#e1e1e1'}; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: ${isActive ? '600' : 'normal'}; margin: 0 2px;">${i}</button>`;
            }
            
            // ÎßàÔøΩ?Ôø??ÔøΩÏù¥ÏßÄÍ∞Ä Î≤îÏúÑ???ÔøΩÏúºÔø?Ï∂îÔøΩ?
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    pagination += `<span style="color: #7a7a7a; padding: 0 5px;">...</span>`;
                }
                pagination += `<button onclick="changeUserCumulativePage(${totalPages})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin: 0 2px;">${totalPages}</button>`;
            }
            
            // ?ÔøΩÏùå Î≤ÑÌäº
            if (currentUserCumulativePage < totalPages) {
                pagination += `<button onclick="changeUserCumulativePage(${currentUserCumulativePage + 1})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin: 0 2px;">??/button>`;
            }
            
            return pagination;
        }

        // Overview ?ÔøΩÎèôÎ¶¨Ïä§???ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥???ÔøΩÏÑ± (Members?Ôø??ÔøΩÏùº)
        function generateOverviewActivityPagination(totalPages) {
            let pagination = '';
            
            // ?ÔøΩÏ†Ñ Î≤ÑÌäº
            if (currentActivityPage > 1) {
                pagination += `<button onclick="changeOverviewActivityPage(${currentActivityPage - 1})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin: 0 2px;">??/button>`;
            }
            
            // ?ÔøΩÏù¥ÏßÄ Î≤àÌò∏??            let startPage = Math.max(1, currentActivityPage - 2);
            let endPage = Math.min(totalPages, currentActivityPage + 2);
            
            // Ôø??ÔøΩÏù¥ÏßÄÍ∞Ä Î≤îÏúÑ???ÔøΩÏúºÔø?Ï∂îÔøΩ?
            if (startPage > 1) {
                pagination += `<button onclick="changeOverviewActivityPage(1)" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin: 0 2px;">1</button>`;
                if (startPage > 2) {
                    pagination += `<span style="color: #7a7a7a; padding: 0 5px;">...</span>`;
                }
            }
            
            // ?ÔøΩÏû¨ Î≤îÏúÑ???ÔøΩÏù¥ÏßÄ??            for (let i = startPage; i <= endPage; i++) {
                const isActive = i === currentActivityPage;
                pagination += `<button onclick="changeOverviewActivityPage(${i})" style="background: ${isActive ? '#4a9eff' : '#3a3a3a'}; border: 1px solid ${isActive ? '#4a9eff' : '#4a4a4a'}; color: ${isActive ? 'white' : '#e1e1e1'}; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: ${isActive ? '600' : 'normal'}; margin: 0 2px;">${i}</button>`;
            }
            
            // ÎßàÔøΩ?Ôø??ÔøΩÏù¥ÏßÄÍ∞Ä Î≤îÏúÑ???ÔøΩÏúºÔø?Ï∂îÔøΩ?
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    pagination += `<span style="color: #7a7a7a; padding: 0 5px;">...</span>`;
                }
                pagination += `<button onclick="changeOverviewActivityPage(${totalPages})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin: 0 2px;">${totalPages}</button>`;
            }
            
            // ?ÔøΩÏùå Î≤ÑÌäº
            if (currentActivityPage < totalPages) {
                pagination += `<button onclick="changeOverviewActivityPage(${currentActivityPage + 1})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin: 0 2px;">??/button>`;
            }
            
            return pagination;
        }

        // Overview ?ÔøΩÎèôÎ¶¨Ïä§???ÔøΩÏù¥ÏßÄ Î≥ÄÔø?        function changeOverviewActivityPage(page) {
            currentActivityPage = page;
            renderOverviewActivityTableWithPagination(currentActivityData);
        }

        // Overview ?ÔøΩÎèôÎ¶¨Ïä§???ÔøΩÏù¥ÏßÄ ?ÔøΩÍ∏∞ Î≥ÄÔø?        function changeOverviewActivityPageSize(pageSize) {
            currentActivityPageSize = parseInt(pageSize);
            currentActivityPage = 1; // ?ÔøΩÏù¥ÏßÄ ?ÔøΩÍ∏∞ Î≥ÄÍ≤ΩÏãú Ôø??ÔøΩÏù¥ÏßÄÔø??ÔøΩÎèô
            renderOverviewActivityTableWithPagination(currentActivityData);
        }

        // Members ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥???ÔøΩÏÑ± (All Raw Events?Ôø??ÔøΩÏùº)
        function generateMembersPagination(totalPages) {
            let pagination = '';
            
            // ?ÔøΩÏ†Ñ Î≤ÑÌäº
            if (currentMembersPage > 1) {
                pagination += `<button onclick="changeMembersPage(${currentMembersPage - 1})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin: 0 2px;">??/button>`;
            }
            
            // ?ÔøΩÏù¥ÏßÄ Î≤àÌò∏??            let startPage = Math.max(1, currentMembersPage - 2);
            let endPage = Math.min(totalPages, currentMembersPage + 2);
            
            // Ôø??ÔøΩÏù¥ÏßÄÍ∞Ä Î≤îÏúÑ???ÔøΩÏúºÔø?Ï∂îÔøΩ?
            if (startPage > 1) {
                pagination += `<button onclick="changeMembersPage(1)" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin: 0 2px;">1</button>`;
                if (startPage > 2) {
                    pagination += `<span style="color: #7a7a7a; padding: 0 5px;">...</span>`;
                }
            }
            
            // ?ÔøΩÏû¨ Î≤îÏúÑ???ÔøΩÏù¥ÏßÄ??            for (let i = startPage; i <= endPage; i++) {
                const isActive = i === currentMembersPage;
                pagination += `<button onclick="changeMembersPage(${i})" style="background: ${isActive ? '#4a9eff' : '#3a3a3a'}; border: 1px solid ${isActive ? '#4a9eff' : '#4a4a4a'}; color: ${isActive ? 'white' : '#e1e1e1'}; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: ${isActive ? '600' : 'normal'}; margin: 0 2px;">${i}</button>`;
            }
            
            // ÎßàÔøΩ?Ôø??ÔøΩÏù¥ÏßÄÍ∞Ä Î≤îÏúÑ???ÔøΩÏúºÔø?Ï∂îÔøΩ?
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    pagination += `<span style="color: #7a7a7a; padding: 0 5px;">...</span>`;
                }
                pagination += `<button onclick="changeMembersPage(${totalPages})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin: 0 2px;">${totalPages}</button>`;
            }
            
            // ?ÔøΩÏùå Î≤ÑÌäº
            if (currentMembersPage < totalPages) {
                pagination += `<button onclick="changeMembersPage(${currentMembersPage + 1})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin: 0 2px;">??/button>`;
            }
            
            return pagination;
        }

        // Members ?ÔøΩÏù¥ÏßÄ Î≥ÄÔø?        function changeMembersPage(page) {
            currentMembersPage = page;
            renderMembersTableWithPagination(currentMembersData);
        }

        // Members ?ÔøΩÏù¥ÏßÄ ?ÔøΩÍ∏∞ Î≥ÄÔø?        function changeMembersPageSize(pageSize) {
            currentMembersPageSize = parseInt(pageSize);
            currentMembersPage = 1; // ?ÔøΩÏù¥ÏßÄ ?ÔøΩÍ∏∞ Î≥ÄÍ≤ΩÏãú Ôø??ÔøΩÏù¥ÏßÄÔø??ÔøΩÎèô
            renderMembersTableWithPagination(currentMembersData);
        }

        // Í≤Ä?ÔøΩÏ∞Ω X Î≤ÑÌäº ?ÔøΩÏãú/?ÔøΩÔøΩ? ?ÔøΩÔøΩ?
        function toggleSearchClearBtn(searchId) {
            const searchInput = document.getElementById(searchId);
            const clearBtn = document.getElementById(searchId + '-clear');
            
            if (searchInput && clearBtn) {
                if (searchInput.value.length > 0) {
                    clearBtn.style.display = 'flex';
                } else {
                    clearBtn.style.display = 'none';
                }
            }
        }

        // Í≤Ä?ÔøΩÏ∞Ω ÎπÑÏö∞Ôø?        function clearSearch(searchId) {
            const searchInput = document.getElementById(searchId);
            const clearBtn = document.getElementById(searchId + '-clear');
            const autocomplete = document.getElementById(searchId.replace('-search', '-autocomplete'));
            
            if (searchInput) {
                searchInput.value = '';
                clearBtn.style.display = 'none';
                
                // ?ÔøΩÎèô?ÔøΩÏÑ± ?ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÍ∏∞Ôø?                if (autocomplete) {
                    autocomplete.style.display = 'none';
                }
                
                // Í≤Ä???ÔøΩÌÑ∞ Ï¥àÍ∏∞??                if (searchId === 'members-search') {
                    filterMembers('');
                } else if (searchId === 'usage-search') {
                    filterUsageMembers('');
                } else if (searchId === 'user-performance-search') {
                    filterUserPerformance('');
                }
            }
        }

        // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÍ≥º Ï∞®Ìä∏ Í≤Ä?ÔøΩÏ∞Ω ÎπÑÏö∞Ôø?        function clearUserPerformanceSearch(searchId) {
            const searchInput = document.getElementById(searchId);
            const clearBtn = document.getElementById(searchId + '-clear');
            const autocomplete = document.getElementById(searchId.replace('-search', '-autocomplete'));
            
            if (searchInput) {
                searchInput.value = '';
                clearBtn.style.display = 'none';
                
                // ?ÔøΩÎèô?ÔøΩÏÑ± ?ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÍ∏∞Ôø?                if (autocomplete) {
                    autocomplete.style.display = 'none';
                }
                
                // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÍ≥º Ï∞®Ìä∏ ?ÔøΩÏÉù??(?ÔøΩÏ≤¥ ?ÔøΩÏö©??
                filterUserPerformance('');
            }
        }

        // ?ÔøΩÎèô?ÔøΩÏÑ± ?ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÏãú
        function showAutocomplete(searchId) {
            const searchInput = document.getElementById(searchId);
            const autocomplete = document.getElementById(searchId.replace('-search', '-autocomplete'));
            
            if (!searchInput || !autocomplete) return;
            
            const searchTerm = searchInput.value.toLowerCase().trim();
            
            if (searchTerm.length === 0) {
                autocomplete.style.display = 'none';
                return;
            }
            
            // ?ÔøΩÏö©???ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø?            let users = [];
            if (searchId === 'members-search') {
                users = getMembersUsers();
            } else if (searchId === 'usage-search') {
                users = getUsageUsers();
            }
            
            // Í≤Ä?ÔøΩÏñ¥?Ôø?Îß§Ïπ≠?ÔøΩÎäî ?ÔøΩÏö©???ÔøΩÌÑ∞Ôø?            const filteredUsers = users.filter(user => 
                user.name.toLowerCase().includes(searchTerm) || 
                user.email.toLowerCase().includes(searchTerm)
            );
            
            if (filteredUsers.length === 0) {
                autocomplete.style.display = 'none';
                return;
            }
            
            // ?ÔøΩÎ°≠?ÔøΩÏö¥ HTML ?ÔøΩÏÑ±
            const dropdownHTML = filteredUsers.map(user => `
                <div class="autocomplete-item" onclick="selectUser('${searchId}', '${user.email}')">
                    <div class="user-name">${user.name}</div>
                    <div class="user-email">${user.email}</div>
                </div>
            `).join('');
            
            autocomplete.innerHTML = dropdownHTML;
            autocomplete.style.display = 'block';
        }

        // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÍ≥º Ï∞®Ìä∏ ?ÔøΩÎèô?ÔøΩÏÑ± ?ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÏãú
        function showUserPerformanceAutocomplete(searchId) {
            const searchInput = document.getElementById(searchId);
            const autocomplete = document.getElementById(searchId.replace('-search', '-autocomplete'));
            
            if (!searchInput || !autocomplete) return;
            
            const searchTerm = searchInput.value.toLowerCase().trim();
            
            if (searchTerm.length === 0) {
                autocomplete.style.display = 'none';
                return;
            }
            
            // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÍ≥º ?ÔøΩÏù¥?ÔøΩÏóê???ÔøΩÏö©???ÔøΩÎ≥¥ Í∞Ä?ÔøΩÏò§Ôø?            const users = getUserPerformanceUsers();
            
            // Í≤Ä?ÔøΩÏñ¥?Ôø?Îß§Ïπ≠?ÔøΩÎäî ?ÔøΩÏö©???ÔøΩÌÑ∞Ôø?            const filteredUsers = users.filter(user => 
                user.name.toLowerCase().includes(searchTerm) || 
                user.email.toLowerCase().includes(searchTerm)
            );
            
            if (filteredUsers.length === 0) {
                autocomplete.style.display = 'none';
                return;
            }
            
            // ?ÔøΩÎ°≠?ÔøΩÏö¥ HTML ?ÔøΩÏÑ±
            const dropdownHTML = filteredUsers.map(user => `
                <div class="autocomplete-item" onclick="selectUserPerformanceUser('${searchId}', '${user.email}')">
                    <div class="user-name">${user.name}</div>
                    <div class="user-email">${user.email}</div>
                </div>
            `).join('');
            
            autocomplete.innerHTML = dropdownHTML;
            autocomplete.style.display = 'block';
        }

        // ?ÔøΩÏö©???ÔøΩÌÉù
        function selectUser(searchId, userEmail) {
            const searchInput = document.getElementById(searchId);
            const autocomplete = document.getElementById(searchId.replace('-search', '-autocomplete'));
            
            if (searchInput) {
                searchInput.value = userEmail;
                
                // Í≤Ä???ÔøΩÌñâ
                if (searchId === 'members-search') {
                    filterMembers(userEmail);
                } else if (searchId === 'usage-search') {
                    filterUsageMembers(userEmail);
                }
                
                // X Î≤ÑÌäº ?ÔøΩÏãú
                toggleSearchClearBtn(searchId);
            }
            
            // ?ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÍ∏∞Ôø?            if (autocomplete) {
                autocomplete.style.display = 'none';
            }
        }

        // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÍ≥º Ï∞®Ìä∏ ?ÔøΩÏö©???ÔøΩÌÉù
        function selectUserPerformanceUser(searchId, userEmail) {
            const searchInput = document.getElementById(searchId);
            const autocomplete = document.getElementById(searchId.replace('-search', '-autocomplete'));
            
            if (searchInput) {
                searchInput.value = userEmail;
                
                // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÍ≥º Ï∞®Ìä∏ ?ÔøΩÌÑ∞Ôø?                filterUserPerformance(userEmail);
                
                // X Î≤ÑÌäº ?ÔøΩÏãú
                toggleSearchClearBtn(searchId);
            }
            
            // ?ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÍ∏∞Ôø?            if (autocomplete) {
                autocomplete.style.display = 'none';
            }
        }

        // Members ?ÔøΩÏÖò ?ÔøΩÏö©???ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø?        function getMembersUsers() {
            if (!currentMembersData || currentMembersData.length === 0) {
                return [];
            }
            
            return currentMembersData.map(member => ({
                name: member.name || 'Unnamed',
                email: member.email
            }));
        }

        // Usage ?ÔøΩÏÖò ?ÔøΩÏö©???ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø?        function getUsageUsers() {
            if (!currentUserCumulativeData || currentUserCumulativeData.length === 0) {
                return [];
            }
            
            return currentUserCumulativeData.map(user => ({
                name: user.name || 'Unnamed',
                email: user.email
            }));
        }

        // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÍ≥º Ï∞®Ìä∏ ?ÔøΩÏö©???ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø?        function getUserPerformanceUsers() {
            const members = currentMembersData || [];
            const rawEvents = currentRawEventsData || [];
            
            if (members.length === 0 || rawEvents.length === 0) {
                return [];
            }
            
            // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÍ≥º ?ÔøΩÏù¥???ÔøΩÏÑ±
            const userPerformance = [];
            const userMap = new Map();
            
            // Î©§Î≤Ñ ?ÔøΩÎ≥¥Ôø?Ï¥àÍ∏∞??            members.forEach(member => {
                userMap.set(member.email, {
                    name: member.name || 'Unnamed',
                    email: member.email,
                    requests: 0,
                    costs: 0,
                    activeDays: 0
                });
            });
            
            // ?ÔøΩÎ≤§???ÔøΩÏù¥?ÔøΩÎ°ú ?ÔøΩÍ≥º Í≥ÑÏÇ∞
            rawEvents.forEach(event => {
                const userEmail = event.email;
                const user = userMap.get(userEmail);
                
                if (user) {
                    user.requests += event.requests || 0;
                    user.costs += event.requestsCosts || 0;
                    
                    // ?ÔøΩÎèô ?ÔøΩÏàò Í≥ÑÏÇ∞ (?ÔøΩÏßúÎ≥ÑÎ°ú ??Î≤àÎßå Ïπ¥Ïö¥??
                    const eventDate = new Date(parseInt(event.timestamp)).toDateString();
                    if (!user.activeDaysSet) {
                        user.activeDaysSet = new Set();
                    }
                    user.activeDaysSet.add(eventDate);
                }
            });
            
            // Set??Í∞úÏàòÔø?Î≥Ä??            userMap.forEach(user => {
                user.activeDays = user.activeDaysSet ? user.activeDaysSet.size : 0;
                delete user.activeDaysSet;
                userPerformance.push(user);
            });
            
            return userPerformance;
        }

        // Î©§Î≤Ñ Í≤Ä??Í∏∞Îä•
        function filterMembers(searchTerm) {
            const rows = document.querySelectorAll('#members .table-row');
            const searchLower = searchTerm.toLowerCase();
           
            rows.forEach(row => {
                const name = row.children[0].textContent.toLowerCase();
                const email = row.children[1].textContent.toLowerCase();
               
                if (name.includes(searchLower) || email.includes(searchLower)) {
                    row.style.display = 'grid';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÍ≥º Ï∞®Ìä∏ ?ÔøΩÌÑ∞Ôø?        function filterUserPerformance(searchTerm) {
            console.log(`?ÔøΩÔøΩ ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÍ≥º Ï∞®Ìä∏ ?ÔøΩÌÑ∞Ôø? "${searchTerm}"`);
            
            const searchLower = searchTerm.toLowerCase().trim();
            
            // Í≤Ä?ÔøΩÏñ¥Í∞Ä ÎπÑÏñ¥?ÔøΩÏúºÔø??ÔøΩÏ≤¥ ?ÔøΩÏö©???ÔøΩÍ≥º Ï∞®Ìä∏ ?ÔøΩÏãú
            if (searchLower === '') {
                createUserPerformanceChart();
                return;
            }
            
            // ?ÔøΩÏ†ï ?ÔøΩÏö©?ÔøΩÏóê ?Ôø???ÔøΩÍ≥º Ï∞®Ìä∏ ?ÔøΩÏÑ±
            createFilteredUserPerformanceChart(searchLower);
        }

        // Ï∞®Ìä∏ ?ÔøΩÏù¥???ÔøΩÌÑ∞Ôø?(?ÔøΩÎ∞ò?ÔøΩÏù∏ Ï∞®Ìä∏ Í≤Ä??
        function filterChartData(searchTerm) {
            console.log(`?ÔøΩÔøΩ Ï∞®Ìä∏ ?ÔøΩÏù¥???ÔøΩÌÑ∞Ôø? "${searchTerm}"`);
            
            const searchLower = searchTerm.toLowerCase().trim();
            const chartSelect = document.getElementById('chartSelect');
            const currentChartType = chartSelect ? chartSelect.value : 'activity-trend';
            
            // Í≤Ä?ÔøΩÏñ¥Í∞Ä ÎπÑÏñ¥?ÔøΩÏúºÔø??ÔøΩÏû¨ Ï∞®Ìä∏ ?ÔøΩÏÉù??            if (searchLower === '') {
                switchChart(currentChartType).catch(error => {
                    console.error('Ï∞®Ìä∏ ?ÔøΩÏÉù??Ôø??ÔøΩÎ•òÍ∞Ä Î∞úÏÉù?ÔøΩÏäµ?ÔøΩÎã§:', error);
                });
                return;
            }
            
            // Ï∞®Ìä∏ ?Ôø?ÔøΩÏóê ?ÔøΩÎùº ?ÔøΩÏ†à???ÔøΩÌÑ∞Ôø??ÔøΩÏö©
            switch (currentChartType) {
                case 'user-performance':
                    filterUserPerformance(searchTerm);
                    break;
                case 'user-heatmap':
                    // ?ÔøΩÏö©???ÔøΩÎèô ?ÔøΩÌä∏Ôø??ÔøΩÌÑ∞Ôø?                    createFilteredUserHeatmapChart(searchTerm);
                    break;
                case 'model-preference':
                    // Î™®Îç∏ ?ÔøΩÌò∏???ÔøΩÌÑ∞Ôø?                    createFilteredModelPreferenceChart(searchTerm);
                    break;
                default:
                    // Í∏∞Î≥∏?ÔøΩÏúºÎ°úÎäî Ï∞®Ìä∏ ?ÔøΩÏÉù??                    switchChart(currentChartType).catch(error => {
                        console.error('Ï∞®Ìä∏ ?ÔøΩÏÉù??Ôø??ÔøΩÎ•òÍ∞Ä Î∞úÏÉù?ÔøΩÏäµ?ÔøΩÎã§:', error);
                    });
                    break;
            }
        }

        // Ï∞®Ìä∏ Í≤Ä?ÔøΩÏ∞Ω ÎπÑÏö∞Ôø?        function clearChartSearch(searchId) {
            const searchInput = document.getElementById(searchId);
            const clearBtn = document.getElementById(searchId + '-clear');
            
            if (searchInput) {
                searchInput.value = '';
                clearBtn.style.display = 'none';
                
                // ?ÔøΩÏû¨ Ï∞®Ìä∏ ?Ôø???ÔøΩÏù∏
                const chartSelect = document.getElementById('chartSelect');
                const currentChartType = chartSelect ? chartSelect.value : 'activity-trend';
                
                // Í≤Ä?ÔøΩÏ∞Ω???ÔøΩÎäî Ï∞®Ìä∏?ÔøΩÏùò Í≤ΩÏö∞ Ï¶âÏãú Í∏∞Î≥∏ Ï∞®Ìä∏Ôø??ÔøΩÌôò
                if (currentChartType === 'user-heatmap') {
                    console.log('?ÔøΩÔøΩ Í≤Ä?ÔøΩÏ∞Ω ?ÔøΩÎ¶¨??- ?ÔøΩÏúÑ 20Ôø??ÔøΩÌä∏ÎßµÏúºÔø??ÔøΩÌôò');
                    createUserHeatmapChart();
                } else if (currentChartType === 'model-preference') {
                    console.log('?ÔøΩÔøΩ Í≤Ä?ÔøΩÏ∞Ω ?ÔøΩÎ¶¨??- ?ÔøΩÏúÑ 20Ôø?Î™®Îç∏ ?ÔøΩÌò∏?ÔøΩÎ°ú ?ÔøΩÌôò');
                    createModelPreferenceChart();
                } else {
                    // ?ÔøΩÎ•∏ Ï∞®Ìä∏??Í∏∞Ï°¥ Î∞©Ïãù?ÔøΩÎ°ú ?ÔøΩÏÉù??                    switchChart(currentChartType).catch(error => {
                        console.error('Ï∞®Ìä∏ ?ÔøΩÏÉù??Ôø??ÔøΩÎ•òÍ∞Ä Î∞úÏÉù?ÔøΩÏäµ?ÔøΩÎã§:', error);
                    });
                }
            }
        }

        // Ï∞®Ìä∏ Í≤Ä??Ï≤òÎ¶¨ (?ÔøΩÌä∏Ôø?Ôø?Î™®Îç∏ ?ÔøΩÌò∏??
        function handleChartSearch(searchTerm) {
            console.log('?ÔøΩÔøΩ Ï∞®Ìä∏ Í≤Ä??Ï≤òÎ¶¨:', searchTerm);
            
            const chartSelect = document.getElementById('chartSelect');
            if (!chartSelect) return;
            
            const selectedChart = chartSelect.value;
            
            // ?ÔøΩÌä∏Ôø?Ï∞®Ìä∏ Í≤Ä??Ï≤òÎ¶¨
            if (selectedChart === 'user-heatmap') {
                if (searchTerm.trim() === '') {
                    // Í≤Ä?ÔøΩÏñ¥Í∞Ä ?ÔøΩÏúºÔø?Ï¶âÏãú Í∏∞Î≥∏ ?ÔøΩÌä∏Ôø??ÔøΩÏãú (?ÔøΩÏúÑ 20Ôø?
                    createUserHeatmapChart();
                } else {
                    // Í≤Ä?ÔøΩÏñ¥Ôø??ÔøΩÏö©???ÔøΩÌÑ∞Ôø?                    const filteredUsers = getFilteredUsers(searchTerm);
                    
                    if (filteredUsers.length === 1) {
                        // ?ÔøΩÌôï??1Î™ÖÏù¥Ôø??ÔøΩÏùºÔø?Ï∞®Ìä∏ ?ÔøΩÏãú
                        createFilteredUserHeatmapChart(filteredUsers[0].email.split('@')[0]);
                    } else if (filteredUsers.length > 1) {
                        // ?ÔøΩÎü¨ Î™ÖÏù¥Ôø??ÔøΩÏúÑ 20Î™ÖÍπåÏßÄ ÎßâÔøΩ? Ï∞®Ìä∏ ?ÔøΩÏãú
                        createMultiUserHeatmapChart(filteredUsers.slice(0, 20));
                    } else {
                        // Í≤Ä??Í≤∞Í≥º ?ÔøΩÏùå
                        showNoSearchResults(searchTerm);
                    }
                }
            }
            // Î™®Îç∏ ?ÔøΩÌò∏??Ï∞®Ìä∏ Í≤Ä??Ï≤òÎ¶¨
            else if (selectedChart === 'model-preference') {
                if (searchTerm.trim() === '') {
                    // Í≤Ä?ÔøΩÏñ¥Í∞Ä ?ÔøΩÏúºÔø?Í∏∞Î≥∏ Î™®Îç∏ ?ÔøΩÌò∏???ÔøΩÏãú (?ÔøΩÏúÑ 20Ôø?
                    createModelPreferenceChart();
                } else {
                    // Í≤Ä?ÔøΩÏñ¥Ôø??ÔøΩÏö©???ÔøΩÌÑ∞Ôø?                    const filteredUsers = getFilteredUsers(searchTerm);
                    
                    if (filteredUsers.length === 1) {
                        // ?ÔøΩÌôï??1Î™ÖÏù¥Ôø??ÔøΩÎãπ ?ÔøΩÏö©?ÔøΩÏùò Î™®Îç∏ ?ÔøΩÏö©??Ï∞®Ìä∏ ?ÔøΩÏãú
                        createFilteredModelPreferenceChart(filteredUsers[0].email.split('@')[0]);
                    } else if (filteredUsers.length > 1) {
                        // ?ÔøΩÎü¨ Î™ÖÏù¥Ôø??ÔøΩÏúÑ 20Î™ÖÍπåÏßÄ Î™®Îç∏ ?ÔøΩÌò∏??Ï∞®Ìä∏ ?ÔøΩÏãú
                        createMultiUserModelPreferenceChart(filteredUsers.slice(0, 20));
                    } else {
                        // Í≤Ä??Í≤∞Í≥º ?ÔøΩÏùå
                        showNoSearchResults(searchTerm);
                    }
                }
            }
        }

        // Í≤Ä?ÔøΩÏñ¥Ôø??ÔøΩÏö©???ÔøΩÌÑ∞Ôø?(ID Í∏∞Î∞ò)
        function getFilteredUsers(searchTerm) {
            const members = (chartDataStore.members && chartDataStore.members.length > 0) ? 
                chartDataStore.members : (currentMembers || []);
            
            if (!members || members.length === 0) return [];
            
            // IDÎ°úÎßå Í≤Ä??(?ÔøΩÌôï???ÔøΩÏπò?ÔøΩÎäî Í≤ΩÏö∞)
            const exactMatch = members.find(member => {
                const emailId = member.email.split('@')[0];
                return emailId.toLowerCase() === searchTerm.toLowerCase();
            });
            
            if (exactMatch) {
                return [exactMatch]; // ?ÔøΩÌôï??1Î™ÖÎßå Î∞òÌôò
            }
            
            // Î∂ÄÔø?Í≤Ä??(ID???ÔøΩÌï®?ÔøΩÎäî Í≤ΩÏö∞)
            return members.filter(member => {
                const emailId = member.email.split('@')[0];
                return emailId.toLowerCase().includes(searchTerm.toLowerCase());
            });
        }

        // ?ÔøΩÎü¨ ?ÔøΩÏö©???ÔøΩÌä∏Ôø?Ï∞®Ìä∏ ?ÔøΩÏÑ± (Î∂ÄÔø?Í≤Ä??Í≤∞Í≥º)
        function createMultiUserHeatmapChart(filteredUsers) {
            console.log('?ÔøΩÔøΩ createMultiUserHeatmapChart ?ÔøΩÏûë:', filteredUsers.length, 'Ôø?);
            const canvas = document.getElementById('userHeatmapChart');
            if (!canvas) return;
            
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = 300;
            
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, width, height);
            
            // ?ÔøΩÌÑ∞???ÔøΩÏö©?ÔøΩÎì§???ÔøΩÎèô ?ÔøΩÏù¥???ÔøΩÏÑ±
            const heatmapData = generateFilteredHeatmapBarData(filteredUsers);
            
            if (heatmapData.length === 0) {
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('?ÔøΩÎèô ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.', width / 2, height / 2);
                return;
            }
            
            // ÎßâÔøΩ? Í∑∏Îûò??Í∑∏Î¶¨Ôø?            drawHeatmapBarChart(ctx, width, height, heatmapData);
        }

        // ?ÔøΩÌÑ∞???ÔøΩÏö©?ÔøΩÎì§???ÔøΩÌä∏Ôø??ÔøΩÏù¥???ÔøΩÏÑ±
        function generateFilteredHeatmapBarData(filteredUsers) {
            console.log('?ÔøΩÔøΩ generateFilteredHeatmapBarData ?ÔøΩÏûë:', filteredUsers.length, 'Ôø?);
            
            const rawEvents = (chartDataStore.rawEvents && chartDataStore.rawEvents.length > 0) ? 
                chartDataStore.rawEvents : (currentRawEventsData || []);
            
            if (!rawEvents || rawEvents.length === 0) {
                console.log('?ÔøΩÔ∏è ?ÔøΩÎ≤§???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                return [];
            }
            
            // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÎèô ??Í≥ÑÏÇ∞
            const userActivityMap = new Map();
            filteredUsers.forEach((member, userIndex) => {
                const userEmail = member.email;
                const userName = member.name;
                const userId = userEmail.split('@')[0];
                
                const userEvents = rawEvents.filter(event => 
                    event.userEmail === userEmail || event.email === userEmail
                );
                
                const totalActivity = userEvents.length;
                
                userActivityMap.set(userIndex, {
                    name: userName,
                    email: userEmail,
                    id: userId,
                    totalActivity: totalActivity
                });
            });
            
            // ?ÔøΩÎèô ?ÔøΩÎ°ú ?ÔøΩÎ†¨
            const sortedUsers = Array.from(userActivityMap.entries())
                .sort((a, b) => b[1].totalActivity - a[1].totalActivity);
            
            const data = sortedUsers.map(([userIndex, userData]) => ({
                userId: userData.id,
                userName: userData.name,
                email: userData.email,
                activity: userData.totalActivity
            }));
            
            console.log(`?ÔøΩÔøΩ ?ÔøΩÌÑ∞???ÔøΩÌä∏Ôø??ÔøΩÏù¥???ÔøΩÏÑ± ?ÔøΩÎ£å: ${data.length}Ôø?);
            return data;
        }

        // Í≤Ä??Í≤∞Í≥º ?ÔøΩÏùå ?ÔøΩÏãú
        function showNoSearchResults(searchTerm) {
            const canvas = document.getElementById('userHeatmapChart');
            if (!canvas) return;
            
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = 300;
            
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, width, height);
            
            ctx.fillStyle = '#7a7a7a';
            ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText(`Í≤Ä??Í≤∞Í≥ºÍ∞Ä ?ÔøΩÏäµ?ÔøΩÎã§: "${searchTerm}"`, width / 2, height / 2);
        }

        // ?ÔøΩÌä∏ÎßµÏö© Ïª§Ïä§?Ôø??ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÏÑ±
        function populateHeatmapEmailDropdown() {
            console.log('?ÔøΩÔøΩ ?ÔøΩÌä∏ÎßµÏö© Ïª§Ïä§?Ôø??ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÏÑ± Ôø?..');
            
            const searchInput = document.getElementById('chart-search-input');
            if (!searchInput) {
                console.error('??chart-search-input ?ÔøΩÏÜåÔø?Ï∞æÏùÑ ???ÔøΩÏäµ?ÔøΩÎã§.');
                return;
            }
            
            // Í∏∞Ï°¥ Ïª§Ïä§?Ôø??ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÍ±∞
            const existingDropdown = document.getElementById('custom-heatmap-dropdown');
            if (existingDropdown) {
                existingDropdown.remove();
            }
            
            // ??Ïª§Ïä§?Ôø??ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÏÑ±
            const dropdown = document.createElement('div');
            dropdown.id = 'custom-heatmap-dropdown';
            dropdown.style.cssText = `
                position: absolute;
                top: calc(100% + 4px);
                left: 0;
                right: 0;
                background-color: #2a2a2a;
                border: 1px solid #3a3a3a;
                border-radius: 8px;
                max-height: 200px;
                overflow-y: auto;
                z-index: 1000;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
                display: none;
            `;
            
            // Î©§Î≤Ñ ?ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø?            const members = (chartDataStore.members && chartDataStore.members.length > 0) ? 
                chartDataStore.members : (currentMembers || []);
            
            if (!members || members.length === 0) {
                console.log('?ÔøΩÔ∏è ?ÔøΩÏö© Í∞Ä?ÔøΩÌïú Î©§Î≤Ñ ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                return;
            }
            
            // ?ÔøΩÏ≤¥ Î©§Î≤ÑÔø??Ôø?ÔøΩÏúºÔø??ÔøΩÎäî ?ÔøΩÎ°≠?ÔøΩÏö¥ Î™©Î°ù ?ÔøΩÏÑ±
            const allMembers = [];
            members.forEach(member => {
                const emailId = member.email.split('@')[0];
                allMembers.push({
                    id: emailId,
                    name: member.name,
                    email: member.email
                });
            });
            
            console.log(`?ÔøΩÔøΩ ?ÔøΩÏ≤¥ Î©§Î≤Ñ Î™©Î°ù ?ÔøΩÏÑ±: ${allMembers.length}Ôø?);
            
            // ?ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÏàò (?ÔøΩÏãúÔø??ÔøΩÌÑ∞Ôø?
            function updateDropdownOptions(searchTerm = '') {
                dropdown.innerHTML = '';
                
                // Í≤Ä?ÔøΩÏñ¥Í∞Ä ?ÔøΩÏúºÔø??ÔøΩÏ≤¥ Î©§Î≤Ñ ?ÔøΩÏãú (ÏµúÔøΩ? 50Ôø?
                if (searchTerm.trim() === '') {
                    const displayMembers = allMembers.slice(0, 50);
                    displayMembers.forEach(member => {
                        const option = createDropdownOption(member, '');
                        dropdown.appendChild(option);
                    });
                    return;
                }
                
                // Í≤Ä?ÔøΩÏñ¥Í∞Ä ?ÔøΩÏúºÔø??ÔøΩÌÑ∞ÎßÅÎêú Î©§Î≤ÑÔø??ÔøΩÏãú
                const filteredMembers = allMembers.filter(member => 
                    member.id.toLowerCase().includes(searchTerm.toLowerCase())
                );
                
                if (filteredMembers.length === 0) {
                    const noResult = document.createElement('div');
                    noResult.style.cssText = `
                        padding: 12px;
                        color: #7a7a7a;
                        text-align: center;
                        font-size: 14px;
                    `;
                    noResult.textContent = 'Í≤Ä??Í≤∞Í≥ºÍ∞Ä ?ÔøΩÏäµ?ÔøΩÎã§';
                    dropdown.appendChild(noResult);
                    return;
                }
                
                // ?ÔøΩÌÑ∞ÎßÅÎêú Í≤∞Í≥º??ÏµúÔøΩ? 30Í∞úÍπåÏßÄ ?ÔøΩÏãú
                const displayMembers = filteredMembers.slice(0, 30);
                
                displayMembers.forEach(member => {
                    const option = createDropdownOption(member, searchTerm);
                    dropdown.appendChild(option);
                });
            }
            
            // ?ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÏÖò ?ÔøΩÏÑ± ?ÔøΩÏàò
            function createDropdownOption(member, searchTerm) {
                const option = document.createElement('div');
                option.style.cssText = `
                    padding: 8px 12px;
                    cursor: pointer;
                    color: #e1e1e1;
                    border-bottom: 1px solid #3a3a3a;
                    transition: background-color 0.2s ease;
                `;
                
                // Í≤Ä?ÔøΩÏñ¥Í∞Ä ?ÔøΩÏúºÔø??ÔøΩÏù¥?ÔøΩÏù¥?? ?ÔøΩÏúºÔø??ÔøΩÎ∞ò ?ÔøΩÏãú
                let displayId = member.id;
                if (searchTerm && searchTerm.trim() !== '') {
                    displayId = member.id.replace(
                        new RegExp(searchTerm, 'gi'),
                        match => `<span style="background-color: #4a9eff; color: white; padding: 1px 2px; border-radius: 2px;">${match}</span>`
                    );
                }
                
                option.innerHTML = `
                    <div style="font-weight: 500; font-size: 14px;">${displayId}</div>
                    <div style="font-size: 12px; color: #7a7a7a;">${member.name} ??${member.email}</div>
                `;
                
                // ?ÔøΩÎ≤Ñ ?ÔøΩÍ≥º
                option.addEventListener('mouseenter', () => {
                    option.style.backgroundColor = '#3a3a3a';
                });
                option.addEventListener('mouseleave', () => {
                    option.style.backgroundColor = 'transparent';
                });
                
                // ?ÔøΩÎ¶≠ ?ÔøΩÎ≤§??                option.addEventListener('click', () => {
                    searchInput.value = member.id;
                    dropdown.style.display = 'none';
                    handleChartSearch(member.id);
                });
                
                return option;
            }
            
            // Í≤Ä???ÔøΩÎ†• Ïª®ÌÖå?ÔøΩÎÑà???ÔøΩÎ°≠?ÔøΩÏö¥ Ï∂îÔøΩ?
            const inputContainer = searchInput.parentElement;
            inputContainer.style.position = 'relative';
            inputContainer.appendChild(dropdown);
            
            // ?ÔøΩÎ†• ?ÔøΩÎ≤§?ÔøΩÎ°ú ?ÔøΩÏãúÔø??ÔøΩÌÑ∞Ôø?            searchInput.addEventListener('input', (e) => {
                const searchTerm = e.target.value;
                if (dropdown.style.display !== 'none') {
                    updateDropdownOptions(searchTerm);
                }
            });
            
            // ?ÔøΩÏª§???ÔøΩÎ≤§?ÔøΩÎ°ú ?ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÏãú
            searchInput.addEventListener('focus', () => {
                updateDropdownOptions(searchInput.value);
                dropdown.style.display = 'block';
            });
            
            // ?ÔøΩÎ≥¥???ÔøΩÎ≤§??Ï≤òÎ¶¨
            searchInput.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    dropdown.style.display = 'none';
                }
            });
            
            // Î∏îÎü¨ ?ÔøΩÎ≤§?ÔøΩÎ°ú ?ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÔøΩ?
            searchInput.addEventListener('blur', (e) => {
                setTimeout(() => {
                    if (!dropdown.contains(document.activeElement)) {
                        dropdown.style.display = 'none';
                    }
                }, 200);
            });
            
            console.log(`???ÔøΩÏ≤¥ Î©§Î≤Ñ ?Ôø???ÔøΩÏãúÔø??ÔøΩÌÑ∞Ôø??ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÏÑ± ?ÔøΩÎ£å: ${allMembers.length}Î™ÖÏùò ?ÔøΩÏö©??);
        }

        // Î™®Îç∏ ?ÔøΩÌò∏?ÔøΩÏö© Ïª§Ïä§?Ôø??ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÏÑ±
        function populateModelPreferenceDropdown() {
            console.log('?ÔøΩÔøΩ Î™®Îç∏ ?ÔøΩÌò∏?ÔøΩÏö© Ïª§Ïä§?Ôø??ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÏÑ± Ôø?..');
            
            const searchInput = document.getElementById('chart-search-input');
            if (!searchInput) {
                console.error('??chart-search-input ?ÔøΩÏÜåÔø?Ï∞æÏùÑ ???ÔøΩÏäµ?ÔøΩÎã§.');
                return;
            }
            
            // Í∏∞Ï°¥ Ïª§Ïä§?Ôø??ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÍ±∞
            const existingDropdown = document.getElementById('custom-model-preference-dropdown');
            if (existingDropdown) {
                existingDropdown.remove();
            }
            
            // ??Ïª§Ïä§?Ôø??ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÏÑ±
            const dropdown = document.createElement('div');
            dropdown.id = 'custom-model-preference-dropdown';
            dropdown.style.cssText = `
                position: absolute;
                top: calc(100% + 4px);
                left: 0;
                right: 0;
                background-color: #2a2a2a;
                border: 1px solid #3a3a3a;
                border-radius: 8px;
                max-height: 200px;
                overflow-y: auto;
                z-index: 1000;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
                display: none;
            `;
            
            // Î©§Î≤Ñ ?ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø?            const members = (chartDataStore.members && chartDataStore.members.length > 0) ? 
                chartDataStore.members : (currentMembers || []);
            
            if (!members || members.length === 0) {
                console.log('?ÔøΩÔ∏è ?ÔøΩÏö© Í∞Ä?ÔøΩÌïú Î©§Î≤Ñ ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                return;
            }
            
            // ?ÔøΩÏ≤¥ Î©§Î≤ÑÔø??Ôø?ÔøΩÏúºÔø??ÔøΩÎäî ?ÔøΩÎ°≠?ÔøΩÏö¥ Î™©Î°ù ?ÔøΩÏÑ±
            const allMembers = [];
            members.forEach(member => {
                const emailId = member.email.split('@')[0];
                allMembers.push({
                    id: emailId,
                    name: member.name,
                    email: member.email
                });
            });
            
            console.log(`?ÔøΩÔøΩ ?ÔøΩÏ≤¥ Î©§Î≤Ñ Î™©Î°ù ?ÔøΩÏÑ±: ${allMembers.length}Ôø?);
            
            // ?ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÏàò (?ÔøΩÏãúÔø??ÔøΩÌÑ∞Ôø?
            function updateDropdownOptions(searchTerm = '') {
                dropdown.innerHTML = '';
                
                // Í≤Ä?ÔøΩÏñ¥Í∞Ä ?ÔøΩÏúºÔø??ÔøΩÏ≤¥ Î©§Î≤Ñ ?ÔøΩÏãú (ÏµúÔøΩ? 50Ôø?
                if (searchTerm.trim() === '') {
                    const displayMembers = allMembers.slice(0, 50);
                    displayMembers.forEach(member => {
                        const option = createModelPreferenceDropdownOption(member, '');
                        dropdown.appendChild(option);
                    });
                    return;
                }
                
                // Í≤Ä?ÔøΩÏñ¥Í∞Ä ?ÔøΩÏúºÔø??ÔøΩÌÑ∞ÎßÅÎêú Î©§Î≤ÑÔø??ÔøΩÏãú
                const filteredMembers = allMembers.filter(member => 
                    member.id.toLowerCase().includes(searchTerm.toLowerCase())
                );
                
                if (filteredMembers.length === 0) {
                    const noResult = document.createElement('div');
                    noResult.style.cssText = `
                        padding: 12px;
                        color: #7a7a7a;
                        text-align: center;
                        font-size: 14px;
                    `;
                    noResult.textContent = 'Í≤Ä??Í≤∞Í≥ºÍ∞Ä ?ÔøΩÏäµ?ÔøΩÎã§';
                    dropdown.appendChild(noResult);
                    return;
                }
                
                // ?ÔøΩÌÑ∞ÎßÅÎêú Í≤∞Í≥º??ÏµúÔøΩ? 30Í∞úÍπåÏßÄ ?ÔøΩÏãú
                const displayMembers = filteredMembers.slice(0, 30);
                
                displayMembers.forEach(member => {
                    const option = createModelPreferenceDropdownOption(member, searchTerm);
                    dropdown.appendChild(option);
                });
            }
            
            // ?ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÏÖò ?ÔøΩÏÑ± ?ÔøΩÏàò
            function createModelPreferenceDropdownOption(member, searchTerm) {
                const option = document.createElement('div');
                option.style.cssText = `
                    padding: 8px 12px;
                    cursor: pointer;
                    color: #e1e1e1;
                    border-bottom: 1px solid #3a3a3a;
                    transition: background-color 0.2s ease;
                `;
                
                // Í≤Ä?ÔøΩÏñ¥Í∞Ä ?ÔøΩÏúºÔø??ÔøΩÏù¥?ÔøΩÏù¥?? ?ÔøΩÏúºÔø??ÔøΩÎ∞ò ?ÔøΩÏãú
                let displayId = member.id;
                if (searchTerm && searchTerm.trim() !== '') {
                    displayId = member.id.replace(
                        new RegExp(searchTerm, 'gi'),
                        match => `<span style="background-color: #4a9eff; color: white; padding: 1px 2px; border-radius: 2px;">${match}</span>`
                    );
                }
                
                option.innerHTML = `
                    <div style="font-weight: 500; font-size: 14px;">${displayId}</div>
                    <div style="font-size: 12px; color: #7a7a7a;">${member.name} ??${member.email}</div>
                `;
                
                // ?ÔøΩÎ≤Ñ ?ÔøΩÍ≥º
                option.addEventListener('mouseenter', () => {
                    option.style.backgroundColor = '#3a3a3a';
                });
                option.addEventListener('mouseleave', () => {
                    option.style.backgroundColor = 'transparent';
                });
                
                // ?ÔøΩÎ¶≠ ?ÔøΩÎ≤§??                option.addEventListener('click', () => {
                    searchInput.value = member.id;
                    dropdown.style.display = 'none';
                    handleChartSearch(member.id);
                });
                
                return option;
            }
            
            // Í≤Ä???ÔøΩÎ†• Ïª®ÌÖå?ÔøΩÎÑà???ÔøΩÎ°≠?ÔøΩÏö¥ Ï∂îÔøΩ?
            const inputContainer = searchInput.parentElement;
            inputContainer.style.position = 'relative';
            inputContainer.appendChild(dropdown);
            
            // ?ÔøΩÎ†• ?ÔøΩÎ≤§?ÔøΩÎ°ú ?ÔøΩÏãúÔø??ÔøΩÌÑ∞Ôø?            searchInput.addEventListener('input', (e) => {
                const searchTerm = e.target.value;
                if (dropdown.style.display !== 'none') {
                    updateDropdownOptions(searchTerm);
                }
            });
            
            // ?ÔøΩÏª§???ÔøΩÎ≤§?ÔøΩÎ°ú ?ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÏãú
            searchInput.addEventListener('focus', () => {
                updateDropdownOptions(searchInput.value);
                dropdown.style.display = 'block';
            });
            
            // ?ÔøΩÎ≥¥???ÔøΩÎ≤§??Ï≤òÎ¶¨
            searchInput.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    dropdown.style.display = 'none';
                }
            });
            
            // Î∏îÎü¨ ?ÔøΩÎ≤§?ÔøΩÎ°ú ?ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÔøΩ?
            searchInput.addEventListener('blur', (e) => {
                setTimeout(() => {
                    if (!dropdown.contains(document.activeElement)) {
                        dropdown.style.display = 'none';
                    }
                }, 200);
            });
            
            console.log(`??Î™®Îç∏ ?ÔøΩÌò∏?ÔøΩÏö© ?ÔøΩÏãúÔø??ÔøΩÌÑ∞Ôø??ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÏÑ± ?ÔøΩÎ£å: ${allMembers.length}Î™ÖÏùò ?ÔøΩÏö©??);
        }

        // ?ÔøΩÏ†ï ?ÔøΩÏö©?ÔøΩÏùò Î™®Îç∏ ?ÔøΩÏö©??Ï∞®Ìä∏ ?ÔøΩÏÑ± (ÎßâÔøΩ? Í∑∏Îûò??
        function createFilteredModelPreferenceChart(userId) {
            console.log('?ÔøΩÔøΩ createFilteredModelPreferenceChart ?ÔøΩÏûë:', userId);
            
            const canvas = document.getElementById('modelPreferenceChart');
            if (!canvas) return;
            
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = 300;
            
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, width, height);
            
            // ?ÔøΩÏ†ï ?ÔøΩÏö©?ÔøΩÏùò Î™®Îç∏ ?ÔøΩÏö©???ÔøΩÏù¥???ÔøΩÏÑ±
            const userModelData = generateUserModelUsageData(userId);
            
            if (!userModelData || userModelData.length === 0) {
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(`${userId}??Î™®Îç∏ ?ÔøΩÏö© ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.`, width / 2, height / 2);
                return;
            }
            
            // ÎßâÔøΩ? Í∑∏Îûò??Í∑∏Î¶¨Ôø?            drawUserModelBarChart(ctx, width, height, userModelData, userId);
        }

        // ?ÔøΩÏ†ï ?ÔøΩÏö©?ÔøΩÏùò Î™®Îç∏ ?ÔøΩÏö©???ÔøΩÏù¥???ÔøΩÏÑ±
        function generateUserModelUsageData(userId) {
            console.log('?ÔøΩÔøΩ generateUserModelUsageData ?ÔøΩÏûë:', userId);
            
            const members = (chartDataStore.members && chartDataStore.members.length > 0) ? 
                chartDataStore.members : (currentMembers || []);
            const rawEvents = (chartDataStore.rawEvents && chartDataStore.rawEvents.length > 0) ? 
                chartDataStore.rawEvents : (currentRawEventsData || []);
            
            if (!members || members.length === 0 || !rawEvents || rawEvents.length === 0) {
                console.log('?ÔøΩÔ∏è ?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂ÄÏ°±Ìï©?ÔøΩÎã§.');
                return [];
            }
            
            // ?ÔøΩÏö©??Ï∞æÍ∏∞
            const user = members.find(member => {
                const emailId = member.email.split('@')[0];
                return emailId.toLowerCase() === userId.toLowerCase();
            });
            
            if (!user) {
                console.log('?ÔøΩÔ∏è ?ÔøΩÏö©?ÔøΩÔøΩ? Ï∞æÏùÑ ???ÔøΩÏäµ?ÔøΩÎã§.');
                return [];
            }
            
            // ?ÔøΩÎãπ ?ÔøΩÏö©?ÔøΩÏùò ?ÔøΩÎ≤§???ÔøΩÌÑ∞Ôø?            const userEvents = rawEvents.filter(event => 
                event.userEmail === user.email || event.email === user.email
            );
            
            // Î™®Îç∏Ôø??ÔøΩÏö© ?ÔøΩÏàò Í≥ÑÏÇ∞
            const modelUsage = new Map();
            userEvents.forEach(event => {
                const model = event.model || 'unknown';
                modelUsage.set(model, (modelUsage.get(model) || 0) + 1);
            });
            
            // Î∞∞Ïó¥Ôø?Î≥Ä??Ôø??ÔøΩÏö© ?ÔøΩÏàò ?ÔøΩÏúºÔø??ÔøΩÎ†¨
            const data = Array.from(modelUsage.entries())
                .map(([model, count]) => ({ model, count }))
                .sort((a, b) => b.count - a.count);
            
            console.log(`?ÔøΩÔøΩ ${userId}??Î™®Îç∏ ?ÔøΩÏö©???ÔøΩÏù¥??`, data);
            return data;
        }

        // ?ÔøΩÏö©?ÔøΩÎ≥Ñ Î™®Îç∏ ?ÔøΩÏö©??ÎßâÔøΩ? Í∑∏Îûò??Í∑∏Î¶¨Ôø?(Î™®Îç∏ ?ÔøΩÏö© Î∂ÑÌè¨ ?ÔøΩÔøΩ???
        function drawUserModelBarChart(ctx, width, height, data, userId) {
            console.log('?ÔøΩÔøΩ drawUserModelBarChart ?ÔøΩÏûë...');
            console.log('?ÔøΩÔøΩ ?ÔøΩÎ†• ?ÔøΩÏù¥??', data);
            console.log('?ÔøΩÔøΩ Ï∫îÎ≤Ñ???ÔøΩÍ∏∞:', width, 'x', height);
            
            if (data.length === 0) {
                console.log('?ÔøΩÔ∏è ?ÔøΩÏù¥?ÔøΩÔøΩ? ÎπÑÏñ¥?ÔøΩÏñ¥ Î°úÎî© Î©îÏãúÏßÄÔø??ÔøΩÏãú?ÔøΩÎãà??');
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('?ÔøΩÏù¥?ÔøΩÔøΩ? Î∂àÎü¨?ÔøΩÎäî Ôø?..', width / 2, height / 2);
                return;
            }
            
            const padding = 60;
            const chartWidth = width - (padding * 2);
            const chartHeight = height - (padding * 2);
            const barWidth = chartWidth / data.length * 0.8;
            const barSpacing = chartWidth / data.length * 0.2;
            
            // ÏµúÔøΩ?Ôø?Í≥ÑÏÇ∞
            const maxValue = Math.max(...data.map(d => d.count));
            
            // YÔø?Í∑∏Î¶¨Ôø?            ctx.strokeStyle = '#3a3a3a';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, height - padding);
            ctx.stroke();
            
            // XÔø?Í∑∏Î¶¨Ôø?            ctx.beginPath();
            ctx.moveTo(padding, height - padding);
            ctx.lineTo(width - padding, height - padding);
            ctx.stroke();
            
            // YÔø??ÔøΩÏù¥Ôø?            ctx.fillStyle = '#7a7a7a';
            ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'right';
            ctx.textBaseline = 'middle';
            
            const ySteps = 5;
            for (let i = 0; i <= ySteps; i++) {
                const y = padding + (chartHeight / ySteps) * i;
                const value = Math.round((maxValue / ySteps) * (ySteps - i));
                ctx.fillText(value.toString(), padding - 10, y);
            }
            
            // ÎßâÔøΩ? Í∑∏Î¶¨Ôø?(?ÔøΩÏñë???ÔøΩÏÉÅ)
            const colors = ['#4a9eff', '#4caf50', '#ff9800', '#f44336', '#9c27b0', '#00bcd4', '#ff5722', '#795548', '#607d8b', '#e91e63'];
            
            data.forEach((item, index) => {
                const x = padding + (chartWidth / data.length) * index + barSpacing / 2;
                const barHeight = (item.count / maxValue) * chartHeight;
                const y = height - padding - barHeight;
                
                // ÎßâÔøΩ? Í∑∏Î¶¨Ôø?(?ÔøΩÏñë???ÔøΩÏÉÅ)
                ctx.fillStyle = colors[index % colors.length];
                ctx.fillRect(x, y, barWidth, barHeight);
                
                // ÎßâÔøΩ? ?ÔøΩÏóê Ôø??ÔøΩÏãú
                ctx.fillStyle = '#e1e1e1';
                ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(item.count.toString(), x + barWidth / 2, y - 10);
                
                // XÔø??ÔøΩÏù¥Ôø?(Î™®Îç∏Ôø?
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '11px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                const modelName = item.model.length > 12 ? item.model.substring(0, 12) + '...' : item.model;
                ctx.fillText(modelName, x + barWidth / 2, height - padding + 20);
            });
            
            // ?ÔøΩÎ™©
            ctx.fillStyle = '#e1e1e1';
            ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText(`${userId}??Î™®Îç∏ ?ÔøΩÏö©??, width / 2, 25);
            
            // YÔø??ÔøΩÎ™©
            ctx.fillStyle = '#7a7a7a';
            ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'center';
            ctx.save();
            ctx.translate(20, height / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText('?ÔøΩÏö© ?ÔøΩÏàò', 0, 0);
            ctx.restore();
        }

        // ?ÔøΩÎü¨ ?ÔøΩÏö©??Î™®Îç∏ ?ÔøΩÌò∏??Ï∞®Ìä∏ ?ÔøΩÏÑ± (Î∂ÄÔø?Í≤Ä??Í≤∞Í≥º)
        function createMultiUserModelPreferenceChart(filteredUsers) {
            console.log('?ÔøΩÔøΩ createMultiUserModelPreferenceChart ?ÔøΩÏûë:', filteredUsers.length, 'Ôø?);
            
            const canvas = document.getElementById('modelPreferenceChart');
            if (!canvas) return;
            
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = 300;
            
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, width, height);
            
            // ?ÔøΩÌÑ∞???ÔøΩÏö©?ÔøΩÎì§??Î™®Îç∏ ?ÔøΩÌò∏???ÔøΩÏù¥???ÔøΩÏÑ±
            const preferenceData = generateFilteredModelPreferenceData(filteredUsers);
            
            if (preferenceData.size === 0) {
                ctx.fillStyle = '#7a7a7a';
                ctx.font = '16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('Î™®Îç∏ ?ÔøΩÌò∏???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.', width / 2, height / 2);
                return;
            }
            
            // ?ÔøΩÌÉù Ôø?Ï∞®Ìä∏ Í∑∏Î¶¨Ôø?            drawStackedBarChart(ctx, width, height, preferenceData);
        }

        // ?ÔøΩÌÑ∞???ÔøΩÏö©?ÔøΩÎì§??Î™®Îç∏ ?ÔøΩÌò∏???ÔøΩÏù¥???ÔøΩÏÑ±
        function generateFilteredModelPreferenceData(filteredUsers) {
            console.log('?ÔøΩÔøΩ generateFilteredModelPreferenceData ?ÔøΩÏûë:', filteredUsers.length, 'Ôø?);
            
            const rawEvents = (chartDataStore.rawEvents && chartDataStore.rawEvents.length > 0) ? 
                chartDataStore.rawEvents : (currentRawEventsData || []);
            
            if (!rawEvents || rawEvents.length === 0) {
                console.log('?ÔøΩÔ∏è ?ÔøΩÎ≤§???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                return new Map();
            }
            
            // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÎèô Ôø?Î™®Îç∏ ?ÔøΩÏö©??Í≥ÑÏÇ∞
            const userActivityData = [];
            filteredUsers.forEach(member => {
                const userEmail = member.email;
                const userId = userEmail.split('@')[0];
                
                const userEvents = rawEvents.filter(event => 
                    event.userEmail === userEmail || event.email === userEmail
                );
                
                // ?ÔøΩÎèô???ÔøΩÎäî ?ÔøΩÏö©?ÔøΩÎäî ?ÔøΩÏô∏
                if (userEvents.length === 0) {
                    return;
                }
                
                const modelUsage = new Map();
                userEvents.forEach(event => {
                    const model = event.model || 'unknown';
                    modelUsage.set(model, (modelUsage.get(model) || 0) + 1);
                });
                
                userActivityData.push({
                    userId: userId,
                    email: userEmail,
                    totalActivity: userEvents.length,
                    modelUsage: modelUsage
                });
            });
            
            // ?ÔøΩÎèô ?ÔøΩÎ°ú ?ÔøΩÎ†¨?ÔøΩÏó¨ ?ÔøΩÏúÑ 20Ôø??ÔøΩÌÉù
            const sortedUsers = userActivityData
                .sort((a, b) => b.totalActivity - a.totalActivity)
                .slice(0, 20);
            
            // Map ?ÔøΩÌÉúÔø?Î≥Ä??            const userModelPreference = new Map();
            sortedUsers.forEach(user => {
                userModelPreference.set(user.userId, user.modelUsage);
            });
            
            console.log(`?ÔøΩÔøΩ ?ÔøΩÌÑ∞??Î™®Îç∏ ?ÔøΩÌò∏???ÔøΩÏù¥???ÔøΩÏÑ± ?ÔøΩÎ£å: ${userModelPreference.size}Î™ÖÏùò ?ÔøΩÏÑ± ?ÔøΩÏö©??);
            return userModelPreference;
        }

        // Usage ?ÔøΩÏÖò ?ÔøΩÏû¨ ?ÔøΩÌÑ∞Ôø??ÔøΩÎç∞?ÔøΩÌä∏
        async function updateUsageWithCurrentFilter(days = 30, showLoading = true) {
            try {
                // ?ÔøΩÔøΩ? Î°úÎî© Ï§ëÏù¥Ôø?Ï§ëÎ≥µ ?ÔøΩÌñâ Î∞©ÔøΩ?
                if (isUsageLoading) {
                    console.log('?ÔøΩÔ∏è Usage ?ÔøΩÏù¥??Î°úÎî© Ôø?- Ï§ëÎ≥µ ?ÔøΩÌñâ Î∞©ÔøΩ?');
                    return;
                }
                
                console.log(`=== Usage ?ÔøΩÏÖò ${days}???ÔøΩÌÑ∞Ôø??ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÏûë (Î°úÎî© ?ÔøΩÏãú: ${showLoading}) ===`);
                
                isUsageLoading = true;
                
                // ?ÔøΩÏßú Î≤îÏúÑ Í≥ÑÏÇ∞
                const dateRange = getDateRange(days);
                currentUsageDateRange = null; // ?ÔøΩÏö©???ÔøΩÏùò Î≤îÏúÑ Ï¥àÍ∏∞??                
                // ?ÔøΩÌÑ∞ Í∏∞Í∞Ñ ?ÔøΩÏãú ?ÔøΩÎç∞?ÔøΩÌä∏
                updateUsageFilterPeriodDisplay(dateRange.startDate, dateRange.endDate);
                
                await updateUsageWithDateRange(dateRange.startDate, dateRange.endDate, showLoading);
                
                // Ôø?Î≤àÏß∏ Î°úÎî© ?ÔøΩÎ£å ?ÔøΩÏãú
                if (showLoading) {
                    isUsageDataLoaded = true;
                }
                
                isUsageLoading = false;
                console.log(`=== Usage ?ÔøΩÏÖò ${days}???ÔøΩÌÑ∞ ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÎ£å ===`);
            } catch (error) {
                console.error('??Usage ?ÔøΩÌÑ∞ ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÌå®:', error);
                isUsageLoading = false;
            }
        }

        // Usage ?ÔøΩÏÖò ?ÔøΩÏ†ï ?ÔøΩÏßú Î≤îÏúÑÔø??ÔøΩÎç∞?ÔøΩÌä∏
        async function updateUsageWithDateRange(startDate, endDate, showLoading = true) {
            try {
                console.log(`=== Usage ?ÔøΩÏÖò ?ÔøΩÏßú Î≤îÏúÑ ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÏûë: ${new Date(startDate).toLocaleDateString()} ~ ${new Date(endDate).toLocaleDateString()} (Î°úÎî© ?ÔøΩÏãú: ${showLoading}) ===`);
                
                // Î°úÎî© ?ÔøΩÌÉú ?ÔøΩÏãú (Ôø?Î≤àÏß∏ Î°úÎî©?ÔøΩÎßå)
                if (showLoading) {
                    showUsageLoadingState(true);
                }
                
                // API ?ÔøΩÏù¥??Í∞Ä?ÔøΩÏò§Ôø?                const [membersData, eventsData, usageData, spendingData] = await Promise.all([
                    getTeamMembers(),
                    getFilteredEvents(startDate, endDate),
                    getUsageData(startDate, endDate),
                    getTeamSpendingData()
                ]);
                
                // Usage Ïπ¥Îìú ?ÔøΩÎç∞?ÔøΩÌä∏
                updateUsageCards(usageData, eventsData);
                
                // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥ ?ÔøΩÎç∞?ÔøΩÌä∏
                updateUserCumulativeInfo(membersData, eventsData, spendingData, startDate, endDate);
                
                // All Raw Events ?ÔøΩÎç∞?ÔøΩÌä∏ (?ÔøΩÏù¥ÏßÄ Ï¥àÍ∏∞??
                currentRawEventsPage = 1;
                updateRawEventsTable(eventsData);
                
                // Î°úÎî© ?ÔøΩÌÉú ?ÔøΩÏ†ú (Ôø?Î≤àÏß∏ Î°úÎî©?ÔøΩÎßå)
                if (showLoading) {
                    showUsageLoadingState(false);
                }
                
                console.log(`=== Usage ?ÔøΩÏÖò ?ÔøΩÏßú Î≤îÏúÑ ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÎ£å ===`);
            } catch (error) {
                console.error('??Usage ?ÔøΩÏßú Î≤îÏúÑ ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÌå®:', error);
                if (showLoading) {
                    showUsageLoadingState(false);
                }
            }
        }

        // Usage Î°úÎî© ?ÔøΩÌÉú ?ÔøΩÏãú/?ÔøΩÏ†ú
        function showUsageLoadingState(isLoading) {
            const usageCards = document.querySelectorAll('#usage .usage-card-number');
            const userTables = document.querySelectorAll('#usage .user-cumulative-info');
            
            if (isLoading) {
                usageCards.forEach(card => {
                    card.textContent = '-';
                });
                userTables.forEach(table => {
                    table.style.opacity = '0.5';
                });
            } else {
                userTables.forEach(table => {
                    table.style.opacity = '1';
                });
            }
        }

        // Usage Ïπ¥Îìú ?ÔøΩÎç∞?ÔøΩÌä∏ (Overview?Ôø?Usage ?ÔøΩÏÖò Î™®Îëê)
        function updateUsageCards(usageData, eventsData) {
            // Overview ?ÔøΩÏÖòÔø?Usage ?ÔøΩÏÖò Î™®Îëê??Ïπ¥ÎìúÔø?Ï∞æÏùå
            const overviewCards = document.querySelectorAll('#overview .usage-card-number');
            const usageCards = document.querySelectorAll('#usage .usage-card-number');
            const allCards = [...overviewCards, ...usageCards];
            
            if (!usageData || !usageData.data) {
                allCards.forEach((card, index) => {
                    const cardIndex = index % 4; // 4Ôø?Ïπ¥Îìú Î∞òÎ≥µ
                    card.textContent = '0';
                });
                console.log('?ÔøΩÔøΩ Usage Ïπ¥Îìú ?ÔøΩÎç∞?ÔøΩÌä∏: ?ÔøΩÏù¥???ÔøΩÏùå - Î™®Îì† Í∞íÏùÑ 0?ÔøΩÎ°ú ?ÔøΩÏ†ï');
                return;
            }
            
            // ?ÔøΩÏ†ú ?ÔøΩÎèô???ÔøΩÏö©????Í≥ÑÏÇ∞
            const activeUsers = new Set();
            if (eventsData && eventsData.usageEvents) {
                eventsData.usageEvents.forEach(event => {
                    if (event.userEmail && event.requestsCosts > 0) {
                        activeUsers.add(event.userEmail);
                    }
                });
            }
            
            // ÏßëÍ≥Ñ Í≥ÑÏÇ∞
            let totalLinesAdded = 0;
            let totalLinesAccepted = 0;
            let totalTabsAccepted = 0;
            let totalChats = 0;
            
            usageData.data.forEach(dayData => {
                totalLinesAdded += (dayData.totalLinesAdded || 0);
                totalLinesAccepted += (dayData.acceptedLinesAdded || 0);
                totalTabsAccepted += (dayData.totalTabsAccepted || 0);
                totalChats += (dayData.chatRequests || 0);
            });
            
            // Ïπ¥Îìú ?ÔøΩÎç∞?ÔøΩÌä∏ (Overview?Ôø?Usage ?ÔøΩÏÖò Î™®Îëê)
            const values = [
                activeUsers.size.toLocaleString(), // Total Users
                (totalLinesAdded + totalLinesAccepted).toLocaleString(), // Lines of Agent Edits
                totalTabsAccepted.toLocaleString(), // Tabs Accepted
                totalChats.toLocaleString() // Chats
            ];
            
            allCards.forEach((card, index) => {
                const cardIndex = index % 4; // 4Ôø?Ïπ¥Îìú Î∞òÎ≥µ
                card.textContent = values[cardIndex];
            });
            
            console.log(`Usage Ïπ¥Îìú ?ÔøΩÎç∞?ÔøΩÌä∏: ?ÔøΩÏö©??${activeUsers.size}Ôø? ?ÔøΩÏù∏ ${totalLinesAdded + totalLinesAccepted}Ôø? ??${totalTabsAccepted}Ôø? Ï±ÑÌåÖ ${totalChats}Ôø?);
        }

        // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥ ?ÔøΩÏù¥Ôø??ÔøΩÎçîÔø?(All Raw Events ?ÔøΩÔøΩ???
        function renderUserCumulativeTableWithPagination(userInfos, startDate, endDate) {
            console.log('?ÔøΩÔøΩ renderUserCumulativeTableWithPagination ?ÔøΩÏàò ?ÔøΩÏ∂ú??);
            console.log('?ÔøΩÔøΩ ?ÔøΩÎçîÔø??ÔøΩÏù¥??', {
                userInfos: userInfos ? `${userInfos.length}Ôø? : 'null',
                startDate: startDate,
                endDate: endDate
            });
            
            // ?ÔøΩÎçî ?ÔøΩÎç∞?ÔøΩÌä∏
            const headerElement = document.querySelector('.user-cumulative-info .user-cumulative-header');
            if (headerElement) {
                if (!userInfos || userInfos.length === 0) {
                    headerElement.innerHTML = '?ÔøΩÔøΩ ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥';
                } else {
                    const totalUsers = userInfos.length;
                    const totalPages = Math.ceil(totalUsers / currentUserCumulativePageSize);
                    const startIndex = (currentUserCumulativePage - 1) * currentUserCumulativePageSize;
                    const endIndex = Math.min(startIndex + currentUserCumulativePageSize, totalUsers);
                    
                    // ?ÔøΩÏßú ?ÔøΩÏãù Î≥ÄÔø?(?ÔøΩÏßú ?ÔøΩÏùò "." ?ÔøΩÍ±∞)
                    const cleanStartDate = new Date(startDate).toLocaleDateString('ko-KR').replace(/\.$/, '');
                    const cleanEndDate = new Date(endDate).toLocaleDateString('ko-KR').replace(/\.$/, '');
                    
                    headerElement.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span>?ÔøΩÔøΩ ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥ (${cleanStartDate} ~ ${cleanEndDate})(${startIndex + 1}-${endIndex} of ${totalUsers})</span>
                            <select id="userCumulativePageSize" onchange="changeUserCumulativePageSize(this.value)" style="background: #3a3a3a; color: #fff; border: 1px solid #4a4a4a; padding: 5px 10px; border-radius: 4px; font-size: 12px;">
                                <option value="10" ${currentUserCumulativePageSize === 10 ? 'selected' : ''}>10Ôø?Î≥¥Í∏∞</option>
                                <option value="20" ${currentUserCumulativePageSize === 20 ? 'selected' : ''}>20Ôø?Î≥¥Í∏∞</option>
                                <option value="30" ${currentUserCumulativePageSize === 30 ? 'selected' : ''}>30Ôø?Î≥¥Í∏∞</option>
                                <option value="50" ${currentUserCumulativePageSize === 50 ? 'selected' : ''}>50Ôø?Î≥¥Í∏∞</option>
                                <option value="100" ${currentUserCumulativePageSize === 100 ? 'selected' : ''}>100Ôø?Î≥¥Í∏∞</option>
                            </select>
                        </div>
                    `;
                }
            }
            
            if (!userInfos || userInfos.length === 0) {
                const container = document.getElementById('user-cumulative-container');
                if (container) {
                    container.innerHTML = `
                        <div style="padding: 20px; text-align: center; color: #7a7a7a; background-color: #1a1a1a;">
                            ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.
                        </div>
                    `;
                }
                // ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥???ÔøΩÍ∏∞Ôø?                const pagination = document.getElementById('user-cumulative-pagination');
                if (pagination) pagination.style.display = 'none';
                return;
            }
            
            // ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥??Í≥ÑÏÇ∞
            const totalUsers = userInfos.length;
            const totalPages = Math.ceil(totalUsers / currentUserCumulativePageSize);
            const startIndex = (currentUserCumulativePage - 1) * currentUserCumulativePageSize;
            const endIndex = Math.min(startIndex + currentUserCumulativePageSize, totalUsers);
            const pageUsers = userInfos.slice(startIndex, endIndex);

            console.log(`?ÔøΩÔøΩ ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥?? ${startIndex + 1}-${endIndex} of ${totalUsers} (?ÔøΩÏù¥ÏßÄ ${currentUserCumulativePage}/${totalPages})`);
            
            // ?ÔøΩÏù¥Ôø??ÔøΩÏö©Ôø??ÔøΩÎç∞?ÔøΩÌä∏
            const tableContent = pageUsers.map(user => `
                <div class="user-cumulative-row">
                    <div>${user.name}</div>
                    <div class="user-email clickable-email" title="View usage for ${user.email}" onclick="navigateToUsageWithEmail('${user.email}')">${user.email}</div>
                    <div><span class="role-badge ${user.role === 'owner' ? 'admin' : ''}">${user.role === 'owner' ? 'Admin' : 'Member'}</span></div>
                    <div style="font-weight: 600;">${user.periodRequests}</div>
                    <div>$${user.spend.toFixed(2)}</div>
                    <div>${user.lastActivity}</div>
                </div>
            `).join('');
            
            // Ïª®ÌÖå?ÔøΩÎÑà???ÔøΩÏù¥Ôø??ÔøΩÏö©Ôø??ÔøΩÏûÖ
            const container = document.getElementById('user-cumulative-container');
            if (container) {
                container.innerHTML = tableContent;
            }

            // ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥???ÔøΩÎç∞?ÔøΩÌä∏
            const paginationContainer = document.getElementById('user-cumulative-pagination');
            if (paginationContainer && totalPages > 1) {
                paginationContainer.innerHTML = generateUserCumulativePagination(totalPages);
                paginationContainer.style.display = 'block';
            } else if (paginationContainer) {
                paginationContainer.style.display = 'none';
            }
            
            console.log('???ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥ ?ÔøΩÏù¥Ôø?HTML ?ÔøΩÎçîÔø??ÔøΩÎ£å');
            console.log(`?ÔøΩÔøΩ ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥ ?ÔøΩÎç∞?ÔøΩÌä∏: Ôø?${userInfos.length}Ôø?(?ÔøΩÏù¥ÏßÄ ${currentUserCumulativePage}/${totalPages})`);
        }
        

        
        // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥ ?ÔøΩÏù¥ÏßÄ Î≥ÄÔø?(All Raw Events ?ÔøΩÔøΩ???
        function changeUserCumulativePage(page) {
            currentUserCumulativePage = page;
            renderUserCumulativeTableWithPagination(currentUserCumulativeData, currentUserCumulativeStartDate, currentUserCumulativeEndDate);
        }
        
        // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥ ?ÔøΩÏù¥ÏßÄ ?ÔøΩÍ∏∞ Î≥ÄÔø?(All Raw Events ?ÔøΩÔøΩ???
        function changeUserCumulativePageSize(pageSize) {
            currentUserCumulativePageSize = parseInt(pageSize);
            currentUserCumulativePage = 1; // ?ÔøΩÏù¥ÏßÄ ?ÔøΩÍ∏∞ Î≥ÄÍ≤ΩÏãú Ôø??ÔøΩÏù¥ÏßÄÔø??ÔøΩÎèô
            renderUserCumulativeTableWithPagination(currentUserCumulativeData, currentUserCumulativeStartDate, currentUserCumulativeEndDate);
        }

        // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥ ?ÔøΩÎç∞?ÔøΩÌä∏
        function updateUserCumulativeInfo(membersData, eventsData, spendingData, startDate, endDate) {
            console.log('?ÔøΩÔøΩ updateUserCumulativeInfo ?ÔøΩÏàò ?ÔøΩÏ∂ú??);
            console.log('?ÔøΩÔøΩ ?ÔøΩÎã¨Î∞õÔøΩ? ?ÔøΩÏù¥??', {
                membersData: membersData ? `${membersData.teamMembers?.length || 0}Ôø? : 'null',
                eventsData: eventsData ? `${eventsData.usageEvents?.length || 0}Ôø??ÔøΩÎ≤§?? : 'null',
                spendingData: spendingData ? `${spendingData.teamMemberSpend?.length || 0}Ôø?ÏßÄÔø? : 'null',
                startDate: startDate,
                endDate: endDate
            });
            
            if (!membersData || !membersData.teamMembers) {
                console.log('?ÔøΩÔ∏è ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥: Î©§Î≤Ñ ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                console.log('?ÔøΩÏÑ∏ ?ÔøΩÎ≥¥:', {
                    membersData: !!membersData,
                    teamMembers: membersData?.teamMembers?.length || 0
                });
                return;
            }
            
            console.log('=== ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥ ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÏûë ===');
            
            // ÏßÄÔø??ÔøΩÏù¥??Îß§Ìïë
            const memberSpendMap = {};
            if (spendingData && spendingData.teamMemberSpend) {
                spendingData.teamMemberSpend.forEach(spendInfo => {
                    memberSpendMap[spendInfo.email] = {
                        premiumRequests: spendInfo.fastPremiumRequests || 0,
                        spend: (spendInfo.spendCents || 0) / 100,
                        hardLimitOverride: spendInfo.hardLimitOverrideDollars || 0
                    };
                });
            }
            
            // ?ÔøΩÌÉù??Í∏∞Í∞Ñ ???ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÎèô ?ÔøΩÍ≥Ñ Í≥ÑÏÇ∞
            const userPeriodStats = {};
            if (eventsData && eventsData.usageEvents) {
                eventsData.usageEvents.forEach(event => {
                    const userEmail = event.userEmail;
                    const timestamp = parseInt(event.timestamp);
                    
                    if (!userPeriodStats[userEmail]) {
                        userPeriodStats[userEmail] = {
                            lastTimestamp: timestamp,
                            periodRequests: 0
                        };
                    }
                    
                    // ÎßàÔøΩ?Ôø??ÔøΩÎèô ?ÔøΩÍ∞Ñ ?ÔøΩÎç∞?ÔøΩÌä∏
                    if (timestamp > userPeriodStats[userEmail].lastTimestamp) {
                        userPeriodStats[userEmail].lastTimestamp = timestamp;
                    }
                    
                    // ?ÔøΩÌÉù??Í∏∞Í∞Ñ ???ÔøΩÏ≤≠ ÎπÑÏö© ?ÔøΩÏ†Å (All Raw Events??COSTÍ∞íÍ≥º ?ÔøΩÏùº)
                    const requestCost = event.requestsCosts || 0;
                    userPeriodStats[userEmail].periodRequests += requestCost;
                    
                    // ?ÔøΩÎ≤ÑÍπÖÏùÑ ?ÔøΩÌïú Î°úÍ∑∏ (Ï≤òÏùå 5Ôø??ÔøΩÎ≤§?ÔøΩÎßå)
                    if (Object.keys(userPeriodStats).length <= 5 && userPeriodStats[userEmail].periodRequests <= requestCost * 3) {
                        console.log(`?ÔøΩÔøΩ ${userEmail}: +${requestCost} (?ÔøΩÏ†Å: ${userPeriodStats[userEmail].periodRequests})`);
                    }
                });
            }
            
            // ?ÔøΩÏö©???ÔøΩÎ≥¥ ?ÔøΩÏÑ±
            const userInfos = membersData.teamMembers.map(member => {
                const spendData = memberSpendMap[member.email] || {};
                const periodStats = userPeriodStats[member.email] || {};
                const actualSpend = spendData.spend || 0;
                const totalPremiumRequests = spendData.premiumRequests || 0; // ?ÔøΩÏ≤¥ Í∏∞Í∞Ñ Premium Requests
                const periodRequests = periodStats.periodRequests || 0; // ?ÔøΩÌÉù??Í∏∞Í∞Ñ ???ÔøΩÏ≤≠ ??                
                // ÎßàÔøΩ?Ôø??ÔøΩÎèô ?ÔøΩÏßú Í≥ÑÏÇ∞
                let lastActivityText = 'No Activity';
                if (periodStats.lastTimestamp) {
                    const lastDate = new Date(periodStats.lastTimestamp);
                    const today = new Date();
                    const daysDiff = Math.floor((today - lastDate) / (1000 * 60 * 60 * 24));
                    
                    if (daysDiff === 0) {
                        lastActivityText = '?ÔøΩÎäò';
                    } else if (daysDiff === 1) {
                        lastActivityText = '?ÔøΩÏ†ú';
                    } else {
                        lastActivityText = `${daysDiff}????;
                    }
                }
                
                return {
                    name: member.name || 'Unnamed',
                    email: member.email,
                    role: member.role,
                    totalPremiumRequests: totalPremiumRequests, // ?ÔøΩÏ≤¥ Premium Requests
                    periodRequests: periodRequests, // ?ÔøΩÌÉù??Í∏∞Í∞Ñ ???ÔøΩÏ≤≠ ??                    spend: actualSpend,
                    lastActivity: lastActivityText,
                    lastTimestamp: periodStats.lastTimestamp || 0
                };
            });
            
            // 1. Last Act ÏµúÏã†?? 2. Request Í∏∞ÔøΩ? ?ÔøΩÎ¶ºÏ∞®Ïàú?ÔøΩÎ°ú ?ÔøΩÎ†¨
            userInfos.sort((a, b) => {
                // 1Ôø??ÔøΩÎ†¨: Last Act (ÎßàÔøΩ?Ôø??ÔøΩÎèô) ÏµúÏã†??- timestamp Í∏∞ÔøΩ? ?ÔøΩÎ¶ºÏ∞®Ïàú
                if (b.lastTimestamp !== a.lastTimestamp) {
                    return b.lastTimestamp - a.lastTimestamp;
                }
                // 2Ôø??ÔøΩÎ†¨: Request Í∏∞ÔøΩ? ?ÔøΩÎ¶ºÏ∞®Ïàú
                return b.periodRequests - a.periodRequests;
            });
            
            // ?ÔøΩÏù¥???Ôø??Ôø??ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥???ÔøΩÏö©
            currentUserCumulativeData = userInfos;
            currentUserCumulativeStartDate = startDate;
            currentUserCumulativeEndDate = endDate;
            currentUserCumulativePage = 1; // Ôø??ÔøΩÏù¥ÏßÄÔø?Î¶¨ÏÖã
            
            // ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥???ÔøΩÏö©
            renderUserCumulativeTableWithPagination(userInfos, startDate, endDate);
            
            console.log(`?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥ ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÎ£å: ${userInfos.length}Ôø?);
            console.log(`?ÔøΩÌÉù??Í∏∞Í∞Ñ ??Ôø??ÔøΩÏ≤≠ ?? ${userInfos.reduce((sum, user) => sum + user.periodRequests, 0)}Ôø?);
        }

        // All Raw Events ?ÔøΩÏù¥Ôø??ÔøΩÎç∞?ÔøΩÌä∏
        function updateRawEventsTable(eventsData) {
            const tableContainer = document.querySelector('#usage .user-cumulative-info:last-child');
            if (!tableContainer || !eventsData || !eventsData.usageEvents) return;
            
            // Í≤Ä??Ï§ëÏù∏ Í≤ΩÏö∞ ?ÔøΩÎèô ?ÔøΩÎç∞?ÔøΩÌä∏ Î∞©ÔøΩ?
            if (window.pendingEmailSearch) {
                console.log(`???ÔøΩÎ©î??Í≤Ä???ÔøΩÔøΩ?Ôø?(${window.pendingEmailSearch}) - Raw Events ?ÔøΩÏù¥Ôø??ÔøΩÎèô ?ÔøΩÎç∞?ÔøΩÌä∏ Í±¥ÎÑà?Ôø?);
                // ?ÔøΩÏù¥?ÔøΩÎäî ?Ôø?ÔøΩÌïò???ÔøΩÏù¥Ôø??ÔøΩÎçîÎßÅÔøΩ? ?ÔøΩÔøΩ? ?ÔøΩÏùå
                currentRawEventsData = eventsData.usageEvents.sort((a, b) => {
                    const timestampA = parseInt(a.timestamp) || 0;
                    const timestampB = parseInt(b.timestamp) || 0;
                    return timestampB - timestampA; // ?ÔøΩÎ¶ºÏ∞®Ïàú (ÏµúÏã† ??Í≥ºÍ±∞)
                });
                return;
            }
            
            // ?ÔøΩÏ≤¥ ?ÔøΩÏù¥???Ôø??Ôø?DATE Í∏∞ÔøΩ? ?ÔøΩÎ¶ºÏ∞®Ïàú ?ÔøΩÎ†¨ (ÏµúÏã†??
            currentRawEventsData = eventsData.usageEvents.sort((a, b) => {
                const timestampA = parseInt(a.timestamp) || 0;
                const timestampB = parseInt(b.timestamp) || 0;
                return timestampB - timestampA; // ?ÔøΩÎ¶ºÏ∞®Ïàú (ÏµúÏã† ??Í≥ºÍ±∞)
            });
            
            // ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥???ÔøΩÏö©
            renderRawEventsTableWithPagination();
        }

        // Raw Events ?ÔøΩÏù¥Ôø??ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥?ÔøΩÍ≥º ?ÔøΩÍªò ?ÔøΩÎçîÔø?        function renderRawEventsTableWithPagination() {
            const tableContainer = document.querySelector('#usage .user-cumulative-info:last-child');
            if (!tableContainer || !currentRawEventsData.length) return;
            
            const totalEvents = currentRawEventsData.length;
            const totalPages = Math.ceil(totalEvents / currentRawEventsPageSize);
            const startIndex = (currentRawEventsPage - 1) * currentRawEventsPageSize;
            const endIndex = Math.min(startIndex + currentRawEventsPageSize, totalEvents);
            const pageEvents = currentRawEventsData.slice(startIndex, endIndex);
            
            const tableHtml = `
                <div class="user-cumulative-header" style="display: flex; justify-content: space-between; align-items: center;">
                    <span>?ÔøΩÔøΩ All Raw Events (${startIndex + 1}-${endIndex} of ${totalEvents})</span>
                    <select id="rawEventsPageSize" onchange="changeRawEventsPageSize(this.value)" style="background: #3a3a3a; color: #fff; border: 1px solid #4a4a4a; padding: 5px 10px; border-radius: 4px; font-size: 12px;">
                        <option value="10" ${currentRawEventsPageSize === 10 ? 'selected' : ''}>10Ôø?Î≥¥Í∏∞</option>
                        <option value="20" ${currentRawEventsPageSize === 20 ? 'selected' : ''}>20Ôø?Î≥¥Í∏∞</option>
                        <option value="30" ${currentRawEventsPageSize === 30 ? 'selected' : ''}>30Ôø?Î≥¥Í∏∞</option>
                        <option value="50" ${currentRawEventsPageSize === 50 ? 'selected' : ''}>50Ôø?Î≥¥Í∏∞</option>
                        <option value="100" ${currentRawEventsPageSize === 100 ? 'selected' : ''}>100Ôø?Î≥¥Í∏∞</option>
                    </select>
                </div>
                <div class="user-cumulative-table">
                    <div>DATE</div>
                    <div>USER</div>
                    <div>KIND</div>
                    <div>MAX_MODEL</div>
                    <div>MODEL</div>
                    <div>COST</div>
                </div>
                ${pageEvents.map(event => {
                    const date = new Date(parseInt(event.timestamp));
                    const dateText = date.toLocaleDateString('en-US', { 
                        month: 'short', 
                        day: 'numeric', 
                        hour: '2-digit', 
                        minute: '2-digit' 
                    });
                    
                    return `
                        <div class="user-cumulative-row">
                            <div>${dateText}</div>
                            <div class="user-email">${event.userEmail}</div>
                            <div>${(event.kindLabel || 'Unknown').substring(0, 15)}${(event.kindLabel || '').length > 15 ? '...' : ''}</div>
                            <div>${event.maxMode ? 'Yes' : 'No'}</div>
                            <div>${(event.model || 'auto').substring(0, 10)}${(event.model || '').length > 10 ? '...' : ''}</div>
                            <div>${event.requestsCosts || 0}</div>
                        </div>
                    `;
                }).join('')}
                ${totalPages > 1 ? `
                    <div style="padding: 15px 20px; background-color: #2a2a2a; border-top: 1px solid #3a3a3a; display: flex; justify-content: center; align-items: center; gap: 10px;">
                        ${generateRawEventsPagination(totalPages)}
                    </div>
                ` : ''}
            `;
            
            tableContainer.innerHTML = tableHtml;
            
            console.log(`Raw Events ?ÔøΩÏù¥Ôø??ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÎ£å: ?ÔøΩÏù¥ÏßÄ ${currentRawEventsPage}/${totalPages}, ${pageEvents.length}Ôø??ÔøΩÎ≤§???ÔøΩÏãú`);
        }

        // Raw Events ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥???ÔøΩÏÑ±
        function generateRawEventsPagination(totalPages) {
            let pagination = '';
            
            // ?ÔøΩÏ†Ñ Î≤ÑÌäº
            if (currentRawEventsPage > 1) {
                pagination += `<button onclick="changeRawEventsPage(${currentRawEventsPage - 1})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">??/button>`;
            }
            
            // ?ÔøΩÏù¥ÏßÄ Î≤àÌò∏??            let startPage = Math.max(1, currentRawEventsPage - 2);
            let endPage = Math.min(totalPages, currentRawEventsPage + 2);
            
            // Ôø??ÔøΩÏù¥ÏßÄÍ∞Ä Î≤îÏúÑ???ÔøΩÏúºÔø?Ï∂îÔøΩ?
            if (startPage > 1) {
                pagination += `<button onclick="changeRawEventsPage(1)" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">1</button>`;
                if (startPage > 2) {
                    pagination += `<span style="color: #7a7a7a; padding: 0 5px;">...</span>`;
                }
            }
            
            // ?ÔøΩÏû¨ Î≤îÏúÑ???ÔøΩÏù¥ÏßÄ??            for (let i = startPage; i <= endPage; i++) {
                const isActive = i === currentRawEventsPage;
                pagination += `<button onclick="changeRawEventsPage(${i})" style="background: ${isActive ? '#4a9eff' : '#3a3a3a'}; border: 1px solid ${isActive ? '#4a9eff' : '#4a4a4a'}; color: ${isActive ? 'white' : '#e1e1e1'}; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: ${isActive ? '600' : 'normal'};">${i}</button>`;
            }
            
            // ÎßàÔøΩ?Ôø??ÔøΩÏù¥ÏßÄÍ∞Ä Î≤îÏúÑ???ÔøΩÏúºÔø?Ï∂îÔøΩ?
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    pagination += `<span style="color: #7a7a7a; padding: 0 5px;">...</span>`;
                }
                pagination += `<button onclick="changeRawEventsPage(${totalPages})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">${totalPages}</button>`;
            }
            
            // ?ÔøΩÏùå Î≤ÑÌäº
            if (currentRawEventsPage < totalPages) {
                pagination += `<button onclick="changeRawEventsPage(${currentRawEventsPage + 1})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">??/button>`;
            }
            
            return pagination;
        }

        // Raw Events ?ÔøΩÏù¥ÏßÄ Î≥ÄÔø?        function changeRawEventsPage(page) {
            currentRawEventsPage = page;
            renderRawEventsTableWithPagination();
        }

        // Raw Events ?ÔøΩÏù¥ÏßÄ ?ÔøΩÍ∏∞ Î≥ÄÔø?        function changeRawEventsPageSize(pageSize) {
            currentRawEventsPageSize = parseInt(pageSize);
            currentRawEventsPage = 1; // ?ÔøΩÏù¥ÏßÄ ?ÔøΩÍ∏∞ Î≥ÄÍ≤ΩÏãú Ôø??ÔøΩÏù¥ÏßÄÔø??ÔøΩÎèô
            renderRawEventsTableWithPagination();
        }

        // ?ÔøΩÌÑ∞ÎßÅÎêú Raw Events ?ÔøΩÏù¥Ôø??ÔøΩÎçîÔø?(?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥???ÔøΩÌï®)
        function renderFilteredRawEventsTable(filteredEvents, container) {
            if (!container || !filteredEvents) return;
            
            // ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥???ÔøΩÏ†ï - Í∏∞Ï°¥ ?ÔøΩÏ†ï???ÔøΩÏúºÔø??ÔøΩÏö©, ?ÔøΩÏúºÔø?Í∏∞Î≥∏Ôø?            const pageSize = window.currentFilteredEventsPageSize || 20;
            const currentPage = window.currentFilteredEventsPage || 1;
            const totalPages = Math.ceil(filteredEvents.length / pageSize);
            
            // ?ÔøΩÏû¨ ?ÔøΩÏù¥ÏßÄ???ÔøΩÎ≤§?ÔøΩÎßå Ï∂îÏ∂ú
            const startIndex = (currentPage - 1) * pageSize;
            const endIndex = Math.min(startIndex + pageSize, filteredEvents.length);
            const pageEvents = filteredEvents.slice(startIndex, endIndex);
            
            console.log(`?ÔøΩÔøΩ ?ÔøΩÌÑ∞ÎßÅÎêú Raw Events ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥?? ${startIndex + 1}-${endIndex} of ${filteredEvents.length} (?ÔøΩÏù¥ÏßÄ ${currentPage}/${totalPages})`);
            
            // ?ÔøΩÎ∞ò ?ÔøΩÏù¥Î∏îÍ≥º ?ÔøΩÏùº??Íµ¨Ï°∞Ôø?HTML ?ÔøΩÏÑ± (?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥???ÔøΩÌï®)
            const tableHtml = `
                <div class="user-cumulative-header" style="display: flex; justify-content: space-between; align-items: center;">
                    <span>?ÔøΩÔøΩ All Raw Events - Í≤Ä??Í≤∞Í≥º (${startIndex + 1}-${endIndex} of ${filteredEvents.length})</span>
                    <select onchange="changeFilteredEventsPageSize(this.value)" style="background: #3a3a3a; color: #fff; border: 1px solid #4a4a4a; padding: 5px 10px; border-radius: 4px; font-size: 12px;">
                        <option value="10" ${pageSize === 10 ? 'selected' : ''}>10Ôø?Î≥¥Í∏∞</option>
                        <option value="20" ${pageSize === 20 ? 'selected' : ''}>20Ôø?Î≥¥Í∏∞</option>
                        <option value="30" ${pageSize === 30 ? 'selected' : ''}>30Ôø?Î≥¥Í∏∞</option>
                        <option value="50" ${pageSize === 50 ? 'selected' : ''}>50Ôø?Î≥¥Í∏∞</option>
                        <option value="100" ${pageSize === 100 ? 'selected' : ''}>100Ôø?Î≥¥Í∏∞</option>
                    </select>
                </div>
                <div class="user-cumulative-table">
                    <div>DATE</div>
                    <div>USER</div>
                    <div>KIND</div>
                    <div>MAX_MODEL</div>
                    <div>MODEL</div>
                    <div>COST</div>
                </div>
                ${pageEvents.map(event => {
                    const date = new Date(parseInt(event.timestamp));
                    const dateText = date.toLocaleDateString('en-US', { 
                        month: 'short', 
                        day: 'numeric', 
                        hour: '2-digit', 
                        minute: '2-digit' 
                    });
                    
                    return `
                        <div class="user-cumulative-row">
                            <div>${dateText}</div>
                            <div class="user-email">${event.userEmail}</div>
                            <div>${(event.kindLabel || 'Unknown').substring(0, 15)}${(event.kindLabel || '').length > 15 ? '...' : ''}</div>
                            <div>${event.maxMode ? 'Yes' : 'No'}</div>
                            <div>${(event.model || 'auto').substring(0, 10)}${(event.model || '').length > 10 ? '...' : ''}</div>
                            <div>${event.requestsCosts || 0}</div>
                        </div>
                    `;
                }).join('')}
                ${totalPages > 1 ? `
                    <div style="padding: 15px 20px; background-color: #2a2a2a; border-top: 1px solid #3a3a3a; display: flex; justify-content: center; align-items: center; gap: 10px;">
                        ${generateFilteredEventsPagination(totalPages, currentPage)}
                    </div>
                ` : ''}
            `;
            
            container.innerHTML = tableHtml;
            
            // ?ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÎ≤§???ÔøΩÏù¥???Ôø??(?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥?ÔøΩÏö©)
            window.currentFilteredEvents = filteredEvents;
            window.currentFilteredEventsPage = currentPage;
            window.currentFilteredEventsPageSize = pageSize;
            
            console.log(`?ÔøΩÌÑ∞ÎßÅÎêú Raw Events ?ÔøΩÏù¥Ôø??ÔøΩÎçîÔø??ÔøΩÎ£å: ${filteredEvents.length}Ôø??ÔøΩÎ≤§??(?ÔøΩÏù¥ÏßÄ ${currentPage}/${totalPages}, ?ÔøΩÏù¥ÏßÄ??${pageSize}Ôø?`);
        }

        // Ôø?Raw Events ?ÔøΩÏù¥Ôø??ÔøΩÎçîÔø?        function renderEmptyRawEventsTable(container, searchedEmails) {
            if (!container) return;
            
            const emailList = searchedEmails.join(', ');
            
            const tableHtml = `
                <div class="user-cumulative-header">
                    <span>?ÔøΩÔøΩ All Raw Events - Í≤Ä??Í≤∞Í≥º (0Ôø?</span>
                </div>
                <div class="user-cumulative-table">
                    <div>DATE</div>
                    <div>USER</div>
                    <div>KIND</div>
                    <div>MAX_MODEL</div>
                    <div>MODEL</div>
                    <div>COST</div>
                </div>
                <div style="padding: 40px 20px; text-align: center; color: #7a7a7a; background-color: #1a1a1a; grid-column: 1 / -1;">
                    <h3 style="color: #e1e1e1; margin-bottom: 10px;">Í≤Ä?ÔøΩÎêú ?ÔøΩÏö©?ÔøΩÏùò ?ÔøΩÎèô???ÔøΩÏäµ?ÔøΩÎã§</h3>
                    <p style="margin-bottom: 15px;">Í≤Ä???Ôø?? <strong style="color: #4a9eff;">${emailList}</strong></p>
                    <p style="font-size: 14px; line-height: 1.4;">
                        ???ÔøΩÎãπ ?ÔøΩÏö©?ÔøΩÔøΩ? ?ÔøΩÌÉù??Í∏∞Í∞Ñ???ÔøΩÎèô?ÔøΩÔøΩ? ?ÔøΩÏïò?????ÔøΩÏäµ?ÔøΩÎã§<br>
                        ???ÔøΩÎ•∏ ?ÔøΩÏßú Î≤îÏúÑÔø??ÔøΩÌÉù?ÔøΩÎ≥¥?ÔøΩÏöî<br>
                        ???ÔøΩÎäî ?ÔøΩÎ•∏ ?ÔøΩÏö©?ÔøΩÔøΩ? Í≤Ä?ÔøΩÌï¥Î≥¥ÏÑ∏??                    </p>
                </div>
            `;
            
            container.innerHTML = tableHtml;
            console.log(`Ôø?Raw Events ?ÔøΩÏù¥Ôø??ÔøΩÎçîÔø??ÔøΩÎ£å (Í≤Ä???Ôø?? ${emailList})`);
        }

        // ?ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÎ≤§???ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥???ÔøΩÏÑ± (?ÔøΩÎ∞ò ?ÔøΩÏù¥Î∏îÍ≥º ?ÔøΩÏùº??Íµ¨Ï°∞)
        function generateFilteredEventsPagination(totalPages, currentPage) {
            let pagination = '';
            
            // ?ÔøΩÏ†Ñ ?ÔøΩÏù¥ÏßÄ Î≤ÑÌäº
            if (currentPage > 1) {
                pagination += `<button onclick="changeFilteredEventsPage(${currentPage - 1})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">??/button>`;
            }
            
            // ?ÔøΩÏù¥ÏßÄ Î≤àÌò∏ Î≤ÑÌäº??            let startPage = Math.max(1, currentPage - 2);
            let endPage = Math.min(totalPages, currentPage + 2);
            
            // ?ÔøΩÏûë ?ÔøΩÏù¥ÏßÄÍ∞Ä 1???ÔøΩÎãàÔø?Ôø??ÔøΩÏù¥ÏßÄ Î≤ÑÌäº Ï∂îÔøΩ?
            if (startPage > 1) {
                pagination += `<button onclick="changeFilteredEventsPage(1)" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">1</button>`;
                if (startPage > 2) {
                    pagination += `<span style="color: #7a7a7a; padding: 0 5px;">...</span>`;
                }
            }
            
            // ?ÔøΩÏù¥ÏßÄ Î≤àÌò∏??            for (let i = startPage; i <= endPage; i++) {
                const isActive = i === currentPage;
                pagination += `<button onclick="changeFilteredEventsPage(${i})" style="background: ${isActive ? '#4a9eff' : '#3a3a3a'}; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">${i}</button>`;
            }
            
            // ???ÔøΩÏù¥ÏßÄÍ∞Ä totalPagesÍ∞Ä ?ÔøΩÎãàÔø?ÎßàÔøΩ?Ôø??ÔøΩÏù¥ÏßÄ Î≤ÑÌäº Ï∂îÔøΩ?
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    pagination += `<span style="color: #7a7a7a; padding: 0 5px;">...</span>`;
                }
                pagination += `<button onclick="changeFilteredEventsPage(${totalPages})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">${totalPages}</button>`;
            }
            
            // ?ÔøΩÏùå ?ÔøΩÏù¥ÏßÄ Î≤ÑÌäº
            if (currentPage < totalPages) {
                pagination += `<button onclick="changeFilteredEventsPage(${currentPage + 1})" style="background: #3a3a3a; border: 1px solid #4a4a4a; color: #e1e1e1; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">??/button>`;
            }
            
            return pagination;
        }

        // ?ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÎ≤§???ÔøΩÏù¥ÏßÄ Î≥ÄÔø?        function changeFilteredEventsPage(page) {
            if (!window.currentFilteredEvents) {
                console.log('?ÔøΩÔ∏è ?ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÎ≤§???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                return;
            }
            
            window.currentFilteredEventsPage = page;
            const filteredEvents = window.currentFilteredEvents;
            const container = document.querySelector('#usage .user-cumulative-info:last-child');
            
            console.log(`?ÔøΩÔøΩ ?ÔøΩÌÑ∞ÎßÅÎêú Raw Events ?ÔøΩÏù¥ÏßÄ Î≥ÄÔø? ?ÔøΩÏù¥ÏßÄ ${page}Ôø??ÔøΩÎèô`);
            console.log(`?ÔøΩÔøΩ Ïª®ÌÖå?ÔøΩÎÑà Î∞úÍ≤¨: ${!!container}, ?ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÎ≤§???? ${filteredEvents.length}`);
            
            if (container) {
                // renderFilteredRawEventsTable ?ÔøΩÏàòÔø??ÔøΩÏÇ¨??                renderFilteredRawEventsTable(filteredEvents, container);
            } else {
                console.error('??Raw Events Ïª®ÌÖå?ÔøΩÎÑàÔø?Ï∞æÏùÑ ???ÔøΩÏäµ?ÔøΩÎã§.');
            }
        }

        // ?ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÎ≤§???ÔøΩÏù¥ÏßÄ ?ÔøΩÍ∏∞ Î≥ÄÔø?        function changeFilteredEventsPageSize(newPageSize) {
            console.log(`?ÔøΩÔøΩ changeFilteredEventsPageSize ?ÔøΩÏ∂ú?? ${newPageSize}`);
            console.log(`?ÔøΩÔøΩ ?ÔøΩÏû¨ ?ÔøΩÌÉú: currentFilteredEvents=${!!window.currentFilteredEvents}, currentFilteredEventsPage=${window.currentFilteredEventsPage}, currentFilteredEventsPageSize=${window.currentFilteredEventsPageSize}`);
            
            if (!window.currentFilteredEvents) {
                console.log('?ÔøΩÔ∏è ?ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÎ≤§???ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏäµ?ÔøΩÎã§.');
                return;
            }
            
            window.currentFilteredEventsPageSize = parseInt(newPageSize);
            window.currentFilteredEventsPage = 1; // ?ÔøΩÏù¥ÏßÄ ?ÔøΩÍ∏∞ Î≥ÄÍ≤ΩÏãú Ôø??ÔøΩÏù¥ÏßÄÔø??ÔøΩÎèô
            
            const filteredEvents = window.currentFilteredEvents;
            const container = document.querySelector('#usage .user-cumulative-info:last-child');
            
            console.log(`?ÔøΩÔøΩ ?ÔøΩÌÑ∞ÎßÅÎêú Raw Events ?ÔøΩÏù¥ÏßÄ ?ÔøΩÍ∏∞ Î≥ÄÔø? ${newPageSize}Í∞úÎ°ú Î≥ÄÔø? Ôø??ÔøΩÏù¥ÏßÄÔø??ÔøΩÎèô`);
            console.log(`?ÔøΩÔøΩ Ïª®ÌÖå?ÔøΩÎÑà Î∞úÍ≤¨: ${!!container}, ?ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÎ≤§???? ${filteredEvents.length}`);
            
            if (container) {
                // renderFilteredRawEventsTable ?ÔøΩÏàòÔø??ÔøΩÏÇ¨??                renderFilteredRawEventsTable(filteredEvents, container);
            } else {
                console.error('??Raw Events Ïª®ÌÖå?ÔøΩÎÑàÔø?Ï∞æÏùÑ ???ÔøΩÏäµ?ÔøΩÎã§.');
            }
        }
        
        // ?ÔøΩÎ≤ÑÍπÖÏö© ?ÔøΩÏó≠ ?ÔøΩÏàò
        window.debugFilteredEvents = function() {
            console.log('=== ?ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÎ≤§???ÔøΩÌÉú ?ÔøΩÎ≤ÑÔø?===');
            console.log('currentFilteredEvents:', window.currentFilteredEvents ? window.currentFilteredEvents.length + 'Ôø? : 'null');
            console.log('currentFilteredEventsPage:', window.currentFilteredEventsPage);
            console.log('currentFilteredEventsPageSize:', window.currentFilteredEventsPageSize);
            console.log('Ïª®ÌÖå?ÔøΩÎÑà:', document.querySelector('#usage .user-cumulative-info:last-child'));
            console.log('==============================');
        };



        // Usage Î©§Î≤Ñ Í≤Ä??Í∏∞Îä• (?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥?Ôø?All Raw Events ?ÔøΩÏù¥Ôø??ÔøΩÎèô)
        function filterUsageMembers(searchTerm) {
            const searchLower = searchTerm.toLowerCase().trim();
            
            console.log(`?ÔøΩÔøΩ Usage Î©§Î≤Ñ Í≤Ä???ÔøΩÏûë: "${searchTerm}"`);
            
            // Í≤Ä?ÔøΩÏñ¥Í∞Ä ÎπÑÏñ¥?ÔøΩÏúºÔø?Î™®Îì† ???ÔøΩÏãú
            if (searchLower === '') {
                const allRows = document.querySelectorAll('#usage .user-cumulative-row');
                allRows.forEach(row => {
                    row.style.display = 'grid';
                });
                
                // ?ÔøΩÏ≤¥ ?ÔøΩÎ≤§??Î°úÍ∑∏ ?ÔøΩÏù¥Î∏îÎèÑ ?ÔøΩÍªò Í∞±Ïã†
                if (currentRawEventsData && currentRawEventsData.length > 0) {
                    // ?ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÎ≤§??Î≥Ä?ÔøΩÎì§ ?ÔøΩÎ¶¨
                    delete window.currentFilteredEvents;
                    delete window.currentFilteredEventsPage;
                    delete window.currentFilteredEventsPageSize;
                    
                    renderRawEventsTableWithPagination();
                    console.log('??Í≤Ä?ÔøΩÏñ¥ ?ÔøΩÏùå - ?ÔøΩÏ≤¥ Raw Events ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥??Î≥µÏõê');
                }
                
                console.log('??Í≤Ä?ÔøΩÏñ¥ ?ÔøΩÏùå - Î™®Îì† ???ÔøΩÏãú Ôø??ÔøΩÏ≤¥ ?ÔøΩÎ≤§??Î°úÍ∑∏ Í∞±Ïã†');
                return;
            }
            
            // ?ÔøΩÎ©î??Ï£ºÏÜå?ÔøΩÔøΩ? ?ÔøΩÏù∏ (@ ?ÔøΩÌï® ?ÔøΩÔøΩ?Ôø??ÔøΩÎã®)
            const isEmailSearch = searchLower.includes('@');
            
            // Î™®Îì† Usage ?ÔøΩÏÖò??user-cumulative-info Ïª®ÌÖå?ÔøΩÎÑà Í∞Ä?ÔøΩÏò§Ôø?            const userInfoContainers = document.querySelectorAll('#usage .user-cumulative-info');
            
            if (userInfoContainers.length === 0) {
                console.log('?ÔøΩÔ∏è Usage ?ÔøΩÏÖò??user-cumulative-info Ïª®ÌÖå?ÔøΩÎÑàÔø?Ï∞æÏùÑ ???ÔøΩÏäµ?ÔøΩÎã§.');
                return;
            }
            
            console.log(`?ÔøΩÔøΩ Î∞úÍ≤¨???ÔøΩÏù¥Ôø?Ïª®ÌÖå?ÔøΩÎÑà: ${userInfoContainers.length}Ôø?);
            
            // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥ ?ÔøΩÏù¥Ôø?(Ôø?Î≤àÏß∏ Ïª®ÌÖå?ÔøΩÎÑà)Ôø?All Raw Events ?ÔøΩÏù¥Ôø?(??Î≤àÏß∏ Ïª®ÌÖå?ÔøΩÎÑà) Íµ¨Î∂Ñ
            const userCumulativeContainer = userInfoContainers[0]; // Ôø?Î≤àÏß∏: ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥
            const rawEventsContainer = userInfoContainers[1]; // ??Î≤àÏß∏: All Raw Events
            
            // 1. ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥ ?ÔøΩÏù¥Î∏îÏóê???ÔøΩÌÑ∞ÎßÅÌïòÔø?Îß§Ïπ≠???ÔøΩÎ©î???ÔøΩÏßë
            const matchedEmails = new Set();
            
            // ?ÔøΩÌôï???ÔøΩÎ©î??Îß§Ïπ≠???ÔøΩÎäîÏßÄ Î®ºÔøΩ? ?ÔøΩÏù∏
            let hasExactMatch = false;
            if (isEmailSearch) {
                const allEmailElements = userCumulativeContainer.querySelectorAll('.user-cumulative-row .user-email, .user-cumulative-row div:nth-child(2)');
                hasExactMatch = Array.from(allEmailElements).some(element => 
                    element.textContent.toLowerCase().trim() === searchLower
                );
                console.log(`?ÔøΩÔøΩ ?ÔøΩÌôï???ÔøΩÎ©î??Îß§Ïπ≠ ?ÔøΩÏù∏: ${hasExactMatch ? 'Î∞úÍ≤¨?? : '?ÔøΩÏùå'}`);
            }
            
            // ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥ ?ÔøΩÏù¥Ôø??ÔøΩÌÑ∞Ôø?            const userCumulativeRows = userCumulativeContainer.querySelectorAll('.user-cumulative-row');
            console.log(`?ÔøΩÔøΩ ?ÔøΩÏö©?ÔøΩÎ≥Ñ ?ÔøΩÏ†Å ?ÔøΩÏö©???ÔøΩÎ≥¥: ${userCumulativeRows.length}Ôø???Î∞úÍ≤¨`);
            
            userCumulativeRows.forEach(row => {
                if (row.children.length < 2) return; // Ï∂©Î∂Ñ??Ïª¨Îüº???ÔøΩÏúºÔø??ÔøΩÌÇµ
                
                const name = row.children[0].textContent.toLowerCase().trim();
                const email = row.children[1].textContent.toLowerCase().trim();
                
                let shouldShow = false;
                
                if (isEmailSearch) {
                    if (hasExactMatch) {
                        // ?ÔøΩÌôï??Îß§Ïπ≠???ÔøΩÏúºÔø??ÔøΩÌôï??Îß§Ïπ≠Ôø??ÔøΩÏãú
                        shouldShow = email === searchLower;
                    } else {
                        // ?ÔøΩÌôï??Îß§Ïπ≠???ÔøΩÏúºÔø?Î∂ÄÔø?Îß§Ïπ≠ ?ÔøΩÏö©
                        shouldShow = email.includes(searchLower);
                    }
                } else {
                    // ?ÔøΩÎ∞ò Í≤Ä?? ?ÔøΩÎ¶Ñ ?ÔøΩÎäî ?ÔøΩÎ©î??Î∂ÄÔø?Îß§Ïπ≠
                    shouldShow = name.includes(searchLower) || email.includes(searchLower);
                }
                
                if (shouldShow) {
                    row.style.display = 'grid';
                    // Îß§Ïπ≠???ÔøΩÎ©î?ÔøΩÏùÑ ?ÔøΩÏßë (?ÔøΩÎ≥∏ ?ÔøΩÎ©î???Ôø??
                    const originalEmail = row.children[1].textContent.trim();
                    matchedEmails.add(originalEmail);
                } else {
                    row.style.display = 'none';
                }
            });
            
            console.log(`?ÔøΩÔøΩ Îß§Ïπ≠???ÔøΩÎ©î?? ${Array.from(matchedEmails).join(', ')}`);
            
            // 2. All Raw Events ?ÔøΩÏù¥Ôø??ÔøΩÎèô ?ÔøΩÌÑ∞Ôø?(?ÔøΩÏ≤¥ ?ÔøΩÏù¥?ÔøΩÏóê??Í≤Ä??
            if (rawEventsContainer && currentRawEventsData && currentRawEventsData.length > 0) {
                console.log(`?ÔøΩÔøΩ All Raw Events ?ÔøΩÏ≤¥ ?ÔøΩÏù¥?? ${currentRawEventsData.length}Ôø??ÔøΩÎ≤§??);
                console.log(`?ÔøΩÔøΩ Îß§Ïπ≠ ?Ôø???ÔøΩÎ©î?? ${Array.from(matchedEmails).join(', ')}`);
                
                // Í≤Ä?ÔøΩÏñ¥Í∞Ä ?ÔøΩÏúºÔø?Îß§Ïπ≠???ÔøΩÎ©î?ÔøΩÏùò ?ÔøΩÎ≤§?ÔøΩÎßå ?ÔøΩÌÑ∞Ôø?                if (matchedEmails.size > 0) {
                    // ?ÔøΩÎ°ú??Í≤Ä???ÔøΩÏûë ???ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥??Î≥Ä??Ï¥àÍ∏∞??                    window.currentFilteredEventsPage = 1;
                    window.currentFilteredEventsPageSize = window.currentFilteredEventsPageSize || 20;
                    
                    const filteredEvents = currentRawEventsData.filter(event => {
                        const eventUserEmail = event.userEmail?.trim() || '';
                        
                        // ?ÔøΩÌôï???ÔøΩÎ©î??Îß§Ïπ≠Ôø??ÔøΩÌñâ (?Ôø?ÔøΩÎ¨∏??Î¨¥Ïãú)
                        return Array.from(matchedEmails).some(email => {
                            const emailLower = email.toLowerCase().trim();
                            const eventEmailLower = eventUserEmail.toLowerCase().trim();
                            return emailLower === eventEmailLower;
                        });
                    });
                    
                    console.log(`???ÔøΩÌÑ∞ÎßÅÎêú Raw Events: ${filteredEvents.length}Ôø?);
                    
                    if (filteredEvents.length > 0) {
                        // ?ÔøΩÌÑ∞ÎßÅÎêú ?ÔøΩÏù¥?ÔøΩÎ°ú ?ÔøΩÏù¥Ôø??ÔøΩÏãú ?ÔøΩÎçîÔø?                        renderFilteredRawEventsTable(filteredEvents, rawEventsContainer);
                        console.log(`??${filteredEvents.length}Í∞úÏùò Îß§Ïπ≠???ÔøΩÎ≤§?ÔøΩÔøΩ? ?ÔøΩÏãú?ÔøΩÏäµ?ÔøΩÎã§.`);
                        console.log(`?ÔøΩÔøΩ ?ÔøΩÏó≠ Î≥Ä???ÔøΩÌÉú: currentFilteredEvents=${!!window.currentFilteredEvents}, currentFilteredEventsPage=${window.currentFilteredEventsPage}, currentFilteredEventsPageSize=${window.currentFilteredEventsPageSize}`);
                    } else {
                        // Îß§Ïπ≠???ÔøΩÎ≤§?ÔøΩÔøΩ? ?ÔøΩÏúºÔø?Ôø??ÔøΩÏù¥Ôø??ÔøΩÏãú
                        renderEmptyRawEventsTable(rawEventsContainer, Array.from(matchedEmails));
                        console.log('?ÔøΩÔ∏è Îß§Ïπ≠???ÔøΩÏö©?ÔøΩÏùò Raw EventsÍ∞Ä ?ÔøΩÏäµ?ÔøΩÎã§.');
                        console.log('?ÔøΩÔøΩ ?ÔøΩÎãπ ?ÔøΩÏö©?ÔøΩÔøΩ? ?ÔøΩÌÉù??Í∏∞Í∞Ñ???ÔøΩÎèô?ÔøΩÔøΩ? ?ÔøΩÏïò?????ÔøΩÏäµ?ÔøΩÎã§.');
                    }
                } else {
                    // Í≤Ä?ÔøΩÏñ¥Í∞Ä ?ÔøΩÏúºÔø??ÔøΩÎûò ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥??Î∞©Ïãù?ÔøΩÎ°ú Î≥µÏõê
                    renderRawEventsTableWithPagination();
                    console.log('??Í≤Ä?ÔøΩÏñ¥ ?ÔøΩÏùå - ?ÔøΩÏ≤¥ Raw Events ?ÔøΩÏù¥ÏßÄ?ÔøΩÏù¥??Î≥µÏõê');
                }
            } else {
                console.log('?ÔøΩÔ∏è All Raw Events Ïª®ÌÖå?ÔøΩÎÑà ?ÔøΩÎäî ?ÔøΩÏù¥?ÔøΩÔøΩ? Ï∞æÏùÑ ???ÔøΩÏäµ?ÔøΩÎã§.');
                console.log(`   - Ïª®ÌÖå?ÔøΩÎÑà Ï°¥Ïû¨: ${!!rawEventsContainer}`);
                console.log(`   - ?ÔøΩÏù¥??Ï°¥Ïû¨: ${!!currentRawEventsData}`);
                console.log(`   - ?ÔøΩÏù¥??Í∏∏Ïù¥: ${currentRawEventsData?.length || 0}`);
            }
            
            const matchingType = isEmailSearch ? (hasExactMatch ? '?ÔøΩÌôï???ÔøΩÎ©î??Îß§Ïπ≠' : '?ÔøΩÎ©î??Î∂ÄÔø?Îß§Ïπ≠') : 'Î∂ÄÔø?Îß§Ïπ≠';
            console.log(`??Usage Í≤Ä???ÔøΩÎ£å: "${searchTerm}" - ${matchingType}?ÔøΩÎ°ú ???ÔøΩÏù¥Ôø??ÔøΩÎèô ?ÔøΩÌÑ∞Ôø??ÔøΩÎ£å (Îß§Ïπ≠???ÔøΩÏö©??${matchedEmails.size}Ôø?`);
            
            // Í≤Ä???ÔøΩÎ£å ???ÔøΩÔøΩ?Ï§ëÏù∏ ?ÔøΩÎ©î??Í≤Ä???ÔøΩÎûòÔø??ÔøΩÍ±∞
            if (window.pendingEmailSearch) {
                console.log(`?ÔøΩÔøΩ ?ÔøΩÎ©î??Í≤Ä???ÔøΩÎûòÔø??ÔøΩÍ±∞: ${window.pendingEmailSearch}`);
                delete window.pendingEmailSearch;
            }
        }

        // Î©§Î≤Ñ ?ÔøΩÎ†¨ Í∏∞Îä•
        let currentSortField = 'requests';
        let currentSortDirection = 'desc';

        function sortMembers(field) {
            const dataTable = document.querySelector('#members .data-table');
            const rows = Array.from(dataTable.querySelectorAll('.table-row'));
           
            // ?ÔøΩÎ†¨ Î∞©Ìñ• ?ÔøΩÔøΩ?
            if (currentSortField === field) {
                currentSortDirection = currentSortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                currentSortField = field;
                currentSortDirection = 'asc';
            }
           
            // ?ÔøΩÎ†¨ ?ÔøΩÏàò
            rows.sort((a, b) => {
                let aValue, bValue;
               
                switch(field) {
                    case 'name':
                        aValue = a.children[0].textContent.toLowerCase();
                        bValue = b.children[0].textContent.toLowerCase();
                        break;
                    case 'email':
                        aValue = a.children[1].textContent.toLowerCase();
                        bValue = b.children[1].textContent.toLowerCase();
                        break;
                    case 'requests':
                        aValue = parseInt(a.children[2].textContent.replace(/,/g, '')) || 0;
                        bValue = parseInt(b.children[2].textContent.replace(/,/g, '')) || 0;
                        break;
                    case 'spend':
                        aValue = parseFloat(a.children[3].textContent.replace('$', '')) || 0;
                        bValue = parseFloat(b.children[3].textContent.replace('$', '')) || 0;
                        break;
                    case 'role':
                        aValue = a.children[4].textContent.toLowerCase();
                        bValue = b.children[4].textContent.toLowerCase();
                        break;
                    default:
                        return 0;
                }
               
                if (currentSortDirection === 'asc') {
                    return aValue > bValue ? 1 : -1;
                } else {
                    return aValue < bValue ? 1 : -1;
                }
            });
           
            // ?ÔøΩÎ†¨???ÔøΩÎì§???ÔøΩÏãú Ï∂îÔøΩ?
            rows.forEach(row => dataTable.appendChild(row));
           
            // ?ÔøΩÎçî ?ÔøΩÎç∞?ÔøΩÌä∏
            updateSortHeaders(field);
        }

        // ?ÔøΩÎ†¨ ?ÔøΩÎçî ?ÔøΩÎç∞?ÔøΩÌä∏
        function updateSortHeaders(field) {
            const headers = document.querySelectorAll('#members .table-header > div');
            headers.forEach((header, index) => {
                if (index < 5) { // ÎßàÔøΩ?Ôø?Ôø????ÔøΩÏô∏
                    const text = header.textContent.replace(/[?ÔøΩ‚Üì]/, '');
                    if (index === 0 && field === 'name') header.textContent = text + (currentSortDirection === 'asc' ? ' ?? : ' ??);
                    else if (index === 1 && field === 'email') header.textContent = text + (currentSortDirection === 'asc' ? ' ?? : ' ??);
                    else if (index === 2 && field === 'requests') header.textContent = text + (currentSortDirection === 'asc' ? ' ?? : ' ??);
                    else if (index === 3 && field === 'spend') header.textContent = text + (currentSortDirection === 'asc' ? ' ?? : ' ??);
                    else if (index === 4 && field === 'role') header.textContent = text + (currentSortDirection === 'asc' ? ' ?? : ' ??);
                    else header.textContent = text + ' ??;
                }
            });
        }

        // Í≤Ä?ÔøΩÏ∞Ω ?ÔøΩÔøΩ? ?ÔøΩÎ¶≠ ???ÔøΩÎèô?ÔøΩÏÑ± ?ÔøΩÎ°≠?ÔøΩÏö¥ ?ÔøΩÍ∏∞Ôø?        document.addEventListener('click', function(e) {
            const autocompleteDropdowns = document.querySelectorAll('.autocomplete-dropdown');
            const searchContainers = document.querySelectorAll('.search-container');
            
            let clickedInsideSearch = false;
            searchContainers.forEach(container => {
                if (container.contains(e.target)) {
                    clickedInsideSearch = true;
                }
            });
            
            if (!clickedInsideSearch) {
                autocompleteDropdowns.forEach(dropdown => {
                    dropdown.style.display = 'none';
                });
            }
        });

        // ÏµúÏ†Å?ÔøΩÎêú ?ÔøΩÏù¥ÏßÄ Ï¥àÍ∏∞??(Progressive Loading)
        document.addEventListener('DOMContentLoaded', async function() {
            PerformanceMonitor.start('?ÔøΩÏù¥ÏßÄ ?ÔøΩÏ≤¥ Î°úÎìú');
            console.log('?? ÏµúÏ†Å?ÔøΩÎêú ?Ôø?ÔøΩÎ≥¥??Ï¥àÍ∏∞???ÔøΩÏûë');
           
            try {
                // 1?ÔøΩÍ≥Ñ: Ï¶âÏãú ?ÔøΩÏºà?ÔøΩÌÜ§ UI ?ÔøΩÏãú (0ms)
                SkeletonUI.show('overview');
                updatePerformanceIndicator('loading', 'UI Ï¥àÍ∏∞??);
                console.log('?? ?ÔøΩÏºà?ÔøΩÌÜ§ UI ?ÔøΩÏãú ?ÔøΩÎ£å');
               
                // 2?ÔøΩÍ≥Ñ: Í∏∞Î≥∏ UI Ï¥àÍ∏∞??(Ï¶âÏãú)
                initOverviewStats();
               
                // Overview ?ÔøΩÌÑ∞ Í∏∞Î≥∏Í∞íÏùÑ 30?ÔøΩÎ°ú ?ÔøΩÏ†ï
                document.querySelectorAll('#overview .chart-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector('#overview .chart-btn[data-days="30"]').classList.add('active');
                
                // Ï¥àÍ∏∞ ?ÔøΩÌÑ∞ Í∏∞Í∞Ñ ?ÔøΩÏãú ?ÔøΩÏ†ï (30??
                const initialDateRange = getDateRange(30);
                updateFilterPeriodDisplay(initialDateRange.startDate, initialDateRange.endDate);
               
                createOverviewChart(); // Ôø?Ï∞®Ìä∏ Î®ºÔøΩ? ?ÔøΩÏãú
                window.overviewChartInitialized = true; // Ï∞®Ìä∏ Ï¥àÍ∏∞???ÔøΩÎûòÔø??ÔøΩÏ†ï
                
                // Í∏∞Î≥∏ Ï∞®Ìä∏ ???ÔøΩÏÑ±??(?ÔøΩÎ≥Ñ ?ÔøΩÎèô Ï∂îÏù¥)
                switchChart('activity-trend');
               
                // 3?ÔøΩÍ≥Ñ: Î∞±Í∑∏?ÔøΩÏö¥?ÔøΩÏóê???ÔøΩÏù¥??Î°úÎìú ?ÔøΩÏûë (ÎπÑÎèôÔø?
                console.log('?ÔøΩÔøΩ Î∞±Í∑∏?ÔøΩÏö¥???ÔøΩÏù¥??Î°úÎìú ?ÔøΩÏûë...');
               
                // Ï∫êÏãú ?ÔøΩÏù∏ Ôø?Ï¶âÏãú ?ÔøΩÏö© Í∞Ä?ÔøΩÌïú ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÎã§Ôø?Î®ºÔøΩ? ?ÔøΩÏãú
                if (DataCache.isValid('members') && DataCache.members) {
                    console.log('?? Ï∫êÏãú??Î©§Î≤Ñ ?ÔøΩÏù¥?ÔøΩÎ°ú Ï¶âÏãú Í∏∞Î≥∏ UI ?ÔøΩÎç∞?ÔøΩÌä∏');
                    updatePerformanceIndicator('cached', 'Ï∫êÏãú ?ÔøΩÏö©');
                    const totalMembers = DataCache.members.teamMembers?.length || 0;
                    updateStatsCards(totalMembers, 0, 0); // Í∏∞Î≥∏Í∞íÏúºÔø?Î®ºÔøΩ? ?ÔøΩÏãú
                } else {
                    updatePerformanceIndicator('loading', 'API ?ÔøΩÏ∂ú');
                }
               
                // 4?ÔøΩÍ≥Ñ: ?ÔøΩÏ†ú API ?ÔøΩÏù¥??Î°úÎìú Ôø??ÔøΩÎç∞?ÔøΩÌä∏
                await refreshAllRealData();
               
                // Ï¥àÍ∏∞ Î°úÎìú ?ÔøΩÎ£å ??Í∏∞Î≥∏ ?ÔøΩÌÉù ?ÔøΩÌÉú ?ÔøΩÏ†ï (?ÔøΩÏ≤¥ Î©§Î≤Ñ)
                console.log('Ï¥àÍ∏∞ Î°úÎìú ?ÔøΩÎ£å ???ÔøΩÏ≤¥ Î©§Î≤Ñ Í∏∞Î≥∏ ?ÔøΩÌÉù');
                document.querySelectorAll('.overview-stat-box').forEach(box => {
                    box.classList.remove('selected');
                });
                document.querySelector('.overview-stat-box[data-type="total"]').classList.add('selected');
                currentFilterType = 'total';
                
                // ?ÔøΩÏßú ?ÔøΩÎ†• ?ÔøΩÎìú Î≥ÄÔø????ÔøΩÎèô ?ÔøΩÎ°úÍ≥†Ïπ® ?ÔøΩÎ≤§??Î¶¨Ïä§??Ï∂îÔøΩ?
                setupAutoRefreshEvents();
                
                // ?ÔøΩÏßú ?ÔøΩÎ†• ?ÔøΩÎìú ?ÔøΩÏãúÔø??ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÎ≤§??Î¶¨Ïä§??Ï∂îÔøΩ?
                setupDateInputEvents();
                
                // Overview ?ÔøΩÏÖò??ÏµúÏ¥à Î∞©Î¨∏??Í≤ÉÏúºÔø??ÔøΩÏãú
                sectionVisited.overview = true;
               
                const totalLoadTime = PerformanceMonitor.end('?ÔøΩÏù¥ÏßÄ ?ÔøΩÏ≤¥ Î°úÎìú');
                updatePerformanceIndicator('ready', `${totalLoadTime}ms`);
                console.log('??ÏµúÏ†Å?ÔøΩÎêú ?Ôø?ÔøΩÎ≥¥??Ï¥àÍ∏∞???ÔøΩÎ£å!');
               
            } catch (error) {
                PerformanceMonitor.end('?ÔøΩÏù¥ÏßÄ ?ÔøΩÏ≤¥ Î°úÎìú');
                updatePerformanceIndicator('error', error.message.substring(0, 20));
                console.error('???Ôø?ÔøΩÎ≥¥??Ï¥àÍ∏∞???ÔøΩÌå®:', error);
               
                // ?ÔøΩÎü¨ Î∞úÏÉù ?ÔøΩÏóê??Í∏∞Î≥∏ UI???ÔøΩÏãú
                const errorMessage = `
                    <div style="text-align: center; padding: 50px; color: #ff6b6b;">
                        <h3>?ÔøΩÔ∏è ?ÔøΩÏù¥??Î°úÎìú ?ÔøΩÌå®</h3>
                        <p>${error.message}</p>
                        <button onclick="location.reload()" style="margin-top: 20px; padding: 10px 20px; background: #4a9eff; color: white; border: none; border-radius: 4px; cursor: pointer;">
                            ?ÔøΩÎ°úÍ≥†Ïπ®
                        </button>
                    </div>
                `;
               
                const overviewSection = document.getElementById('overview');
                if (overviewSection) {
                    overviewSection.innerHTML = errorMessage;
                }
            }
        });

        // Ï∫êÏãú ?ÔøΩÎ°úÍ≥†Ïπ® ?ÔøΩÏàò (Î≤ÑÌäº??
        function forceCacheRefresh() {
            console.log('?ÔøΩÔøΩÔø?Ï∫êÏãú Í∞ïÏ†ú ?ÔøΩÎ°úÍ≥†Ïπ® ?ÔøΩÏûë');
            DataCache.clear();
            location.reload();
        }

        // Refresh ?ÔøΩÌñâ ?ÔøΩÌÉú Í¥ÄÔø?(Ï§ëÎ≥µ ?ÔøΩÌñâ Î∞©ÔøΩ?)
        let isRefreshInProgress = false;

        // ÏßÑÌñâÔø??ÔøΩÏñ¥ ?ÔøΩÏàò??        function showRefreshProgress() {
            const progressContainer = document.querySelector('.refresh-progress');
            const progressBar = document.querySelector('.refresh-progress-bar');
            if (progressContainer && progressBar) {
                progressContainer.style.display = 'block';
                progressBar.style.width = '0%';
            }
        }

        function updateRefreshProgress(percentage) {
            const progressBar = document.querySelector('.refresh-progress-bar');
            if (progressBar) {
                progressBar.style.width = percentage + '%';
            }
        }

        function hideRefreshProgress() {
            const progressContainer = document.querySelector('.refresh-progress');
            if (progressContainer) {
                progressContainer.style.display = 'none';
            }
        }

        // Refresh Î©îÎâ¥ ?ÔøΩÎ¶≠ ?ÔøΩÎì§??(?ÔøΩÏ†Ñ Î∞±Í∑∏?ÔøΩÏö¥???ÔøΩÏûë)
        async function handleRefreshClick() {
            // ?ÔøΩÔøΩ? refreshÍ∞Ä ÏßÑÌñâ Ï§ëÏù¥Ôø?Î¨¥Ïãú
            if (isRefreshInProgress) {
                console.log('?ÔøΩÔøΩ Refresh ?ÔøΩÔøΩ? ÏßÑÌñâ Ôø?- ?ÔøΩÏ≤≠ Î¨¥Ïãú');
                return;
            }

            // ÏßÑÌñâÔø??ÔøΩÏãú
            showRefreshProgress();
            
            // Refresh ?ÔøΩÏûë (?ÔøΩÏö©?ÔøΩÏóêÍ≤åÎäî ?ÔøΩÎ¨¥ Î≥Ä???ÔøΩÏùå)
            isRefreshInProgress = true;
            
            try {
                console.log('?ÔøΩÔøΩ Refresh ?ÔøΩÏûë - Î∞±Í∑∏?ÔøΩÏö¥???ÔøΩÏù¥??Í∞±Ïã† (?ÔøΩÏö©???ÔøΩÎ©¥ Î≥Ä???ÔøΩÏùå)');
                
                // ?ÔøΩÏû¨ ?ÔøΩÏÑ±?ÔøΩÎêú ?ÔøΩÏÖò ?ÔøΩÏù∏
                const activeSection = document.querySelector('.content-section.active');
                const activeSectionId = activeSection ? activeSection.id : 'overview';
                
                console.log(`?ÔøΩÏû¨ ?ÔøΩÏÑ± ?ÔøΩÏÖò: ${activeSectionId}`);
                
                // Î∞±Í∑∏?ÔøΩÏö¥?ÔøΩÏóê??Î™®Îì† ?ÔøΩÏù¥???ÔøΩÎ°úÍ≥†Ïπ® (Î≥ëÎ†¨ Ï≤òÎ¶¨)
                console.log('?ÔøΩÔøΩ Î∞±Í∑∏?ÔøΩÏö¥??API ?ÔøΩÏù¥??Î°úÎìú ?ÔøΩÏûë...');
                
                // ÏßÑÌñâÔø??ÔøΩÍ≥ÑÔø??ÔøΩÎç∞?ÔøΩÌä∏
                updateRefreshProgress(20);
                await refreshOverviewData();
                updateRefreshProgress(50);
                await refreshMembersData();
                updateRefreshProgress(80);
                await refreshUsageData();
                updateRefreshProgress(90);
                
                // ?ÔøΩÏû¨ ?ÔøΩÏÖò???ÔøΩÏÑ±?ÔøΩÎêò???ÔøΩÎã§Ôø??ÔøΩÎ©¥ ?ÔøΩÎç∞?ÔøΩÌä∏
                await updateCurrentSectionDisplay(activeSectionId);
                updateRefreshProgress(100);
                
                console.log('??Refresh ?ÔøΩÎ£å - Î™®Îì† ?ÔøΩÏù¥?ÔøΩÔøΩ? Î∞±Í∑∏?ÔøΩÏö¥?ÔøΩÏóê??Í∞±Ïã†??);
                
            } catch (error) {
                console.error('??Refresh ?ÔøΩÌå®:', error);
                // ?ÔøΩÎü¨ Î∞úÏÉù ?ÔøΩÏóê???ÔøΩÏö©???ÔøΩÎ©¥?ÔøΩÎäî Î≥Ä???ÔøΩÏùå (ÏΩòÏÜî?ÔøΩÎßå Î°úÍ∑∏)
            } finally {
                // ÏßÑÌñâÔø??ÔøΩÍ∏∞Ôø?                setTimeout(() => {
                    hideRefreshProgress();
                }, 500);
                
                // Refresh ?ÔøΩÎ£å ?ÔøΩÌÉúÔø?Î≥ÄÔø?                isRefreshInProgress = false;
            }
        }

        // Overview ?ÔøΩÏù¥??Î∞±Í∑∏?ÔøΩÏö¥???ÔøΩÎ°úÍ≥†Ïπ®
        async function refreshOverviewData() {
            try {
                console.log('?ÔøΩÔøΩ Overview ?ÔøΩÏù¥??Î∞±Í∑∏?ÔøΩÏö¥??Í∞±Ïã† Ôø?..');
                await updateOverviewWithRealData();
                console.log('??Overview ?ÔøΩÏù¥??Í∞±Ïã† ?ÔøΩÎ£å');
            } catch (error) {
                console.error('??Overview ?ÔøΩÏù¥??Í∞±Ïã† ?ÔøΩÌå®:', error);
                throw error;
            }
        }

        // Members ?ÔøΩÏù¥??Î∞±Í∑∏?ÔøΩÏö¥???ÔøΩÎ°úÍ≥†Ïπ®
        async function refreshMembersData() {
            try {
                console.log('?ÔøΩÔøΩ Members ?ÔøΩÏù¥??Î∞±Í∑∏?ÔøΩÏö¥??Í∞±Ïã† Ôø?..');
                await updateMembersWithRealData();
                console.log('??Members ?ÔøΩÏù¥??Í∞±Ïã† ?ÔøΩÎ£å');
            } catch (error) {
                console.error('??Members ?ÔøΩÏù¥??Í∞±Ïã† ?ÔøΩÌå®:', error);
                throw error;
            }
        }

        // Usage ?ÔøΩÏù¥??Î∞±Í∑∏?ÔøΩÏö¥???ÔøΩÎ°úÍ≥†Ïπ® (?ÔøΩÎ©¥ Î≥Ä???ÔøΩÏù¥ Ï∫êÏãúÔø?Í∞±Ïã†)
        async function refreshUsageData() {
            try {
                console.log('?ÔøΩÔøΩ Usage ?ÔøΩÏù¥??Î∞±Í∑∏?ÔøΩÏö¥??Í∞±Ïã† Ôø?(?ÔøΩÎ©¥ Î≥Ä???ÔøΩÏùå)...');
                
                // ?ÔøΩÏßú Î≤îÏúÑ Í≥ÑÏÇ∞
                const dateRange = getDateRange(30);
                
                // API ?ÔøΩÏù¥?ÔøΩÎßå Í∞Ä?ÔøΩÔøΩ???Ï∫êÏãú???Ôø??(?ÔøΩÎ©¥ ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÏùå)
                const [membersData, eventsData, usageData, spendingData] = await Promise.all([
                    getTeamMembers(),
                    getFilteredEvents(dateRange.startDate, dateRange.endDate),
                    getUsageData(dateRange.startDate, dateRange.endDate),
                    getTeamSpendingData()
                ]);
                
                // Ï∫êÏãú?ÔøΩÎßå ?Ôø?ÔøΩÌïòÔø??ÔøΩÎ©¥?Ôø??ÔøΩÎç∞?ÔøΩÌä∏?ÔøΩÔøΩ? ?ÔøΩÏùå
                console.log('?ÔøΩÔøΩ Usage ?ÔøΩÏù¥?ÔøΩÔøΩ? Ï∫êÏãú???Ôø??(?ÔøΩÎ©¥ ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÌï®)');
                
                // ?ÔøΩÏó≠ Î≥Ä?ÔøΩÏóê ?ÔøΩÏù¥???Ôø??(?ÔøΩÎ©¥ ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÏàò???ÔøΩÏ∂ú?ÔøΩÔøΩ? ?ÔøΩÏùå)
                // ?ÔøΩÎ†áÔø??ÔøΩÎ©¥ ?ÔøΩÏù¥?ÔøΩÎäî ÏµúÏã†?ÔøΩÎ°ú ?ÔøΩÔøΩ??ÔøΩÔøΩ?Ôø??ÔøΩÎ©¥?Ôø?Î≥ÄÍ≤ΩÎêòÏßÄ ?ÔøΩÏùå
                
                console.log('??Usage ?ÔøΩÏù¥??Î∞±Í∑∏?ÔøΩÏö¥??Í∞±Ïã† ?ÔøΩÎ£å (Ï∫êÏãúÔø??ÔøΩÎç∞?ÔøΩÌä∏)');
            } catch (error) {
                console.error('??Usage ?ÔøΩÏù¥??Í∞±Ïã† ?ÔøΩÌå®:', error);
                throw error;
            }
        }

        // ?ÔøΩÏû¨ ?ÔøΩÏÖò ?ÔøΩÎ©¥ ?ÔøΩÎç∞?ÔøΩÌä∏ (Î∞±Í∑∏?ÔøΩÏö¥??Í∞±Ïã† ??
        async function updateCurrentSectionDisplay(activeSectionId) {
            try {
                console.log(`?ÔøΩÔøΩÔø??ÔøΩÏû¨ ?ÔøΩÏÖò ?ÔøΩÎ©¥ ?ÔøΩÎç∞?ÔøΩÌä∏: ${activeSectionId}`);
                switch(activeSectionId) {
                    case 'overview':
                        await updateOverviewWithCurrentFilter();
                        break;
                    case 'members':
                        // Members???ÔøΩÔøΩ? refreshMembersData()?ÔøΩÏÑú Í∞±Ïã†??                        // Ï∂îÔøΩ? ?ÔøΩÎ©¥ ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÏùå
                        break;
                    case 'usage':
                        // Usage??Î∞±Í∑∏?ÔøΩÏö¥?ÔøΩÏóê?ÔøΩÎßå ?ÔøΩÏù¥??Í∞±Ïã†??                        // ?ÔøΩÎ©¥ ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÔøΩ? ?ÔøΩÏùå (?ÔøΩÏö©?ÔøΩÔøΩ? Î≥¥Í≥† ?ÔøΩÎäî ?ÔøΩÎ©¥ ?ÔøΩÔøΩ?)
                        console.log('Usage ?ÔøΩÏÖò: ?ÔøΩÎ©¥ ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÌï® (Î∞±Í∑∏?ÔøΩÏö¥??Í∞±Ïã†Ôø?');
                        break;
                    case 'settings':
                        // Settings??Î≥ÑÎèÑ API ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏùå
                        break;
                }
                console.log(`??${activeSectionId} ?ÔøΩÏÖò ?ÔøΩÎ©¥ ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÎ£å`);
            } catch (error) {
                console.error(`??${activeSectionId} ?ÔøΩÏÖò ?ÔøΩÎ©¥ ?ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÌå®:`, error);
            }
        }

        // ?ÔøΩÎèô ?ÔøΩÎ°úÍ≥†Ïπ® ?ÔøΩÎ≤§???ÔøΩÏ†ï
        function setupAutoRefreshEvents() {
            console.log('?ÔøΩÎèô ?ÔøΩÎ°úÍ≥†Ïπ® ?ÔøΩÎ≤§??Î¶¨Ïä§???ÔøΩÏ†ï Ôø?..');
            
            // Overview ?ÔøΩÏßú ?ÔøΩÎ†• ?ÔøΩÎìú
            const overviewStartDate = document.getElementById('start-date');
            const overviewEndDate = document.getElementById('end-date');
            
            if (overviewStartDate && overviewEndDate) {
                overviewStartDate.addEventListener('change', debounce(async () => {
                    if (overviewStartDate.value && overviewEndDate.value) {
                        console.log('Overview ?ÔøΩÏûë ?ÔøΩÏßú Î≥ÄÍ≤ΩÎê® - ?ÔøΩÎèô ?ÔøΩÎ°úÍ≥†Ïπ®');
                        await applyDateFilter();
                    }
                }, 500));
                
                overviewEndDate.addEventListener('change', debounce(async () => {
                    if (overviewStartDate.value && overviewEndDate.value) {
                        console.log('Overview Ï¢ÖÎ£å ?ÔøΩÏßú Î≥ÄÍ≤ΩÎê® - ?ÔøΩÎèô ?ÔøΩÎ°úÍ≥†Ïπ®');
                        await applyDateFilter();
                    }
                }, 500));
            }
            
            // Usage ?ÔøΩÏßú ?ÔøΩÎ†• ?ÔøΩÎìú
            const usageStartDate = document.getElementById('usage-start-date');
            const usageEndDate = document.getElementById('usage-end-date');
            
            if (usageStartDate && usageEndDate) {
                usageStartDate.addEventListener('change', debounce(async () => {
                    if (usageStartDate.value && usageEndDate.value) {
                        console.log('Usage ?ÔøΩÏûë ?ÔøΩÏßú Î≥ÄÍ≤ΩÎê® - ?ÔøΩÎèô ?ÔøΩÎ°úÍ≥†Ïπ®');
                        await applyUsageDateFilter();
                    }
                }, 500));
                
                usageEndDate.addEventListener('change', debounce(async () => {
                    if (usageStartDate.value && usageEndDate.value) {
                        console.log('Usage Ï¢ÖÎ£å ?ÔøΩÏßú Î≥ÄÍ≤ΩÎê® - ?ÔøΩÎèô ?ÔøΩÎ°úÍ≥†Ïπ®');
                        await applyUsageDateFilter();
                    }
                }, 500));
            }
            
            console.log('?ÔøΩÎèô ?ÔøΩÎ°úÍ≥†Ïπ® ?ÔøΩÎ≤§??Î¶¨Ïä§???ÔøΩÏ†ï ?ÔøΩÎ£å');
        }

        // ?ÔøΩÏßú ?ÔøΩÎ†• ?ÔøΩÎìú ?ÔøΩÏãúÔø??ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÎ≤§???ÔøΩÏ†ï
        function setupDateInputEvents() {
            console.log('?ÔøΩÏßú ?ÔøΩÎ†• ?ÔøΩÎìú ?ÔøΩÏãúÔø??ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÎ≤§??Î¶¨Ïä§???ÔøΩÏ†ï Ôø?..');
            
            // Overview ?ÔøΩÏßú ?ÔøΩÎ†• ?ÔøΩÎìú ?ÔøΩÏãúÔø??ÔøΩÎç∞?ÔøΩÌä∏
            const overviewStartDate = document.getElementById('start-date');
            const overviewEndDate = document.getElementById('end-date');
            
            if (overviewStartDate && overviewEndDate) {
                // ?ÔøΩÏûë ?ÔøΩÏßú Î≥ÄÔø???Ï¶âÏãú Î≤îÏúÑ ?ÔøΩÏãú ?ÔøΩÎç∞?ÔøΩÌä∏
                overviewStartDate.addEventListener('input', () => {
                    if (overviewStartDate.value && overviewEndDate.value) {
                        const startDate = new Date(overviewStartDate.value).getTime();
                        const endDate = new Date(overviewEndDate.value).getTime() + (24 * 60 * 60 * 1000 - 1);
                        updateFilterPeriodDisplay(startDate, endDate);
                    }
                });
                
                // Ï¢ÖÎ£å ?ÔøΩÏßú Î≥ÄÔø???Ï¶âÏãú Î≤îÏúÑ ?ÔøΩÏãú ?ÔøΩÎç∞?ÔøΩÌä∏
                overviewEndDate.addEventListener('input', () => {
                    if (overviewStartDate.value && overviewEndDate.value) {
                        const startDate = new Date(overviewStartDate.value).getTime();
                        const endDate = new Date(overviewEndDate.value).getTime() + (24 * 60 * 60 * 1000 - 1);
                        updateFilterPeriodDisplay(startDate, endDate);
                    }
                });
            }
            
            // Usage ?ÔøΩÏßú ?ÔøΩÎ†• ?ÔøΩÎìú ?ÔøΩÏãúÔø??ÔøΩÎç∞?ÔøΩÌä∏
            const usageStartDate = document.getElementById('usage-start-date');
            const usageEndDate = document.getElementById('usage-end-date');
            
            if (usageStartDate && usageEndDate) {
                // ?ÔøΩÏûë ?ÔøΩÏßú Î≥ÄÔø???Ï¶âÏãú Î≤îÏúÑ ?ÔøΩÏãú ?ÔøΩÎç∞?ÔøΩÌä∏
                usageStartDate.addEventListener('input', () => {
                    if (usageStartDate.value && usageEndDate.value) {
                        const startDate = new Date(usageStartDate.value).getTime();
                        const endDate = new Date(usageEndDate.value).getTime() + (24 * 60 * 60 * 1000 - 1);
                        updateUsageFilterPeriodDisplay(startDate, endDate);
                    }
                });
                
                // Ï¢ÖÎ£å ?ÔøΩÏßú Î≥ÄÔø???Ï¶âÏãú Î≤îÏúÑ ?ÔøΩÏãú ?ÔøΩÎç∞?ÔøΩÌä∏
                usageEndDate.addEventListener('input', () => {
                    if (usageStartDate.value && usageEndDate.value) {
                        const startDate = new Date(usageStartDate.value).getTime();
                        const endDate = new Date(usageEndDate.value).getTime() + (24 * 60 * 60 * 1000 - 1);
                        updateUsageFilterPeriodDisplay(startDate, endDate);
                    }
                });
            }
            
            console.log('?ÔøΩÏßú ?ÔøΩÎ†• ?ÔøΩÎìú ?ÔøΩÏãúÔø??ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÎ≤§??Î¶¨Ïä§???ÔøΩÏ†ï ?ÔøΩÎ£å');
        }

        // ?ÔøΩÎ∞î?ÔøΩÏä§ ?ÔøΩÏàò (?ÔøΩÏÜç ?ÔøΩÏ∂ú Î∞©ÔøΩ?)
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }



        // Email Report ?ÔøΩÏ†ï - ÏßÅÏ†ë ?ÔøΩÎ†• Ï≤¥ÌÅ¨Î∞ïÏä§ ?ÔøΩÔøΩ? ?ÔøΩÏàò
        function toggleCustomEmailInput(checkbox) {
            const customEmailInput = document.getElementById('custom-email-input');
            if (checkbox.checked) {
                customEmailInput.style.display = 'block';
                console.log('ÏßÅÏ†ë ?ÔøΩÎ†• ?ÔøΩÎ©î???ÔøΩÏó≠???ÔøΩÏãú?ÔøΩÏóà?ÔøΩÎãà??');
            } else {
                customEmailInput.style.display = 'none';
                console.log('ÏßÅÏ†ë ?ÔøΩÎ†• ?ÔøΩÎ©î???ÔøΩÏó≠???ÔøΩÍ≤®Ï°åÏäµ?ÔøΩÎã§.');
            }
            updateRecipientCount();
        }

        // ?ÔøΩÏã†????Í≥ÑÏÇ∞ Ôø??ÔøΩÎç∞?ÔøΩÌä∏ ?ÔøΩÏàò
        function updateRecipientCount() {
            let totalCount = 0;
            const adminCheckbox = document.getElementById('admin-checkbox');
            const allMembersCheckbox = document.getElementById('all-members-checkbox');
            const inactiveMembersCheckbox = document.getElementById('inactive-members-checkbox');
            const customEmailCheckbox = document.getElementById('custom-email-checkbox');
            const customEmails = document.getElementById('custom-emails');
            
            // Í¥ÄÎ¶¨Ïûê ??Í≥ÑÏÇ∞
            if (adminCheckbox && adminCheckbox.checked) {
                const adminCount = originalMembersData ? originalMembersData.filter(member => member.role === 'owner').length : 0;
                totalCount += adminCount;
            }
            
            // ?ÔøΩÏ≤¥ Î©§Î≤Ñ ??Í≥ÑÏÇ∞
            if (allMembersCheckbox && allMembersCheckbox.checked) {
                const allMembersCount = originalMembersData ? originalMembersData.length : 0;
                totalCount += allMembersCount;
            }
            
            // ÎπÑÌôú??Î©§Î≤Ñ ??Í≥ÑÏÇ∞
            if (inactiveMembersCheckbox && inactiveMembersCheckbox.checked) {
                const inactiveCount = originalMembersData ? originalMembersData.filter(member => member.spendData.premiumRequests === 0).length : 0;
                totalCount += inactiveCount;
            }
            
            // ÏßÅÏ†ë ?ÔøΩÎ†• ?ÔøΩÎ©î????Í≥ÑÏÇ∞
            if (customEmailCheckbox && customEmailCheckbox.checked && customEmails && customEmails.value.trim()) {
                const emailList = customEmails.value.split(',').filter(email => email.trim().length > 0);
                totalCount += emailList.length;
            }
            
            // ?ÔøΩÏã†?????ÔøΩÏãú ?ÔøΩÎç∞?ÔøΩÌä∏
            const recipientCountElement = document.getElementById('recipient-count');
            if (recipientCountElement) {
                recipientCountElement.textContent = totalCount;
            }
            
            console.log(`?ÔøΩÏã†?????ÔøΩÎç∞?ÔøΩÌä∏: ${totalCount}Ôø?);
        }

        // Email Report ?ÔøΩÏ†ï - Î©îÏãúÏßÄ Í∏Ä????Ïπ¥Ïö¥???ÔøΩÏàò
        function updateMessageCharCount() {
            const messageInput = document.getElementById('email-report-message');
            const charCount = document.getElementById('report-message-char-count');
            
            if (messageInput && charCount) {
                const maxLength = 1000;
                const currentLength = messageInput.value.length;
                
                // Í∏Ä?????ÔøΩÎç∞?ÔøΩÌä∏
                charCount.textContent = currentLength;
                
                // Í∏Ä?????ÔøΩÌïú
                if (currentLength > maxLength) {
                    messageInput.value = messageInput.value.substring(0, maxLength);
                    charCount.textContent = maxLength;
                }
                
                // Í∏Ä???ÔøΩÏóê ?ÔøΩÎ•∏ ?ÔøΩÏÉÅ Î≥ÄÔø?                if (currentLength >= maxLength * 0.9) {
                    charCount.style.color = '#ff9800'; // Í≤ΩÍ≥† ?ÔøΩÏÉÅ (90% ?ÔøΩÏÉÅ)
                } else if (currentLength >= maxLength * 0.8) {
                    charCount.style.color = '#ff9800'; // Ï£ºÏùò ?ÔøΩÏÉÅ (80% ?ÔøΩÏÉÅ)
                } else {
                    charCount.style.color = '#7a7a7a'; // Í∏∞Î≥∏ ?ÔøΩÏÉÅ
                }
            }
        }

        // ?ÔøΩÏïΩ Î¶¨Ïä§??Î≥¥Í∏∞ ?ÔøΩÏàò
        function showEmailScheduleList() {
            // Í∏∞Ï°¥ Î™®Îã¨???ÔøΩÏúºÔø??ÔøΩÍ±∞
            const existingModal = document.getElementById('email-schedule-modal');
            if (existingModal) {
                existingModal.remove();
            }

            // ?ÔøΩÏïΩ Î¶¨Ïä§???ÔøΩÏù¥??(?Ôø?ÔøΩÎêú ?ÔøΩÏïΩ + Í∏∞Î≥∏ ?ÔøΩÌîå ?ÔøΩÏù¥??
            let scheduleList = [];
            
            // ?Ôø?ÔøΩÎêú ?ÔøΩÏïΩ Î¶¨Ïä§?ÔøΩÔøΩ? ?ÔøΩÏúºÔø?Ï∂îÔøΩ?
            if (window.emailScheduleList && window.emailScheduleList.length > 0) {
                scheduleList = scheduleList.concat(window.emailScheduleList);
            }
            
            // Í∏∞Î≥∏ ?ÔøΩÌîå ?ÔøΩÏù¥??(?Ôø?ÔøΩÎêú ?ÔøΩÏïΩ???ÔøΩÏùÑ ?ÔøΩÎßå ?ÔøΩÏãú)
            if (scheduleList.length === 0) {
                scheduleList = [
                    {
                        id: 1,
                        title: "Ï£ºÍ∞Ñ ?ÔøΩÎèô Î¶¨Ìè¨??,
                        frequency: "Îß§Ï£º",
                        time: "?ÔøΩÏ†Ñ 9??00Ôø?,
                        recipients: "Í¥ÄÎ¶¨Ïûê, ?ÔøΩÏ≤¥ Î©§Î≤Ñ",
                        status: "?ÔøΩÏÑ±",
                        nextSend: "2025-01-27 09:00",
                        message: "?ÔøΩÎ≤à Ôø??Ôø??ÔøΩÎèô ?ÔøΩÌô©???ÔøΩÏù∏?ÔøΩÎ≥¥?ÔøΩÏöî."
                    },
                    {
                        id: 2,
                        title: "?ÔøΩÍ∞Ñ ?ÔøΩÍ≥Ñ Î¶¨Ìè¨??,
                        frequency: "Îß§Ïõî",
                        time: "?ÔøΩÌõÑ 2??00Ôø?,
                        recipients: "Í¥ÄÎ¶¨Ïûê",
                        status: "?ÔøΩÏÑ±",
                        nextSend: "2025-02-01 14:00",
                        message: "?ÔøΩÍ∞Ñ ?ÔøΩÍ≥Ñ Ôø?Î∂ÑÏÑù Í≤∞Í≥º?ÔøΩÎãà??"
                    },
                    {
                        id: 3,
                        title: "?ÔøΩÏùº ?ÔøΩÏïΩ Î¶¨Ìè¨??,
                        frequency: "Îß§Ïùº",
                        time: "?ÔøΩÌõÑ 6??00Ôø?,
                        recipients: "?ÔøΩÏ≤¥ Î©§Î≤Ñ",
                        status: "ÎπÑÌôú??,
                        nextSend: "-",
                        message: "?ÔøΩÎäò???ÔøΩÎèô ?ÔøΩÏïΩ?ÔøΩÎãà??"
                    }
                ];
            }

            // Î™®Îã¨ HTML ?ÔøΩÏÑ±
            const modalHTML = `
                <div id="email-schedule-modal" style="
                    display: block;
                    position: fixed;
                    z-index: 1000;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    background-color: rgba(0,0,0,0.7);
                ">
                    <div style="
                        background-color: #2a2a2a;
                        margin: 5% auto;
                        padding: 25px;
                        border-radius: 8px;
                        width: 90%;
                        max-width: 800px;
                        box-shadow: 0 4px 20px rgba(0,0,0,0.5);
                        max-height: 85vh;
                        overflow-y: auto;
                        border: 1px solid #3a3a3a;
                    ">
                        <!-- Î™®Îã¨ ?ÔøΩÎçî -->
                        <div style="
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                            margin-bottom: 25px;
                            padding-bottom: 15px;
                            border-bottom: 1px solid #3a3a3a;
                        ">
                            <div style="color: #fff; font-size: 18px; font-weight: 600;">Î©îÏùº Î∞úÏÜ° ?ÔøΩÏïΩ Î¶¨Ïä§??/div>
                            <button onclick="closeEmailScheduleModal()" style="
                                background: none;
                                border: none;
                                color: #7a7a7a;
                                font-size: 20px;
                                cursor: pointer;
                                padding: 5px;
                                border-radius: 3px;
                                transition: color 0.2s ease;
                            " onmouseover="this.style.color='#fff'" onmouseout="this.style.color='#7a7a7a'">√ó</button>
                        </div>

                        <!-- Í≤Ä??Ôø??ÔøΩÌÑ∞ -->
                        <div style="margin-bottom: 20px;">
                            <div style="
                                position: relative;
                                display: flex;
                                align-items: center;
                                background-color: #1a1a1a;
                                border: 1px solid #3a3a3a;
                                border-radius: 4px;
                                padding: 0 12px;
                                transition: all 0.2s ease;
                                margin-bottom: 15px;
                            " onfocus="this.style.backgroundColor='#2a2a2a'; this.style.borderColor='#4a9eff'" onblur="this.style.backgroundColor='#1a1a1a'; this.style.borderColor='#3a3a3a'">
                                <span style="
                                    color: #7a7a7a;
                                    margin-right: 8px;
                                    font-size: 14px;
                                ">?ÔøΩÔøΩ</span>
                                <input 
                                    type="text" 
                                    id="schedule-search" 
                                    placeholder="?ÔøΩÏïΩ Î¶¨Ïä§??Í≤Ä??.."
                                    style="
                                        flex: 1;
                                        padding: 10px 0;
                                        border: none;
                                        background: transparent;
                                        color: #e1e1e1;
                                        font-size: 14px;
                                        outline: none;
                                    "
                                >
                            </div>
                            
                            <!-- ?ÔøΩÌÑ∞ Î≤ÑÌäº -->
                            <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                                <button class="chart-btn active" data-filter="all" onclick="filterScheduleList('all')">?ÔøΩÏ≤¥</button>
                                <button class="chart-btn" data-filter="active" onclick="filterScheduleList('active')">?ÔøΩÏÑ±</button>
                                <button class="chart-btn" data-filter="inactive" onclick="filterScheduleList('inactive')">ÎπÑÌôú??/button>
                            </div>
                        </div>

                        <!-- ?ÔøΩÏïΩ Î¶¨Ïä§???ÔøΩÏù¥Ôø?-->
                        <div style="
                            background-color: #1a1a1a;
                            border-radius: 4px;
                            overflow: hidden;
                            margin-bottom: 20px;
                        ">
                            <!-- ?ÔøΩÏù¥Ôø??ÔøΩÎçî -->
                            <div style="
                                display: grid;
                                grid-template-columns: 2fr 1fr 1fr 1.5fr 1fr 1fr 1fr;
                                gap: 15px;
                                padding: 15px;
                                background-color: #1a1a1a;
                                border-bottom: 1px solid #3a3a3a;
                                font-weight: 600;
                                color: #fff;
                                font-size: 14px;
                            ">
                                <div>?ÔøΩÎ™©</div>
                                <div>Ï£ºÍ∏∞</div>
                                <div>?ÔøΩÍ∞Ñ</div>
                                <div>?ÔøΩÏã†??/div>
                                <div>?ÔøΩÌÉú</div>
                                <div>?ÔøΩÏùå Î∞úÏÜ°</div>
                                <div>?ÔøΩÏóÖ</div>
                            </div>

                            <!-- ?ÔøΩÏù¥Ôø??ÔøΩÏö© -->
                            <div id="schedule-list-content">
                                ${scheduleList.map(item => `
                                    <div class="schedule-item" data-status="${item.status}" style="
                                        display: grid;
                                        grid-template-columns: 2fr 1fr 1fr 1.5fr 1fr 1fr 1fr;
                                        gap: 15px;
                                        padding: 15px;
                                        border-bottom: 1px solid #3a3a3a;
                                        color: #e1e1e1;
                                        font-size: 14px;
                                        transition: background-color 0.2s ease;
                                    " onmouseover="this.style.backgroundColor='#3a3a3a'" onmouseout="this.style.backgroundColor='transparent'">
                                        <div style="cursor: pointer;" onclick="showScheduleDetail(${item.id})">
                                            <div style="font-weight: 600; color: #fff; margin-bottom: 5px;">${item.title}</div>
                                            <div style="color: #7a7a7a; font-size: 12px;">${item.message}</div>
                                        </div>
                                        <div>${item.frequency}</div>
                                        <div>${item.time}</div>
                                        <div>${item.recipients}</div>
                                        <div>
                                            <span style="
                                                padding: 4px 8px;
                                                border-radius: 12px;
                                                font-size: 12px;
                                                font-weight: 600;
                                                ${item.status === '?ÔøΩÏÑ±' ? 'background-color: #4a9eff; color: white;' : 'background-color: #5a5a5a; color: #b1b1b1;'}
                                            ">${item.status}</span>
                                        </div>
                                        <div style="color: #7a7a7a;">${item.nextSend}</div>
                                        <div style="display: flex; gap: 5px;">
                                            <button onclick="editSchedule(${item.id})" style="
                                                background: none;
                                                border: none;
                                                color: #4a9eff;
                                                cursor: pointer;
                                                padding: 4px;
                                                font-size: 12px;
                                            ">?ÔøΩÏßë</button>
                                            <button onclick="toggleScheduleStatus(${item.id})" style="
                                                background: none;
                                                border: none;
                                                color: ${item.status === '?ÔøΩÏÑ±' ? '#ff9800' : '#4a9eff'};
                                                cursor: pointer;
                                                padding: 4px;
                                                font-size: 12px;
                                            ">${item.status === '?ÔøΩÏÑ±' ? 'ÎπÑÌôú?? : '?ÔøΩÏÑ±'}</button>
                                            <button onclick="deleteSchedule(${item.id})" style="
                                                background: none;
                                                border: none;
                                                color: #ff4757;
                                                cursor: pointer;
                                                padding: 4px;
                                                font-size: 12px;
                                            ">??ÔøΩÔøΩ</button>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        <!-- ?ÔøΩÎã® Î≤ÑÌäº -->
                        <div style="display: flex; justify-content: space-between; align-items: center; border-top: 1px solid #3a3a3a; padding-top: 20px;">
                            <div style="color: #7a7a7a; font-size: 14px;">
                                Ôø?${scheduleList.length}Í∞úÏùò ?ÔøΩÏïΩ Î¶¨Ïä§??                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button class="analytics-btn" onclick="addNewSchedule()">???ÔøΩÏïΩ Ï∂îÔøΩ?</button>
                                <button class="chart-btn" onclick="closeEmailScheduleModal()">?ÔøΩÍ∏∞</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Î™®Îã¨???ÔøΩÏù¥ÏßÄ??Ï∂îÔøΩ?
            document.body.insertAdjacentHTML('beforeend', modalHTML);

            // Î™®Îã¨ ?ÔøΩÔøΩ? ?ÔøΩÎ¶≠ ???ÔøΩÍ∏∞
            document.getElementById('email-schedule-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeEmailScheduleModal();
                }
            });

            // Í≤Ä??Í∏∞Îä• Ï∂îÔøΩ?
            setTimeout(() => {
                const searchInput = document.getElementById('schedule-search');
                if (searchInput) {
                    searchInput.addEventListener('input', function() {
                        const searchTerm = this.value.toLowerCase();
                        const scheduleItems = document.querySelectorAll('#email-schedule-modal .schedule-item');
                        
                        scheduleItems.forEach(item => {
                            const text = item.textContent.toLowerCase();
                            if (text.includes(searchTerm)) {
                                item.style.display = 'grid';
                            } else {
                                item.style.display = 'none';
                            }
                        });
                    });
                }
            }, 100);
        }

        // ?ÔøΩÏã†??Î≥¥Í∏∞ ?ÔøΩÏàò
        function showEmailRecipients() {
            // Í∏∞Ï°¥ Î™®Îã¨???ÔøΩÏúºÔø??ÔøΩÍ±∞
            const existingModal = document.getElementById('email-recipients-modal');
            if (existingModal) {
                existingModal.remove();
            }

            // ?ÔøΩÏû¨ ?ÔøΩÏ†ï Í∞íÎì§ ?ÔøΩÏßë
            const frequency = document.getElementById('email-frequency-select');
            const timeInput = document.getElementById('email-time-input');
            
            const frequencyText = frequency ? frequency.options[frequency.selectedIndex].text : 'Îß§Ï£º';
            
            // ?ÔøΩÍ∞Ñ ?ÔøΩÎ†• Ï≤òÎ¶¨
            let timeText = '?ÔøΩÏ†Ñ 9??00Ôø?;
            if (timeInput && timeInput.value) {
                const [hours, minutes] = timeInput.value.split(':');
                const hour = parseInt(hours);
                const minute = parseInt(minutes);
                
                if (hour < 12) {
                    timeText = `?ÔøΩÏ†Ñ ${hour}??${minute.toString().padStart(2, '0')}Ôø?;
                } else if (hour === 12) {
                    timeText = `?ÔøΩÌõÑ 12??${minute.toString().padStart(2, '0')}Ôø?;
                } else {
                    timeText = `?ÔøΩÌõÑ ${hour - 12}??${minute.toString().padStart(2, '0')}Ôø?;
                }
            }

            // ?ÔøΩÌÉù???ÔøΩÏã†??Í∑∏Î£π ?ÔøΩÏù∏ Ôø??ÔøΩÏ†ú Î©§Î≤Ñ ?ÔøΩÏù¥???ÔøΩÏßë
            const selectedGroups = [];
            const adminCheckbox = document.getElementById('admin-checkbox');
            const allMembersCheckbox = document.getElementById('all-members-checkbox');
            const inactiveMembersCheckbox = document.getElementById('inactive-members-checkbox');
            const customEmailCheckbox = document.getElementById('custom-email-checkbox');
            
            let allRecipients = [];
            
            // Í¥ÄÎ¶¨Ïûê ?ÔøΩÏßë
            if (adminCheckbox && adminCheckbox.checked) {
                const admins = originalMembersData ? originalMembersData.filter(member => member.role === 'owner') : [];
                allRecipients = allRecipients.concat(admins);
                selectedGroups.push('Í¥ÄÎ¶¨Ïûê');
                console.log(`Í¥ÄÎ¶¨Ïûê ${admins.length}Ôø?Ï∂îÔøΩ?`);
            }
            
            // ?ÔøΩÏ≤¥ Î©§Î≤Ñ ?ÔøΩÏßë
            if (allMembersCheckbox && allMembersCheckbox.checked) {
                const allMembers = originalMembersData ? [...originalMembersData] : [];
                allRecipients = allRecipients.concat(allMembers);
                selectedGroups.push('?ÔøΩÏ≤¥ Î©§Î≤Ñ');
                console.log(`?ÔøΩÏ≤¥ Î©§Î≤Ñ ${allMembers.length}Ôø?Ï∂îÔøΩ?`);
            }
            
            // ÎπÑÌôú??Î©§Î≤Ñ ?ÔøΩÏßë
            if (inactiveMembersCheckbox && inactiveMembersCheckbox.checked) {
                const inactiveMembers = originalMembersData ? originalMembersData.filter(member => member.spendData.premiumRequests === 0) : [];
                allRecipients = allRecipients.concat(inactiveMembers);
                selectedGroups.push('ÎπÑÌôú??Î©§Î≤Ñ');
                console.log(`ÎπÑÌôú??Î©§Î≤Ñ ${inactiveMembers.length}Ôø?Ï∂îÔøΩ?`);
            }
            
            // ÏßÅÏ†ë ?ÔøΩÎ†• ?ÔøΩÎ©î???ÔøΩÏù∏
            const customEmails = document.getElementById('custom-emails');
            const customEmailList = customEmails && customEmails.value.trim() ? customEmails.value.trim() : '';
            
            if (customEmailCheckbox && customEmailCheckbox.checked && customEmailList) {
                const emailList = customEmailList.split(',').filter(email => email.trim().length > 0);
                emailList.forEach(email => {
                    allRecipients.push({
                        name: 'ÏßÅÏ†ë ?ÔøΩÎ†•',
                        email: email.trim(),
                        role: 'custom',
                        spendData: { premiumRequests: 0, spend: 0 }
                    });
                });
                selectedGroups.push('ÏßÅÏ†ë ?ÔøΩÎ†•');
                console.log(`ÏßÅÏ†ë ?ÔøΩÎ†• ?ÔøΩÎ©î??${emailList.length}Ôø?Ï∂îÔøΩ?`);
            }
            
            // Ï§ëÎ≥µ ?ÔøΩÍ±∞ (?ÔøΩÎ©î??Í∏∞ÔøΩ?)
            const uniqueRecipients = [];
            const seenEmails = new Set();
            allRecipients.forEach(recipient => {
                if (!seenEmails.has(recipient.email)) {
                    seenEmails.add(recipient.email);
                    uniqueRecipients.push(recipient);
                }
            });
            
            console.log(`Ôø?${uniqueRecipients.length}Î™ÖÏùò Í≥†Ïú† ?ÔøΩÏã†???ÔøΩÏßë ?ÔøΩÎ£å`);

            // Î™®Îã¨ HTML ?ÔøΩÏÑ±
            const modalHTML = `
                <div id="email-recipients-modal" style="
                    display: block;
                    position: fixed;
                    z-index: 1000;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    background-color: rgba(0,0,0,0.7);
                ">
                    <div style="
                        background-color: #2a2a2a;
                        margin: 5% auto;
                        padding: 25px;
                        border-radius: 8px;
                        width: 90%;
                        max-width: 700px;
                        box-shadow: 0 4px 20px rgba(0,0,0,0.5);
                        max-height: 85vh;
                        overflow-y: auto;
                        border: 1px solid #3a3a3a;
                    ">
                        <!-- Î™®Îã¨ ?ÔøΩÎçî -->
                        <div style="
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                            margin-bottom: 25px;
                            padding-bottom: 15px;
                            border-bottom: 1px solid #3a3a3a;
                        ">
                            <div style="color: #fff; font-size: 18px; font-weight: 600;">?ÔøΩÏã†??ÎØ∏Î¶¨Î≥¥Í∏∞</div>
                            <button onclick="closeEmailRecipientsModal()" style="
                                background: none;
                                border: none;
                                color: #7a7a7a;
                                font-size: 20px;
                                cursor: pointer;
                                padding: 5px;
                                border-radius: 3px;
                                transition: color 0.2s ease;
                            " onmouseover="this.style.color='#fff'" onmouseout="this.style.color='#7a7a7a'">√ó</button>
                        </div>

                        <!-- Î∞úÏÜ° ?ÔøΩÏ†ï -->
                        <div style="margin-bottom: 25px;">
                            <div style="color: #fff; font-size: 16px; font-weight: 600; margin-bottom: 15px;">Î∞úÏÜ° ?ÔøΩÏ†ï</div>
                            <div style="
                                color: #b1b1b1;
                                font-size: 14px;
                                line-height: 1.6;
                            ">
                                <div style="
                                    margin-bottom: 8px;
                                    padding: 8px 12px;
                                    border: 1px solid #3a3a3a;
                                    border-radius: 4px;
                                    background-color: transparent;
                                ">??Ï£ºÍ∏∞: <span style="color: #ff9800;">${frequencyText}</span></div>
                                <div style="
                                    margin-bottom: 8px;
                                    padding: 8px 12px;
                                    border: 1px solid #3a3a3a;
                                    border-radius: 4px;
                                    background-color: transparent;
                                ">???ÔøΩÍ∞Ñ: <span style="color: #ff9800;">${timeText}</span></div>
                                <div style="
                                    margin-bottom: 8px;
                                    padding: 8px 12px;
                                    border: 1px solid #3a3a3a;
                                    border-radius: 4px;
                                    background-color: transparent;
                                ">???ÔøΩÏã†??Í∑∏Î£π: <span style="color: #ff9800;">${selectedGroups.length > 0 ? selectedGroups.join(', ') : '?ÔøΩÌÉù??Í∑∏Î£π ?ÔøΩÏùå'}</span></div>
                                <div style="
                                    padding: 8px 12px;
                                    border: 1px solid #3a3a3a;
                                    border-radius: 4px;
                                    background-color: transparent;
                                ">??Ôø??ÔøΩÏã†?? <span style="color: #ff9800;">${calculateTotalRecipients(selectedGroups, customEmailList)}Ôø?/span></div>
                            </div>
                        </div>

                        <!-- Î∞úÏÜ° Î©îÏãúÏßÄ -->
                        <div style="margin-bottom: 25px;">
                            <div style="color: #fff; font-size: 16px; font-weight: 600; margin-bottom: 15px;">Î∞úÏÜ° Î©îÏãúÏßÄ</div>
                            <div style="
                                position: relative;
                                background-color: #1a1a1a;
                                border: 1px solid #3a3a3a;
                                border-radius: 4px;
                                transition: all 0.2s ease;
                            ">
                                <textarea 
                                    id="email-message-input" 
                                    placeholder="?ÔøΩÎ©î?ÔøΩÏóê ?ÔøΩÌï®??Î©îÏãúÏßÄÔø??ÔøΩÎ†•?ÔøΩÏÑ∏??.."
                                    style="
                                        width: 100%;
                                        height: 120px;
                                        padding: 12px;
                                        border: none;
                                        background: transparent;
                                        color: #e1e1e1;
                                        font-size: 14px;
                                        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                                        line-height: 1.5;
                                        outline: none;
                                        resize: vertical;
                                        min-height: 120px;
                                        max-height: 200px;
                                    "
                                    onfocus="this.parentElement.style.backgroundColor='#2a2a2a'; this.parentElement.style.borderColor='#4a9eff'"
                                    onblur="this.parentElement.style.backgroundColor='#1a1a1a'; this.parentElement.style.borderColor='#3a3a3a'"
                                ></textarea>
                            </div>
                            <div style="
                                color: #7a7a7a;
                                font-size: 12px;
                                margin-top: 5px;
                                text-align: right;
                            ">
                                <span id="message-char-count">0</span>/500 Í∏Ä??                            </div>
                        </div>

                        <!-- ?ÔøΩÏã†??Í∑∏Î£π -->
                        <div style="margin-bottom: 25px;">
                            <div style="color: #fff; font-size: 16px; font-weight: 600; margin-bottom: 15px;">?ÔøΩÏã†??Í∑∏Î£π</div>
                            
                            <!-- ?ÔøΩÏã†??Í≤Ä??Ôø?-->
                            <div style="margin-bottom: 20px; position: relative;">
                                <div style="
                                    position: relative;
                                    display: flex;
                                    align-items: center;
                                    background-color: #1a1a1a;
                                    border: 1px solid #3a3a3a;
                                    border-radius: 4px;
                                    padding: 0 12px;
                                    transition: all 0.2s ease;
                                " onfocus="this.style.backgroundColor='#2a2a2a'; this.style.borderColor='#4a9eff'" onblur="this.style.backgroundColor='#1a1a1a'; this.style.borderColor='#3a3a3a'">
                                    <span style="
                                        color: #7a7a7a;
                                        margin-right: 8px;
                                        font-size: 14px;
                                    ">?ÔøΩÔøΩ</span>
                                    <input 
                                        type="text" 
                                        id="recipient-search" 
                                        placeholder="?ÔøΩÏã†??Í≤Ä??.."
                                        style="
                                            flex: 1;
                                            padding: 10px 0;
                                            border: none;
                                            background: transparent;
                                            color: #e1e1e1;
                                            font-size: 14px;
                                            outline: none;
                                        "
                                    >
                                    <button 
                                        id="clear-search" 
                                        onclick="clearRecipientSearch()"
                                        style="
                                            background: none;
                                            border: none;
                                            color: #7a7a7a;
                                            cursor: pointer;
                                            padding: 4px;
                                            font-size: 16px;
                                            margin-left: 8px;
                                            display: none;
                                        "
                                        onmouseover="this.style.color='#fff'" 
                                        onmouseout="this.style.color='#7a7a7a'"
                                    >√ó</button>
                                </div>
                            </div>

                            ${generateRecipientGroups(selectedGroups, customEmailList)}
                            
                            <!-- Ôø??ÔøΩÏã†?????ÔøΩÏãú -->
                            <div style="
                                margin-top: 20px;
                                padding: 15px;
                                background-color: #1a1a1a;
                                border-radius: 4px;
                                border: 1px solid #3a3a3a;
                            ">
                                <div style="color: #fff; font-size: 16px; font-weight: 600; margin-bottom: 10px;">?ÔøΩÔøΩ ?ÔøΩÏã†???ÔøΩÍ≥Ñ</div>
                                <div style="color: #b1b1b1; font-size: 14px; line-height: 1.6;">
                                    <div>??Ôø??ÔøΩÏã†?? <span style="color: #ff9800; font-weight: 600;">${uniqueRecipients.length}Ôø?/span></div>
                                    <div>??Ï§ëÎ≥µ ?ÔøΩÍ±∞: <span style="color: #4a9eff; font-weight: 600;">${allRecipients.length - uniqueRecipients.length}Ôø?/span></div>
                                    <div>???ÔøΩÌÉù??Í∑∏Î£π: <span style="color: #4a9eff; font-weight: 600;">${selectedGroups.join(', ')}</span></div>
                                </div>
                            </div>
                        </div>

                        <!-- ?ÔøΩÎã® Î≤ÑÌäº -->
                        <div style="display: flex; justify-content: flex-end; gap: 10px; border-top: 1px solid #3a3a3a; padding-top: 20px;">
                            <button onclick="closeEmailRecipientsModal()" class="chart-btn" style="padding: 10px 20px;">?ÔøΩÍ∏∞</button>
                        </div>
                    </div>
                </div>
            `;

            // Î™®Îã¨???ÔøΩÏù¥ÏßÄ??Ï∂îÔøΩ?
            document.body.insertAdjacentHTML('beforeend', modalHTML);

            // Î™®Îã¨ ?ÔøΩÔøΩ? ?ÔøΩÎ¶≠ ???ÔøΩÍ∏∞
            document.getElementById('email-recipients-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeEmailRecipientsModal();
                }
            });

            // ?ÔøΩÏã†??Í≤Ä??Í∏∞Îä• Ôø?Î©îÏãúÏßÄ ?ÔøΩÎ†•Ôø?Í∏∞Îä• Ï∂îÔøΩ?
            setTimeout(() => {
                const searchInput = document.getElementById('recipient-search');
                const clearButton = document.getElementById('clear-search');
                const messageInput = document.getElementById('email-message-input');
                const charCount = document.getElementById('message-char-count');
                
                // ?ÔøΩÏã†??Í≤Ä??Í∏∞Îä•
                if (searchInput) {
                    searchInput.addEventListener('input', function() {
                        const searchTerm = this.value.toLowerCase();
                        const recipientRows = document.querySelectorAll('#email-recipients-modal .recipient-row');
                        
                        // X Î≤ÑÌäº ?ÔøΩÏãú/?ÔøΩÔøΩ?
                        if (clearButton) {
                            clearButton.style.display = this.value ? 'block' : 'none';
                        }
                        
                        recipientRows.forEach(row => {
                            const text = row.textContent.toLowerCase();
                            if (text.includes(searchTerm)) {
                                row.style.display = 'grid';
                            } else {
                                row.style.display = 'none';
                            }
                        });
                    });
                }
                
                // Î©îÏãúÏßÄ ?ÔøΩÎ†•Ôø?Í∏Ä????Ïπ¥Ïö¥??Í∏∞Îä•
                if (messageInput && charCount) {
                    const maxLength = 500;
                    
                    // Ï¥àÍ∏∞ Í∏Ä?????ÔøΩÏ†ï
                    charCount.textContent = messageInput.value.length;
                    
                    messageInput.addEventListener('input', function() {
                        const currentLength = this.value.length;
                        charCount.textContent = currentLength;
                        
                        // Í∏Ä?????ÔøΩÌïú
                        if (currentLength > maxLength) {
                            this.value = this.value.substring(0, maxLength);
                            charCount.textContent = maxLength;
                        }
                        
                        // Í∏Ä???ÔøΩÏóê ?ÔøΩÎ•∏ ?ÔøΩÏÉÅ Î≥ÄÔø?                        if (currentLength >= maxLength * 0.9) {
                            charCount.style.color = '#ff9800'; // Í≤ΩÍ≥† ?ÔøΩÏÉÅ
                        } else if (currentLength >= maxLength * 0.8) {
                            charCount.style.color = '#ff9800'; // Ï£ºÏùò ?ÔøΩÏÉÅ
                        } else {
                            charCount.style.color = '#7a7a7a'; // Í∏∞Î≥∏ ?ÔøΩÏÉÅ
                        }
                    });
                }
            }, 100);
        }

        // Ôø??ÔøΩÏã†????Í≥ÑÏÇ∞ ?ÔøΩÏàò
        function calculateTotalRecipients(selectedGroups, customEmailList) {
            let total = 0;
            
            // Ôø?Í∑∏Î£πÔø??ÔøΩÏã†????Í≥ÑÏÇ∞
            selectedGroups.forEach(group => {
                switch(group) {
                    case 'Í¥ÄÎ¶¨Ïûê':
                        total += 3; // Í¥ÄÎ¶¨Ïûê 3Ôø?                        break;
                    case '?ÔøΩÏ≤¥ Î©§Î≤Ñ':
                        total += 127; // ?ÔøΩÏ≤¥ Î©§Î≤Ñ 127Ôø?                        break;
                    case 'ÎπÑÌôú??Î©§Î≤Ñ':
                        total += 23; // ÎπÑÌôú??Î©§Î≤Ñ 23Ôø?                        break;
                }
            });
            
            // ÏßÅÏ†ë ?ÔøΩÎ†• ?ÔøΩÎ©î????Ï∂îÔøΩ?
            if (customEmailList) {
                const emails = customEmailList.split(',').filter(email => email.trim().length > 0);
                total += emails.length;
            }
            
            return total;
        }

        // ?ÔøΩÏã†??Í∑∏Î£π HTML ?ÔøΩÏÑ± ?ÔøΩÏàò
        function generateRecipientGroups(selectedGroups, customEmailList) {
            let html = '';
            
            // ?ÔøΩÏ†ú Î©§Î≤Ñ ?ÔøΩÏù¥?ÔøΩÔøΩ? ?ÔøΩÏö©?ÔøΩÏó¨ Í∑∏Î£πÔø??ÔøΩÏã†???ÔøΩÏãú
            const adminCheckbox = document.getElementById('admin-checkbox');
            const allMembersCheckbox = document.getElementById('all-members-checkbox');
            const inactiveMembersCheckbox = document.getElementById('inactive-members-checkbox');
            const customEmailCheckbox = document.getElementById('custom-email-checkbox');
            
            // Í¥ÄÎ¶¨Ïûê Í∑∏Î£π
            if (adminCheckbox && adminCheckbox.checked) {
                const admins = originalMembersData ? originalMembersData.filter(member => member.role === 'owner') : [];
                html += `
                    <div style="margin-bottom: 20px;">
                        <div style="color: #fff; font-size: 14px; font-weight: 600; margin-bottom: 10px;">??Í¥ÄÎ¶¨Ïûê <span style="color: #fff;">(</span><span style="color: #fff; font-weight: 700;">${admins.length}Ôø?/span><span style="color: #fff;">)</span></div>
                        <div style="
                            border: 1px solid #3a3a3a;
                            border-radius: 4px;
                            overflow: hidden;
                            max-height: 200px;
                            overflow-y: auto;
                            scrollbar-width: thin;
                            scrollbar-color: #2a2a2a #1a1a1a;
                        ">
                            ${admins.length > 0 ? admins.map(admin => `
                                <div class="recipient-row" style="
                                    display: grid;
                                    grid-template-columns: 1fr 2fr;
                                    border-bottom: 1px solid #3a3a3a;
                                ">
                                    <div style="padding: 10px; color: #ff9800; border-right: 1px solid #3a3a3a;">${admin.name || 'Unnamed'}</div>
                                    <div style="padding: 10px; color: #ff9800;">${admin.email}</div>
                                </div>
                            `).join('') : '<div style="padding: 10px; color: #7a7a7a; text-align: center;">Í¥ÄÎ¶¨ÏûêÍ∞Ä ?ÔøΩÏäµ?ÔøΩÎã§.</div>'}
                        </div>
                    </div>
                `;
            }
            
            // ?ÔøΩÏ≤¥ Î©§Î≤Ñ Í∑∏Î£π
            if (allMembersCheckbox && allMembersCheckbox.checked) {
                const allMembers = originalMembersData ? [...originalMembersData] : [];
                html += `
                    <div style="margin-bottom: 20px;">
                        <div style="color: #fff; font-size: 14px; font-weight: 600; margin-bottom: 10px;">???ÔøΩÏ≤¥ Î©§Î≤Ñ <span style="color: #fff;">(</span><span style="color: #fff; font-weight: 700;">${allMembers.length}Ôø?/span><span style="color: #fff;">)</span></div>
                        <div style="
                            border: 1px solid #3a3a3a;
                            border-radius: 4px;
                            overflow: hidden;
                            max-height: 200px;
                            overflow-y: auto;
                            scrollbar-width: thin;
                            scrollbar-color: #2a2a2a #1a1a1a;
                        ">
                            ${allMembers.length > 0 ? allMembers.map(member => `
                                <div class="recipient-row" style="
                                    display: grid;
                                    grid-template-columns: 1fr 2fr;
                                    border-bottom: 1px solid #3a3a3a;
                                ">
                                    <div style="padding: 10px; color: #e1e1e1; border-right: 1px solid #3a3a3a;">${member.name || 'Unnamed'}</div>
                                    <div style="padding: 10px; color: #e1e1e1;">${member.email}</div>
                                </div>
                            `).join('') : '<div style="padding: 10px; color: #7a7a7a; text-align: center;">Î©§Î≤ÑÍ∞Ä ?ÔøΩÏäµ?ÔøΩÎã§.</div>'}
                        </div>
                    </div>
                `;
            }
            
            // ÎπÑÌôú??Î©§Î≤Ñ Í∑∏Î£π
            if (inactiveMembersCheckbox && inactiveMembersCheckbox.checked) {
                const inactiveMembers = originalMembersData ? originalMembersData.filter(member => member.spendData.premiumRequests === 0) : [];
                html += `
                    <div style="margin-bottom: 20px;">
                        <div style="color: #fff; font-size: 14px; font-weight: 600; margin-bottom: 10px;">??ÎπÑÌôú??Î©§Î≤Ñ <span style="color: #fff;">(</span><span style="color: #fff; font-weight: 700;">${inactiveMembers.length}Ôø?/span><span style="color: #fff;">)</span></div>
                        <div style="
                            border: 1px solid #3a3a3a;
                            border-radius: 4px;
                            overflow: hidden;
                            max-height: 200px;
                            overflow-y: auto;
                            scrollbar-width: thin;
                            scrollbar-color: #2a2a2a #1a1a1a;
                        ">
                            ${inactiveMembers.length > 0 ? inactiveMembers.map(member => `
                                <div class="recipient-row" style="
                                    display: grid;
                                    grid-template-columns: 1fr 2fr;
                                    border-bottom: 1px solid #3a3a3a;
                                ">
                                    <div style="padding: 10px; color: #7a7a7a; border-right: 1px solid #3a3a3a;">${member.name || 'Unnamed'}</div>
                                    <div style="padding: 10px; color: #7a7a7a;">${member.email}</div>
                                </div>
                            `).join('') : '<div style="padding: 10px; color: #7a7a7a; text-align: center;">ÎπÑÌôú??Î©§Î≤ÑÍ∞Ä ?ÔøΩÏäµ?ÔøΩÎã§.</div>'}
                        </div>
                    </div>
                `;
            }
            
            // ÏßÅÏ†ë ?ÔøΩÎ†• ?ÔøΩÎ©î??Í∑∏Î£π
            if (customEmailCheckbox && customEmailCheckbox.checked && customEmailList) {
                const emailList = customEmailList.split(',').filter(email => email.trim().length > 0);
                html += `
                    <div style="margin-bottom: 20px;">
                        <div style="color: #fff; font-size: 14px; font-weight: 600; margin-bottom: 10px;">??ÏßÅÏ†ë ?ÔøΩÎ†• <span style="color: #fff;">(</span><span style="color: #fff; font-weight: 700;">${emailList.length}Ôø?/span><span style="color: #fff;">)</span></div>
                        <div style="
                            border: 1px solid #3a3a3a;
                            border-radius: 4px;
                            overflow: hidden;
                            max-height: 200px;
                            overflow-y: auto;
                            scrollbar-width: thin;
                            scrollbar-color: #2a2a2a #1a1a1a;
                        ">
                            ${emailList.length > 0 ? emailList.map(email => `
                                <div class="recipient-row" style="
                                    display: grid;
                                    grid-template-columns: 1fr 2fr;
                                    border-bottom: 1px solid #3a3a3a;
                                ">
                                    <div style="padding: 10px; color: #4a9eff; border-right: 1px solid #3a3a3a;">ÏßÅÏ†ë ?ÔøΩÎ†•</div>
                                    <div style="padding: 10px; color: #4a9eff;">${email.trim()}</div>
                                </div>
                            `).join('') : '<div style="padding: 10px; color: #7a7a7a; text-align: center;">ÏßÅÏ†ë ?ÔøΩÎ†•???ÔøΩÎ©î?ÔøΩÏù¥ ?ÔøΩÏäµ?ÔøΩÎã§.</div>'}
                        </div>
                    </div>
                `;
            }
            
            return html;
        }

        // Î©§Î≤Ñ ???ÔøΩÏÑ± ?ÔøΩÏàò
        function generateMemberRows(count, type) {
            let html = '';
            const names = ['ÍπÄÏ≤†Ïàò', '?ÔøΩÏòÅ??, 'Î∞ïÔøΩ???, '?ÔøΩÏàòÔø?, 'ÏµúÎèô??, '?ÔøΩÏÑú??, 'Í∞ïÌÉú??, '?ÔøΩÔøΩ???, '?ÔøΩÏäπ??, '?ÔøΩÔøΩ???];
            const domains = ['samsung.com', 'samsung.co.kr'];
            
            for (let i = 0; i < count; i++) {
                const name = names[i % names.length] + (Math.floor(i / names.length) + 1);
                const domain = domains[i % domains.length];
                const email = `${name.toLowerCase().replace(/[Í∞Ä-??/g, '')}@${domain}`;
                
                html += `
                    <div class="recipient-row" style="
                        display: grid;
                        grid-template-columns: 1fr 2fr;
                        ${i < count - 1 ? 'border-bottom: 1px solid #3a3a3a;' : ''}
                    ">
                        <div style="padding: 10px; color: #ff9800; border-right: 1px solid #3a3a3a;">${name}</div>
                        <div style="padding: 10px; color: #ff9800;">${email}</div>
                    </div>
                `;
            }
            
            return html;
        }

        // Í≤Ä?ÔøΩÏ∞Ω Ï¥àÍ∏∞???ÔøΩÏàò
        function clearRecipientSearch() {
            const searchInput = document.getElementById('recipient-search');
            const clearButton = document.getElementById('clear-search');
            
            if (searchInput) {
                searchInput.value = '';
                if (clearButton) {
                    clearButton.style.display = 'none';
                }
                
                // Î™®Îì† ???ÔøΩÏãú ?ÔøΩÏãú
                const recipientRows = document.querySelectorAll('#email-recipients-modal .recipient-row');
                recipientRows.forEach(row => {
                    row.style.display = 'grid';
                });
            }
        }

        // ?ÔøΩÏ†ï ?Ôø???ÔøΩÏàò
        function saveEmailSettings() {
            // ?ÔøΩÎèô Î¶¨Ìè¨???ÔøΩÏÑ±???ÔøΩÏù∏
            const autoReportToggle = document.querySelector('#settings .toggle-switch');
            const isAutoReportEnabled = autoReportToggle && autoReportToggle.classList.contains('active') || autoReportToggle && !autoReportToggle.classList.contains('off');

            if (!isAutoReportEnabled) {
                alert('?ÔøΩÔ∏è ?ÔøΩÎèô Î¶¨Ìè¨??Î∞úÏÜ°??ÎπÑÌôú?ÔøΩÌôî ?ÔøΩÌÉú?ÔøΩÎãà??\n?ÔøΩÏ†ï???Ôø?ÔøΩÌïòÔø??ÔøΩÏóê ?ÔøΩÎèô Î¶¨Ìè¨?ÔøΩÔøΩ? ?ÔøΩÏÑ±?ÔøΩÌï¥Ï£ºÏÑ∏??');
                return;
            }

            // ?ÔøΩÌÉù???ÔøΩÏã†??Í∑∏Î£π ?ÔøΩÏù∏
            const selectedGroups = [];
            const adminCheckbox = document.getElementById('admin-checkbox');
            const allMembersCheckbox = document.getElementById('all-members-checkbox');
            const inactiveMembersCheckbox = document.getElementById('inactive-members-checkbox');
            const customEmailCheckbox = document.getElementById('custom-email-checkbox');
            
            if (adminCheckbox && adminCheckbox.checked) selectedGroups.push('Í¥ÄÎ¶¨Ïûê');
            if (allMembersCheckbox && allMembersCheckbox.checked) selectedGroups.push('?ÔøΩÏ≤¥ Î©§Î≤Ñ');
            if (inactiveMembersCheckbox && inactiveMembersCheckbox.checked) selectedGroups.push('ÎπÑÌôú??Î©§Î≤Ñ');
            if (customEmailCheckbox && customEmailCheckbox.checked) selectedGroups.push('ÏßÅÏ†ë ?ÔøΩÎ†•');

            if (selectedGroups.length === 0) {
                alert('?ÔøΩÔ∏è ?ÔøΩÏã†??Í∑∏Î£π??ÏµúÏÜå ?ÔøΩÎÇò ?ÔøΩÏÉÅ ?ÔøΩÌÉù?ÔøΩÏ£º?ÔøΩÏöî.');
                return;
            }

            // ÏßÅÏ†ë ?ÔøΩÎ†• Ï≤¥ÌÅ¨ ???ÔøΩÎ©î??Ï£ºÏÜå ?ÔøΩÏù∏
            const customEmails = document.getElementById('custom-emails');
            
            if (customEmailCheckbox && customEmailCheckbox.checked) {
                if (!customEmails || !customEmails.value.trim()) {
                    alert('?ÔøΩÔ∏è ÏßÅÏ†ë ?ÔøΩÎ†•???ÔøΩÌÉù?ÔøΩÏÖ®?ÔøΩÎãà??\n?ÔøΩÎ©î??Ï£ºÏÜåÔø??ÔøΩÎ†•?ÔøΩÏ£º?ÔøΩÏöî.');
                    return;
                }
                
                // ?ÔøΩÎ©î???ÔøΩÏãù Í∞ÑÎã® Í≤ÄÔø?                const emailList = customEmails.value.split(',');
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                for (let email of emailList) {
                    email = email.trim();
                    if (email && !emailRegex.test(email)) {
                        alert(`?ÔøΩÔ∏è ?ÔøΩÎ∞îÎ•¥ÔøΩ? ?ÔøΩÔøΩ? ?ÔøΩÎ©î???ÔøΩÏãù?ÔøΩÎãà?? ${email}\n\n?ÔøΩÎ∞îÔø??ÔøΩÏãù: example@samsung.com`);
                        return;
                    }
                }
            }

            // Î©îÏãúÏßÄ ?ÔøΩÎ†• ?ÔøΩÏù∏
            const messageInput = document.getElementById('email-report-message');
            const messageText = messageInput ? messageInput.value.trim() : '';
            
            if (!messageText) {
                alert('?ÔøΩÔ∏è ?ÔøΩÎ†•??Î©îÏùº???ÔøΩÏäµ?ÔøΩÎã§.\n\nÎ∞úÏÜ° Î©îÏãúÏßÄ ?ÔøΩÎ†•?Ôø??Î©îÏãúÏßÄÔø??ÔøΩÎ†•?ÔøΩÏ£º?ÔøΩÏöî.');
                return;
            }

            // ?ÔøΩÏû¨ ?ÔøΩÏ†ï Í∞íÎì§ ?ÔøΩÏßë
            const frequency = document.getElementById('email-frequency-select');
            const timeInput = document.getElementById('email-time-input');
            
            const frequencyText = frequency ? frequency.options[frequency.selectedIndex].text : 'Îß§Ï£º';
            const frequencyValue = frequency ? frequency.value : 'weekly';
            
            // ?ÔøΩÍ∞Ñ ?ÔøΩÎ†• Ï≤òÎ¶¨
            let timeText = '?ÔøΩÏ†Ñ 9??00Ôø?;
            let timeValue = '09:00';
            if (timeInput && timeInput.value) {
                const [hours, minutes] = timeInput.value.split(':');
                const hour = parseInt(hours);
                const minute = parseInt(minutes);
                timeValue = timeInput.value;
                
                if (hour < 12) {
                    timeText = `?ÔøΩÏ†Ñ ${hour}??${minute.toString().padStart(2, '0')}Ôø?;
                } else if (hour === 12) {
                    timeText = `?ÔøΩÌõÑ 12??${minute.toString().padStart(2, '0')}Ôø?;
                } else {
                    timeText = `?ÔøΩÌõÑ ${hour - 12}??${minute.toString().padStart(2, '0')}Ôø?;
                }
            }

            // ?ÔøΩÏã†???ÔøΩÎ≥¥ ?ÔøΩÏßë
            let recipientsText = selectedGroups.join(', ');
            if (customEmailCheckbox && customEmailCheckbox.checked && customEmails && customEmails.value.trim()) {
                recipientsText += `, ÏßÅÏ†ë?ÔøΩÎ†•`;
            }

            // ???ÔøΩÏïΩ ?ÔøΩÏÑ±
            const newSchedule = {
                id: Date.now(), // Í≥†Ïú† ID ?ÔøΩÏÑ±
                title: `${frequencyText} Î¶¨Ìè¨??,
                frequency: frequencyText,
                time: timeText,
                recipients: recipientsText,
                status: "?ÔøΩÏÑ±",
                nextSend: calculateNextSendTime(frequencyValue, timeValue),
                message: messageText
            };

            // ?ÔøΩÏïΩ Î¶¨Ïä§?ÔøΩÏóê Ï∂îÔøΩ? (?ÔøΩÏó≠ Î≥Ä?ÔøΩÎ°ú Í¥ÄÔø?
            if (!window.emailScheduleList) {
                window.emailScheduleList = [];
            }
            window.emailScheduleList.push(newSchedule);

            // ?Ôø???ÔøΩÍ≥µ Î©îÏãúÏßÄ
            alert('??Email Report ?ÔøΩÏ†ï???ÔøΩÍ≥µ?ÔøΩÏúºÔø??Ôø?ÔøΩÎêò?ÔøΩÏäµ?ÔøΩÎã§!\n\n?ÔøΩÎ°ú???ÔøΩÏïΩ???ÔøΩÏïΩ Î¶¨Ïä§?ÔøΩÏóê Ï∂îÔøΩ??ÔøΩÏóà?ÔøΩÎãà??');
            console.log('Email Report ?ÔøΩÏ†ï ?Ôø???ÔøΩÎ£å', newSchedule);
        }

        // ?ÔøΩÏùå Î∞úÏÜ° ?ÔøΩÍ∞Ñ Í≥ÑÏÇ∞ ?ÔøΩÏàò
        function calculateNextSendTime(frequency, time) {
            const now = new Date();
            const [hours, minutes] = time.split(':');
            let nextDate = new Date();
            
            // ?ÔøΩÍ∞Ñ ?ÔøΩÏ†ï
            nextDate.setHours(parseInt(hours), parseInt(minutes), 0, 0);
            
            // Ï£ºÍ∏∞???ÔøΩÎ•∏ ?ÔøΩÏßú Ï°∞Ï†ï
            switch(frequency) {
                case 'daily':
                    // ?ÔøΩÏùå?ÔøΩÎ°ú ?ÔøΩÏ†ï
                    nextDate.setDate(nextDate.getDate() + 1);
                    break;
                case 'weekly':
                    // ?ÔøΩÏùåÔø?Í∞ôÔøΩ? ?ÔøΩÏùºÔø??ÔøΩÏ†ï
                    nextDate.setDate(nextDate.getDate() + 7);
                    break;
                case 'monthly':
                    // ?ÔøΩÏùå??Í∞ôÔøΩ? ?ÔøΩÏßúÔø??ÔøΩÏ†ï
                    nextDate.setMonth(nextDate.getMonth() + 1);
                    break;
            }
            
            // ?ÔøΩÏû¨ ?ÔøΩÍ∞ÑÎ≥¥Îã§ ?ÔøΩÏ†Ñ?ÔøΩÎ©¥ ?ÔøΩÏùå Ï£ºÍ∏∞Ôø?Ï°∞Ï†ï
            if (nextDate <= now) {
                switch(frequency) {
                    case 'daily':
                        nextDate.setDate(nextDate.getDate() + 1);
                        break;
                    case 'weekly':
                        nextDate.setDate(nextDate.getDate() + 7);
                        break;
                    case 'monthly':
                        nextDate.setMonth(nextDate.getMonth() + 1);
                        break;
                }
            }
            
            return nextDate.toLocaleDateString('ko-KR') + ' ' + nextDate.toLocaleTimeString('ko-KR', {hour: '2-digit', minute: '2-digit'});
        }

        // Î©§Î≤Ñ ???ÔøΩÏÑ± ?ÔøΩÏàò
        function generateMemberRows(count, type) {
            let html = '';
            const names = ['ÍπÄÏ≤†Ïàò', '?ÔøΩÏòÅ??, 'Î∞ïÔøΩ???, '?ÔøΩÏàòÔø?, 'ÏµúÎèô??, '?ÔøΩÏÑú??, 'Í∞ïÌÉú??, '?ÔøΩÔøΩ???, '?ÔøΩÏäπ??, '?ÔøΩÔøΩ???];
            const domains = ['samsung.com', 'samsung.co.kr'];
            
            for (let i = 0; i < count; i++) {
                const name = names[i % names.length] + (Math.floor(i / names.length) + 1);
                const domain = domains[i % domains.length];
                const email = `${name.toLowerCase().replace(/[Í∞Ä-??/g, '')}@${domain}`;
                
                html += `
                    <div class="recipient-row" style="
                        display: grid;
                        grid-template-columns: 1fr 2fr;
                        ${i < count - 1 ? 'border-bottom: 1px solid #3a3a3a;' : ''}
                    ">
                        <div style="padding: 10px; color: #ff9800; border-right: 1px solid #3a3a3a;">${name}</div>
                        <div style="padding: 10px; color: #ff9800;">${email}</div>
                    </div>
                `;
            }
            
            return html;
        }

        // Í≤Ä?ÔøΩÏ∞Ω Ï¥àÍ∏∞???ÔøΩÏàò
        function clearRecipientSearch() {
            const searchInput = document.getElementById('recipient-search');
            const clearButton = document.getElementById('clear-search');
            
            if (searchInput) {
                searchInput.value = '';
                if (clearButton) {
                    clearButton.style.display = 'none';
                }
                
                // Î™®Îì† ???ÔøΩÏãú ?ÔøΩÏãú
                const recipientRows = document.querySelectorAll('#email-recipients-modal .recipient-row');
                recipientRows.forEach(row => {
                    row.style.display = 'grid';
                });
            }
        }

        // ?ÔøΩÏïΩ Î¶¨Ïä§??Î≥¥Í∏∞ ?ÔøΩÏàò
        function showEmailScheduleList() {
            // Í∏∞Ï°¥ Î™®Îã¨???ÔøΩÏúºÔø??ÔøΩÍ±∞
            const existingModal = document.getElementById('email-schedule-modal');
            if (existingModal) {
                existingModal.remove();
            }

            // ?ÔøΩÏïΩ Î¶¨Ïä§???ÔøΩÏù¥??(?Ôø?ÔøΩÎêú ?ÔøΩÏïΩ + Í∏∞Î≥∏ ?ÔøΩÌîå ?ÔøΩÏù¥??
            let scheduleList = [];
            
            // ?Ôø?ÔøΩÎêú ?ÔøΩÏïΩ Î¶¨Ïä§?ÔøΩÔøΩ? ?ÔøΩÏúºÔø?Ï∂îÔøΩ?
            if (window.emailScheduleList && window.emailScheduleList.length > 0) {
                scheduleList = scheduleList.concat(window.emailScheduleList);
            }
            
            // Í∏∞Î≥∏ ?ÔøΩÌîå ?ÔøΩÏù¥??(?Ôø?ÔøΩÎêú ?ÔøΩÏïΩ???ÔøΩÏùÑ ?ÔøΩÎßå ?ÔøΩÏãú)
            if (scheduleList.length === 0) {
                scheduleList = [
                    {
                        id: 1,
                        title: "Ï£ºÍ∞Ñ ?ÔøΩÎèô Î¶¨Ìè¨??,
                        frequency: "Îß§Ï£º",
                        time: "?ÔøΩÏ†Ñ 9??00Ôø?,
                        recipients: "Í¥ÄÎ¶¨Ïûê, ?ÔøΩÏ≤¥ Î©§Î≤Ñ",
                        status: "?ÔøΩÏÑ±",
                        nextSend: "2025-01-27 09:00",
                        message: "?ÔøΩÎ≤à Ôø??Ôø??ÔøΩÎèô ?ÔøΩÌô©???ÔøΩÏù∏?ÔøΩÎ≥¥?ÔøΩÏöî."
                    },
                    {
                        id: 2,
                        title: "?ÔøΩÍ∞Ñ ?ÔøΩÍ≥Ñ Î¶¨Ìè¨??,
                        frequency: "Îß§Ïõî",
                        time: "?ÔøΩÌõÑ 2??00Ôø?,
                        recipients: "Í¥ÄÎ¶¨Ïûê",
                        status: "?ÔøΩÏÑ±",
                        nextSend: "2025-02-01 14:00",
                        message: "?ÔøΩÍ∞Ñ ?ÔøΩÍ≥Ñ Ôø?Î∂ÑÏÑù Í≤∞Í≥º?ÔøΩÎãà??"
                    },
                    {
                        id: 3,
                        title: "?ÔøΩÏùº ?ÔøΩÏïΩ Î¶¨Ìè¨??,
                        frequency: "Îß§Ïùº",
                        time: "?ÔøΩÌõÑ 6??00Ôø?,
                        recipients: "?ÔøΩÏ≤¥ Î©§Î≤Ñ",
                        status: "ÎπÑÌôú??,
                        nextSend: "-",
                        message: "?ÔøΩÎäò???ÔøΩÎèô ?ÔøΩÏïΩ?ÔøΩÎãà??"
                    }
                ];
            }

            // Î™®Îã¨ HTML ?ÔøΩÏÑ±
            const modalHTML = `
                <div id="email-schedule-modal" style="
                    display: block;
                    position: fixed;
                    z-index: 1000;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    background-color: rgba(0,0,0,0.7);
                ">
                    <div style="
                        background-color: #2a2a2a;
                        margin: 5% auto;
                        padding: 25px;
                        border-radius: 8px;
                        width: 90%;
                        max-width: 800px;
                        box-shadow: 0 4px 20px rgba(0,0,0,0.5);
                        max-height: 85vh;
                        overflow-y: auto;
                        border: 1px solid #3a3a3a;
                    ">
                        <!-- Î™®Îã¨ ?ÔøΩÎçî -->
                        <div style="
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                            margin-bottom: 25px;
                            padding-bottom: 15px;
                            border-bottom: 1px solid #3a3a3a;
                        ">
                            <div style="color: #fff; font-size: 18px; font-weight: 600;">Î©îÏùº Î∞úÏÜ° ?ÔøΩÏïΩ Î¶¨Ïä§??/div>
                            <button onclick="closeEmailScheduleModal()" style="
                                background: none;
                                border: none;
                                color: #7a7a7a;
                                font-size: 20px;
                                cursor: pointer;
                                padding: 5px;
                                border-radius: 3px;
                                transition: color 0.2s ease;
                            " onmouseover="this.style.color='#fff'" onmouseout="this.style.color='#7a7a7a'">√ó</button>
                        </div>

                        <!-- Í≤Ä??Ôø??ÔøΩÌÑ∞ -->
                        <div style="margin-bottom: 20px;">
                            <div style="
                                position: relative;
                                display: flex;
                                align-items: center;
                                background-color: #1a1a1a;
                                border: 1px solid #3a3a3a;
                                border-radius: 4px;
                                padding: 0 12px;
                                transition: all 0.2s ease;
                                margin-bottom: 15px;
                            " onfocus="this.style.backgroundColor='#2a2a2a'; this.style.borderColor='#4a9eff'" onblur="this.style.backgroundColor='#1a1a1a'; this.style.borderColor='#3a3a3a'">
                                <span style="
                                    color: #7a7a7a;
                                    margin-right: 8px;
                                    font-size: 14px;
                                ">?ÔøΩÔøΩ</span>
                                <input 
                                    type="text" 
                                    id="schedule-search" 
                                    placeholder="?ÔøΩÏïΩ Î¶¨Ïä§??Í≤Ä??.."
                                    style="
                                        flex: 1;
                                        padding: 10px 0;
                                        border: none;
                                        background: transparent;
                                        color: #e1e1e1;
                                        font-size: 14px;
                                        outline: none;
                                    "
                                >
                            </div>
                            
                            <!-- ?ÔøΩÌÑ∞ Î≤ÑÌäº -->
                            <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                                <button class="chart-btn active" data-filter="all" onclick="filterScheduleList('all')">?ÔøΩÏ≤¥</button>
                                <button class="chart-btn" data-filter="active" onclick="filterScheduleList('active')">?ÔøΩÏÑ±</button>
                                <button class="chart-btn" data-filter="inactive" onclick="filterScheduleList('inactive')">ÎπÑÌôú??/button>
                            </div>
                        </div>

                        <!-- ?ÔøΩÏïΩ Î¶¨Ïä§???ÔøΩÏù¥Ôø?-->
                        <div style="
                            background-color: #1a1a1a;
                            border-radius: 4px;
                            overflow: hidden;
                            margin-bottom: 20px;
                        ">
                            <!-- ?ÔøΩÏù¥Ôø??ÔøΩÎçî -->
                            <div style="
                                display: grid;
                                grid-template-columns: 2fr 1fr 1fr 1.5fr 1fr 1fr 1fr;
                                gap: 15px;
                                padding: 15px;
                                background-color: #1a1a1a;
                                border-bottom: 1px solid #3a3a3a;
                                font-weight: 600;
                                color: #fff;
                                font-size: 14px;
                            ">
                                <div>?ÔøΩÎ™©</div>
                                <div>Ï£ºÍ∏∞</div>
                                <div>?ÔøΩÍ∞Ñ</div>
                                <div>?ÔøΩÏã†??/div>
                                <div>?ÔøΩÌÉú</div>
                                <div>?ÔøΩÏùå Î∞úÏÜ°</div>
                                <div>?ÔøΩÏóÖ</div>
                            </div>

                            <!-- ?ÔøΩÏù¥Ôø??ÔøΩÏö© -->
                            <div id="schedule-list-content">
                                ${scheduleList.map(item => `
                                    <div class="schedule-item" data-status="${item.status}" style="
                                        display: grid;
                                        grid-template-columns: 2fr 1fr 1fr 1.5fr 1fr 1fr 1fr;
                                        gap: 15px;
                                        padding: 15px;
                                        border-bottom: 1px solid #3a3a3a;
                                        color: #e1e1e1;
                                        font-size: 14px;
                                        transition: background-color 0.2s ease;
                                    " onmouseover="this.style.backgroundColor='#3a3a3a'" onmouseout="this.style.backgroundColor='transparent'">
                                        <div style="cursor: pointer;" onclick="showScheduleDetail(${item.id})">
                                            <div style="font-weight: 600; color: #fff; margin-bottom: 5px;">${item.title}</div>
                                            <div style="color: #7a7a7a; font-size: 12px;">${item.message}</div>
                                        </div>
                                        <div>${item.frequency}</div>
                                        <div>${item.time}</div>
                                        <div>${item.recipients}</div>
                                        <div>
                                            <span style="
                                                padding: 4px 8px;
                                                border-radius: 12px;
                                                font-size: 12px;
                                                font-weight: 600;
                                                ${item.status === '?ÔøΩÏÑ±' ? 'background-color: #4a9eff; color: white;' : 'background-color: #5a5a5a; color: #b1b1b1;'}
                                            ">${item.status}</span>
                                        </div>
                                        <div style="color: #7a7a7a;">${item.nextSend}</div>
                                        <div style="display: flex; gap: 5px;">
                                            <button onclick="editSchedule(${item.id})" style="
                                                background: none;
                                                border: none;
                                                color: #4a9eff;
                                                cursor: pointer;
                                                padding: 4px;
                                                font-size: 12px;
                                            ">?ÔøΩÏßë</button>
                                            <button onclick="toggleScheduleStatus(${item.id})" style="
                                                background: none;
                                                border: none;
                                                color: ${item.status === '?ÔøΩÏÑ±' ? '#ff9800' : '#4a9eff'};
                                                cursor: pointer;
                                                padding: 4px;
                                                font-size: 12px;
                                            ">${item.status === '?ÔøΩÏÑ±' ? 'ÎπÑÌôú?? : '?ÔøΩÏÑ±'}</button>
                                            <button onclick="deleteSchedule(${item.id})" style="
                                                background: none;
                                                border: none;
                                                color: #ff4757;
                                                cursor: pointer;
                                                padding: 4px;
                                                font-size: 12px;
                                            ">??ÔøΩÔøΩ</button>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        <!-- ?ÔøΩÎã® Î≤ÑÌäº -->
                        <div style="display: flex; justify-content: space-between; align-items: center; border-top: 1px solid #3a3a3a; padding-top: 20px;">
                            <div style="color: #7a7a7a; font-size: 14px;">
                                Ôø?${scheduleList.length}Í∞úÏùò ?ÔøΩÏïΩ Î¶¨Ïä§??                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button class="analytics-btn" onclick="addNewSchedule()">???ÔøΩÏïΩ Ï∂îÔøΩ?</button>
                                <button class="chart-btn" onclick="closeEmailScheduleModal()">?ÔøΩÍ∏∞</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Î™®Îã¨???ÔøΩÏù¥ÏßÄ??Ï∂îÔøΩ?
            document.body.insertAdjacentHTML('beforeend', modalHTML);

            // Î™®Îã¨ ?ÔøΩÔøΩ? ?ÔøΩÎ¶≠ ???ÔøΩÍ∏∞
            document.getElementById('email-schedule-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeEmailScheduleModal();
                }
            });

            // Í≤Ä??Í∏∞Îä• Ï∂îÔøΩ?
            setTimeout(() => {
                const searchInput = document.getElementById('schedule-search');
                if (searchInput) {
                    searchInput.addEventListener('input', function() {
                        const searchTerm = this.value.toLowerCase();
                        const scheduleItems = document.querySelectorAll('#email-schedule-modal .schedule-item');
                        
                        scheduleItems.forEach(item => {
                            const text = item.textContent.toLowerCase();
                            if (text.includes(searchTerm)) {
                                item.style.display = 'grid';
                            } else {
                                item.style.display = 'none';
                            }
                        });
                    });
                }
            }, 100);
        }

        // ?ÔøΩÏïΩ Î¶¨Ïä§??Î™®Îã¨ ?ÔøΩÍ∏∞ ?ÔøΩÏàò
        function closeEmailScheduleModal() {
            const modal = document.getElementById('email-schedule-modal');
            if (modal) {
                modal.remove();
            }
        }

        // ?ÔøΩÏïΩ Î¶¨Ïä§???ÔøΩÌÑ∞Ôø??ÔøΩÏàò
        function filterScheduleList(filter) {
            const filterButtons = document.querySelectorAll('#email-schedule-modal [data-filter]');
            const scheduleItems = document.querySelectorAll('#email-schedule-modal .schedule-item');
            
            // ?ÔøΩÌÑ∞ Î≤ÑÌäº ?ÔøΩÏÑ±???ÔøΩÌÉú Î≥ÄÔø?            filterButtons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // ?ÔøΩÏù¥???ÔøΩÌÑ∞Ôø?            scheduleItems.forEach(item => {
                const status = item.getAttribute('data-status');
                if (filter === 'all' || status === filter) {
                    item.style.display = 'grid';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        // ?ÔøΩÏïΩ ?ÔøΩÏÑ∏ Î≥¥Í∏∞ ?ÔøΩÏàò
        function showScheduleDetail(id) {
            alert(`?ÔøΩÏïΩ ID ${id}???ÔøΩÏÑ∏ ?ÔøΩÎ≥¥Ôø?Î≥¥Ïó¨Ï§çÎãà??`);
            // ?ÔøΩÏ†úÎ°úÎäî ?ÔøΩÏÑ∏ Î™®Îã¨???ÔøΩÏö∞Í±∞ÎÇò ?ÔøΩÏù¥ÏßÄÔø??ÔøΩÎèô
        }

        // ?ÔøΩÏïΩ ?ÔøΩÏßë ?ÔøΩÏàò
        function editSchedule(id) {
            alert(`?ÔøΩÏïΩ ID ${id}Ôø??ÔøΩÏßë?ÔøΩÎãà??`);
            // ?ÔøΩÏ†úÎ°úÎäî ?ÔøΩÏßë Î™®Îã¨???ÔøΩÏö∞Í±∞ÎÇò ?ÔøΩÏù¥ÏßÄÔø??ÔøΩÎèô
        }

        // ?ÔøΩÏïΩ ?ÔøΩÌÉú ?ÔøΩÔøΩ? ?ÔøΩÏàò
        function toggleScheduleStatus(id) {
            const item = document.querySelector(`#email-schedule-modal .schedule-item[onclick*="${id}"]`);
            if (item) {
                const statusSpan = item.querySelector('span');
                const toggleBtn = item.querySelector('button[onclick*="toggleScheduleStatus"]');
                
                if (statusSpan.textContent === '?ÔøΩÏÑ±') {
                    statusSpan.textContent = 'ÎπÑÌôú??;
                    statusSpan.style.backgroundColor = '#5a5a5a';
                    statusSpan.style.color = '#b1b1b1';
                    item.setAttribute('data-status', 'ÎπÑÌôú??);
                    toggleBtn.textContent = '?ÔøΩÏÑ±';
                    toggleBtn.style.color = '#4a9eff';
                    
                    // ?ÔøΩÏó≠ Î≥Ä???ÔøΩÎç∞?ÔøΩÌä∏
                    if (window.emailScheduleList) {
                        const schedule = window.emailScheduleList.find(s => s.id === id);
                        if (schedule) {
                            schedule.status = 'ÎπÑÌôú??;
                        }
                    }
                } else {
                    statusSpan.textContent = '?ÔøΩÏÑ±';
                    statusSpan.style.backgroundColor = '#4a9eff';
                    statusSpan.style.color = 'white';
                    item.setAttribute('data-status', '?ÔøΩÏÑ±');
                    toggleBtn.textContent = 'ÎπÑÌôú??;
                    toggleBtn.style.color = '#ff9800';
                    
                    // ?ÔøΩÏó≠ Î≥Ä???ÔøΩÎç∞?ÔøΩÌä∏
                    if (window.emailScheduleList) {
                        const schedule = window.emailScheduleList.find(s => s.id === id);
                        if (schedule) {
                            schedule.status = '?ÔøΩÏÑ±';
                        }
                    }
                }
            }
        }

        // ?ÔøΩÏïΩ ??ÔøΩÔøΩ ?ÔøΩÏàò
        function deleteSchedule(id) {
            if (confirm('?ÔøΩÎßêÔø????ÔøΩÏïΩ????ÔøΩÔøΩ?ÔøΩÏãúÍ≤†Ïäµ?ÔøΩÍπå?')) {
                const item = document.querySelector(`#email-schedule-modal .schedule-item[onclick*="${id}"]`);
                if (item) {
                    item.remove();
                    
                    // ?ÔøΩÏó≠ Î≥Ä?ÔøΩÏóê?ÔøΩÎèÑ ??ÔøΩÔøΩ
                    if (window.emailScheduleList) {
                        window.emailScheduleList = window.emailScheduleList.filter(schedule => schedule.id !== id);
                    }
                    
                    // ?ÔøΩÏ†úÎ°úÎäî API ?ÔøΩÏ∂úÔø???ÔøΩÔøΩ Ï≤òÎ¶¨
                    console.log(`?ÔøΩÏïΩ ID ${id}Í∞Ä ??ÔøΩÔøΩ?ÔøΩÏóà?ÔøΩÎãà??`);
                }
            }
        }

        // ???ÔøΩÏïΩ Ï∂îÔøΩ? ?ÔøΩÏàò
        function addNewSchedule() {
            alert('???ÔøΩÏïΩ??Ï∂îÔøΩ??ÔøΩÎãà?? ?ÔøΩÏû¨ ?ÔøΩÏ†ï??Í∏∞Î∞ò?ÔøΩÎ°ú ???ÔøΩÏïΩ???ÔøΩÏÑ±?ÔøΩÎãà??');
            // ?ÔøΩÏ†úÎ°úÎäî ???ÔøΩÏïΩ ?ÔøΩÏÑ± Î™®Îã¨???ÔøΩÏö∞Í±∞ÎÇò ?ÔøΩÏù¥ÏßÄÔø??ÔøΩÎèô
        }

        // ?ÔøΩÏã†??Î≥¥Í∏∞ ?ÔøΩÏàò
        function showEmailRecipients() {
            // Í∏∞Ï°¥ Î™®Îã¨???ÔøΩÏúºÔø??ÔøΩÍ±∞
            const existingModal = document.getElementById('email-recipients-modal');
            if (existingModal) {
                existingModal.remove();
            }

            // ?ÔøΩÏû¨ ?ÔøΩÏ†ï Í∞íÎì§ ?ÔøΩÏßë
            const frequency = document.getElementById('email-frequency-select');
            const timeInput = document.getElementById('email-time-input');
            
            const frequencyText = frequency ? frequency.options[frequency.selectedIndex].text : 'Îß§Ï£º';
            
            // ?ÔøΩÍ∞Ñ ?ÔøΩÎ†• Ï≤òÎ¶¨
            let timeText = '?ÔøΩÏ†Ñ 9??00Ôø?;
            if (timeInput && timeInput.value) {
                const [hours, minutes] = timeInput.value.split(':');
                const hour = parseInt(hours);
                const minute = parseInt(minutes);
                
                if (hour < 12) {
                    timeText = `?ÔøΩÏ†Ñ ${hour}??${minute.toString().padStart(2, '0')}Ôø?;
                } else if (hour === 12) {
                    timeText = `?ÔøΩÌõÑ 12??${minute.toString().padStart(2, '0')}Ôø?;
                } else {
                    timeText = `?ÔøΩÌõÑ ${hour - 12}??${minute.toString().padStart(2, '0')}Ôø?;
                }
            }

            // ?ÔøΩÌÉù???ÔøΩÏã†??Í∑∏Î£π ?ÔøΩÏù∏ Ôø??ÔøΩÏ†ú Î©§Î≤Ñ ?ÔøΩÏù¥???ÔøΩÏßë
            const selectedGroups = [];
            const adminCheckbox = document.getElementById('admin-checkbox');
            const allMembersCheckbox = document.getElementById('all-members-checkbox');
            const inactiveMembersCheckbox = document.getElementById('inactive-members-checkbox');
            const customEmailCheckbox = document.getElementById('custom-email-checkbox');
            
            let allRecipients = [];
            
            // Í¥ÄÎ¶¨Ïûê ?ÔøΩÏßë
            if (adminCheckbox && adminCheckbox.checked) {
                const admins = originalMembersData ? originalMembersData.filter(member => member.role === 'owner') : [];
                allRecipients = allRecipients.concat(admins);
                selectedGroups.push('Í¥ÄÎ¶¨Ïûê');
                console.log(`Í¥ÄÎ¶¨Ïûê ${admins.length}Ôø?Ï∂îÔøΩ?`);
            }
            
            // ?ÔøΩÏ≤¥ Î©§Î≤Ñ ?ÔøΩÏßë
            if (allMembersCheckbox && allMembersCheckbox.checked) {
                const allMembers = originalMembersData ? [...originalMembersData] : [];
                allRecipients = allRecipients.concat(allMembers);
                selectedGroups.push('?ÔøΩÏ≤¥ Î©§Î≤Ñ');
                console.log(`?ÔøΩÏ≤¥ Î©§Î≤Ñ ${allMembers.length}Ôø?Ï∂îÔøΩ?`);
            }
            
            // ÎπÑÌôú??Î©§Î≤Ñ ?ÔøΩÏßë
            if (inactiveMembersCheckbox && inactiveMembersCheckbox.checked) {
                const inactiveMembers = originalMembersData ? originalMembersData.filter(member => member.spendData.premiumRequests === 0) : [];
                allRecipients = allRecipients.concat(inactiveMembers);
                selectedGroups.push('ÎπÑÌôú??Î©§Î≤Ñ');
                console.log(`ÎπÑÌôú??Î©§Î≤Ñ ${inactiveMembers.length}Ôø?Ï∂îÔøΩ?`);
            }
            
            // ÏßÅÏ†ë ?ÔøΩÎ†• ?ÔøΩÎ©î???ÔøΩÏù∏
            const customEmails = document.getElementById('custom-emails');
            const customEmailList = customEmails && customEmails.value.trim() ? customEmails.value.trim() : '';
            
            if (customEmailCheckbox && customEmailCheckbox.checked && customEmailList) {
                const emailList = customEmailList.split(',').filter(email => email.trim().length > 0);
                emailList.forEach(email => {
                    allRecipients.push({
                        name: 'ÏßÅÏ†ë ?ÔøΩÎ†•',
                        email: email.trim(),
                        role: 'custom',
                        spendData: { premiumRequests: 0, spend: 0 }
                    });
                });
                selectedGroups.push('ÏßÅÏ†ë ?ÔøΩÎ†•');
                console.log(`ÏßÅÏ†ë ?ÔøΩÎ†• ?ÔøΩÎ©î??${emailList.length}Ôø?Ï∂îÔøΩ?`);
            }
            
            // Ï§ëÎ≥µ ?ÔøΩÍ±∞ (?ÔøΩÎ©î??Í∏∞ÔøΩ?)
            const uniqueRecipients = [];
            const seenEmails = new Set();
            allRecipients.forEach(recipient => {
                if (!seenEmails.has(recipient.email)) {
                    seenEmails.add(recipient.email);
                    uniqueRecipients.push(recipient);
                }
            });
            
            console.log(`Ôø?${uniqueRecipients.length}Î™ÖÏùò Í≥†Ïú† ?ÔøΩÏã†???ÔøΩÏßë ?ÔøΩÎ£å`);

            // Î™®Îã¨ HTML ?ÔøΩÏÑ±
            const modalHTML = `
                <div id="email-recipients-modal" style="
                    display: block;
                    position: fixed;
                    z-index: 1000;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    background-color: rgba(0,0,0,0.7);
                ">
                    <div style="
                        background-color: #2a2a2a;
                        margin: 5% auto;
                        padding: 25px;
                        border-radius: 8px;
                        width: 90%;
                        max-width: 700px;
                        box-shadow: 0 4px 20px rgba(0,0,0,0.5);
                        max-height: 85vh;
                        overflow-y: auto;
                        border: 1px solid #3a3a3a;
                    ">
                        <!-- Î™®Îã¨ ?ÔøΩÎçî -->
                        <div style="
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                            margin-bottom: 25px;
                            padding-bottom: 15px;
                            border-bottom: 1px solid #3a3a3a;
                        ">
                            <div style="color: #fff; font-size: 18px; font-weight: 600;">?ÔøΩÏã†??ÎØ∏Î¶¨Î≥¥Í∏∞</div>
                            <button onclick="closeEmailRecipientsModal()" style="
                                background: none;
                                border: none;
                                color: #7a7a7a;
                                font-size: 20px;
                                cursor: pointer;
                                padding: 5px;
                                border-radius: 3px;
                                transition: color 0.2s ease;
                            " onmouseover="this.style.color='#fff'" onmouseout="this.style.color='#7a7a7a'">√ó</button>
                        </div>

                        <!-- Î∞úÏÜ° ?ÔøΩÏ†ï -->
                        <div style="margin-bottom: 25px;">
                            <div style="color: #fff; font-size: 16px; font-weight: 600; margin-bottom: 15px;">Î∞úÏÜ° ?ÔøΩÏ†ï</div>
                            <div style="
                                color: #b1b1b1;
                                font-size: 14px;
                                line-height: 1.6;
                            ">
                                <div style="
                                    margin-bottom: 8px;
                                    padding: 8px 12px;
                                    border: 1px solid #3a3a3a;
                                    border-radius: 4px;
                                    background-color: transparent;
                                ">??Ï£ºÍ∏∞: <span style="color: #ff9800;">${frequencyText}</span></div>
                                <div style="
                                    margin-bottom: 8px;
                                    padding: 8px 12px;
                                    border: 1px solid #3a3a3a;
                                    border-radius: 4px;
                                    background-color: transparent;
                                ">???ÔøΩÍ∞Ñ: <span style="color: #ff9800;">${timeText}</span></div>
                                <div style="
                                    margin-bottom: 8px;
                                    padding: 8px 12px;
                                    border: 1px solid #3a3a3a;
                                    border-radius: 4px;
                                    background-color: transparent;
                                ">???ÔøΩÏã†??Í∑∏Î£π: <span style="color: #ff9800;">${selectedGroups.length > 0 ? selectedGroups.join(', ') : '?ÔøΩÌÉù??Í∑∏Î£π ?ÔøΩÏùå'}</span></div>
                                <div style="
                                    padding: 8px 12px;
                                    border: 1px solid #3a3a3a;
                                    border-radius: 4px;
                                    background-color: transparent;
                                ">??Ôø??ÔøΩÏã†?? <span style="color: #ff9800;">${uniqueRecipients.length}Ôø?/span></div>
                            </div>
                        </div>

                        <!-- Î∞úÏÜ° Î©îÏãúÏßÄ -->
                        <div style="margin-bottom: 25px;">
                            <div style="color: #fff; font-size: 16px; font-weight: 600; margin-bottom: 15px;">Î∞úÏÜ° Î©îÏãúÏßÄ</div>
                            <div style="
                                position: relative;
                                background-color: #1a1a1a;
                                border: 1px solid #3a3a3a;
                                border-radius: 4px;
                                transition: all 0.2s ease;
                            ">
                                <textarea 
                                    id="email-message-input" 
                                    placeholder="?ÔøΩÎ©î?ÔøΩÏóê ?ÔøΩÌï®??Î©îÏãúÏßÄÔø??ÔøΩÎ†•?ÔøΩÏÑ∏??.."
                                    style="
                                        width: 100%;
                                        height: 120px;
                                        padding: 12px;
                                        border: none;
                                        background: transparent;
                                        color: #e1e1e1;
                                        font-size: 14px;
                                        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                                        line-height: 1.5;
                                        outline: none;
                                        resize: vertical;
                                        min-height: 120px;
                                        max-height: 200px;
                                    "
                                    onfocus="this.parentElement.style.backgroundColor='#2a2a2a'; this.parentElement.style.borderColor='#4a9eff'"
                                    onblur="this.parentElement.style.backgroundColor='#1a1a1a'; this.parentElement.style.borderColor='#3a3a3a'"
                                ></textarea>
                            </div>
                            <div style="
                                color: #7a7a7a;
                                font-size: 12px;
                                margin-top: 5px;
                                text-align: right;
                            ">
                                <span id="message-char-count">0</span>/500 Í∏Ä??                            </div>
                        </div>

                        <!-- ?ÔøΩÏã†??Í∑∏Î£π -->
                        <div style="margin-bottom: 25px;">
                            <div style="color: #fff; font-size: 16px; font-weight: 600; margin-bottom: 15px;">?ÔøΩÏã†??Í∑∏Î£π</div>
                            
                            <!-- ?ÔøΩÏã†??Í≤Ä??Ôø?-->
                            <div style="margin-bottom: 20px; position: relative;">
                                <div style="
                                    position: relative;
                                    display: flex;
                                    align-items: center;
                                    background-color: #1a1a1a;
                                    border: 1px solid #3a3a3a;
                                    border-radius: 4px;
                                    padding: 0 12px;
                                    transition: all 0.2s ease;
                                " onfocus="this.style.backgroundColor='#2a2a2a'; this.style.borderColor='#4a9eff'" onblur="this.style.backgroundColor='#1a1a1a'; this.style.borderColor='#3a3a3a'">
                                    <span style="
                                        color: #7a7a7a;
                                        margin-right: 8px;
                                        font-size: 14px;
                                    ">?ÔøΩÔøΩ</span>
                                    <input 
                                        type="text" 
                                        id="recipient-search" 
                                        placeholder="?ÔøΩÏã†??Í≤Ä??.."
                                        style="
                                            flex: 1;
                                            padding: 10px 0;
                                            border: none;
                                            background: transparent;
                                            color: #e1e1e1;
                                            font-size: 14px;
                                            outline: none;
                                        "
                                    >
                                    <button 
                                        id="clear-search" 
                                        onclick="clearRecipientSearch()"
                                        style="
                                            background: none;
                                            border: none;
                                            color: #7a7a7a;
                                            cursor: pointer;
                                            padding: 4px;
                                            font-size: 16px;
                                            margin-left: 8px;
                                            display: none;
                                        "
                                        onmouseover="this.style.color='#fff'" 
                                        onmouseout="this.style.color='#7a7a7a'"
                                    >√ó</button>
                                </div>
                            </div>

                            ${generateRecipientGroups(selectedGroups, customEmailList)}
                            
                            <!-- Ôø??ÔøΩÏã†?????ÔøΩÏãú -->
                            <div style="
                                margin-top: 20px;
                                padding: 15px;
                                background-color: #1a1a1a;
                                border-radius: 4px;
                                border: 1px solid #3a3a3a;
                            ">
                                <div style="color: #fff; font-size: 16px; font-weight: 600; margin-bottom: 10px;">?ÔøΩÔøΩ ?ÔøΩÏã†???ÔøΩÍ≥Ñ</div>
                                <div style="color: #b1b1b1; font-size: 14px; line-height: 1.6;">
                                    <div>??Ôø??ÔøΩÏã†?? <span style="color: #ff9800; font-weight: 600;">${uniqueRecipients.length}Ôø?/span></div>
                                    <div>??Ï§ëÎ≥µ ?ÔøΩÍ±∞: <span style="color: #4a9eff; font-weight: 600;">${allRecipients.length - uniqueRecipients.length}Ôø?/span></div>
                                    <div>???ÔøΩÌÉù??Í∑∏Î£π: <span style="color: #4a9eff; font-weight: 600;">${selectedGroups.join(', ')}</span></div>
                                </div>
                            </div>
                        </div>

                        <!-- ?ÔøΩÎã® Î≤ÑÌäº -->
                        <div style="display: flex; justify-content: flex-end; gap: 10px; border-top: 1px solid #3a3a3a; padding-top: 20px;">
                            <button onclick="closeEmailRecipientsModal()" class="chart-btn" style="padding: 10px 20px;">?ÔøΩÍ∏∞</button>
                        </div>
                    </div>
                </div>
            `;

            // Î™®Îã¨???ÔøΩÏù¥ÏßÄ??Ï∂îÔøΩ?
            document.body.insertAdjacentHTML('beforeend', modalHTML);

            // Î™®Îã¨ ?ÔøΩÔøΩ? ?ÔøΩÎ¶≠ ???ÔøΩÍ∏∞
            document.getElementById('email-recipients-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeEmailRecipientsModal();
                }
            });

            // ?ÔøΩÏã†??Í≤Ä??Í∏∞Îä• Ôø?Î©îÏãúÏßÄ ?ÔøΩÎ†•Ôø?Í∏∞Îä• Ï∂îÔøΩ?
            setTimeout(() => {
                const searchInput = document.getElementById('recipient-search');
                const clearButton = document.getElementById('clear-search');
                const messageInput = document.getElementById('email-message-input');
                const charCount = document.getElementById('message-char-count');
                
                // ?ÔøΩÏã†??Í≤Ä??Í∏∞Îä•
                if (searchInput) {
                    searchInput.addEventListener('input', function() {
                        const searchTerm = this.value.toLowerCase();
                        const recipientRows = document.querySelectorAll('#email-recipients-modal .recipient-row');
                        
                        // X Î≤ÑÌäº ?ÔøΩÏãú/?ÔøΩÔøΩ?
                        if (clearButton) {
                            clearButton.style.display = this.value ? 'block' : 'none';
                        }
                        
                        recipientRows.forEach(row => {
                            const text = row.textContent.toLowerCase();
                            if (text.includes(searchTerm)) {
                                row.style.display = 'grid';
                            } else {
                                row.style.display = 'none';
                            }
                        });
                    });
                }
                
                // Î©îÏãúÏßÄ ?ÔøΩÎ†•Ôø?Í∏Ä????Ïπ¥Ïö¥??Í∏∞Îä•
                if (messageInput && charCount) {
                    const maxLength = 500;
                    
                    // Ï¥àÍ∏∞ Í∏Ä?????ÔøΩÏ†ï
                    charCount.textContent = messageInput.value.length;
                    
                    messageInput.addEventListener('input', function() {
                        const currentLength = this.value.length;
                        charCount.textContent = currentLength;
                        
                        // Í∏Ä?????ÔøΩÌïú
                        if (currentLength > maxLength) {
                            this.value = this.value.substring(0, maxLength);
                            charCount.textContent = maxLength;
                        }
                        
                        // Í∏Ä???ÔøΩÏóê ?ÔøΩÎ•∏ ?ÔøΩÏÉÅ Î≥ÄÔø?                        if (currentLength >= maxLength * 0.9) {
                            charCount.style.color = '#ff9800'; // Í≤ΩÍ≥† ?ÔøΩÏÉÅ
                        } else if (currentLength >= maxLength * 0.8) {
                            charCount.style.color = '#ff9800'; // Ï£ºÏùò ?ÔøΩÏÉÅ
                        } else {
                            charCount.style.color = '#7a7a7a'; // Í∏∞Î≥∏ ?ÔøΩÏÉÅ
                        }
                    });
                }
            }, 100);
        }

        // ?ÔøΩÏã†??ÎØ∏Î¶¨Î≥¥Í∏∞ Î™®Îã¨ ?ÔøΩÍ∏∞ ?ÔøΩÏàò
        function closeEmailRecipientsModal() {
            const modal = document.getElementById('email-recipients-modal');
            if (modal) {
                modal.remove();
            }
        }

        // Ôø??ÔøΩÏã†????Í≥ÑÏÇ∞ ?ÔøΩÏàò
        function calculateTotalRecipients(selectedGroups, customEmailList) {
            let total = 0;
            
            // Ôø?Í∑∏Î£πÔø??ÔøΩÏã†????Í≥ÑÏÇ∞
            selectedGroups.forEach(group => {
                switch(group) {
                    case 'Í¥ÄÎ¶¨Ïûê':
                        const adminCount = originalMembersData ? originalMembersData.filter(member => member.role === 'owner').length : 0;
                        total += adminCount;
                        break;
                    case '?ÔøΩÏ≤¥ Î©§Î≤Ñ':
                        const allMembersCount = originalMembersData ? originalMembersData.length : 0;
                        total += allMembersCount;
                        break;
                    case 'ÎπÑÌôú??Î©§Î≤Ñ':
                        const inactiveCount = originalMembersData ? originalMembersData.filter(member => member.spendData.premiumRequests === 0).length : 0;
                        total += inactiveCount;
                        break;
                }
            });
            
            // ÏßÅÏ†ë ?ÔøΩÎ†• ?ÔøΩÎ©î????Ï∂îÔøΩ?
            if (customEmailList) {
                const emails = customEmailList.split(',').filter(email => email.trim().length > 0);
                total += emails.length;
            }
            
            return total;
        }

        document.addEventListener('DOMContentLoaded', function() {
            
            // Í∏∞Î≥∏ ?ÔøΩÏ†ï ??            setTimeout(async () => {
                // ?ÔøΩÎ°≠?ÔøΩÏö¥?ÔøΩÏÑú Ï¥àÍ∏∞ Ï∞®Ìä∏ ?ÔøΩÏ†ï
                const chartSelect = document.getElementById('chartSelect');
                if (chartSelect) {
                    chartSelect.value = 'activity-trend';
                    await switchChart('activity-trend');
                }
                console.log('=== ?ÔøΩÏù¥ÏßÄ Î°úÎìú ???ÔøΩÎèô ?ÔøΩÏ†ú API ?ÔøΩÏù¥???ÔøΩÎ°úÍ≥†Ïπ® ?ÔøΩÏûë ===');
                await refreshAllRealData(); // ?ÔøΩÎèô ?ÔøΩÎ°úÍ≥†Ïπ®
                
                // ?ÔøΩÏã†????Ï¥àÍ∏∞??                setTimeout(() => {
                    updateRecipientCount();
                }, 2000); // ?ÔøΩÏù¥??Î°úÎìú ???ÔøΩÏã†????Í≥ÑÏÇ∞
            }, 100);
        });

    </script>
</body>
</html>
